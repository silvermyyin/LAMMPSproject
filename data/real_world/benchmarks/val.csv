"sample","label"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 1.0 running for 50000 steps at temperature 1.0.","# 2d NEMD simulation

units		lj
atom_style	atomic
dimension	2

lattice		sq2 0.8442
region		box prism 0 10 0 8 -0.5 0.5 0 0 0
create_box	2 box
create_atoms	1 box
mass		* 1.0

velocity	all create 1.44 87287 loop geom

region		slice block 4 6 INF INF INF INF
set		region slice type 2

pair_style	lj/cut 2.5
pair_coeff	* * 1.0 1.0 1.0

neighbor	0.3 bin
neigh_modify	delay 0 every 1

fix		1 all nvt/sllod temp 1.0 1.0 1.0 tchain 1
fix		2 all deform 1 xy erate 0.01 remap v

#dump		1 all custom 5000 dump.nemd id type x y z

#dump		2 all image 1000 image.*.jpg type type adiam 1.2
#dump_modify	2 pad 5

#dump		3 all movie 1000 movie.mpg type type adiam 1.2
#dump_modify	3 pad 5

thermo		1000

run		50000
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using zero 1.0 pair style with pair coefficients * * with a timestep of 0.005 running for 100 steps.","# Point dipoles in a 2d box

units		lj
atom_style  charge	

read_data data.NaCl

replicate 8 8 8 

velocity	all create 1.5 49893

neighbor	1.0 bin
neigh_modify	delay 0

fix             1 all nve

# LAMMPS computes pairwise and long-range Coulombics

#pair_style      coul/long 3.0
#pair_coeff      * *
#kspace_style    pppm 1.0e-3

# Scafacos computes entire long-range Coulombics
# use dummy pair style to perform atom sorting

pair_style	zero 1.0
pair_coeff	* * 

#fix		2 all scafacos p3m tolerance field 0.001

kspace_style    scafacos fmm 0.001
kspace_modify    scafacos tolerance energy

timestep	0.005
thermo          10

run		100
"
"Generate a LAMMPS input script for a NVE simulation using lj/cut 8.76 pair style with pair coefficients 1 1 0.2339 3.504 with a timestep of 1.0 running for 10000 steps.","
units real
lattice         sc 5.0
region          box block -110 60 -30 220 -90 130  units box
create_box      2 box
region          particles cylinder y 0 -30 47 130 190 units box
create_atoms    1 region particles
region          lid cylinder y 0 -30 47 190 200 units box
group           mobile type 1

create_atoms    2 mesh race_track.stl units box
group           mesh type 2

mass * 39.95
pair_style lj/cut 8.76
pair_coeff      1 1 0.2339 3.504
pair_coeff      1 2 0.2339 7.008 $(7.008*2^(1.0/6.0))
pair_coeff      2 2 0.0    1.0

balance 1.1 shift xyz 10 1.01

neigh_modify exclude type 2 2
timestep 1.0

fix track mesh setforce 0.0 0.0 0.0
fix pull mobile addforce 0.0 -0.05 0.0 region particles
fix dir  mobile oneway 10 lid -y
fix move mobile nve
fix load all balance 1000 1.1 shift xyz 10 1.01 weight neigh 0.5 weight group 2 mesh 0.1 mobile 1.0

minimize 0.0 0.0 1000 1000

reset_timestep 0 time 0.0

velocity mobile create 150.0 54634234
compute ptemp mobile temp
thermo_modify temp ptemp

thermo 1000

# dump 1 all atom 1000 race.lammpstrj
run 10000

"
"Generate a LAMMPS input script for a NPT simulation of an full system using lj/charmm/coul/long 8 10 pair style with a timestep of 2.0 running for 5000000 steps at temperature 300.0.","# 
units           real
neighbor        2.5 bin
neigh_modify    delay 1 every 1 

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic

pair_style      lj/charmm/coul/long 8 10
pair_modify     mix arithmetic
special_bonds   charmm
read_data       data.deca-ala-solv


group peptide   id <= 103
fix             rigidh all shake 1e-6 100 1000 t 1 2 3 4 5 a 23

thermo          100
thermo_style    multi
timestep        2.0
kspace_style    pppm 1e-5

fix             ensemble all npt temp 300.0 300.0 100.0 iso 1.0 1.0 1000.0 drag 0.2

# IMD setup.
fix  comm       peptide imd 5678 unwrap on trate 10

run 5000000


"
"Generate a LAMMPS input script for a NVE simulation of an atomic system running for 10 steps.","# 3d Lennard-Jones melt - MDI driver script

variable        x index 5
variable        y index 5
variable        z index 5

units           lj
atom_style      atomic
atom_modify     map array

lattice         fcc 0.8442
region          box block 0 $x 0 $y 0 $z
create_box      1 box
create_atoms    1 box
mass            1 1.0

velocity        all create 1.44 87287 loop geom

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

# NVE
fix             1 all nve
# NPT
#fix             1 all npt temp 1.0 1.0 0.1 iso 1.0 1.0 1.0

fix             2 all mdi/qm virial yes

thermo_style    custom step temp pe etotal press vol
thermo          1

run             10
"
"Generate a LAMMPS input script for a general simulation of an atomic system running for 0 steps.","# 3d Lennard-Jones melt - MDI driver script

variable        x index 5
variable        y index 5
variable        z index 5

variable        rho index 0.7 0.8 0.9

mdi             connect

label LOOP

  units         lj
  atom_style    atomic
  atom_modify   map array

  read_data     data.series.${rho}

  displace_atoms all random 0.1 0.1 0.1 48294

  neighbor      0.3 bin
  neigh_modify  delay 0 every 1 check yes

  fix           1 all mdi/qm add no virial yes connect no
  variable      evirial equal (f_1[1]+f_1[2]+f_1[3])/3

  thermo_style  custom step temp f_1 v_evirial f_1[1] f_1[2] f_1[3]

  run           0

  write_dump    all custom dump.series.driver &
                id type x y z f_1[1] f_1[2] f_1[3] modify sort id append yes
  
  clear

next rho

jump SELF LOOP

mdi             exit
"
"Generate a LAMMPS input script for a NVT simulation of an body rounded/polyhedron 1 10 system using body/rounded/polyhedron ${c_n} ${c_t} ${mu} ${A_ua} ${cut_inner} pair style with pair coefficients * * ${k_n} ${k_na} with a timestep of 0.001 running for ${steps} steps at temperature 1.2.","# 3d rounded cubes

variable    r     index 3
variable    steps index 10000

units       lj
dimension   3

atom_style  body rounded/polyhedron 1 10

read_data   data.cubes

replicate   $r $r $r

velocity    all create 1.2 187287 dist gaussian mom yes rot yes

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 1
variable c_n        equal 20
variable c_t        equal 5
variable mu         equal 0
variable A_ua       equal 1

pair_style body/rounded/polyhedron ${c_n} ${c_t} ${mu} ${A_ua} ${cut_inner}
pair_coeff * * ${k_n} ${k_na}

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix          1 all nve/body
fix          1 all nvt/body temp 1.2 1.2 0.1
#fix          1 all npt/body temp 1.2 1.2 0.1 iso 0.002 0.02 1.0

compute      p2 all pressure 1_temp

#compute      1 all body/local id 1 2 3
#dump         1 all local 1000 dump.* index c_1[1] c_1[2] c_1[3] c_1[4]

#dump         2 all image 1000 image.*.jpg type type &
#             zoom 1.5 adiam 1.5 body type 0 0 view 60 15
#dump_modify  2 pad 6

thermo_style custom step ke pe etotal c_p2 c_1_temp

thermo       1000

run          ${steps}

"
"Generate a LAMMPS input script for a NVT simulation of an full system using python 12.0 pair style with pair coefficients * * py_pot.LJCutSPCE OW HW running for 100 steps at temperature 300.0.","units           real
atom_style      full

read_data       data.spce

pair_style      python 12.0
pair_coeff      * * py_pot.LJCutSPCE OW HW

bond_style      harmonic
angle_style     harmonic
dihedral_style  none
improper_style  none

bond_coeff      1 1000.00 1.000
angle_coeff     1 100.0 109.47

special_bonds   lj/coul 0.0 0.0 1.0

neighbor        2.0 bin

fix             1 all shake 0.0001 20 0 b 1 a 1
fix             2 all nvt temp 300.0 300.0 100.0

# create only lj/cut table for the oxygen atoms from python
shell rm -f spce.table
pair_write      1 1 2000 rsq 0.1 12 spce.table OW-OW

# switch to tabulated potential with long-range coulomb as overlay
pair_style      hybrid/overlay coul/long 12.0 table linear 2000
kspace_style    pppm 1.0e-6
pair_coeff      * * coul/long
pair_coeff      1 1 table spce.table OW-OW

thermo 10
run 100

shell rm spce.table

"
"Generate a LAMMPS input script for a NPT simulation of an electron system using eff/cut 30.627847 pair style with pair coefficients * * and p p p boundary conditions running for 10 steps at temperature 20000.0.","variable        sname index h2bulk

units 		electron
newton		on
boundary	p p p

atom_style	electron

read_data  	data.${sname}

pair_style      eff/cut 30.627847
pair_coeff	* * 

neigh_modify	one 20000 page 200000

comm_modify	vel yes

compute		effTemp all temp/eff

thermo          100
thermo_style    custom step pe temp press vol
thermo_modify	temp effTemp

# structure minimization
dump            1 all xyz 1 ${sname}.min.xyz
min_style	cg
minimize 	0 1.0e-4 1 10000
undump		1

# create initial velocities according to temp, w/out e radial dof
velocity 	all create 20000.0 4928459 rot yes dist gaussian

# npt
fix		1 all npt/eff temp 20000.0 20000.0 1.0 iso 1e9 1e9 1.0
variable       density equal 11.2058851*mass(all)
thermo_style    custom step pe temp press vol v_density
thermo_modify	temp effTemp

dump		2 all xyz 10000 ${sname}.npt.xyz
compute         1 all property/atom spin eradius
dump		3 all custom 10000 ${sname}.npt.lammpstrj id type x y z c_1[1] c_1[2]

thermo          1
run		10

unfix		1
undump		2
undump		3
"
"Generate a LAMMPS input script for a general simulation of an atomic system using eam pair style with pair coefficients * * ../../../../potentials/Cu_u3.eam and p p p boundary conditions with a timestep of 0.0 running for 1 steps.","# This test compares the thermodynamic consistency of the stress, displacement_gradient
# and internal energy density as calculated with the Hardy/field method.
#
# we should see:
# * H = Grad u exact except at the free boundaries where we get u at CM != node
# * \\\\Delta W / \\\\Delta F = P converging with smaller load step / dt
#   since W and P are consistent via the balance laws thanks to Hard
echo both
units		metal	
atom_style	atomic
variable L equal 16
variable E equal 8
# create domain
lattice         fcc 3.615 origin 0.25 0.25 0.25
region		mdRegion block 0 $L -3 3 -3 3
boundary	p p p
create_box	1 mdRegion
# create atoms
create_atoms	1 region mdRegion
mass		1 63.550 
group		internal region mdRegion
# specify inter-atomic potential
pair_style	eam
pair_coeff  	* * ../../../../potentials/Cu_u3.eam
# specify neighbor/re-neighboring parameters
neighbor	0.3 bin
#neigh_modify	every 10 delay 0 check no
neigh_modify	delay 10000 check no
min_modify line quadratic
minimize  1.e-10 1.e-10 100000 1000000
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc field
fix_modify      AtC mesh  create $E 1 1 mdRegion f p p
fix_modify      AtC fields none 
fix_modify      AtC fields add mass_density displacement stress internal_energy eshelby_stress temperature
fix_modify      AtC gradients add displacement 
fix_modify      AtC set reference_potential_energy
#fix_modify      AtC  hardy_reset 1
# output
thermo		10
thermo_style custom step pe ke press lx ly lz
fix_modify	AtC  output        consistencyFE 1 text tensor_components
# displace atoms
# NOTE we need to figure out how to output post minimize w/o a ""run""
#   or try to interface with ""dump""
# this is fine, no integrator is being used
timestep 0.0
# initial before minimization?
run 	1
# increment
variable n equal 10
variable i loop $n
# NOTE this does not generate KE
label loop_i
  change_box all x scale 1.001 remap
  minimize  1.e-10 1.e-10 100000 1000000
  velocity all set 0 0 0
  run 1
next i
jump in.consistency loop_i
"
"Generate a LAMMPS input script for a general simulation of an spin system using hybrid/overlay spin/exchange 6.0 spin/magelec 4.5 spin/dmi 4.5 pair style with pair coefficients * * spin/exchange exchange 6.0 -0.01575 0.0 1.965 and p p f boundary conditions with a timestep of 0.0001.","# bfo in a 3d periodic box

units 		metal
dimension 	3
boundary 	p p f
atom_style 	spin

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice 	sc 3.96
region 		box block 0.0 34.0 0.0 34.0 0.0 5.0
create_box 	1 box
create_atoms 	1 box

# setting mass, mag. moments, and interactions for bcc iron

mass		1 1.0
set 		group all spin/random 11 2.50

pair_style 	hybrid/overlay spin/exchange 6.0 spin/magelec 4.5 spin/dmi 4.5
pair_coeff 	* * spin/exchange exchange 6.0 -0.01575 0.0 1.965
# pair_coeff 	* * spin/magelec magelec 4.5 0.000109 1.0 1.0 1.0
pair_coeff 	* * spin/magelec magelec 4.5 0.00109 1.0 1.0 1.0
pair_coeff 	* * spin/dmi dmi 4.5 0.00005 1.0 1.0 1.0

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin anisotropy 0.0000033 0.0 0.0 1.0
fix_modify	1 energy yes

timestep	0.0001

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo          100
thermo_style    custom step time v_magnorm v_emag v_tmag temp etotal
thermo_modify   format float %20.15g

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
dump 		1 all custom 50 dump.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3] c_outsp[4] c_outsp[5] c_outsp[6] c_outsp[7]

min_style	spin/cg
# min_modify 	line spin_none discrete_factor 10.0
minimize        1.0e-10 1.0e-10 1000 100
"
"Generate a LAMMPS input script for a NVT simulation using agni pair style with pair coefficients * * Al_jpc.agni Al and p p p boundary conditions with a timestep of 0.0005 running for 1000 steps at temperature 900.","
units metal
boundary p p p
read_data vacancy.data

pair_style agni
pair_coeff * * Al_jpc.agni Al
neighbor 0.3 bin 
neigh_modify delay 2 check yes 


timestep 0.0005
velocity all create 1000 12345
fix 1 all nvt temp 900 900 200
fix 5 all momentum 1 linear 1 1 1


thermo 100
thermo_style custom step ke etotal temp

# dump MyDump all custom 250 dump.atoms id type x y z vx vy vz fx fy fz

run 1000
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using hybrid/overlay coul/streitz 12.0 wolf 0.31 eam/alloy pair style with pair coefficients * * coul/streitz AlO.streitz Al O and p p p boundary conditions with a timestep of 0.0004 running for 100 steps.","# Streitz-Mintmire potential with alpha-alumina
# option to use with Ewald or Wolf sum
# EAM (AlO.eam.alloy) includes 1994 SM and 2004 Zhou versions
# Streitz Mintmire (coul/streitz) does not include 2004 Zhou modifications
# Contributing authors: Ray Shan, Chris Weinberger (Sandia)

units		metal
atom_style	charge
dimension       3
boundary        p p p

read_data    	data.streitz

group    	type1 type 1
compute   	charge1 type1 property/atom q
compute   	q1 type1 reduce ave c_charge1
group    	type2 type 2
compute   	charge2 type2 property/atom q
compute   	q2 type2 reduce ave c_charge2

variable   	qcat equal 2.8
variable  	qani equal -${qcat}*count(type1)/count(type2)
set   		group type1 charge ${qcat}
set   		group type2 charge ${qani}
variable   	qsum equal count(type1)*c_q1+count(type2)*c_q2

# Ewald sum for coul/streitz
#pair_style  	hybrid/overlay coul/streitz 12.0 ewald eam/alloy
#kspace_style  	ewald 1e-6

# Wolf sum for coul/streitz
pair_style  	hybrid/overlay coul/streitz 12.0 wolf 0.31 eam/alloy

pair_coeff   	* * coul/streitz AlO.streitz Al O
pair_coeff   	* * eam/alloy AlO.eam.alloy Al O

neighbor	1.0 bin
neigh_modify	every 10 delay 0 check yes
timestep        0.0004

thermo_style	custom step temp etotal pe evdwl ecoul elong &
                c_q1 c_q2 v_qsum press
thermo_modify  	norm yes
thermo   	10

velocity  	all create 300.0 42128
fix     	1 all qeq/slater 1 12.0 1.0e-6 100 coul/streitz
fix     	2 all nve

run    		100
"
"Generate a LAMMPS input script for a NVE simulation using lj/sf ${rc} pair style with pair coefficients 1 1 1.0 1.0 ${rc} with a timestep of ${dt} running for ${Nprod} steps.","###############################################################################
#
#
#  This input script is a modified version of the example script lj_hex.lmp
#  which is part of the supplementary (open access) material of the paper
# 
#  P. Wirnsberger, D. Frenkel and C. Dellago, 
#  ""An enhanced version of the heat exchange algorithm with excellent energy 
#  conservation properties"", J. Chem. Phys. 143, 124104 (2015).
#
#  The full article is available on arXiv: http://arxiv.org/pdf/1507.07081.
#
#
#  Description: 
#  ------------
# 
#  This file is a LAMMPS input script for carrying out a NEMD simulation of
#  Lennard-Jones using the HEX/a algorithm. The run produces two files:
#  ""out.Tlj_hex"" contains the temperature profile and ""out.Elj_hex"" the time
#  evolution of the total energy.
#
###############################################################################

log                 log.lj_hex

# heat flux
variable J          equal 0.15 	        		

# timestep
variable dt         equal 0.007				

# cutoff radius for shifted LJ-potential
variable rc         equal 3.0

# simulation time for the production run
variable tprod      equal 5000

# total number of timesteps
variable Nprod      equal floor(${tprod}/${dt})

# equilibrated steady state configuration 
read_data           ""data.lj""   

# use LJ shifted force pair style
pair_style      lj/sf ${rc}

# with coefficients eps = 1, sigma = 1, and rc = 3.0
pair_coeff      1 1 1.0 1.0 ${rc}

# increase neigbor skin because of the large timestep
neighbor  0.8 bin

# options used for fix ave/time; sample the quantities every 10 steps
variable    Nsamp    equal 10
variable    Nrepeat  equal floor(${Nprod}/${Nsamp})
variable    Nevery   equal ${Nsamp}*${Nrepeat}

# box dimensions
variable Lz  equal zhi-zlo
variable Lx  equal xhi-xlo
variable Ly  equal yhi-ylo

# reservoir width in z-direction
variable delta     equal 2.

# specify z-extents of both reservoirs
variable zlo_Thi   equal -${Lz}/4.-${delta}/2.
variable zhi_Thi   equal ${zlo_Thi}+${delta}
variable zlo_Tlo   equal ${zlo_Thi}+${Lz}/2.
variable zhi_Tlo   equal ${zlo_Tlo}+${delta}

# resolution for fix ave/spatial
variable dz        equal ${Lz}/60

# compute per-atom kinetic energy and temperature, respectively
# NOTE: In this example we ignored the centre of mass (com) velocities
#       of the individual bins for simplicity. However, we took that 
#       into account for the publication.
compute        ke        all   ke/atom
variable       T         atom  c_ke/1.5

# specify the reservoirs 
region         Thi_region     block  INF INF INF INF  ${zlo_Thi} ${zhi_Thi}
region         Tlo_region     block  INF INF INF INF  ${zlo_Tlo} ${zhi_Tlo}

# compute the temperature of the individual region
compute        cTlo  all temp/region Tlo_region
compute        cThi  all temp/region Thi_region

# calculate the energy flux from the specified heat flux
variable       F  equal  ${J}*${Lx}*${Ly}*2.

# use fix ehex to create the gradient
# hot reservoir
fix            fHi all ehex 1 +${F} region Thi_region  hex

# cold reservoir
fix            fLo all ehex 1 -${F} region Tlo_region  hex

# use velocity Verlet for integration
fix            fNVEGrad  all   nve

# calculate the centre of mass velocity of the entire box (vcmx, vcmy, vcmz)
variable vcmx equal ""vcm(all,x)""
variable vcmy equal ""vcm(all,y)""
variable vcmz equal ""vcm(all,z)""
variable vcm2 equal v_vcmx*v_vcmx+v_vcmy*v_vcmy+v_vcmz*v_vcmz

# specify the timestep
timestep  ${dt}

# frequency for console output
thermo    10000

# print timestep, temperature, total energy and v_com^2 to console
thermo_style   custom step temp etotal v_vcm2

# calculate spatial average of temperature
compute	       cchT  all  chunk/atom bin/1d z lower ${dz}
fix            fchT  all  ave/chunk  ${Nsamp} ${Nrepeat} ${Nevery} cchT v_T file out.Tlj_hex

# compute the total energy
compute   cKe all ke
compute   cPe all pe
variable  E   equal c_cKe+c_cPe

# track the time evolution of the total energy
fix       fE  all ave/time ${Nsamp} 1000 10000 v_E file out.Elj_hex

# production run
run            ${Nprod}

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using hybrid lj/cut 6.0 hdnnp ${hdnnpCutoff} dir ${hdnnpDir} showew no showewsum 5 resetew no maxew 100 cflength 1.8897261328 cfenergy 0.0367493254 pair style with pair coefficients * * hdnnp NULL H O and p p p boundary conditions with a timestep of ${dt} running for ${numSteps} steps.","###############################################################################
# MD simulation for HDNNP water
###############################################################################

###############################################################################
# VARIABLES
###############################################################################
clear
# Configuration files
variable cfgFile         string ""data.H2O-360mol""
# Timesteps
variable numSteps        equal  10
variable dt              equal  0.0005
# HDNNP
variable hdnnpCutoff     equal  6.36
variable hdnnpDir        string ""hdnnp-data""

###############################################################################
# GENERAL SETUP
###############################################################################
units metal
boundary p p p
atom_style atomic
region box block 0.0 2.2695686722465727E+01 0.0 2.3586033624598713E+01 0.0 2.2237130028217017E+01
create_box 3 box

mass 1 1.0

read_data ${cfgFile} add append offset 1 0 0 0 0
timestep ${dt}
thermo 1

###############################################################################
# HDNNP
###############################################################################
pair_style hybrid lj/cut 6.0 hdnnp ${hdnnpCutoff} dir ${hdnnpDir} showew no showewsum 5 resetew no maxew 100 cflength 1.8897261328 cfenergy 0.0367493254
pair_coeff * * hdnnp NULL H O
pair_coeff 1 * lj/cut 0.1 3.0

###############################################################################
# INTEGRATOR
###############################################################################
fix INT all nve

###############################################################################
# OUTPUT
###############################################################################
#dump 1 all atom 1 dump.hdnnp

###############################################################################
# SIMULATION
###############################################################################
run ${numSteps}
"
"Generate a LAMMPS input script for a general simulation of an charge system using hybrid/overlay pedone 15.0 coul/long 15.0 pair style with pair coefficients * * coul/long with a timestep of 0.002.","# Ca-O crystal with Pedone potential

units metal
atom_style charge

lattice fcc 4.8105  # experimental lattice parameter for fcc-lattice Ca cations

region box block 0 4 0 4 0 4
create_box 2 box
create_atoms 1 box

lattice fcc 4.8105 origin 0.5 0.5 0.5 # O anion lattice shifted by half a unit cell
create_atoms 2 box

mass 1 40.078
mass 2 15.999

displace_atoms all random 0.01 0.01 0.01 9084544
set type 1 charge 1.2
set type 2 charge -1.2

timestep 0.002
neigh_modify delay 5 every 1 check yes

pair_style hybrid/overlay pedone 15.0 coul/long 15.0
kspace_style pppm 1.0e-6

pair_coeff * * coul/long
pair_coeff 1 2 pedone 0.030211 2.241334 2.923245 5.0
pair_coeff 2 2 pedone 0.042395 1.379316 3.618701 22.0

variable len equal lx*0.25
thermo_style custom step v_len lx pe press
thermo 100
fix 1 all box/relax iso 0.0
minimize 0.0 0.0 1000 10000

print ""Expected lattice parameter: 4.7748,  computed: $(v_len:%6.4f)""
"
"Generate a LAMMPS input script for a general simulation of an hybrid rheo/thermal bond system using hybrid/overlay rheo ${cut} artificial/visc ${zeta} rheo/solid pair style with pair coefficients * * rheo and m m p boundary conditions with a timestep of 0.1 running for 40000 steps.","# ------ 2D oxidizing bar ------ #

dimension          2
units              lj
atom_style         hybrid rheo/thermal bond
boundary           m m p
comm_modify        vel yes
newton             off

region             box block -60 60 0 80 -0.01 0.01 units box
create_box         3 box bond/types 2 extra/bond/per/atom 20 extra/special/per/atom 50

region             lbar block -15 0 3 80 EDGE EDGE units box
region             rbar block 0 15 3 80 EDGE EDGE units box
region             bar union 2 lbar rbar
region             floor block EDGE EDGE EDGE 3.0 EDGE EDGE units box

lattice            hex 1.0
create_atoms       1 region bar
create_atoms       3 region floor

set                region rbar type 2
group              bar type 1 2
group              rbar type 2
group              floor type 3

set                group all sph/e 0.0
set                group all rheo/status 1

# ------ Model parameters ------#

variable           cut equal 3.0
variable           n equal 1.0
variable           rho0 equal 1.0
variable           cs equal 1.0
variable           mp equal ${rho0}/${n}
variable           zeta equal 0.05
variable           kappa equal 0.1*${rho0}/${mp}
variable           dt_max equal 0.1*${cut}/${cs}/3
variable           eta equal 0.05
variable           Cv equal 1.0
variable           L equal 0.1
variable           Tf equal 1.0

mass               * ${mp}
timestep           0.1

pair_style         hybrid/overlay rheo ${cut} artificial/visc ${zeta} rheo/solid
pair_coeff         * * rheo
pair_coeff         * * rheo/solid 1.0 1.0 1.0

special_bonds      lj 0.0 1.0 1.0 coul 0.0 1.0 1.0
create_bonds       many bar bar 1 0 1.5
special_bonds      lj 0.0 1.0 1.0 coul 1.0 1.0 1.0

bond_style         hybrid bpm/spring rheo/shell t/form 100
bond_coeff         1 bpm/spring 1.0 1.0 1.0
bond_coeff         2 rheo/shell 0.2 0.2 0.1

# ------ Apply dynamics ------#

# Note: surface detection is not performed on solid bodies, so cannot use surface property
compute         coord all rheo/property/atom coordination
variable        surf atom c_coord<22
group           surf dynamic all var surf every 10

fix             1 all rheo ${cut} quintic 0 &
                           thermal &
                           shift &
                           surface/detection coordination 22 8
fix             2 all rheo/viscosity * constant ${eta}
fix             3 all rheo/pressure * linear
fix             4 all rheo/thermal conductivity * constant ${kappa} &
                                   specific/heat * constant ${Cv} &
                                   Tfreeze * constant ${Tf} &
                                   latent/heat * constant ${L} &
                                   react 1.5 1

fix             5 rbar rheo/oxidation 1.5 2 1.0
fix             6 all wall/harmonic ylo EDGE 2.0 1.0 1.0
fix             7 all gravity 5e-5 vector 0 -1 0
fix             8 floor setforce 0.0 0.0 0.0
fix             9 surf add/heat linear 1.1 0.05
fix             10 floor add/heat constant 0 overwrite yes # fix the temperature of the floor
fix             11 all enforce2d

compute         surf all rheo/property/atom surface
compute         rho all rheo/property/atom rho
compute         phase all rheo/property/atom phase
compute         temp all rheo/property/atom temperature
compute         eng all rheo/property/atom energy
compute         nbond_shell all rheo/property/atom nbond/shell
compute         nbond_solid all nbond/atom bond/type 1

# ------ Output & Run ------ #

thermo          200
thermo_style    custom step time ke press atoms

#dump            1 all custom 200 atomDump id type x y vx vy fx fy c_phase c_temp c_eng c_nbond_solid c_nbond_shell c_rho c_surf

run             40000
"
"Generate a LAMMPS input script for a NVE simulation and p p p boundary conditions with a timestep of 0.5e-3 running for ${nsteps} steps.","# Demonstrate MLIAP interface to linear SNAP potential

# Initialize simulation

variable nsteps index 100
variable nrep equal 4
variable a equal 3.316
units           metal

# generate the box and atom positions using a BCC lattice

variable nx equal ${nrep}
variable ny equal ${nrep}
variable nz equal ${nrep}

boundary        p p p

lattice         bcc $a
region          box block 0 ${nx} 0 ${ny} 0 ${nz}
create_box      1 box
create_atoms    1 box

mass 1 180.88

# choose potential

include Ta06A.nn.mliap

# Setup output

compute  eatom all pe/atom
compute  energy all reduce sum c_eatom

compute  satom all stress/atom NULL
compute  str all reduce sum c_satom[1] c_satom[2] c_satom[3]
variable press equal (c_str[1]+c_str[2]+c_str[3])/(3*vol)

thermo_style    custom step temp epair c_energy etotal press v_press
thermo          10
thermo_modify norm yes

# Set up NVE run

timestep 0.5e-3
neighbor 1.0 bin
neigh_modify once no every 1 delay 0 check yes

# Run MD

velocity all create 300.0 4928459 loop geom
fix 1 all nve
run             ${nsteps}

"
"Generate a LAMMPS input script for a general simulation of an molecular system using lj/cut 5.88 pair style with pair coefficients * * 0.0 0.0 5.88 and p p p boundary conditions with a timestep of 0.00025 running for 2000 steps.","#===========================================================================#
# 2 particle microrheology test                                             #
#                                                                           #
# Run consists of 2 colloidal particles undergoing Brownian motion in a     #
#   thermal lattice-Boltzmann fluid.                                        #
#                                                                           #
# If you uncomment the ""fix printCM..."" line, sample output from this run   #
# can be found in the file:                                                 # 
#   'twocolloid.out'                                                        #
#===========================================================================#

units          nano
dimension      3
boundary       p p p
atom_style     molecular
read_data      data.two

#----------------------------------------------------------------------------
# Need a neighbor bin size smaller than the lattice-Boltzmann grid spacing   
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid. 
# The arguments for neigh_modify have been set to ""delay 0 every 1"", again
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid.  However, these values can likely
#   be somewhat increased without issue.  If a problem does arise (a particle
#   is outside of its processors LB grid) an error message is printed and 
#   the simulation is terminated.                                 
#---------------------------------------------------------------------------- 
neighbor 0.3 bin
neigh_modify delay 0 every 1
neigh_modify exclude type 2 2
neigh_modify exclude type 2 1

comm_modify cutoff 2.5       # cutoff for communcation shoud be at least 2 dx

#----------------------------------------------------------------------------
# Implement a hard-sphere interaction between the particles at the center of 
#   each colloidal object (use a truncated and shifted Lennard-Jones 
#   potential).
#----------------------------------------------------------------------------
pair_style	lj/cut 5.88
pair_coeff	* * 0.0 0.0 5.88
pair_coeff      1 1 100.0 5.238484463 5.88
pair_modify     shift yes

mass * 0.0002398
timestep 0.00025

#----------------------------------------------------------------------------
# ForceAtoms are the particles at the center of each colloidal object which  
#   do not interact with the fluid, but are used to implement the hard-sphere
#   interactions.       
# FluidAtoms are the particles representing the surface of the colloidal
#   object which do interact with the fluid.                               
#----------------------------------------------------------------------------
group ForceAtoms type 1
group FluidAtoms type 2

#---------------------------------------------------------------------------
# Create a lattice-Boltzmann fluid covering the simulation domain.
# This fluid feels a force due to the particles specified through FluidAtoms 
#   (however, this fix does not explicitly apply a force back on to these 
#    particles...this is accomplished through the use of the lb/viscous fix).
# Use a fluid viscosity = 1.0, fluid density= 0.0009982071 (water), and a
#   lattice spacing dx=1.2.
# Use the trilinear interpolation stencil to distribute the force from
#   a given particle onto the fluid mesh.
# Use a thermal lattice-Boltzmann fluid (temperature 300K, random number 
#   seed=2762).  This enables the particles to undergo Brownian motion in 
#   the fluid.
#----------------------------------------------------------------------------
fix   1 FluidAtoms lb/fluid 1 1.0 0.0009982071 dx 1.2 stencil 2 noise 300.0 2762

#----------------------------------------------------------------------------
# Apply the force due to the fluid onto the FluidAtoms particles (again,
#   these atoms represent the surface of the colloidal object, which should
#   interact with the fluid).
#----------------------------------------------------------------------------
fix   2 FluidAtoms lb/viscous

#----------------------------------------------------------------------------
# Each colloidal object (spherical shell of particles and central particle)
#   is specified as a separate molecule in the confinedcolloids.dat data
#   file.  Integrate the motion of these sets of particles as rigid objects 
#   which each move and rotate together.
#----------------------------------------------------------------------------
fix   3 all rigid molecule

#----------------------------------------------------------------------------
# To ensure that numerical errors do not lead to a buildup of momentum in the
#   system, the momentum_lb fix is used every 50000 timesteps to zero out the
#   total (particle plus fluid) momentum in the system.
#----------------------------------------------------------------------------
fix   4 all lb/momentum 50000 linear 1 1 1

#----------------------------------------------------------------------------
# Create variables containing the positions of the central atoms (these 
#   values should correspond to the center of mass of each composite 
#   colloidal particle), and output these quantities to the screen.
#----------------------------------------------------------------------------
variable x1 equal x[1]
variable y1 equal y[1]
variable z1 equal z[1]
variable x2 equal x[242]
variable y2 equal y[242]
variable z2 equal z[242]

#fix printCM all print 100 ""$(step) ${x1} ${y1} ${z1} ${x2} ${y2} ${z2}"" file twocolloid.out screen no
thermo_style custom step v_x1 v_y1 v_z1 v_x2 v_y2 v_z2
thermo       100

run 2000
#run	       2000000000
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff lmp_control pair style with pair coefficients * * ffield.reax.AuO O Au with a timestep of 0.25 running for 100 steps.","# REAX potential for AuO system
# .....

units           real

atom_style      charge
read_data       data.AuO

pair_style      reaxff lmp_control
pair_coeff      * * ffield.reax.AuO O Au

neighbor        2 bin
neigh_modify    every 10 delay 0 check no

fix             1 all nve
fix             2 all qeq/reax 1 0.0 10.0 1e-6 param.qeq
fix             3 all temp/berendsen 500.0 500.0 100.0

timestep        0.25

thermo 5

#dump           1 all atom 30 dump.reax.auo

run             100
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style with pair coefficients 1 1 0.238 3.405 and p p p boundary conditions with a timestep of 0.0 running for 1 steps.","# This test compares Hardy and Cauchy-Born metrics of energy density and stress
# for an Ar system subjected to volumetric stretching.
echo  both
units       real
atom_style  atomic
variable lattice_constant equal 5.256227487
variable c equal 6
variable L equal $c*${lattice_constant}
#variable d equal 0.01
variable d equal 0.005
variable s equal 1.005
variable V0 equal ($c*${lattice_constant})^3
# create system
lattice        fcc ${lattice_constant} origin 0.25 0.25 0.25
region          box block 0 $c 0 $c 0 $c
boundary        p p p
create_box      1 box 
create_atoms    1 box 
mass            1 39.95 
group           all region box
pair_style lj/cut 13.5  
pair_coeff 1 1 0.238 3.405 
#           ID  group atc PhysicsType ParameterFile
fix         AtC all   atc field Ar_CauchyBorn.mat
fix_modify  AtC mesh create $c $c $c box p p p
fix_modify  AtC  fields none
fix_modify  AtC  fields add displacement
fix_modify  AtC  fields add internal_energy stress cauchy_born_energy cauchy_born_stress
fix_modify  AtC  gradients add displacement
fix_modify  AtC set reference_potential_energy 0.
fix_modify  AtC  output cb_volumetricFE 1 full_text tensor_components
log  cb_volumetric.log
thermo 100
variable gamma equal 0.0
variable step  equal 0
thermo_style  custom step v_step pxx pyy pzz pxy pxz pyz v_gamma pe 
timestep 0.0
min_modify      line quadratic
timestep 0.0
variable i loop 4
label loop_i
  print "">>> step $i""
  minimize 1.e-20 1.e-20 1000 1000
  run  1
  variable step equal ${step}+1
  change_box all x scale $s y scale $s z scale $s remap
  variable gamma equal lx/$L-1.0
next i
jump in.cb_volumetric loop_i
"
"Generate a LAMMPS input script for a NVE simulation of an electron system using eff/cut 5000.0 pair style with pair coefficients * * and f f f boundary conditions with a timestep of 0.001 running for 1000000 steps at temperature 300.0.","variable        sname index ch4_ionized

units           electron
newton          on
boundary        f f f

atom_style      electron 

read_data       data.${sname}

pair_style      eff/cut 5000.0
pair_coeff      * *

comm_modify     vel yes 

# minimize

min_style       cg
min_modify      line quadratic 
minimize        0 1.0e-6 10000 100000

# dynamics
compute         effTemp all temp/eff

thermo          100
thermo_style    custom step etotal pe ke temp press
thermo_modify   temp effTemp

# equilibrate
timestep        0.001
fix             1 all nvt/eff temp 300.0 300.0 0.1
 
# the custom dump includes the radii
compute         1 all property/atom spin eradius
#dump            1 all custom 100 ${sname}.nvt.lammpstrj id type x y z c_1[1] c_1[2]
#dump           2 all xyz 100 ${sname}.nvt.xyz 

run             1000000

fix             2 all nve/eff

run             1000000 
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using lj/cut 1.122562 pair style with pair coefficients 1 1 1.0 1.0 running for 10000 steps at temperature 0.722.","# biaxial NPT deformation of WCA fluid

units		lj
atom_style	atomic


pair_style	lj/cut 1.122562
read_data       data.wca
pair_coeff	1 1 1.0 1.0
pair_modify     shift yes

neighbor	0.5 bin
neigh_modify	delay 0

change_box      all triclinic

# these commads show the different methods that may be used to impose
# a constant stress through isotropic or anisotropic coupling
fix		1 all npt/uef temp 0.722 0.722 0.5 iso 10 10 5 erate 0.5 0.5 ext z
#fix		1 all npt/uef temp 0.722 0.722 0.5 z 10 10 5  erate 0.5 0.5 ext xyz

fix             2 all momentum 100 linear 1 1 1

#dump		1 all atom 25 dump.lammpstrj

#dump		2 all cfg/uef 25 dump.*.cfg mass type xs ys zs

thermo_style    custom step c_1_press[1] c_1_press[2] c_1_press[3]

thermo		50
run		10000
"
"Generate a LAMMPS input script for a NVE simulation of an ellipsoid system using resquared 4.0 pair style with pair coefficients 1 1 3.0 1 1 1 1 1 1 1 2.5 with a timestep of 0.002 running for 2000 steps at temperature 2.0.","# RESquared ellipsoids in LJ background fluid

units        lj
atom_style   ellipsoid
dimension    2

lattice      sq 0.02
region       box block 0 20 0 20 -0.5 0.5
create_box   2 box
create_atoms 1 box

set          group all type/fraction 2 0.1 95392
set          type 1 mass 1.0
set          type 2 mass 1.5
set          type 1 shape 1 1 1
set          type 2 shape 3 1 1
set          group all quat/random 18238

compute      rot all temp/asphere
group        spheroid type 1
variable     dof equal count(spheroid)+2
compute_modify rot extra/dof ${dof}

velocity     all create 2.4 87287 loop geom

pair_style   resquared 4.0
pair_coeff   1 1 3.0 1 1 1 1 1 1 1 2.5
pair_coeff   1 2 3.0 1 1 1 1 0 0 0
pair_coeff   2 2 1.0 1 1 1 0.2 0 0 0

neighbor     0.8 bin

thermo_style custom step c_rot epair etotal press vol
thermo       100

timestep     0.002

compute      0 all property/atom quatw quati quatj quatk shapex shapey shapez

dump        1 all custom 100 dump.ellipse.resquared id type x y z c_0[*]
dump_modify 1 colname c_0[1] quatw colname c_0[2] quati colname c_0[3] quatj colname c_0[4] quatk &
              colname c_0[5] shapex colname c_0[6] shapey colname c_0[7] shapez

#dump        1 all custom 100 dump.ellipse.resquared &
#            id type x y z c_q[1] c_q[2] c_q[3] c_q[4]

#dump        2 all image 100 image.*.jpg type type &
#            zoom 1.6 center d 0.5 0.5 0.5
#dump_modify  2 pad 4 adiam 1 1.0 adiam 2 2.0

#dump        3 all movie 100 movie.mpg type type &
#            zoom 1.6 center d 0.5 0.5 0.5
#dump_modify  3 pad 4 adiam 1 1.0 adiam 2 2.0

fix          1 all npt/asphere temp 2.0 2.0 0.1 iso 0.0 1.0 1.0 &
               mtk no pchain 0 tchain 1
fix          2 all enforce2d

compute_modify 1_temp extra/dof ${dof}

# equilibrate to shrink box around dilute system

run          2000

# run dynamics on dense system

unfix        1
fix          1 all nve/asphere

run          2000
"
"Generate a LAMMPS input script for a NVT simulation using eam/alloy pair style with pair coefficients * * AlCu.eam.alloy Cu Al with a timestep of 0.002 running for 10000 post no steps at temperature 2500.0.","# Example for an alchemical transformation simulation of pure copper into an aluminium bronze

# set up different names for two partitions
variable name world pure alloy

# create pure copper system
units metal
lattice fcc 3.75
region box block 0 6 0 6 0 6
create_box 2 box

timestep 0.002
create_atoms 1 box
displace_atoms all random 0.3 0.3 0.3 57845645
pair_style eam/alloy
pair_coeff * * AlCu.eam.alloy Cu Al

# replace 5% of copper with aluminium on the second partition only
if ""${name} == alloy"" then &
   ""set type 1 type/fraction 2 0.05 6745234""

# define ramp variable to combine the two different partitions
if ""${name} == pure"" then             &
   ""variable ramp equal ramp(1.0,0.0)""    &
else                                      &
   ""variable ramp equal ramp(0.0,1.0)""

velocity all create 5000.0 6567345
fix 1 all nvt temp 2500.0 500.0 0.002
fix 2 all alchemy v_ramp

compute pressure all pressure/alchemy 2

# only need to output a dump file from one partition
#if ""${name} == alloy"" then &
#    ""dump 1 all custom 100 ${name}.lammpstrj id type element x y z"" &
#    ""dump_modify 1 element Cu Al""

thermo_style custom step temp press etotal density pe ke f_2 f_2[3]
thermo_modify colname f_2 lambda colname f_2[3] EPot_mixed
thermo_modify press pressure

thermo 100
run 10000 post no

"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using meam/spline pair style with pair coefficients * * Si_1.meam.spline Si and p p p boundary conditions running for 500 steps at temperature 500.0.","# Si fcc phase

units           metal
boundary        p p p

atom_style      atomic
lattice         fcc 3.98
region          box block 0 5 0 5 0 5
create_box              1 box
create_atoms    1 box

pair_style      meam/spline
pair_coeff      * * Si_1.meam.spline Si
mass            * 28.085

velocity        all create 500.0 44226611

fix             1 all nvt temp 500.0 500.0 1.0

thermo          50
run             500

"
"Generate a LAMMPS input script for a NPT simulation of an full system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0  2.5 and p p p boundary conditions with a timestep of 0.005 running for 400 steps at temperature 1.0.","# run019 <016/tolammps.py -> input.lammps
# T=0.3 harmonic
# Np=900
# f=6
# dens = 0.80
# rigid wall: none

log             quartic_bonds.log
echo            both
units           lj
lattice		sc 1.0
boundary        p p p
neighbor        1.0 bin
neigh_modify    every 5 delay 0 check yes

atom_style      full
bond_style      harmonic 
#angle_style	harmonic
pair_style      lj/cut 2.5
pair_modify     table 0
special_bonds   lj 0.0 1.0 1.0

read_data    	quartic_bonds.data

special_bonds   lj 0.0 1.0 1.0  

bond_coeff      1 100.0 1.0 

pair_coeff	* * 1.0 1.0  2.5

timestep        0.005

fix             NPT all npt temp 1.0 1.0  1.0  iso 0.1 0.1 10.0

thermo_style    custom step temp etotal evdwl ebond pxx pyy pzz lz 
thermo_modify   flush yes
thermo          100

########################################################################
variable        l equal xhi
region          MESH  block -$l $l -$l $l -$l $l
group           MESH  region MESH
#               ID  group atc PhysicsType ParameterFile
fix             ATC MESH  atc field
fix_modify      ATC atom_element_map eulerian 100
fix_modify      ATC fields add mass_density energy stress
##               ID  part keywords    nx ny nz region
fix_modify      ATC mesh  create 4 4 1 MESH p p p
fix_modify      ATC bond_interactions on
fix_modify      ATC pair_interactions on
fix_modify      ATC output nodeset all average energy
fix_modify      ATC output nodeset all average stress
fix_modify      ATC output quartic_bondsFE 100 full_text binary tensor_components
#########################################################################

reset_timestep	0

dump            d1 all custom 10000 config.dmp id type mol x y z ix iy iz

run             400
"
"Generate a LAMMPS input script for a general simulation of an line system using line/lj 2.5 pair style with pair coefficients * * 1.0 1.0 1.0 0.25 2.5 with a timestep of 0.004 running for 10000 steps.","# Aspherical shear demo - 2d line box and triangle mixture, implicit solvent

units           lj
atom_style      line
dimension       2

read_data       data.line

velocity        all create 1.44 320984 loop geom

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes
neigh_modify    exclude molecule/intra all

pair_style      line/lj 2.5
pair_coeff      * * 1.0 1.0 1.0 0.25 2.5

fix             2 all rigid molecule langevin 2.0 2.0 1.0 492983

fix             3 all deform 1 x scale 0.3 y scale 0.3
fix             4 all enforce2d

compute         10 all property/atom end1x end1y end2x end2y

#dump           1 all custom 500 dump1.atom id type x y z ix iy iz
#dump           2 all custom 500 dump1.line id type &
#               c_10[1] c_10[2] c_10[3] c_10[4]

timestep        0.004

compute         1 all erotate/asphere
compute         2 all ke
compute         3 all pe
variable        toteng equal (c_1+c_2+c_3)/atoms

compute_modify  thermo_temp extra/dof -350

thermo          1000
thermo_style    custom step f_2 pe ke c_1 c_2 c_3 v_toteng

run             10000

#undump          1
#undump          2
unfix           3

change_box      all triclinic

#dump           1 all custom 500 dump2.atom id type x y z ix iy iz
#dump           2 all custom 500 dump2.line id type &
#               c_10[1] c_10[2] c_10[3] c_10[4]

fix             3 all deform 1 xy erate 0.01 units box

run             10000
"
"Generate a LAMMPS input script for a NVE simulation using mliap model mliappy ACE_NN_Pytorch.pt descriptor ace ccs_single_element.yace pair style with pair coefficients * * Ta and p p p boundary conditions with a timestep of 0.5e-3 running for ${nsteps} steps.","# Demonstrate MLIAP/PyTorch interface to linear ACE potential

# Initialize simulation

variable        nsteps index 100
variable        nrep equal 4
variable        a equal 3.316
units           metal

# generate the box and atom positions using a BCC lattice

variable nx equal ${nrep}
variable ny equal ${nrep}
variable nz equal ${nrep}

boundary        p p p

lattice         bcc $a
region          box block 0 ${nx} 0 ${ny} 0 ${nz}
create_box      1 box
create_atoms    1 box

mass 1 180.88

# choose potential

pair_style mliap model mliappy ACE_NN_Pytorch.pt descriptor ace ccs_single_element.yace
pair_coeff * * Ta


# Setup output

compute  eatom all pe/atom
compute  energy all reduce sum c_eatom

compute  satom all stress/atom NULL
compute  str all reduce sum c_satom[1] c_satom[2] c_satom[3]
variable press equal (c_str[1]+c_str[2]+c_str[3])/(3*vol)

thermo_style    custom step temp epair c_energy etotal press v_press
thermo          10
thermo_modify norm yes

# Set up NVE run

timestep 0.5e-3
neighbor 1.0 bin
neigh_modify once no every 1 delay 0 check yes

# Run MD

velocity all create 300.0 4928459 loop geom
fix 1 all nve

# Uncomment dumps commands for visualization
#dump            0 all cfg 10 min.*.cfg mass type xs ys zs
#dump_modify     0 element Ta

run             ${nsteps}

"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 with a timestep of 0.001 running for 1000 steps.","# 2d SRD test: big + small particles

units		lj
atom_style	sphere
atom_modify	first big
dimension	2

# create big particles with sigma 1.0

lattice		sq 0.4
region		box block 0 10 0 10 -0.5 0.5
create_box	2 box
create_atoms	1 region box
set		type 1 mass 1.0
set		type 1 diameter 1.0

group		big type 1
velocity	big create 1.44 87287 loop geom

# equilibrate big particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix		1 big nve
fix		2 all enforce2d

run		1000

unfix		1
unfix		2

# add small particles as hi density lattice

lattice		sq 0.4
region		plane block 0 10 0 10 -0.001 0.001
lattice		sq 85.0
create_atoms	2 region plane
set		type 2 mass 0.01
set		type 2 diameter 0.0

group		small type 2

velocity	small create 1.0 593849 loop geom

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.5

delete_atoms	overlap 0.5 small big

# SRD run

reset_timestep	0

neighbor	0.3 multi
neigh_modify	delay 0 every 1 check yes

comm_modify	mode multi group big vel yes
neigh_modify	include big

# no pairwise interactions with small particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones

timestep	0.001

fix		1 big nve
fix	        2 small srd 20 big 1.0 0.25 49894 &
		  radius 0.88 search 0.2 collision slip
fix		3 all enforce2d

# diagnostics

compute		tbig big temp
variable	pebig equal pe*atoms/count(big)
variable	ebig equal etotal*atoms/count(big)
thermo_style	custom step temp f_2[7] etotal v_pebig v_ebig press &
		f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] &
		f_2[6] f_2[8] f_2[9] f_2[10]

thermo_modify	temp tbig
thermo		100

#dump		1 all atom 250 dump.srd.mixture

#dump		2 all image 250 image.*.jpg type type zoom 1.6
#dump_modify	2 pad 4 adiam 1 1 adiam 2 0.2

#dump		3 all movie 250 movie.mpg type type zoom 1.6
#dump_modify	3 pad 4 adiam 1 1 adiam 2 0.2

run		5000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/cut 5.0 pair style with a timestep of 1.0 running for 1000 steps.","# LJ particles
variable        T0 equal 300.0
variable        press equal 0.0

units           real
atom_style      full
pair_style      lj/cut 5.0

read_data       ""lj.data""

thermo          10
thermo_style    custom step temp pe etotal press vol

timestep        1.0

fix             fxnvt all nvt temp ${T0} ${T0} 1000.0
fix             fxgREM all grem 400 -.01 -30000 fxnvt
run             1000

#write_data      lj-out.data
"
"Generate a LAMMPS input script for a general simulation of an electron system using eff/cut 100.0 pair style with pair coefficients * * and f f f boundary conditions.","variable        sname index ch4

units           electron
newton          on
boundary        f f f

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 100.0
pair_coeff      * *

comm_modify     vel yes 

compute         effTemp all temp/eff

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        ecoul equal c_energies[3]
variable        erres equal c_energies[4]

thermo          1
thermo_style    custom step etotal pe ke v_eke v_epauli v_ecoul v_erres

min_style       cg
compute         1 all property/atom spin eradius erforce
#dump            2 all custom 10 ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
minimize        0 1e-6 2000 4000

"
"Generate a LAMMPS input script for a NVE simulation of an full system using born/coul/dsf/cs 0.1 20.0 20.0    # A, rho, sigma=0, C, D pair style with pair coefficients * *      0.0 1.000   0.00  0.00   0.00 and p	p	p boundary conditions with a timestep of 0.002 running for 500 steps.","# Testsystem for core-shell model compared to Mitchel and Finchham
# Hendrik Heenen, June 2014

# ------------------------ INITIALIZATION ----------------------------

units 		metal
dimension	3
boundary	p	p	p
atom_style	full

# ----------------------- ATOM DEFINITION ----------------------------

fix csinfo all property/atom i_CSID
read_data data.coreshell fix csinfo NULL CS-Info

group cores type 1 2
group shells type 3 4

neighbor 2.0 bin
comm_modify vel yes

# ------------------------ FORCE FIELDS ------------------------------

pair_style   born/coul/dsf/cs 0.1 20.0 20.0    # A, rho, sigma=0, C, D 
pair_coeff   * *      0.0 1.000   0.00  0.00   0.00
pair_coeff   3 3    487.0 0.23768 0.00  1.05   0.50 #Na-Na
pair_coeff   3 4 145134.0 0.23768 0.00  6.99   8.70 #Na-Cl
pair_coeff   4 4 405774.0 0.23768 0.00 72.40 145.40 #Cl-Cl

bond_style harmonic
bond_coeff 1 63.014 0.0
bond_coeff 2 25.724 0.0

# ------------------------ Equilibration Run -------------------------------

reset_timestep 0

thermo 50
thermo_style custom step etotal pe ke temp press &
             epair evdwl ecoul elong ebond fnorm fmax vol

compute CSequ all temp/cs cores shells 

# output via chunk method

#compute prop all property/atom i_CSID
#compute cs_chunk all chunk/atom c_prop
#compute cstherm all temp/chunk cs_chunk temp internal com yes cdof 3.0
#fix ave_chunk all ave/time 100 1 100 c_cstherm file chunk.dump mode vector 

thermo_modify temp CSequ

# velocity bias option

velocity all create 1427 134 dist gaussian mom yes rot no bias yes temp CSequ
velocity all scale 1427 temp CSequ

fix thermoberendsen all temp/berendsen 1427 1427 0.4
fix nve all nve
fix_modify thermoberendsen temp CSequ

# 2 fmsec timestep

timestep 0.002
run 500

unfix thermoberendsen

# ------------------------ Dynamic Run -------------------------------

run 1000
"
"Generate a LAMMPS input script for a general simulation and p p p # ffield uses periodic z- and no slab boundary conditions running for 500 steps.","# electrodes with constant potential using finite field
# for z-periodic graphene-ionic liquid supercapacitor

boundary p p p # ffield uses periodic z-boundary and no slab
include settings.mod # styles, groups, computes and fixes

fix conp bot electrode/conp -1.0 1.979 couple top 1.0 symm on etypes on ffield yes

thermo 50
thermo_style custom step temp c_ctemp epair etotal c_qbot c_qtop
run 500
"
"Generate a LAMMPS input script for a NVE simulation of an bond system using soft 1.12246 pair style with pair coefficients * * 0.0 1.12246 running for 1000 steps.","# 2d micelle simulation

dimension	2

neighbor	0.3 bin
neigh_modify	delay 5

atom_style	bond

# Soft potential push-off

read_data	data.micelle
special_bonds	fene

pair_style	soft 1.12246
pair_coeff	* * 0.0 1.12246

bond_style 	harmonic
bond_coeff	1 50.0 0.75

velocity	all create 0.45 2349852

variable	prefactor equal ramp(1.0,20.0)

fix		1 all nve
fix		2 all temp/rescale 100 0.45 0.45 0.02 1.0
fix		3 all adapt 1 pair soft a * * v_prefactor
fix		4 all enforce2d

thermo		50
run		1000

unfix		3

# Main run

pair_style	lj/cut 2.5

# solvent/head - full-size and long-range

pair_coeff	1 1 1.0 1.0 2.5
pair_coeff	2 2 1.0 1.0 2.5
pair_coeff	1 2 1.0 1.0 2.5

# tail/tail - size-averaged and long-range

pair_coeff	3 3 1.0 0.75 2.5
pair_coeff	4 4 1.0 0.50 2.5
pair_coeff	3 4 1.0 0.67 2.5

# solvent/tail - full-size and repulsive

pair_coeff	1 3 1.0 1.0 1.12246
pair_coeff	1 4 1.0 1.0 1.12246

# head/tail - size-averaged and repulsive

pair_coeff	2 3 1.0 0.88 1.12246
pair_coeff	2 4 1.0 0.75 1.12246

thermo		50

#dump		1 all atom 2000 dump.micelle

#dump		2 all image 2000 image.*.jpg type type zoom 1.6
#dump_modify	2 pad 5 adiam 1 0.5 adiam 2 1.5 adiam 3 1.0 adiam 4 0.75

#dump		3 all movie 2000 movie.mpg type type zoom 1.6
#dump_modify	3 pad 5 adiam 1 0.5 adiam 2 1.5 adiam 3 1.0 adiam 4 0.75

reset_timestep	0
run		1000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using rebo pair style with pair coefficients * * CH.rebo C H with a timestep of 0.0005 running for 100 steps.","# REBO polyethelene benchmark

units               metal
atom_style          atomic

read_data           data.airebo

replicate           17 16 2

neighbor            0.5 bin
neigh_modify        delay 5 every 1

pair_style          rebo
pair_coeff          * * CH.rebo C H

velocity            all create 300.0 761341

fix                 1 all nve
timestep            0.0005

thermo              10
run                 100
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using hybrid/overlay zero 9.0 eam/fs pair style with pair coefficients * *  zero and p p p boundary conditions with a timestep of 0.002 running for ${equilSteps} steps.","variable        trequis equal 750.0
variable        prequis_low equal 0.0
variable        prequis_high equal 25.0e4
variable        equilSteps equal 200
variable        runSteps equal 2000
variable        freqdump equal 200
variable        pstime equal step*dt
variable        sxx equal 1.e-4*pxx
variable        syy equal 1.e-4*pyy
variable        szz equal 1.e-4*pzz
variable        sxy equal 1.e-4*pxy
variable        sxz equal 1.e-4*pxz
variable        syz equal 1.e-4*pyz
variable        TK  equal temp
variable        PE  equal pe
variable        KE  equal ke
variable        V   equal vol

dimension       3
boundary        p p p
units           metal
atom_style      atomic
read_data       data.zr_cell
replicate       1 5 5

change_box      all triclinic

pair_style      hybrid/overlay zero 9.0 eam/fs
pair_coeff * *  zero
pair_coeff * *  eam/fs Zr_mm.eam.fs Zr

timestep        0.002

thermo          50
thermo_style    custom step pe ke temp vol pxx pyy pzz pxy pyz pxz

# fix             extra all print 50 ""${pstime} ${TK} ${PE} ${KE} ${V} ${sxx} ${syy} ${szz} ${sxy} ${sxz} ${syz}""  file thermo_global_npt_low_temperature_Zr_hcp.dat

velocity        all create ${trequis} 42345 dist gaussian

# 1st step : compute the bispectrum on 24 nearest neighbors
compute         bnnn all sna/atom 9.0 0.99363 8 0.5 1.0 rmin0 0.0 nnn 24 wmode 1 delta 0.25

# 2nd step : perform dimension reduction + logistic regression
compute         slcsa all slcsa/atom 8 4 dir.slcsa/mean_descriptor.dat dir.slcsa/lda_scalings.dat dir.slcsa/lr_decision.dat dir.slcsa/lr_bias.dat dir.slcsa/mahalanobis_file.dat c_bnnn[*]

#dump            d1 all custom ${freqdump} slcsa_demo.dump id x y z c_slcsa[*]

# for testing only. in production use dump as shown above
compute max_slcsa all reduce max c_slcsa[*]
compute min_slcsa all reduce min c_slcsa[*]
thermo_style    custom step pe ke temp c_max_slcsa[*] c_min_slcsa[*]

#fix            1 all nvt temp ${trequis} ${trequis} 0.100
fix             1 all npt temp ${trequis} ${trequis} 0.100 tri ${prequis_low} ${prequis_low} 1.0

run             ${equilSteps}
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system and f p p boundary conditions with a timestep of ${dt} running for 100 steps.","# DESCRIPTION: haynes-schockley
echo both
units    metal

variable V equal  5000.0
variable n0 equal 0.085
variable dn equal 2.0*${n0}
variable dt equal 0.0005
variable s equal 10

timestep  ${dt}

atom_style  atomic
lattice         fcc 1.0 
region    simRegion block -50 50  0 1 0 1
boundary  f p p
create_box  1 simRegion
mass    1 1.0 # need to keep this
atom_modify     sort 0 1

#          ID  group atc PhysicsType ParameterFile
fix        AtC all   atc convective_drift_diffusion  Cu_cddm.mat

#          ID  part keywords    nx ny nz region
fix_modify AtC mesh  create 100 1  1  simRegion f p p

fix_modify AtC material all Cu

fix_modify AtC mesh create_nodeset lbc -50.0 -50.0 -INF  INF -INF  INF
fix_modify AtC mesh create_nodeset rbc  50.0  50.0 -INF  INF -INF  INF

# fix a temperature
fix_modify AtC  initial temperature          all 300.0
#fix_modify AtC  initial electron_temperature all 300.0
fix_modify AtC  fix electron_temperature all 300.
#fix_modify AtC  initial electron_temperature all gaussian 0 0 0 1 0 0 5.0 300. 300.
fix_modify AtC  initial electron_density all gaussian 0 0 0 1 0 0 5.0 ${dn} ${n0}
#fix_modify AtC fix electron_density all ${n0}
# isolate system: 
# diffusion: dn/dx = 0
# drift    : n = 0
fix_modify AtC  fix electron_density lbc ${n0}
fix_modify AtC  fix electron_density rbc ${n0}
fix_modify AtC  fix temperature lbc 300.0
fix_modify AtC  fix temperature rbc 300.0
fix_modify AtC  fix electron_temperature lbc 300.0
fix_modify AtC  fix electron_temperature rbc 300.0
fix_modify AtC  fix electric_potential all 0.
fix_modify AtC extrinsic electron_integration implicit

# electron velocity
fix_modify AtC initial electron_velocity x all 0.
#fix_modify AtC fix electron_velocity x all 0.
fix_modify AtC initial electron_velocity y all 0.
fix_modify AtC fix electron_velocity y all 0
fix_modify AtC initial electron_velocity z all 0.
fix_modify AtC fix electron_velocity z all 0.

# f_AtC:1 thermal energy, 2 avg T, 3 electron energy, 4 avg Te, 5 total n
thermo_style custom step cpu f_AtC[1] f_AtC[2] f_AtC[3] f_AtC[4] f_AtC[5]
thermo_modify  format 1 %5i format 2 %7.2g
fix_modify      AtC  output   convective_pulseFE $s text binary
thermo  $s
#run     100

# free electric field and allow shielding
fix_modify AtC  unfix electric_potential all
fix_modify AtC  fix electric_potential  lbc -$V
fix_modify AtC  fix electric_potential  rbc 0
fix_modify AtC  source electric_potential all ${n0}
fix_modify AtC extrinsic electron_integration implicit 10
run     100
"
"Generate a LAMMPS input script for a general simulation of an molecular system using hybrid/overlay drip rebo pair style with pair coefficients * * drip  C.drip     C and p p s boundary conditions.","# Define unit set and class of atomic model
units metal
atom_style molecular

# BC
boundary p p s

# read config
read_data      data.C


# potential
pair_style hybrid/overlay drip rebo
pair_coeff * * drip  C.drip     C
pair_coeff * * rebo  CH.rebo  C

compute        peratom all pe/atom

# set what thermodynamic information to print to log
thermo         10  # print every 1 timestep

# set what information to write to dump file
dump           id all custom 1 lammps.dump id type x y z fx fy fz c_peratom
dump_modify    id every 10 format line ""%d %d %13.5e %13.5e %13.5e %13.5e %13.5e %13.5e %13.5e""
dump_modify    id sort id

# minimize energy
minimize  1.0e-15 1.0e-15 100 100

"
"Generate a LAMMPS input script for a NPT simulation of an full system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0  2.5 and p p p boundary conditions with a timestep of 0.005 running for 1000 steps at temperature 0.3.","# run018 <017/tolammps.py -> input.lammps
# T->0.3 harmonic->quartic
# Np=900
# f=6
# dens = 0.80
# rigid wall: none

log             harmonic_bonds.log
echo            both
units           lj
lattice		sc 1.0
boundary        p p p
neighbor        1.0 bin
neigh_modify    every 5 delay 0 check yes

atom_style      full
bond_style      quartic
#angle_style	harmonic
pair_style      lj/cut 2.5
pair_modify     table 0
special_bonds   lj 1.0 1.0 1.0

read_data    	harmonic_bonds.init

#                  k      b1     b2   rc  U0
bond_coeff      1 1434.3 -0.7589 0.00 1.5 67.2234
pair_coeff	* * 1.0 1.0  2.5

timestep        0.005
fix             1 all npt temp 0.3 0.3  1.0  iso 0.1 0.1 10.0
thermo_style    custom step temp etotal evdwl ebond pxx pyy pzz lz 
thermo_modify   flush yes
thermo          100
reset_timestep	0


########################################################################
variable        l equal xhi
#region          MESH  block xlo xhi ylo yhi zlo zhi
region          MESH  block -$l $l -$l $l -$l $l
group           MESH  region MESH
#               ID  group atc PhysicsType ParameterFile
fix             ATC all  atc field
fix_modify      ATC fields add mass_density energy stress heat_flux
#               ID  part keywords    nx ny nz region
fix_modify      ATC mesh  create 4 4 1 MESH p p p
fix_modify      ATC bond_interactions on
fix_modify      ATC pair_interactions off
fix_modify      ATC output nodeset all average energy
fix_modify      ATC output nodeset all average stress
fix_modify      ATC output harmonic_bondsFE 100 full_text binary tensor_components
########################################################################

dump            d1 all custom 1000 config.dmp id type mol x y z ix iy iz
run             1000
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 9.5251 pair style with pair coefficients * * 0.00965188 3.4 and p p p boundary conditions with a timestep of 0.001 running for 1000 steps at temperature 113.15.","variable ibead uloop 99 pad

units metal
atom_style atomic
atom_modify map yes
boundary p p p
pair_style lj/cut 9.5251
read_data data.metalnpt${ibead}

pair_coeff    * * 0.00965188 3.4
pair_modify shift yes

mass 1 39.948

timestep 0.001

velocity all create 0.0 ${ibead}

fix 1 all pimd/langevin method pimd ensemble nvt integrator obabo thermostat PILE_L 1234 tau 1.0 temp 113.15 taup 1.0 fixcom no

thermo_style custom step temp f_1[*] vol press
thermo 100
thermo_modify norm no

# dump dcd all custom 100 ${ibead}.dcd id type xu yu zu vx vy vz ix iy iz fx fy fz
# dump_modify dcd sort id format line ""%d %d %.16f %.16f %.16f %.16f %.16f %.16f %d %d %d %.16f %.16f %.16f""

run 1000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cubic pair style with pair coefficients * * 1.0 0.8908987 and p p p boundary conditions with a timestep of 0.001 running for 10000 steps at temperature 1.0.","# This script reproduces stress trajectories from Fig. 1 in
# Ravelo, Holian, Germann, and Lomdahl, PRB 70 014103 (2004)
#
# Three thermostatting scenarios are visited: undamped (nodrag),
# damped (drag) and Nose-Hoover chain (nhchains).
#
# The axial and shear stress trajectories are printed to the
# file ""stress_vs_t.dat"". For the damped case, the original figure
# seems to be a plot of 2*tau, rather than tau.
#
# The script also demonstrates how to
# orient a crystal along <110>,
# and how to use the lj/cubic pair style.

units           lj
boundary        p p p

atom_style      atomic

# Set up FCC lattice with z axis along <110>

lattice                fcc 1.4142136 &
                       orient x 0 0 1 &
                       orient y 1 -1 0 &
                       orient z 1 1 0

region         mycell block 0.0 5.0 0.0 5.0 0.0 5.0 units lattice
create_box     1 mycell
mass           * 1.0
create_atoms   1 box

# Using units of Rmin, so sigma = 2^-1/6 = 0.8908987

pair_style lj/cubic
pair_coeff * * 1.0 0.8908987

# Relax box dimensions

fix             3 all box/relax aniso 0.0 vmax 1.0e-4 nreset 100

thermo          100
thermo_style    custom step temp pe etotal pxx pyy pzz lx ly lz

min_modify      line quadratic
minimize        0.0 1.0e-6 10000 100000

# Define initial velocity

velocity        all create 0.01 87287 mom yes rot yes dist gaussian
write_restart restart.equil

# Start Run #1

clear
read_restart restart.equil

neighbor        0.2 bin
neigh_modify    every 1 delay 0 check yes
timestep        0.001
reset_timestep 0

# Pzz = 40.0, drag/damping term off

fix myhug all nphug temp 1.0 1.0 10.0 z 40.0 40.0 70.0 drag 0.0 tchain 1 pchain 0

# Specify reference state from paper, times 1000 atoms

fix_modify myhug e0 -6334.0 p0 0.0 v0 680.73519

# Define output

variable dele  equal f_myhug[1] # energy delta [temperature]
variable us    equal f_myhug[2] # shock velocity [distance/time]
variable up    equal f_myhug[3] # particle velocity [distance/time]
variable pzz   equal pzz  # axial stress
variable tau equal 0.5*(pzz-0.5*(pxx+pyy)) # shear stress
variable time equal dt*step

thermo          1000
thermo_style custom step temp ke epair econserve pzz v_tau lz f_myhug v_dele v_us v_up

fix stress all print 10 ""${time} ${pzz} ${tau} "" screen no append stress_vs_t.dat title '#time pzz tau (no drag)'

#dump           id all atom 500 dump.hugoniostat

#dump           2 all image 500 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 5

#dump           3 all movie 500 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 5

run             10000

# Start Run #2

clear
read_restart restart.equil

neighbor        0.2 bin
neigh_modify    every 1 delay 0 check yes
timestep        0.001
reset_timestep 0

# Pzz = 40.0, drag/damping term on

fix myhug all nphug temp 1.0 1.0 1.0 z 40.0 40.0 70.0 drag 200.0 tchain 1 pchain 0

# Specify reference state from paper, times 1000 atoms

fix_modify myhug e0 -6334.0 p0 0.0 v0 680.73519

# Define output

variable dele  equal f_myhug[1] # energy delta [temperature]
variable us    equal f_myhug[2] # shock velocity [distance/time]
variable up    equal f_myhug[3] # particle velocity [distance/time]
variable pzz   equal pzz  # axial stress
variable tau equal 0.5*(pzz-0.5*(pxx+pyy)) # shear stress
variable time equal dt*step

thermo          1000
thermo_style custom step temp ke epair econserve pzz v_tau lz f_myhug v_dele v_us v_up

fix stress all print 10 ""${time} ${pzz} ${tau} "" screen no append stress_vs_t.dat title '#time pzz tau (with drag)'

run             10000

# Start Run #3

clear
read_restart restart.equil

neighbor        0.2 bin
neigh_modify    every 1 delay 0 check yes
timestep        0.001
reset_timestep 0

# Pzz = 40.0, drag/damping term off, Nose-Hoover chains

fix myhug all nphug temp 1.0 1.0 1.0 z 40.0 40.0 70.0

# Specify reference state from paper, times 1000 atoms

fix_modify myhug e0 -6334.0 p0 0.0 v0 680.73519

# Define output

variable dele  equal f_myhug[1] # energy delta [temperature]
variable us    equal f_myhug[2] # shock velocity [distance/time]
variable up    equal f_myhug[3] # particle velocity [distance/time]
variable pzz   equal pzz  # axial stress
variable tau equal 0.5*(pzz-0.5*(pxx+pyy)) # shear stress
variable time equal dt*step

thermo          1000
thermo_style custom step temp ke epair econserve pzz v_tau lz f_myhug v_dele v_us v_up

fix stress all print 10 ""${time} ${pzz} ${tau} "" screen no append stress_vs_t.dat title '#time pzz tau (Nose-Hoover chain)'

run             10000

"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/long 12 pair style with a timestep of 0.01 running for 2 steps.","# QMMM with PySCF - mixture example

units           real
atom_style      full

pair_style      lj/cut/coul/long 12
pair_modify     mix arithmetic

bond_style      harmonic
angle_style     harmonic
dihedral_style  none
improper_style  none

kspace_style    pppm 1e-5

read_data       data.mixture

# QM atoms are IDs 1 to 9
# MM atoms are remaining atoms

group           qm id 1:9
group           mm subtract all qm

# remove bonds/angles between QM atoms
# set charges to zero on QM atoms

delete_bonds    qm multi remove special
set             group qm charge 0.0

neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes

# QMMM dynamics

timestep        0.01

fix		1 all nve

fix             2 qm mdi/qmmm direct elements N H C H Cl O H
fix_modify      2 energy yes

thermo_style    custom step cpu temp ke evdwl ecoul epair emol elong &
                f_2 pe etotal press

thermo          1
run		2
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/charmmfsw/coul/charmmfsh 8 12 pair style and p p p boundary conditions with a timestep of 2.0 running for 100000 steps.","# Created by charmm2lammps v1.8.2.6 beta on Thu Mar  3 20:56:57 EST 2016

units           real
neigh_modify    delay 2 every 1
#newton          off

boundary        p p p

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmmfsw
improper_style  harmonic

pair_style      lj/charmmfsw/coul/charmmfsh 8 12
pair_modify     mix arithmetic

fix             cmap all cmap charmm22.cmap
fix_modify      cmap energy yes

read_data       gagg.data fix cmap crossterm CMAP

special_bonds   charmm
fix             1 all nve

#fix             1 all nvt temp 300 300 100.0
#fix             2 all shake 1e-9 500 0 m 1.0

velocity        all create 0.0 12345678 dist uniform

thermo          1000
thermo_style    custom step ecoul evdwl ebond eangle edihed f_cmap eimp
timestep        2.0

run             100000
"
"Generate a LAMMPS input script for a general simulation running for ${nequil} steps.","# Compute elastic constant tensor for a crystal at finite temperature
# These settings replicate the 1477~K benchmark of
# Kluge, Ray, and Rahman (1986) that is Ref.[15] in:
# Y. Zhen, C. Chu, Computer Physics Communications 183(2012) 261-265

# here: Y. Zhen, C. Chu, Computer Physics Communications 183(2012) 261-265

include init.in

# Compute initial state

include potential.in
thermo_style custom step temp pe press density
run ${nequil}

# Run dynamics

include potential.in
include output.in

run ${nrun}

# Output final values

include final_output.in
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 1.12246 pair style with pair coefficients * * 1.0 1.0 1.12246 and p s p boundary conditions with a timestep of 0.003 running for 25000 steps.","# 2d LJ obstacle flow

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
region		box block 0 40 0 10 -0.25 0.25
create_box	3 box
create_atoms	1 box

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	        1 block INF INF INF 1.25 INF INF
group		lower region 1
region		2 block INF INF 8.75 INF INF INF
group		upper region 2
group		boundary union lower upper
group		flow subtract all boundary

set		group lower type 2
set		group upper type 3

# initial velocities

compute	        mobile flow temp
velocity	flow create 1.0 482748 temp mobile
fix		1 all nve
fix		2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify	2 temp mobile

# Poiselle flow

velocity	boundary set 0.0 0.0 0.0
fix		3 lower setforce 0.0 0.0 0.0
fix		4 upper setforce 0.0 NULL 0.0
fix		5 upper aveforce 0.0 -0.5 0.0
fix		6 flow addforce 1.0 0.0 0.0

# 2 obstacles

region		void1 sphere 10 4 0 3
delete_atoms	region void1
region		void2 sphere 20 7 0 3
delete_atoms	region void2

fix		7 flow indent 100 sphere 10 4 0 4
fix		8 flow indent 100 sphere 20 7 0 4
fix		9 all enforce2d

# Run

timestep	0.003
thermo		1000
thermo_modify	temp mobile

#dump		1 all atom 100 dump.obstacle

#dump		2 all image 500 image.*.jpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	2 pad 5

#dump		3 all movie 500 movie.mpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	3 pad 5

run		25000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 5000000 steps.","# 3d Lennard-Jones melt

units		lj
atom_style	atomic

lattice		fcc 0.8442
region		box block 0 10 0 10 0 10
create_box	1 box
create_atoms	1 box
mass		1 1.0

velocity	all create 3.0 87287

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0 2.5

neighbor	0.3 bin
neigh_modify	every 5 delay 10 check yes

thermo_style    custom step pe ke spcpu

fix		1 all nve

# IMD setup.
fix  comm       all imd 5678 unwrap off fscale 20.0 trate 10 nowait on

thermo		500
run		5000000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/class2/coul/long 8.5 pair style and p p p boundary conditions running for 10000 steps.","# 20 styrene molecules
# three reactions defined

units real

boundary p p p

atom_style full

kspace_style pppm 1.0e-4

pair_style lj/class2/coul/long 8.5

angle_style class2

bond_style class2

dihedral_style class2

improper_style class2

special_bonds lj/coul 0 0 1
pair_modify tail yes mix sixthpower

variable T equal 530

read_data tiny_polystyrene.data  &
  extra/bond/per/atom 5 &
  extra/angle/per/atom 15 &
  extra/dihedral/per/atom 15 &
  extra/improper/per/atom 25 &
  extra/special/per/atom 25

molecule mol1 2styrene_unreacted.molecule_template
molecule mol2 2styrene_reacted.molecule_template
molecule mol3 chain_plus_styrene_unreacted.molecule_template
molecule mol4 chain_plus_styrene_reacted.molecule_template
molecule mol5 chain_chain_unreacted.molecule_template
molecule mol6 chain_chain_reacted.molecule_template

thermo 100

# dump 1 all xyz 5 test_vis.xyz
# dump_modify 1 types labels

fix rxn1 all bond/react stabilization yes statted_grp .03 &
 react rxn1 all 1 0 3.0 mol1 mol2 2styrene_map stabilize_steps 100 &
 react rxn2 all 1 0 3.0 mol3 mol4 chain_plus_styrene_map stabilize_steps 100 &
 react rxn3 all 1 0 5.0 mol5 mol6 chain_chain_map stabilize_steps 100

fix 1 statted_grp_REACT nvt temp $T $T 100

fix 4 bond_react_MASTER_group temp/rescale 1 $T $T 1 1

thermo_style custom step temp press density f_rxn1[*]

run 10000

# write_restart restart_longrun nofix
# write_data restart_longrun.data
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 1.122562 pair style with pair coefficients 1 1 1.0 1.0 running for 10000 steps at temperature 0.722.","# uniaxial NVT deformation of WCA fluid

units		lj
atom_style	atomic


pair_style	lj/cut 1.122562
read_data       data.wca
pair_coeff	1 1 1.0 1.0
pair_modify     shift yes

neighbor	0.5 bin
neigh_modify	delay 0

change_box      all triclinic

fix		1 all nvt/uef temp 0.722 0.722 0.5 erate -0.5 -0.5

fix             2 all momentum 100 linear 1 1 1

#dump		1 all atom 25 dump.lammpstrj

#dump		2 all cfg/uef 25 dump.*.cfg mass type xs ys zs

thermo_style    custom step c_1_press[1] c_1_press[2] c_1_press[3]

thermo		50
run		10000
"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using granular pair style with pair coefficients 1 * hertz/material 1e5 0.2 0.3 tangential mindlin NULL 1.0 0.5 damping tsuji with a timestep of 0.001 running for 2000 steps.","# pour two types of particles (cohesive and non-cohesive) into cylinder
# 'turn' cylinder by changing direction of gravity, then rotate it.
# This simulates a rotating drum powder characterization experiment.

variable        name string rotating_drum_two_types

atom_style      sphere
units           lj

###############################################
# Geometry-related parameters
###############################################

variable        boxx equal 30
variable        boxy equal 30
variable        boxz equal 50

variable        drum_rad equal ${boxx}*0.5
variable        drum_height equal 20

variable        xc equal 0.5*${boxx}
variable        yc equal 0.5*${boxx}
variable        zc equal 0.5*${boxz}

###############################################
# Particle-related parameters
###############################################
variable        rlo equal 0.25
variable        rhi equal 0.5
variable        dlo equal 2.0*${rlo}
variable        dhi equal 2.0*${rhi}

variable        cyl_rad_inner equal ${drum_rad}-1.1*${rhi}

variable        dens equal 1.0

variable skin equal 0.4*${rhi}

#############
processors * * 1
region          boxreg block 0 ${boxx} 0 ${boxy} 0 ${boxz}
create_box      2 boxreg
change_box      all boundary p p f

pair_style      granular
pair_coeff      1 * hertz/material 1e5 0.2 0.3 tangential mindlin NULL 1.0 0.5 damping tsuji
pair_coeff      2 2 jkr 1e5 0.1 0.3 50 tangential mindlin NULL 1.0 0.5 rolling sds 1e3 1e3 0.1 twisting marshall 

variable        theta equal 0

region          curved_wall cylinder z ${xc} ${yc} ${drum_rad} 0 ${drum_height} side in rotate v_theta ${xc} ${yc} 0 0 0 1
region          bottom_wall plane ${xc} ${yc} 0 0 0 1 side in rotate v_theta ${xc} ${yc} 0 0 0 1

region          insreg cylinder z ${xc} ${yc} ${cyl_rad_inner} ${drum_height} ${boxz}

fix             0 all balance 100 1.0 shift xy 5 1.1
fix             1 all nve/sphere
fix             grav all gravity 10 vector 0 0 -1
fix             ins1 all pour 2000 1 1234 region insreg diam range ${dlo} ${dhi} dens ${dens} ${dens}
fix             ins2 all pour 2000 2 1234 region insreg diam range ${dlo} ${dhi} dens ${dens} ${dens}

comm_modify     vel yes

neighbor        ${skin} bin
neigh_modify    delay 0 every 1 check yes

fix             3 all wall/gran/region granular hertz/material 1e5 0.1 0.3 tangential mindlin NULL 1.0 0.5 damping tsuji region curved_wall
fix             4 all wall/gran/region granular hertz/material 1e5 0.1 0.3 tangential mindlin NULL 1.0 0.5 damping tsuji region bottom_wall

thermo_style    custom step atoms ke v_theta
thermo_modify   lost warn
thermo          100

timestep        0.001

#dump           1 all custom 100 ${name}.dump id type radius mass x y z

#For removal later
compute         1 all property/atom radius
variable        zmax atom z+c_1>0.5*${drum_height}
group           delgroup dynamic all var zmax every 10000

run             2000

#Remove any particles that are above z > 0.5*drum_height
delete_atoms    group delgroup

#Add top lid
region          top_wall plane ${xc} ${yc} ${drum_height} 0 0 -1 side in rotate v_theta ${xc} ${yc} 0 0 0 1
fix             5 all wall/gran/region granular hertz/material 1e5 0.1 0.3 tangential mindlin NULL 1.0 0.5 damping tsuji region top_wall

# 'Turn' drum by switching the direction of gravity
unfix           grav
unfix           ins1
unfix           ins2
fix             grav all gravity 10 vector 0 -1 0

variable        theta equal 2*PI*elapsed/20000.0
run             3000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using hybrid/overlay e3b 1 lj/cut/tip4p/long 1 2 1 1 0.1546 8.5 pair style with pair coefficients * * lj/cut/tip4p/long 0.0 0.0 and p p p boundary conditions with a timestep of ${ts} running for _style 	verlet steps.","#LAMMPS input file
#to simulate bulk E3B3 water model

#####################################################################

variable	samp_rate 	equal 10
variable	thermo_rate 	equal 10
variable	Wlat		equal 3.10744  #for water density 0.997g/mL
variable        L		equal 3  #(L*2)^3 = Nmolec, L=3 -> N=216

variable	equil		equal 100
variable	run		equal 100

variable	ts		equal 2.0
variable	Tdamp		equal 100*${ts}
variable 	Pdamp		equal 1000*${ts}
variable	myT		equal 298.0
variable	myP		equal 1.0

units 		real
atom_style	full

dimension 	3

boundary 	p p p

#############################################################################
#setup box
read_data       e3b_box.data

#############################################################################
#set up potential

pair_style 	hybrid/overlay e3b 1 lj/cut/tip4p/long 1 2 1 1 0.1546 8.5
pair_modify 	table 0 table/disp 0 shift yes

bond_style  	harmonic
angle_style 	harmonic

kspace_style 	pppm/tip4p 1.0e-6

pair_coeff 	* * lj/cut/tip4p/long 0.0 0.0
pair_coeff	1 1 lj/cut/tip4p/long 0.1852 3.1589
pair_coeff	* * e3b preset 2015

#potential coeffs aren't too important since will be rigid anyways
bond_coeff	1 554.13 0.9572
angle_coeff	1 45.769 104.52

#############################################################################
#setup for run
thermo 		${thermo_rate}
thermo_style 	custom step vol temp epair pe etotal press density

timestep 	${ts}
run_style 	verlet

neighbor	2.0 bin
neigh_modify	every 1 delay 3 check yes

#############################################################################

#dump positions only in first batch run
#dump 		7 all custom ${samp_rate} dump.lammpstrj id x y z
#dump_modify	7 sort id

#############################################################################
#initialize velocity and rigid constraint

fix 		rigid all shake 1.0e-8 100 0 b 1 a 1 t 1 2
velocity 	all create ${myT} 15856 dist gaussian rot yes mom yes

#scale velocity
run		0
velocity	all scale ${myT}

compute    	e3b all pair e3b
fix		e3b all ave/time 1 1 ${thermo_rate} c_e3b c_e3b[*] &
		file e3b.txt title2 ""step pe_e3b pe_e2 pe_ea pe_eb pe_ec""

#############################################################################
#equilibrate bulk water at NVT

fix 		1 all nvt temp ${myT} ${myT} ${Tdamp}
run 		${equil}

#############################################################################
#run at NVT

#dump 		1 all custom ${samp_rate} dump.lammpstrj id x y z type
#dump_modify	1 sort id

run 		${run}

# write_restart 	lammps.restart
"
"Generate a LAMMPS input script for a NVE simulation and p p f # slab calculation boundary conditions running for 500 steps at temperature 500.","# electrodes with thermopotentiostat
# for graphene-ionic liquid supercapacitor

boundary p p f # slab calculation
include settings.mod # styles, groups, computes and fixes
kspace_modify slab 3.0

unfix nvt # remove NVT thermostat included from ""settings.mod""
fix conpthermo bot electrode/thermo -1.0 1.979 couple top 1.0 etypes on temp 500 100 7 symm on # temp tau rng
# to compare to regular constant potential, switch previous line to this:
#fix conp bot electrode/conp -1.0 1.979 couple top 1.0 etypes on symm on
fix nve electrolyte nve

# note ionic liquid does not reach 500K immediately
# because its thermal response time is finite
# run this about 10k steps (10ps) to reach preset temperature
thermo 50
thermo_style custom step temp c_ctemp epair etotal c_qbot c_qtop
run 500
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style with pair coefficients 1 1 0.238 3.405 and p p p boundary conditions with a timestep of 0 running for 1 steps.","# This is a test for reading an atomic reference configuration
echo both
units       real
atom_style  atomic
variable lattice_constant equal 5.256227487 
variable c equal 4
variable L equal (${lattice_constant}*$c)
# create system
lattice        fcc ${lattice_constant} 
region         box block 0 $c 0 $c 0 $c
boundary       p p p
# the stretched configuration of the atoms
read_data read_xref_1.init
mass         1 39.95
pair_style lj/cut 13.5  
pair_coeff 1 1 0.238 3.405 
# define region
neighbor  1.0 bin
neigh_modify  delay 1000000
thermo    1
thermo_style  custom step vol etotal
timestep  0
fix         ATC all atc field Ar_CauchyBorn.mat
# the original configuration of the atoms
fix_modify  ATC  reset_atomic_reference_positions read_xref_0.data
# ""box"" is the original box
fix_modify  ATC mesh create 1 1 1 box f f f 
fix_modify  ATC  fields none
fix_modify  ATC  fields add mass_density
fix_modify  ATC  output read_xrefFE 1 text
fix_modify  ATC  output index step
variable u1 atom x-f_ATC[1]
variable u2 atom y-f_ATC[2]
variable u3 atom z-f_ATC[3]
variable rho atom mass*f_ATC[4]
dump  CONFIG all custom 1 read_xref.dmp id type x y z v_u1 v_u2 v_u3 v_rho
run 1
"
"Generate a LAMMPS input script for a NVE simulation of an hybrid bond ellipsoid oxdna system using hybrid/overlay oxdna2/excv oxdna2/stk oxdna2/hbond oxdna2/xstk oxdna2/coaxstk oxdna2/dh pair style with pair coefficients * * oxdna2/excv 11.92337812042065 5.9626 5.74965 11.92337812042065 4.38677 4.259 11.92337812042065 2.81094 2.72576 and p p p boundary conditions with a timestep of 0.01706 running for 1000000 steps.","variable number	equal 4
variable ofreq	equal 1000
variable efreq	equal 1000

variable ntype equal 4

variable T equal 300.0
variable rhos   equal 0.2

units real

dimension 3

newton on

boundary  p p p

atom_style hybrid bond ellipsoid oxdna
atom_modify sort 0 8.518

# Pair interactions require lists of neighbours to be calculated
neighbor 17.036 bin 
neigh_modify every 10 delay 0 check yes

read_data data.duplex4.4type

mass * 315.8376           # sets per-type mass if not in data file
set atom * mass 315.8376  # sets per-atom mass

group all type 1 4

# oxDNA2 bond interactions - FENE backbone
bond_style oxdna2/fene 
bond_coeff * 11.92337812042065 2.1295 6.4430152
special_bonds lj 0 1 1

# oxDNA pair interactions
pair_style hybrid/overlay oxdna2/excv oxdna2/stk oxdna2/hbond oxdna2/xstk oxdna2/coaxstk oxdna2/dh 
pair_coeff * * oxdna2/excv 11.92337812042065 5.9626 5.74965 11.92337812042065 4.38677 4.259 11.92337812042065 2.81094 2.72576
pair_coeff * * oxdna2/stk seqdep ${T} 8.06199211612242 0.005309213 0.70439070204273 3.4072 7.6662 2.72576 6.3885 1.3 0.0 0.8 0.9 0.0 0.95 0.9 0.0 0.95 2.0 0.65 2.0 0.65
pair_coeff * * oxdna2/hbond seqdep 0.0 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0.0 0.7 1.5 0 0.7 1.5 0 0.7 0.46 3.141592654 0.7 4.0 1.570796327 0.45 4.0 1.570796327 0.45

label loop
variable base loop ${ntype} 
  variable basemod equal ${base}%4
  if ""${basemod} == 1"" then &
    ""variable comp equal ${base}+3"" &
    ""pair_coeff ${base} ${comp} oxdna2/hbond seqdep 6.36589157849259 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0 0.7 1.5 0.0 0.7 1.5 0 0.7 0.46 3.141592654 0.7 4.0 1.570796327 0.45 4.0 1.570796327 0.45""
  if ""${basemod} == 2"" then &
    ""variable comp equal ${base}+1"" &
    ""pair_coeff ${base} ${comp} oxdna2/hbond seqdep 6.36589157849259 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0 0.7 1.5 0.0 0.7 1.5 0 0.7 0.46 3.141592654 0.7 4.0 1.570796327 0.45 4.0 1.570796327 0.45""
next base
jump in.duplex4.4type loop

pair_coeff * * oxdna2/xstk 3.9029021145006 4.89785 5.74965 4.21641 5.57929 2.25 0.791592654 0.58 1.7 1.0 0.68 1.7 1.0 0.68 1.5 0 0.65 1.7 0.875 0.68 1.7 0.875 0.68
pair_coeff * * oxdna2/coaxstk 4.80673207785863 3.4072 5.1108 1.87396 4.94044 2.0 2.891592653589793 0.65 1.3 0 0.8 0.9 0 0.95 0.9 0 0.95 40.0 3.116592653589793
pair_coeff * * oxdna2/dh ${T} ${rhos} 0.815

# Langevin dynamics
fix 1 all nve/asphere
fix 2 all langevin ${T} ${T} 4265.0 457145 angmom 10

timestep 0.01706

#comm_style tiled
fix 3 all balance 1000 1.03 shift xyz 10 1.03
comm_modify cutoff 32.4

compute quat all property/atom quatw quati quatj quatk

compute erot all erotate/asphere
compute ekin all ke
compute epot all pe
variable erot equal c_erot
variable ekin equal c_ekin
variable epot equal c_epot
variable etot equal c_erot+c_ekin+c_epot
fix 5 all print ${efreq} ""$(step)  ekin = ${ekin} |  erot = ${erot} | epot = ${epot} | etot = ${etot}"" screen yes

dump out all custom ${ofreq} out.${number}.lammpstrj id mol type x y z ix iy iz vx vy vz c_quat[1] c_quat[2] c_quat[3] c_quat[4] angmomx angmomy angmomz
dump_modify out sort id
dump_modify out format line ""%d %d %d  %22.15le %22.15le %22.15le  %d %d %d  %22.15le %22.15le %22.15le  %22.15le %22.15le %22.15le %22.15le  %22.15le %22.15le %22.15le""

run 1000000

write_data last_config.${number}.* nocoeff
#write_restart last_config.${number}.*
"
"Generate a LAMMPS input script for a general simulation of an atomic system using eam pair style with pair coefficients * * Au_u3.eam and p p p boundary conditions with a timestep of 0 # 1.e-20 # 0 running for 0 steps.","echo both
units		metal
atom_style      atomic
atom_modify map hash
boundary	p p p

variable l equal 3
variable l2 equal 0.5*$l
variable L equal 10
variable L2 equal 0.5*$L
variable h equal $L

lattice fcc 4.08 origin 0.25 0.25 0.25
region	BOX  block -${l2} ${l2} -${L2} ${L2} -${l2} ${l2} 
create_box 1 BOX
create_atoms 1 region BOX

pair_style  eam 
pair_coeff  * * Au_u3.eam
mass          *  196.97


### NOTE change to CB -linear
fix         PP  all   atc field   Au_elastic.mat 
fix_modify  PP  mesh  create 1 $h 1 BOX p f p
fix_modify  PP  fields add displacement velocity potential_energy cauchy_born_energy #  kinetic_energy
fix_modify  PP  gradients add displacement 
fix_modify  PP  set reference_potential_energy 
fix_modify  PP  output counter step
fix_modify  PP  output eam_energyPP 1 text

fix         ATC all   atc elastic Au_elastic.mat
fix_modify  ATC mesh  create 1 $h 1 BOX p f p
fix_modify  ATC internal_quadrature off
fix_modify  ATC control momentum none
#fix_modify  ATC consistent_fe_initialization on
fix_modify  ATC output counter step
fix_modify  ATC output eam_energyFE 1 text binary
fix_modify  ATC material all Au_cubic


dump  CONFIG all custom 1 eam_energy.dmp id type x y z
thermo 1

timestep 0 # 1.e-20 # 0

variable e0 equal pe
variable L0 equal ly
run 0
variable pe equal pe-${e0}
variable dL equal ly-${L0}
variable strain equal v_dL/${L0}

variable x equal y[1]
variable x2 equal y[2]
variable v equal vy[1]
thermo_style custom step etotal v_pe ke f_ATC[1] f_ATC[2] v_x v_v v_x2 ly v_dL v_strain
thermo_modify format 2 %15.8g

###############################################################################
log  eam_energy.log
run 1
velocity all set 0 0.1 0 units box
fix_modify ATC fix velocity y all 0.1
run 1
velocity all set 0 0.2 0 units box
fix_modify ATC fix velocity y all 0.2
run 1
velocity all set 0 0.3 0 units box
fix_modify ATC fix velocity y all 0.3
run 1
change_box all y scale 1.01 remap
fix_modify ATC fix displacement y all linear 0 0 0 0 0.01 0 0
run 1
change_box all y scale 1.01 remap
fix_modify ATC fix displacement y all linear 0 0 0 0 0.0201 0 0
run 1
change_box all y scale 1.01 remap
fix_modify ATC fix displacement y all linear 0 0 0 0 0.030301 0 0
run 1
"
"Generate a LAMMPS input script for a NVT simulation of an charge system using reaxff NULL safezone 3.0 mincap 150 pair style with pair coefficients * * acks2_ff.water O H and p p p boundary conditions with a timestep of 0.5 running for 20 steps at temperature 300.","# ACKS2 Water, CITE: Achtyl et al., Nat. Comm., 6 6539 (2015)

boundary        p p p
units           real
atom_style      charge

read_data       data.water

variable        x index 1
variable        y index 1
variable        z index 1

replicate       $x $y $z

pair_style      reaxff NULL safezone 3.0 mincap 150
pair_coeff      * * acks2_ff.water O H
neighbor        0.5 bin
neigh_modify    every 1 delay 0 check yes

velocity all create 300.0 4928459 rot yes dist gaussian

fix             1 all acks2/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 1000
fix             2 all nvt temp 300 300 50.0

timestep        0.5
thermo          10
thermo_style    custom step temp press density vol

run 20
"
"Generate a LAMMPS input script for a general simulation of an atomic system and f p p boundary conditions with a timestep of ${dt} running for $m steps.","#needs description
echo both
units    metal

variable E equal 0.1
variable L equal 10.0
#variable N equal 100
variable N equal 80
variable T equal 1000
variable n0 equal 0.0001
variable dn equal 2.0*${n0}
variable dt equal 0.0000001
variable s equal 1

timestep  ${dt}

atom_style  atomic
lattice         fcc 1.0 
variable a equal 0.5*$L
region    simRegion block -$a $a  0 1 0 1
boundary  f p p
create_box  1 simRegion
mass    1 1.0 # need to keep this
atom_modify     sort 0 1

#          ID  group atc PhysicsType ParameterFile
fix        AtC all   atc drift_diffusion-schrodinger  SiGe_ddm_schrodinger.mat

#          ID  part keywords    nx ny nz region
fix_modify AtC mesh  create $N 1  1  simRegion f p p
variable a   equal 0.2*$L+0.001
fix_modify AtC mesh create_elementset well -$a $a -INF INF -INF INF
fix_modify AtC mesh create_nodeset    well -$a $a -INF INF -INF INF
fix_modify AtC material well Ge

variable b   equal $a-0.002
fix_modify AtC mesh create_nodeset lbc -$a -$b -INF INF -INF INF 
fix_modify AtC mesh create_nodeset rbc  $b  $a -INF INF -INF INF

# ics/bcs
fix_modify AtC  initial temperature          all 300.0
fix_modify AtC  fix     temperature          all 300.0
#
fix_modify AtC  initial electron_temperature all $T
fix_modify AtC  fix     electron_temperature all $T 
#
fix_modify AtC  initial electron_density     all 0.0
#fix_modify AtC  fix electron_density         all -0.001
#fix_modify AtC  fix electron_density        well  0.002
#
fix_modify AtC  initial electric_potential   all 0.0
#fix_modify AtC  fix     electric_potential   lbc 0.5 
#fix_modify AtC  fix     electric_potential   rbc 0.5 
fix_modify AtC  fix     electric_potential   lbc 0.0
fix_modify AtC  fix     electric_potential   rbc 0.0
#
fix_modify AtC  initial electron_wavefunction all 0.0
fix_modify AtC  fix electron_wavefunction lbc 0.0
fix_modify AtC  fix electron_wavefunction rbc 0.0


thermo  $s
# f_AtC:1 thermal energy, 2 avg T, 3 electron energy, 4 avg Te, 5 total n
thermo_style custom step cpu f_AtC[1] f_AtC[2] f_AtC[3] f_AtC[4] f_AtC[5]
thermo_modify  format 1 %5i format 2 %7.2g
fix_modify      AtC  output   finite_wellFE $s text
fix_modify AtC extrinsic electron_integration implicit 3
fix_modify AtC extrinsic schrodinger_poisson_solver self_consistency 3 # 30
variable m equal 1*$s
# (A) no field
run     $m
# (B) fixed boundary field
fix_modify AtC  fix electric_potential lbc linear 0 0 0 $E 0 0 1
fix_modify AtC  fix electric_potential rbc linear 0 0 0 $E 0 0 1
run     $m
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.0 pair style with pair coefficients 1 1 0.0 1.0 and p p p boundary conditions running for 0 steps.","# Test of Kawasaki Dynamics on LJ test system

units		metal
#newton off
boundary	p p p

lattice         fcc 1 origin 0.25 0.25 0.25
atom_style	atomic

# indexed atom variables in test 5 need a map

atom_modify     sort 0 0.0 map hash

region          box block 0 10  0 10 0 10
create_box      2 box
create_atoms    1 box basis 1 2

mass 1 50
mass 2 50

pair_style      lj/cut 2.0
pair_coeff      1 1 0.0 1.0 
pair_coeff      1 2 0.0 1.0
pair_coeff      2 2 0.0 1.0

neighbor	0.3 bin
neigh_modify	delay 10

# set the cut-off to 2.5x the cutoff from the potential
comm_modify     cutoff 5.0

# atom radii per type
variable r atom (type==1)*0.1+(type==2)*0.3

# groups
group type1 type 1
group type2 type 2

thermo 1
# reduce computes
#compute r1 type1 reduce sum c_v1[1]
#compute r2 type2 reduce sum c_v1[1]

#compute v1 all voronoi/atom radius v_r

#
# TEST 1: Sum of all voronoi cells is the simulation cell volume
#

compute v1 all voronoi/atom
dump    d1 all custom 1 dump.voro id type x y z c_v1[1] c_v1[2]
compute r0 all   reduce sum c_v1[1]
thermo_style custom c_r0
variable t1 equal c_r0
run  0
print ""TEST_1  $(round(abs(v_t1-1000)/10))% Error.  Sum of all voronoi cells is the simulation cell volume""
uncompute v1
uncompute r0
undump    d1

#
# TEST 2: Sum of all only_group voronoi cells is the simulation cell volume
#

compute v1 type2 voronoi/atom only_group
dump    d1 all custom 1 dump.voro id type x y z c_v1[1] c_v1[2]
compute r0 type2   reduce sum c_v1[1]
compute r1 type1   reduce sum c_v1[1]
thermo_style custom c_r0 c_r1
variable t2a equal c_r0
variable t2b equal c_r1
run  0
print ""TEST_2a $(round(abs(v_t2a-1000)/10))% Error.  Sum of all only_group voronoi cells is the simulation cell volume""
print ""TEST_2b $(round(v_t2b/10))% Error.  Sum of all only_group not included voronoi cells is zero""
uncompute v1
uncompute r0
uncompute r1
undump    d1

#
# TEST 3: Sum of all radius voronoi cells is the simulation cell volume
#

compute v1 all voronoi/atom radius v_r
dump    d1 all custom 1 dump.voro id type x y z c_v1[1] c_v1[2]
compute r0 all   reduce sum c_v1[1]
thermo_style custom c_r0
variable t3 equal c_r0
run  0
print ""TEST_3  $(round(abs(v_t3-1000)/10))% Error.  Sum of all radius voronoi cells is the simulation cell volume""
uncompute v1
uncompute r0
undump    d1

#
# TEST 4: Edge histogram tests
#

compute v1 type2 voronoi/atom edge_histo 8
thermo_style custom c_v1[1] c_v1[2] c_v1[3] c_v1[4] c_v1[5] c_v1[6] c_v1[7]
run  1
variable t4a equal (abs(c_v1[4]-12000)+c_v1[1]+c_v1[2]+c_v1[3]+c_v1[5]+c_v1[6]+c_v1[7])/120
print ""TEST_4a $(round(v_t4a))% Error.  Edge histogram of a simple cubic lattice (6 sides. 4 edges per side)""
uncompute v1
compute v1 all voronoi/atom edge_histo 8
thermo_style custom c_v1[1] c_v1[2] c_v1[3] c_v1[4] c_v1[5] c_v1[6] c_v1[7]
run  1
variable t4b equal (abs(c_v1[4]-48000)+c_v1[1]+c_v1[2]+c_v1[3]+c_v1[5]+c_v1[6]+c_v1[7])/480
print ""TEST_4b $(round(v_t4b))% Error.  Edge histogram of a face centered cubic lattice (12 sides. 4 edges per side)""
uncompute v1

# perturbed fcc lattice
displace_atoms all random 0.01 0.01 0.01 31423
compute v1 all voronoi/atom edge_histo 8 edge_threshold 0.1
thermo_style custom c_v1[1] c_v1[2] c_v1[3] c_v1[4] c_v1[5] c_v1[6] c_v1[7]
run  1
variable t4c equal (abs(c_v1[4]-48000)+c_v1[1]+c_v1[2]+c_v1[3]+c_v1[5]+c_v1[6]+c_v1[7])/480
print ""TEST_4c $(round(v_t4c))% Error.  Edge histogram of a perturbed face centered cubic lattice with edge_threshold""
uncompute v1

# bcc lattice
delete_atoms group all
lattice         bcc 1 origin 0.25 0.25 0.25
create_atoms    1 box
compute v1 all voronoi/atom edge_histo 8
thermo_style custom c_v1[1] c_v1[2] c_v1[3] c_v1[4] c_v1[5] c_v1[6] c_v1[7]
run  1
variable t4d equal (abs(c_v1[4]-12000)+abs(c_v1[6]-16000)+c_v1[1]+c_v1[2]+c_v1[3]+c_v1[5]+c_v1[7])/280
print ""TEST_4d $(round(v_t4d))% Error.  Edge histogram of a body centered cubic lattice (truncated octahedron, 6 sides with 4 edges, 8 sides with 6 edges)""
uncompute v1

# restore fcc lattice
delete_atoms group all
lattice         fcc 1 origin 0.25 0.25 0.25
create_atoms    1 box basis 1 2

#
# TEST 5: Occupation analysis
#

print ""START5""

# start with pristine lattice
variable i1 equal 13
variable i2 equal 257
compute v1 all voronoi/atom occupation
compute r0 all   reduce sum c_v1[1]
compute r1 all   reduce sum c_v1[2]
variable d5a equal C_v1[${i1}][1]
variable d5b equal C_v1[${i2}][1]
variable d5c equal C_v1[${i1}][2]
variable d5d equal C_v1[${i2}][2]
thermo_style custom c_r0 c_r1 v_d5a v_d5b v_d5c v_d5d

run 0
# expect 1 1 1 1 (one atom per cell each)
variable t5a equal abs(${d5a}-1)+abs(${d5b}-1)+abs(${d5c}-1)+abs(${d5d}-1)

# move atom i1 next to atom i2
variable oxd equal x[${i1}]
variable oyd equal y[${i1}]
variable ozd equal z[${i1}]
# we need to freeze this value
variable ox equal ${oxd}
variable oy equal ${oyd}
variable oz equal ${ozd}
# these coords dont change so dynamic evaluation is ok
variable nx equal x[${i2}]
variable ny equal y[${i2}]
variable nz equal z[${i2}]
set atom ${i1} x $(v_nx+0.2) y $(v_ny+0.2) z $(v_nz+0.2) 

run 0
# expect 0 2 2 2 (vacancy at the original i1 site, interstitial at i2 and both atoms are now sharing a site)
variable t5b equal abs(${d5a}-0)+abs(${d5b}-2)+abs(${d5c}-2)+abs(${d5d}-2)

# move atom back
set atom ${i1} x ${ox} y ${oy} z ${oz}

run 0
# expect 1 1 1 1 (restored to the initial state)
variable t5c equal abs(${d5a}-1)+abs(${d5b}-1)+abs(${d5c}-1)+abs(${d5d}-1)

print ""TEST_5  $((v_t5a+v_t5b+v_t5c)*100)% Error.  Detection of vacancies and interstitials using the {occupation} keyword.""

uncompute v1
uncompute r0
uncompute r1

#
# TEST 6: Sum of all voronoi cells is the triclinic simulation cell volume
#

# switch to triclinic box
change_box all triclinic
change_box all xy final 5.0 remap units box

compute v1 all voronoi/atom
dump    d1 all custom 1 dump.voro id type x y z c_v1[1] c_v1[2]
compute r0 all   reduce sum c_v1[1]
thermo_style custom c_r0
variable t6 equal c_r0
run  0
print ""TEST_6  $(round((v_t6-1000)/10))% Error.  Sum of all voronoi cells is the triclinic simulation cell volume""
uncompute v1
uncompute r0
undump    d1

# All tests done

print TEST_DONE
"
"Generate a LAMMPS input script for a NVT simulation of an charge system using reaxff NULL pair style with pair coefficients * * ffield.reax.FC C F and p p p boundary conditions with a timestep of 0.2 running for 10 steps at temperature 100.0.","# REAX potential for Nitroamines system
# .....

dimension      3
boundary       p p p
units           real

atom_style      charge
read_data       data.FC

pair_style      reaxff NULL
pair_coeff      * * ffield.reax.FC C F
neighbor        2. bin
neigh_modify    every 10 delay 0 check no
fix             2 all qeq/reax 1 0.0 10.0 1e-6 reaxff

# should equilibrate much longer in practice

fix             1 all npt temp 100.0 100.0 10.0 iso 1.0 1. 2000.0
timestep        0.2
thermo_style    custom step temp epair etotal press 
thermo          1
dump            4 all xyz 5000 dumpnpt.xyz
run             10

unfix           1

fix             1  all nvt temp 100.0 100.0 100.0
thermo_style    custom step temp epair etotal press 
timestep        0.2

#dump           5 all xyz 5000 dumpnvt.xyz
#dump            6 all custom 5000 dumpidtype.dat id type x y z 

run             10
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using soft ${softlength} pair style with pair coefficients * * 0.0 and p p f boundary conditions with a timestep of 0.2 running for 100000 steps.","#===========================================================================#
#  Toy car driving down a system with a floor and ceiling.                  #
#                                                                           #
#  The car is first constructed by condensing particles onto various regions#
#  that make up the car's parts.  Then the car moves in a lattice Boltzmann #
#  fluid.  This requires compilation with the RIGID and LATBOLTZ packages   #
#  You will need to uncomment the dump options to get useful output.        #
#===========================================================================#

units cgs
dimension 3
boundary p p f
atom_style atomic
processors * 1 *

#-------------------------------------------------------------------------#
# Set up the simulation box
#-------------------------------------------------------------------------#
variable dx equal 1.5

variable more equal 6.5

variable xl equal ""-32*v_dx""
variable xh equal ""32*v_dx""
variable yl equal ""-60*v_dx""
variable yh equal ""420*v_dx""
variable zl equal ""-6*v_dx""
variable zh equal ""58*v_dx""

region mybox block ${xl} ${xh} ${yl} ${yh} ${zl} ${zh}
create_box 14 mybox

#-------------------------------------------------------------------------#
# Creating the regions and filling them with atoms assigned to surge_group
#-------------------------------------------------------------------------#
variable density equal 0.001184

variable sigma equal  ""1.2*v_dx""            #""1.2*v_dx""
variable rcutlj equal ""v_sigma*2^(1/6)""
variable rcutlj93 equal ""v_sigma*(2/5)^(1/6)""

#-------------------------------------------------------------------------#
# Creating the cylinder
#-------------------------------------------------------------------------#
variable c1 equal 12.5
variable c2 equal -1.5
variable radius equal 6.0
variable lo equal 9.5
variable hi equal 12.5

region mycylinderinside1 cylinder x ${c1} ${c2} ${radius} ${lo} ${hi}

variable n_nodes_Cy_1 equal ""round(v_more*0.28*((2*PI*v_radius*(v_hi-v_lo))+(2*PI*(v_radius)^2)))""
create_atoms 1 random ${n_nodes_Cy_1} 1234 mycylinderinside1 units box

variable radius_2 equal ""v_radius + v_rcutlj93""
variable hi_2 equal ""v_hi + 2*v_rcutlj93""
variable lo_2 equal ""v_lo - v_rcutlj93""
region mycylinder1 cylinder x ${c1} ${c2} ${radius_2} ${lo_2} ${hi_2}
group gcylinder1 region mycylinder1
#-------------------------------------------------------------------------#
# Creating the cylinder
#-------------------------------------------------------------------------#
variable c1 equal -9.0
variable c2 equal -1.5
variable radius equal 6.0
variable lo equal 9.5
variable hi equal 12.5

region mycylinderinside2 cylinder x ${c1} ${c2} ${radius} ${lo} ${hi}

variable n_nodes_Cy_2 equal ""round(v_more*0.28*((2*PI*v_radius*(v_hi-v_lo))+(2*PI*(v_radius)^2)))""
create_atoms 2 random ${n_nodes_Cy_2} 1234 mycylinderinside2 units box

variable radius_2 equal ""v_radius + v_rcutlj93""
variable hi_2 equal ""v_hi + 2*v_rcutlj93""
variable lo_2 equal ""v_lo - v_rcutlj93""
region mycylinder2 cylinder x ${c1} ${c2} ${radius_2} ${lo_2} ${hi_2}
group gcylinder2 region mycylinder2
#-------------------------------------------------------------------------#
# Creating the cylinder
#-------------------------------------------------------------------------#
variable c1 equal -9.0
variable c2 equal -1.5
variable radius equal 6.0
variable lo equal -12.5
variable hi equal -9.5

region mycylinderinside3 cylinder x ${c1} ${c2} ${radius} ${lo} ${hi}

variable n_nodes_Cy_3 equal ""round(v_more*0.28*((2*PI*v_radius*(v_hi-v_lo))+(2*PI*(v_radius)^2)))""
create_atoms 3 random ${n_nodes_Cy_3} 1234 mycylinderinside3 units box

variable radius_2 equal ""v_radius + v_rcutlj93""
variable hi_2 equal ""v_hi + v_rcutlj93""
variable lo_2 equal ""v_lo - 2*v_rcutlj93""
region mycylinder3 cylinder x ${c1} ${c2} ${radius_2} ${lo_2} ${hi_2}
group gcylinder3 region mycylinder3
#-------------------------------------------------------------------------#
# Creating the cylinder
#-------------------------------------------------------------------------#
variable c1 equal 12.0
variable c2 equal -1.5
variable radius equal 6.0
variable lo equal -12.5
variable hi equal -9.5

region mycylinderinside4 cylinder x ${c1} ${c2} ${radius} ${lo} ${hi}

variable n_nodes_Cy_4 equal ""round(v_more*0.28*((2*PI*v_radius*(v_hi-v_lo))+(2*PI*(v_radius)^2)))""
create_atoms 4 random ${n_nodes_Cy_4} 1234 mycylinderinside4 units box

variable radius_2 equal ""v_radius + v_rcutlj93""
variable hi_2 equal ""v_hi + v_rcutlj93""
variable lo_2 equal ""v_lo - 2*v_rcutlj93""
region mycylinder4 cylinder x ${c1} ${c2} ${radius_2} ${lo_2} ${hi_2}
group gcylinder4 region mycylinder4


#-------------------------------------------------------------------------#
# Creating the prism
#-------------------------------------------------------------------------#
variable xlo1 equal -5.0
variable xhi1 equal 5.0
variable ylo1 equal -15.0
variable yhi1 equal 15.0
variable zlo1 equal -6.0
variable zhi1 equal 6.0

region myprisminside1 block ${xlo1} ${xhi1} ${ylo1} ${yhi1} ${zlo1} ${zhi1}
variable n_nodes_P_1 equal ""(round(v_more*3.4*(6*(10.0)^2)/(PI*v_dx^2)))""
create_atoms 5 random ${n_nodes_P_1} 1234 myprisminside1 units box

variable xlo1_2 equal ""v_xlo1 - v_rcutlj93/2""
variable xhi1_2 equal ""v_xhi1 + v_rcutlj93/2""
variable ylo1_2 equal ""v_ylo1 - v_rcutlj93/2""
variable yhi1_2 equal ""v_yhi1 + v_rcutlj93/2""
variable zlo1_2 equal ""v_zlo1 - v_rcutlj93/2""
variable zhi1_2 equal ""v_zhi1 + v_rcutlj93/2""

region myprism1 block ${xlo1_2} ${xhi1_2} ${ylo1_2} ${yhi1_2} ${zlo1_2} ${zhi1_2}
group gprism1 region myprism1

#-------------------------------------------------------------------------#
# Creating the rear wing
#-------------------------------------------------------------------------#
variable xlo2 equal -10.0
variable xhi2 equal 10.0
variable ylo2 equal 14.0
variable yhi2 equal 22.0
variable zlo2 equal 10.0
variable zhi2 equal 12.0

region myprisminside2 block ${xlo2} ${xhi2} ${ylo2} ${yhi2} ${zlo2} ${zhi2}
variable n_nodes_P_2 equal ""(round(v_more*0.93*(6*(7.0)^2)/(PI*v_dx^2)))""
create_atoms 6 random ${n_nodes_P_2} 1234 myprisminside2 units box

variable xlo2_2 equal ""v_xlo2 - v_rcutlj93/2""
variable xhi2_2 equal ""v_xhi2 + v_rcutlj93/2""
variable ylo2_2 equal ""v_ylo2 - v_rcutlj93/2""
variable yhi2_2 equal ""v_yhi2 + v_rcutlj93/2""
variable zlo2_2 equal ""v_zlo2 - v_rcutlj93/2""
variable zhi2_2 equal ""v_zhi2 + v_rcutlj93/2""

region myprism2 block ${xlo2_2} ${xhi2_2} ${ylo2_2} ${yhi2_2} ${zlo2_2} ${zhi2_2}
group gprism2 region myprism2

#-------------------------------------------------------------------------#
# Creating the rear wing stand
#-------------------------------------------------------------------------#
variable xlo3 equal -2.0
variable xhi3 equal 2.0
variable ylo3 equal 17.0
variable yhi3 equal 19.0
variable zlo3 equal -2.0
variable zhi3 equal 7.0

region myprisminside3 block ${xlo3} ${xhi3} ${ylo3} ${yhi3} ${zlo3} ${zhi3}
variable n_nodes_P_3 equal ""(round(v_more*0.32*(6*(6.0)^2)/(PI*v_dx^2)))""
create_atoms 7 random ${n_nodes_P_3} 1234 myprisminside3 units box

variable xlo3_2 equal ""v_xlo3 - v_rcutlj93/2""
variable xhi3_2 equal ""v_xhi3 + v_rcutlj93/2""
variable ylo3_2 equal ""v_ylo3 - v_rcutlj93/2""
variable yhi3_2 equal ""v_yhi3 + v_rcutlj93/2""
variable zlo3_2 equal ""v_zlo3 - v_rcutlj93/2""
variable zhi3_2 equal ""v_zhi3 + v_rcutlj93/2""

region myprism3 block ${xlo3_2} ${xhi3_2} ${ylo3_2} ${yhi3_2} ${zlo3_2} ${zhi3_2}
group gprism3 region myprism3

#-------------------------------------------------------------------------#
# Creating the front wing
#-------------------------------------------------------------------------#
variable xlo4 equal -10.0
variable xhi4 equal 10.0
variable ylo4 equal -26.5
variable yhi4 equal -22.0
variable zlo4 equal -5.0
variable zhi4 equal -3.0

region myprisminside4 block ${xlo4} ${xhi4} ${ylo4} ${yhi4} ${zlo4} ${zhi4}
variable n_nodes_P_4 equal ""(round(v_more*1.47*(6*(4.0)^2)/(PI*v_dx^2)))""
create_atoms 8 random ${n_nodes_P_4} 1234 myprisminside4 units box

variable xlo4_2 equal ""v_xlo4 - v_rcutlj93/2""
variable xhi4_2 equal ""v_xhi4 + v_rcutlj93/2""
variable ylo4_2 equal ""v_ylo4 - v_rcutlj93/2""
variable yhi4_2 equal ""v_yhi4 + v_rcutlj93/2""
variable zlo4_2 equal ""v_zlo4 - v_rcutlj93/2""
variable zhi4_2 equal ""v_zhi4 + v_rcutlj93/2""

region myprism4 block ${xlo4_2} ${xhi4_2} ${ylo4_2} ${yhi4_2} ${zlo4_2} ${zhi4_2}
group gprism4 region myprism4

#-------------------------------------------------------------------------#
# Creating the front wing stand
#-------------------------------------------------------------------------#
variable xlo5 equal -4.0
variable xhi5 equal 4.0
variable ylo5 equal -20.0
variable yhi5 equal -18.0
variable zlo5 equal -5.0
variable zhi5 equal 3.0

region myprisminside5 block ${xlo5} ${xhi5} ${ylo5} ${yhi5} ${zlo5} ${zhi5}
variable n_nodes_P_5 equal ""(round(v_more*2.15*(6*(3.0)^2)/(PI*v_dx^2)))""
create_atoms 9 random ${n_nodes_P_5} 1234 myprisminside5 units box

variable xlo5_2 equal ""v_xlo5 - v_rcutlj93/2""
variable xhi5_2 equal ""v_xhi5 + v_rcutlj93/2""
variable ylo5_2 equal ""v_ylo5 - v_rcutlj93/2""
variable yhi5_2 equal ""v_yhi5 + v_rcutlj93/2""
variable zlo5_2 equal ""v_zlo5 - v_rcutlj93/2""
variable zhi5_2 equal ""v_zhi5 + v_rcutlj93/2""

region myprism5 block ${xlo5_2} ${xhi5_2} ${ylo5_2} ${yhi5_2} ${zlo5_2} ${zhi5_2}
group gprism5 region myprism5

#-------------------------------------------------------------------------#
# Creating the driver
#-------------------------------------------------------------------------#
variable radius2 equal 1.0
variable xloc equal 0.0
variable yloc equal 3.0
variable zloc equal 9.5

region mysphereinside2 sphere ${xloc} ${yloc} ${zloc} ${radius2}

variable n_nodes_S_2 equal ""(round(v_more*2.0*(2*v_radius2^2/v_dx^2)))""
create_atoms 10 random ${n_nodes_S_2} 1234 mysphereinside2 units box
variable radius2_2 equal ""v_radius2 + v_rcutlj93""
region mysphere2 sphere ${xloc} ${yloc} ${zloc} ${radius2_2}
group gball2 region mysphere2

#-------------------------------------------------------------------------#
# Creating the rear wing side
#-------------------------------------------------------------------------#
variable xlo5 equal 12.0
variable xhi5 equal 14.25
variable ylo5 equal 14.0
variable yhi5 equal 22.0
variable zlo5 equal 10.0
variable zhi5 equal 14.0

region myprisminside6 block ${xlo5} ${xhi5} ${ylo5} ${yhi5} ${zlo5} ${zhi5}
variable n_nodes_P_6 equal ""(round(v_more*1.0*(6*(3.0)^2)/(PI*v_dx^2)))""
create_atoms 11 random ${n_nodes_P_6} 1234 myprisminside6 units box

variable xlo5_2 equal ""v_xlo5 - v_rcutlj93/2""
variable xhi5_2 equal ""v_xhi5 + v_rcutlj93/2""
variable ylo5_2 equal ""v_ylo5 - v_rcutlj93/2""
variable yhi5_2 equal ""v_yhi5 + v_rcutlj93/2""
variable zlo5_2 equal ""v_zlo5 - v_rcutlj93/2""
variable zhi5_2 equal ""v_zhi5 + v_rcutlj93/2""

region myprism6 block ${xlo5_2} ${xhi5_2} ${ylo5_2} ${yhi5_2} ${zlo5_2} ${zhi5_2}
group gprism6 region myprism6

#-------------------------------------------------------------------------#
# Creating the rear wing side
#-------------------------------------------------------------------------#
variable xlo5 equal -14.25
variable xhi5 equal -12.0
variable ylo5 equal 14.0
variable yhi5 equal 22.0
variable zlo5 equal 10.0
variable zhi5 equal 14.0

region myprisminside7 block ${xlo5} ${xhi5} ${ylo5} ${yhi5} ${zlo5} ${zhi5}
variable n_nodes_P_7 equal ""(round(v_more*1.0*(6*(3.0)^2)/(PI*v_dx^2)))""
create_atoms 12 random ${n_nodes_P_7} 1234 myprisminside7 units box

variable xlo5_2 equal ""v_xlo5 - v_rcutlj93/2""
variable xhi5_2 equal ""v_xhi5 + v_rcutlj93/2""
variable ylo5_2 equal ""v_ylo5 - v_rcutlj93/2""
variable yhi5_2 equal ""v_yhi5 + v_rcutlj93/2""
variable zlo5_2 equal ""v_zlo5 - v_rcutlj93/2""
variable zhi5_2 equal ""v_zhi5 + v_rcutlj93/2""

region myprism7 block ${xlo5_2} ${xhi5_2} ${ylo5_2} ${yhi5_2} ${zlo5_2} ${zhi5_2}
group gprism7 region myprism7

#-------------------------------------------------------------------------#
# Creating the front wing side
#-------------------------------------------------------------------------#
variable xlo5 equal 12.0
variable xhi5 equal 14.25
variable ylo5 equal -26.0
variable yhi5 equal -20.0
variable zlo5 equal -5.0
variable zhi5 equal -1.0

region myprisminside8 block ${xlo5} ${xhi5} ${ylo5} ${yhi5} ${zlo5} ${zhi5}
variable n_nodes_P_8 equal ""(round(v_more*1.8*(6*(2.0)^2)/(PI*v_dx^2)))""
create_atoms 11 random ${n_nodes_P_8} 1234 myprisminside8 units box

variable xlo5_2 equal ""v_xlo5 - v_rcutlj93/2""
variable xhi5_2 equal ""v_xhi5 + v_rcutlj93/2""
variable ylo5_2 equal ""v_ylo5 - v_rcutlj93/2""
variable yhi5_2 equal ""v_yhi5 + v_rcutlj93/2""
variable zlo5_2 equal ""v_zlo5 - v_rcutlj93/2""
variable zhi5_2 equal ""v_zhi5 + v_rcutlj93/2""

region myprism8 block ${xlo5_2} ${xhi5_2} ${ylo5_2} ${yhi5_2} ${zlo5_2} ${zhi5_2}
group gprism8 region myprism8

#-------------------------------------------------------------------------#
# Creating the front wing side
#-------------------------------------------------------------------------#
variable xlo5 equal -14.25
variable xhi5 equal -12.0
variable ylo5 equal -26.0
variable yhi5 equal -20.0
variable zlo5 equal -5.0
variable zhi5 equal -1.0

region myprisminside9 block ${xlo5} ${xhi5} ${ylo5} ${yhi5} ${zlo5} ${zhi5}
variable n_nodes_P_9 equal ""(round(v_more*1.8*(6*(2.0)^2)/(PI*v_dx^2)))""
create_atoms 12 random ${n_nodes_P_9} 1234 myprisminside9 units box

variable xlo5_2 equal ""v_xlo5 - v_rcutlj93/2""
variable xhi5_2 equal ""v_xhi5 + v_rcutlj93/2""
variable ylo5_2 equal ""v_ylo5 - v_rcutlj93/2""
variable yhi5_2 equal ""v_yhi5 + v_rcutlj93/2""
variable zlo5_2 equal ""v_zlo5 - v_rcutlj93/2""
variable zhi5_2 equal ""v_zhi5 + v_rcutlj93/2""

region myprism9 block ${xlo5_2} ${xhi5_2} ${ylo5_2} ${yhi5_2} ${zlo5_2} ${zhi5_2}
group gprism9 region myprism9

#------------------------------------------------------------------------#
# creating the union between the regions
#------------------------------------------------------------------------#

group wheels union gcylinder1 gcylinder2 gcylinder3 gcylinder4
group not_wheels union gprism1 gprism2 gprism3 gprism4 gprism5 gball2 gprism6 gprism7 gprism8 gprism9

group aero_group union gprism2 gprism3 gprism4 gprism5 gball2 gprism6 gprism7 gprism8 gprism9
region aero union 9 myprism2 myprism3 myprism4 myprism5 mysphere2 myprism6 myprism7 myprism8 myprism9
group chassis_group union gcylinder1 gcylinder2 gcylinder3 gcylinder4 gprism1
region chassis union 5 mycylinder1 mycylinder2 mycylinder3 mycylinder4 myprism1

group surge_group union aero_group chassis_group
region surge union 2 aero chassis

#------------------------------------------------------------------------#
# Soft Potential
#------------------------------------------------------------------------#
variable softlength equal ""0.5*v_rcutlj""
pair_style soft ${softlength}
pair_coeff * * 0.0
variable prefactor equal ramp(0,4.14e-8)
fix 1 all adapt 1 pair soft a * * v_prefactor

#------------------------------------------------------------------------#
# Run parameters and set up dump
#------------------------------------------------------------------------#
timestep 0.2
mass * 1.0e-6

variable nbin equal ""v_rcutlj / (4/3)""
neighbor ${nbin} bin
neigh_modify delay 0 every 1 check yes
#variable commcutoff equal ""v_dx*2""
#comm_modify cutoff ${commcutoff}

#dump mydump all atom 10000 out.lammpstrj
thermo 5000

#------------------------------------------------------------------------#
# Computes initial interaction
#------------------------------------------------------------------------#
variable epsilon equal 10.0e-10
variable cutofflj93 equal 7.0

fix wall surge_group wall/region surge lj93 ${epsilon} ${sigma} ${cutofflj93}

fix 3 all langevin 31000000.0 50000.0 100.0 5678

fix 2 all nve

#restart 100000 ParticleRestart

run 100000

unfix 1
unfix 2
unfix 3
unfix wall

#------------------------------------------------------------------------#
# Phase 2 : annealing
#------------------------------------------------------------------------#


#------------------------------------------------------------------------#
# Soft Potential
#------------------------------------------------------------------------#
variable softlength equal ""0.475*v_rcutlj""
pair_style soft ${softlength}
pair_coeff * * 4.14e-8

#------------------------------------------------------------------------#
# Computes initial interaction
#------------------------------------------------------------------------#
variable epsilon equal 20.0e-10
variable cutofflj93 equal 7.0

fix wall surge_group wall/region surge lj93 ${epsilon} ${sigma} ${cutofflj93}

fix 3 all langevin 100000.0 5000.0 100.0 5678

fix 2 all nve

run 200000

minimize 0.0 1.0e-8 1000 100000

unfix wall
unfix 2
unfix 3


#-------------------------------------------------------------------------#
# The lb/fluid simulation
#
# The sphere travels through the simulation, being pushed by the fluid
#-------------------------------------------------------------------------#

variable number_all equal count(all)
variable node_mass equal ""500000 / v_number_all""
mass 5* ${node_mass}
variable wheel_mass equal ""v_node_mass/1000""
mass *4 ${wheel_mass}

variable dx equal 1.0
variable density equal 0.001184

neighbor 0.5 bin            
neigh_modify delay 0 every 1 check yes
comm_modify cutoff 3.0     

pair_style lj/cut 1.2
pair_coeff * * 0.0 0.0

timestep 0.025
if ""$(is_defined(dump,mydump))"" then ""undump mydump""

reset_timestep 0

#dump mydump all atom 10000 run.lammpstrj
#variable total_force equal 0.2
#variable node_force equal ""v_total_force / 178""
#fix drag all addforce 0.0 0.0 0.0

velocity all set 0.0 -7.5.0 0.0 units box

# viscosity of air is 0.0001847

fix   FL all lb/fluid 1 0.0002 ${density} stencil 2 dx ${dx} zwall_velocity 0 0 # dumpxdmf 1000 sflow 0

variable vx equal vcm(all,x)
variable vy equal vcm(all,y)
variable vz equal vcm(all,z)

#dump mydumpvtk all vtk 1000 out*.vtp vx vy vz

fix   2 all lb/viscous

fix 4 not_wheels nve

fix  3 wheels rigid group 4 gcylinder1 gcylinder2 gcylinder3 gcylinder4 force * off off off torque * on off off

fix 5 not_wheels setforce 0.0 0.0 0.0

thermo_style custom step v_number_all v_node_mass f_FL[2] f_5[1] f_5[2] f_5[3]
thermo 100

run 5000


#-------------------------------------------------------------------------#
"
"Generate a LAMMPS input script for a NPT simulation of an charge system using lj/polysoft 2.03 pair style with pair coefficients 1 1 1.0 1.0 2.025 1.25 0.2 with a timestep of 0.01 running for 100000 steps.","# Example script of liquid front propagation in glass 2d-NPT simulation
# see C. Herrero et al. ( https://doi.org/10.48550/arXiv.2210.04775 ) for details

# parameters set

variable	Ti equal 0.035		# Initial glass temperature
variable        Ta equal 0.11		# Annealing temperature
variable	P equal 2.31052		# Pressure
variable 	wx equal 80		# half slit size
variable	seed equal 4115699	# RNG seed

# problem setup

units           lj
atom_style      charge
atom_modify 	map array

dimension 	2

pair_style      lj/polysoft 2.03
read_data       Ti${Ti}.lmps		# initial glass config equlibrated with swap MC
pair_coeff      1 1 1.0 1.0 2.025 1.25 0.2

neighbor        0.3 bin
neigh_modify    every 1 delay 0 check yes

# define liquid (front) and glass regions
region		front block -${wx} +${wx} INF INF INF INF
group		front dynamic all region front
region 		glassL block INF -${wx} INF INF INF INF
region		glassR block +${wx} INF INF INF INF INF
region		glass union 2 glassL glassR
group		glass dynamic all region glass

velocity 	all create ${Ti} ${seed}

timestep        0.01
reset_timestep  0

# Perform simulation
# 1st let the system expand quickly

fix             1 all npt temp ${Ta} ${Ta} 1.0 iso $P $P 1.0

# track glass and front pressure
compute		peratomf front stress/atom NULL
compute		pf front reduce sum c_peratomf[1] c_peratomf[2]
variable	pressf equal -(c_pf[1]+c_pf[2])/(2*2*v_wx*ly)

compute         peratomg glass stress/atom NULL
compute         pg glass reduce sum c_peratomg[1] c_peratomg[2]
variable        pressg equal -(c_pg[1]+c_pg[2])/(2*(lx-2*v_wx)*ly)

compute         tempf front temp
compute         tempg glass temp

variable	thermofreq equal logfreq2(100,18,10)
thermo          v_thermofreq
thermo_style    custom step temp pe ke etotal press vol v_pos v_pressf c_tempf v_pressg c_tempg
thermo_modify   flush yes

run             100000

# 2nd freeze all the particles and create liquid front of size 2*wx

unfix 		1
fix		1 front nvt temp 0.8 0.8 1.0

run		100000

# 3rd equilibrate the liquid inside the cavity at Ta (only with md in this example)

unfix		1
fix		1 front nvt temp ${Ta} ${Ta} 1.0

run		1000000

# 4th study front propagation from this configuration

unfix		1
reset_timestep	0

velocity	all create ${Ta} ${seed} rot yes dist gaussian

fix		1 all npt temp ${Ta} ${Ta} 1.0 iso $P $P 1.0

dump		traj all custom 500000 front.lammpstrj x y c_epot c_patom[1] c_patom[2] c_patom[4]
dump_modify	traj sort id first yes pbc yes

restart         5000000 front.*.restart

run             10000000

write_data      front.end
"
"Generate a LAMMPS input script for a NVE simulation using tersoff/zbl pair style with pair coefficients * * SiC.tersoff.zbl Si and p p p boundary conditions running for 100 steps.","# ***
# Example input for including electronic stopping effects using fix electron/stopping/fit
# Si lattice with one primary knock-on atom (PKA) - single species simulation
# ***

units            metal
boundary         p p p

lattice          diamond 5.431

region           box block -10 10 -10 10 -10 10
create_box       1 box
create_atoms     1 box

pair_style       tersoff/zbl
pair_coeff       * * SiC.tersoff.zbl Si

mass             1 28.0855

velocity         all create 300 42534 mom yes rot yes

group            pka id 1
velocity         pka set 1120 1620 400

fix              1 all nve
fix              2 all dt/reset 1 NULL 0.001 0.05 emax 10.0
fix              3 all electron/stopping/fit 4.63 3.3e-3 4.0e-8

thermo           5
thermo_style     custom step dt time temp pe ke f_3
thermo_modify    lost warn flush yes

#dump             0 all custom 10 dump.pka_* id type x y z vx vy vz fx fy fz
#dump_modify      0 first yes

run              100
"
"Generate a LAMMPS input script for a general simulation of an charge system using buck/coul/long ${cut_off}                                                               #BKS interaction, PRL 64 1955 (1990) pair style with pair coefficients 1 1 0.0 1.0 0.0 and p p p boundary conditions running for 10000                                                                                   # 20 ps steps.","## This script first constructs an alpha quartz structure of a given size. It then uses fix qtb to equilibrate the computational cell to the specified temperature and pressure.
variable                x_rep equal 2                                                                           #x-direction replication number
variable                y_rep equal 2                                                                           #y-direction replication number
variable                z_rep equal 2                                                                           #z-direction replication number
variable                cut_off equal 10.0                                                                      #Cut-off distance for the Buckingham term (Angstrom in metal units)
variable                pressure equal 1.03125                                                                  #Initial state pressure (bar in metal units)
variable                temperature equal 300.0                                                                 #Initial state quantum temperature (K in metal units)
variable                delta_t equal 1.0e-3                                                                    #MD timestep length (ps in metal units)
variable                damp_qtb equal 1                                                                        #1/gamma where gamma is the friction coefficient in quantum thermal bath (ps in metal units)

## This part defines units, alpha-quartz crystal, and atomic information
#General
units                   metal
dimension               3
boundary                p p p
atom_style              charge

#Lattice
lattice                 custom 1.0 &
                        a1      4.916000 0.000000 0.000000 &
                        a2      -2.45800 4.257381 0.000000 &
                        a3      0.000000 0.000000 5.405400 &
                        &
                        basis   0.469700 0.000000 0.000000 &
                        basis   0.000000 0.469700 0.666667 &
                        basis   0.530300 0.530300 0.333333 &
                        &
                        basis   0.413500 0.266900 0.119100 &
                        basis   0.266900 0.413500 0.547567 &
                        basis   0.733100 0.146600 0.785767 &
                        basis   0.586500 0.853400 0.214233 &
                        basis   0.853400 0.586500 0.452433 &
                        basis   0.146600 0.733100 0.880900                                                      #American Mineralogist 65 920 1980 (Space Group 154)

#Computational Cell
region                  orthorhombic_unit_cell block 0 4.916000 0 8.514762 0 5.405400 units box
create_box              2 orthorhombic_unit_cell
create_atoms            1 box &
                        basis   1 1 &
                        basis   2 1 &
                        basis   3 1 &
                        basis   4 2 &
                        basis   5 2 &
                        basis   6 2 &
                        basis   7 2 &
                        basis   8 2 &
                        basis   9 2
replicate               ${x_rep} ${y_rep} ${z_rep}

#Atomic Information
mass                    1 28.085500
mass                    2 15.999400
set                     type 1 charge +2.4
set                     type 2 charge -1.2


## This part implements the BKS pair potential with a cut-off distance for the Buckingham term. Long range Coulomb interactions are evaluated with the pppm method.
#Pair Potentials
pair_style              buck/coul/long ${cut_off}                                                               #BKS interaction, PRL 64 1955 (1990)
pair_coeff              1 1 0.0 1.0 0.0
pair_coeff              1 2 18003.757200 0.205205 133.538100
pair_coeff              2 2 1388.773000  0.362319 175.000000
pair_modify             shift yes
kspace_style            pppm 1.0e-4

#Neighbor style
neighbor                2.0 bin
neigh_modify            check yes every 1 delay 0 page 100000 one 2000


## This part equilibrates your crystal to a pressure of ${pressure}(unit pressure) and a temperature of ${temperature}(unit temperatureture) with quantum nuclear effects
variable                p_damp equal ${delta_t}*1000                                                            #Recommended pressure damping parameter in fix nph
fix                     scapegoat_qtb all nph iso ${pressure} ${pressure} ${p_damp} ptemp ${temperature}                                #NPH does the time integration
fix                     quartz_qtb all qtb temp ${temperature} damp ${damp_qtb} seed 35082 f_max 120.00 N_f 100 #Change f_max (THz) if your Debye frequency is higher
thermo_style            custom step temp press etotal vol lx ly lz pxx pyy pzz pxy pyz pxz
thermo                  500
run                     10000                                                                                   # 20 ps
unfix                   quartz_qtb
unfix                   scapegoat_qtb
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut/gpu 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 5000000 steps.","# 3d Lennard-Jones melt

units		lj
atom_style	atomic
newton      off

lattice		fcc 0.8442
region		box block 0 10 0 10 0 10
create_box	1 box
create_atoms	1 box
mass		1 1.0

velocity	all create 3.0 87287

pair_style	lj/cut/gpu 2.5
pair_coeff	1 1 1.0 1.0 2.5

neighbor	0.3 bin
neigh_modify	every 5 delay 10 check yes

thermo_style    custom step pe ke spcpu

fix     0 all gpu force/neigh 0 0 1.0
fix		1 all nve

# IMD setup.
fix  comm       all imd 5678 unwrap off fscale 20.0 trate 20 nowait on

thermo		500
run		5000000
"
"Generate a LAMMPS input script for a NVE simulation of an bpm/sphere system using gran/hooke/history 1.0 NULL 0.5 NULL 0.1 1 pair style with pair coefficients 1 1 and f f f boundary conditions with a timestep of 0.05 running for 7500 steps.","units           lj
dimension       3
boundary        f f f
atom_style      bpm/sphere
special_bonds   lj 0.0 1.0 1.0 coul 0.0 1.0 1.0
newton          on off
comm_modify     vel yes cutoff 2.6
lattice         fcc 1.0
region          box block -25 15 -22 22 -22 22
create_box      1 box bond/types 2 extra/bond/per/atom 20 extra/special/per/atom 50

region          disk cylinder x 0.0 0.0 20.0 -0.5 0.5
create_atoms    1 region disk
group           plate region disk

region          ball sphere 8.0 0.0 0.0 6.0
create_atoms    1 region ball
group           projectile region ball

displace_atoms  all random 0.1 0.1 0.1 134598738

neighbor        1.0 bin
pair_style      gran/hooke/history 1.0 NULL 0.5 NULL 0.1 1
pair_coeff      1 1

fix             1 all nve/bpm/sphere

create_bonds    many plate plate 1 0.0 1.5
create_bonds    many projectile projectile 2 0.0 1.5

neighbor        0.3 bin
special_bonds   lj 0.0 1.0 1.0 coul 1.0 1.0 1.0

bond_style      bpm/rotational store/local brkbond 100 time id1 id2
bond_coeff      1 1.0 0.2 0.02 0.02 0.05 0.01 0.01 0.01 0.1 0.2 0.002 0.002
bond_coeff      2 1.0 0.2 0.02 0.02 0.20 0.04 0.04 0.04 0.1 0.2 0.002 0.002

velocity        projectile set -0.05 0.0 0.0
compute         nbond all nbond/atom
compute         tbond all reduce sum c_nbond

timestep        0.05
thermo_style    custom step ke pe pxx pyy pzz c_tbond
thermo          100
thermo_modify   lost ignore lost/bond ignore
#dump            1 all custom 100 atomDump id radius x y z c_nbond

dump            2 all local 100 brokenDump f_brkbond[1] f_brkbond[2] f_brkbond[3]
dump_modify     2 header no

run             7500
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut ${rc} pair style with pair coefficients * * 1 1 running for 5000 steps.","# sample LAMMPS input script for viscosity of 2d LJ liquid
# NEMD via fix deform and fix nvt/sllod

# settings

variable	x equal 20
variable	y equal 20

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

variable	srate equal 2.7 # velocity of top edge

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

# problem setup

lattice         sq2 ${rho}
region          simbox prism 0 $x 0 $y -0.1 0.1 0.0 0.0 0.0
create_box      1 simbox
create_atoms    1 box

pair_style      lj/cut ${rc}
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        3 all enforce2d

# equilibration run

thermo          1000
run	        5000

unfix  	        1
unfix		2

# turn on NEMD shear and equilibrate some more

velocity	all scale $t

# shear rate defined relative to perpendicular dimension

variable	xyrate equal ${srate}/ly 

fix		1 all nvt/sllod temp $t $t 0.1
fix		2 all deform 1 xy erate ${xyrate} remap v

compute         layers all chunk/atom bin/1d y center 0.05 units reduced
fix		4 all ave/chunk 20 250 5000 layers vx file profile.nemd.2d

compute		usual all temp
compute		tilt all temp/deform

thermo          1000
thermo_style	custom step temp c_usual epair etotal press pxy
thermo_modify	temp tilt
run		50000

# data gathering run

variable	visc equal -pxy/(v_srate/ly)
fix		vave all ave/time 10 100 1000 v_visc ave running start 56000

thermo_style	custom step temp press pxy v_visc f_vave
thermo_modify	temp tilt

# only need to run for 5400 steps to make a good 100-frame movie
# set 54K steps above in equil and 5400 here simply to make good movie
# 54K and 5400 are multiples of box-swap periodicity = 2700 steps

#dump	        1 all custom 50 dump.nemd.2d id type x y z vx

#dump		2 all image 50 image.*.jpg vx type zoom 1.2 adiam 1.2
#dump_modify	2 pad 5 amap 0.0 ${srate} ca 0.0 2 min blue max red

run		50000
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using hybrid reax/c NULL zbl 8.0 10.0 pair style with pair coefficients * * reax/c ../../../../potential.reaxFF/ffield.reax.combined.COFSi.v4 Si O C F NULL and p p f boundary conditions with a timestep of ${dt} running for 2000 steps at temperature 300.0.","# deposit CF_x molecules on amorphous SiO2

dimension      3
boundary       p p f
units		   real
atom_style	   charge

variable       dt equal 0.25 # units=fs
timestep       ${dt}

variable       box_zh equal 60
region         sim_box block 0 30 0 30 0 ${box_zh} units box
create_box     5 sim_box
read_data	   ../../../SiO2.300K.equilibrated.dat add merge

mass	3 12.0107  # C
mass	4 18.9984  # F
mass    5 39.948   # Ar

# # reduce box sizes in x and y dimensions and delete corresponding atoms
# variable       material_desired_lateral_size equal 20
# region         delete_region_x block ${material_desired_lateral_size} EDGE EDGE EDGE EDGE EDGE
# region         delete_region_y block EDGE EDGE ${material_desired_lateral_size} EDGE EDGE EDGE
# region         delete_region union 2 delete_region_x delete_region_y
# delete_atoms   region delete_region compress yes
# change_box     all x final $(xlo) ${material_desired_lateral_size} y final $(ylo) ${material_desired_lateral_size} units box

# freeze the bottom layer
variable       material_height equal 34.5
variable       freeze_below_z equal 0.2*v_material_height
region         freeze_block block INF INF INF INF INF ${freeze_below_z} units box
region         mobile_block block INF INF INF INF ${freeze_below_z} INF units box
group		   freeze_group region freeze_block
group          mobile_group region mobile_block
fix        1   freeze_group setforce 0.0 0.0 0.0

# NVT for middle region and NVE for top region
variable       between_nvt_and_nve equal 0.8*v_material_height
region         middle_nvt_block block INF INF INF INF ${freeze_below_z} ${between_nvt_and_nve} units box
region         top_nve_block    block INF INF INF INF ${between_nvt_and_nve} INF units box
group          middle_nvt_group region middle_nvt_block
group          top_nve_group    region top_nve_block

pair_style	   hybrid reax/c NULL zbl 8.0 10.0
pair_coeff	   * * reax/c ../../../../potential.reaxFF/ffield.reax.combined.COFSi.v4 Si O C F NULL
# pair_coeff	   * * ffield.reax.CHOSi Si O
pair_coeff     1 5 zbl 14.0 18.0
pair_coeff     2 5 zbl  8.0 18.0
pair_coeff     3 5 zbl  6.0 18.0
pair_coeff     4 5 zbl  9.0 18.0
pair_coeff     5 5 zbl 18.0 18.0

neighbor	   2. bin
neigh_modify   every 10 delay 0 check no
fix        2   all qeq/reax 1 0.0 10.0 1e-6 reax/c

# # initial minimisation
# thermo_style   custom step temp epair etotal press
# thermo         10
# minimize       1.0e-6 1.0e-6 100000 100000
# reset_timestep 0

compute        mobile_temp mobile_group temp
compute_modify mobile_temp dynamic/dof yes

dump           1 all custom 100 dumpidtype.dat id type x y z
thermo_style   custom step temp pe ke etotal press vol density
thermo         100
thermo_modify  lost warn temp mobile_temp

fix		   3   mobile_group npt temp 300.0 300.0 $(100.0*dt) x 0.0 0.0 $(1000.0*dt) y 0.0 0.0 $(1000.0*dt)
run		       2000
unfix      3

# fix		   3   mobile_group nvt temp 300.0 300.0 $(100.0*dt)
fix		   3   middle_nvt_group nvt temp 300.0 300.0 $(100.0*dt)
fix		   4   top_nve_group nve
run		       4000

molecule       CFx  ../../../molecules/data.molecule.CF  ../../../molecules/data.molecule.CF2

# deposit CF_x molecules on top of a-SiO2
variable       num_of_insert_CFx equal 1000
variable       delta_step_insert_CFx equal 4000 # 1000fs
variable       CF2_to_CF_flux_ratio equal 2
variable       randomSeedForDeposit equal YYY
variable       offset_for_atom_types equal 2
variable       deposit_slab_zl equal v_material_height+10
variable       deposit_slab_zh equal v_material_height+15

variable       in_angle_degree equal 0 # degree
variable       in_energy equal 1 # eV
variable       in_angle equal v_in_angle_degree/180*3.1415926 # rad
variable       in_mass_kg_CF equal 1.66054E-27*(12.0107+18.9984)
variable       in_mass_kg_CF2 equal 1.66054E-27*(12.0107+18.9984*2)
variable       in_velocity equal sqrt(2*v_in_energy*1.602E-19/((v_in_mass_kg_CF+v_in_mass_kg_CF2)/2))/100/1000 # Angstrom/fs
variable       in_vz equal -v_in_velocity*cos(v_in_angle)
# variable       in_vy equal v_in_velocity*sin(v_in_angle)

# define variables for Ar atoms
variable       CFx_to_Ar_flux_ratio equal 3/80
variable       num_of_insert_Ar equal floor(v_num_of_insert_CFx*v_CFx_to_Ar_flux_ratio)
variable       delta_step_insert_Ar equal floor(v_delta_step_insert_CFx/v_CFx_to_Ar_flux_ratio)
variable       in_angle_degree_Ar equal 75 # degree
variable       in_energy_Ar equal XXX # eV
variable       in_angle_Ar equal v_in_angle_degree_Ar/180*3.1415926 # rad
variable       in_velocity_Ar equal sqrt(2*v_in_energy_Ar*1.602E-19/6.633E-26)/100/1000 # Angstrom/fs
variable       in_vz_Ar equal -v_in_velocity_Ar*cos(v_in_angle_Ar)
variable       in_vy_Ar equal  v_in_velocity_Ar*sin(v_in_angle_Ar)


group	       addatoms type 3 4 5
region         deposit_slab block EDGE EDGE EDGE EDGE ${deposit_slab_zl} ${deposit_slab_zh} units box
fix		   5   addatoms deposit ${num_of_insert_CFx} ${offset_for_atom_types} ${delta_step_insert_CFx} ${randomSeedForDeposit} &
               region deposit_slab near 2.0 id next mol CFx molfrac 0.25 0.75 vz ${in_vz} ${in_vz} units box
fix        6   addatoms deposit ${num_of_insert_Ar} 5 ${delta_step_insert_Ar} ${randomSeedForDeposit} region deposit_slab near 2.0 &
               id next vz ${in_vz_Ar} ${in_vz_Ar} vy ${in_vy_Ar} ${in_vy_Ar} units box

fix        7   addatoms nve

# remove atoms using evaporate to fix the issues of partially removing molecules
variable       evaporate_slab_zl equal v_box_zh-5
region         evaporate_slab block EDGE EDGE EDGE EDGE ${evaporate_slab_zl} EDGE units box
fix        8   all oneway 100 evaporate_slab z

variable       run_step equal (v_num_of_insert_CFx+5)*v_delta_step_insert_CFx
run		       ${run_step}

write_data     SiO2.300K.deposited.with.CFx.dat
write_restart  SiO2.300K.deposited.with.CFx.restart
"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay eam/alloy spin/exchange 4.0 pair style with pair coefficients * * eam/alloy Co_PurjaPun_2012.eam.alloy Co and p p p boundary conditions with a timestep of 0.0001 running for 1000 steps.","# fcc cobalt in a 3d periodic box

clear 
units		metal
atom_style 	spin

dimension 	3
boundary 	p p p

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice fcc 	3.54
region box 	block 0.0 5.0 0.0 5.0 0.0 5.0
create_box 	1 box
create_atoms 	1 box

# setting mass, mag. moments, and interactions for fcc cobalt

mass		1 58.93

#set 		group all spin/random 31 1.72
set 		group all spin 1.72 0.0 0.0 1.0
velocity 	all create 100 4928459 rot yes dist gaussian

pair_style 	hybrid/overlay eam/alloy spin/exchange 4.0
pair_coeff 	* * eam/alloy Co_PurjaPun_2012.eam.alloy Co
pair_coeff 	* * spin/exchange exchange 4.0 0.0446928 0.003496 1.4885 

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin zeeman 1.0 0.0 0.0 1.0
fix_modify 	1 energy yes

fix 		2 all langevin/spin 0.0 0.0 21

fix 		3 all nve/spin lattice moving
timestep	0.0001

# compute and output options

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	magx      equal c_out_mag[1]
variable 	magy      equal c_out_mag[2]
variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo_style    custom step time v_magx v_magy v_magnorm pe v_emag temp etotal
thermo          50

# compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
# dump 		1 all custom 100 dump_cobalt_fcc.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3]

run 		1000
"
"Generate a LAMMPS input script for a NVE simulation of an body nparticle 2 6 system using body/nparticle 5.0 pair style with pair coefficients * * 1.0 1.0 running for 10000 steps.","# 2d polygon nparticle bodies

units		lj
dimension       2
atom_style	body nparticle 2 6

read_data       data.body

velocity	all create 1.44 87287 loop geom

pair_style	body/nparticle 5.0
pair_coeff	* * 1.0 1.0

neighbor	0.5 bin
neigh_modify    every 1 delay 0 check yes

fix		1 all nve/body
#fix		1 all nvt/body temp 1.44 1.44 1.0
fix		2 all enforce2d

#compute         1 all body/local type 1 2 3
#dump            1 all local 100 dump.body index c_1[1] c_1[2] c_1[3] c_1[4]

#dump		2 all image 1000 image.*.jpg type type &
#		zoom 1.6 adiam 1.5 body type 1.0 0
#dump_modify    2 pad 5

thermo          100
run		10000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 13. pair style with pair coefficients 1 1 .2381 3.405 13. and f p p boundary conditions with a timestep of 5 running for 1000 steps.","# Computes elastic waves propagating in and out of a finite temperature region
#AtC ThermoElastic Coupling
echo both

units		real
atom_style	atomic

# create domain
#lattice	type reduced density rho* = 4*(sigma/a)^3, where N=4 for fcc, s = 3.405 A (Wagner) and a = 5.25 A (Ashcroft & Mermin, p. 70)
lattice         fcc 5.2582305 origin 0.25 0.25 0.25

region		simRegion block -12 12 -3 3 -3 3
region		mdRegion block -8 8 -3 3 -3 3
boundary	f p p
create_box	1 simRegion
create_atoms	1 region mdRegion
mass		1 39.95

# specify interal/ghost atoms
region		mdInternal block -6 6 -3 3 -3 3
region		leftghost block -8 -6 -3 3 -3 3
region		rightghost block 6 8 -3 3 -3 3
group		internal region mdInternal
group		Lghost region leftghost
group		Rghost region rightghost
group		ghosts union Lghost Rghost

# velocities have Vcm = 0, NOTE next for lines commented out for restart
pair_style	lj/cut 13.
#pair_coeff	1 1 0.010323166 3.405 13.
pair_coeff  	1 1 .2381 3.405 13.

neighbor	5. bin
neigh_modify	every 10 delay 0 check no

# define  layer
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc elastic     Ar_elastic.mat
fix_modify	AtC boundary ghosts

#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 12  1  1  simRegion f p p
fix_modify      AtC mesh create_faceset obndy box -6.0 6.0 -INF INF -INF  INF outward
fix_modify      AtC internal_quadrature off
fix_modify  AtC  internal_atom_integrate off
fix iNVE internal nve

# initial conditions 
fix_modify  AtC  initial displacement x all 0.0
fix_modify  AtC  fix displacement y all 0.0
fix_modify  AtC  fix displacement z all 0.0
fix_modify  AtC  initial velocity x all 0.0
fix_modify  AtC  fix velocity y all 0.0
fix_modify  AtC  fix velocity z all 0.0

# set node sets and bcs
#           ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
fix_modify  AtC mesh create_nodeset lbc -12.1  -11.9   -INF INF  -INF INF
fix_modify  AtC mesh create_nodeset rbc  11.9   12.1   -INF INF  -INF INF
#fix_modify  AtC  fix velocity x rbc 0.
#fix_modify  AtC  fix displacement x rbc 0.
fix_modify  AtC  fix displacement x lbc 0.
fix_modify  AtC  fix velocity x lbc 0.

# turn on multiscale
fix_modify      AtC control momentum ghost_flux

# new boundary conditions
fix_modify  AtC  fix velocity x rbc 0.00000004


#fix_modify      AtC  output follow_ex.fe 50
#fix_modify	AtC  localized_lambda on
#fix_modify	AtC  momentum control glc_velocity
#fix_modify	AtC  momentum control flux faceset obndy
#fix_modify     AtC control momentum flux
#fix_modify	AtC control momentum ghost_flux
#fix_modify      AtC  filter scale 1000.0

# run to extension
compute		myTemp internal temp
compute		atomStress internal stress/atom NULL
compute		avgStress internal reduce sum c_atomStress[1] c_atomStress[2] c_atomStress[3]
variable	myPres equal -(c_avgStress[1]+c_avgStress[2]+c_avgStress[3])/(3*vol)
thermo_style	custom step c_myTemp v_myPres pe
fix_modify      AtC  output bar1d_ghost_fluxFE 500 text
#dump            D1 all atom 100 bar1d_ghost_flux.dmp
timestep	5
thermo		100
run 		1000

# change nodes to fixed
fix_modify      AtC  unfix velocity x rbc
#fix_modify	AtC  fix displacement x rbc 0.0002

#fix_modify      AtC  output bar1d_fluxFE 500 text binary

# run to equilibrium
timestep        5
thermo		100
run 		3000
"
"Generate a LAMMPS input script for a NVE simulation using mliap model mliappy Ta_ACE.mliap.pytorch.model.pt descriptor ace linear_ACE_ccs.yace pair style with pair coefficients * * Ta and p p p boundary conditions with a timestep of 0.5e-3 running for ${nsteps} steps.","# Demonstrate MLIAP/PyTorch interface to linear SNAP potential

# Initialize simulation

variable nsteps index 100
variable nrep equal 4
variable a equal 3.316
units           metal

# generate the box and atom positions using a BCC lattice

variable nx equal ${nrep}
variable ny equal ${nrep}
variable nz equal ${nrep}

boundary        p p p

lattice         bcc $a
region          box block 0 ${nx} 0 ${ny} 0 ${nz}
create_box      1 box
create_atoms    1 box

mass 1 180.88

# choose potential

pair_style mliap model mliappy Ta_ACE.mliap.pytorch.model.pt descriptor ace linear_ACE_ccs.yace
pair_coeff * * Ta

# Setup output

compute  eatom all pe/atom
compute  energy all reduce sum c_eatom

compute  satom all stress/atom NULL
compute  str all reduce sum c_satom[1] c_satom[2] c_satom[3]
variable press equal (c_str[1]+c_str[2]+c_str[3])/(3*vol)

thermo_style    custom step temp epair c_energy etotal press v_press
thermo          10
thermo_modify norm yes

# Set up NVE run

timestep 0.5e-3
neighbor 1.0 bin
neigh_modify once no every 1 delay 0 check yes

# Run MD

velocity all create 300.0 4928459 loop geom
fix 1 all nve
run             ${nsteps}

"
"Generate a LAMMPS input script for a NVT simulation of an electron system using eff/cut 529.177249 pair style with pair coefficients * * and f f f boundary conditions with a timestep of 0.001 running for 100000 steps at temperature 1.0.","
# Created 2010-12-13

# General parameters

variable	sname index C2H6fc.ang

units		real
newton		on
boundary	f f f

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 529.177249
pair_coeff      * *

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

comm_modify	vel yes

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo		100
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp press effPress

# Minimization

min_style       cg
dump            1 all xyz 100 ${sname}.min.xyz
compute         1 all property/atom spin eradius erforce
dump            2 all custom 100 ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
dump            3 all custom 100 data.${sname}.restart id type q c_1[1] c_1[2] x y z
min_modify      line quadratic
minimize        0 1e-6 1000 2000

undump		1
undump		2
undump          3

# Equilibrate at 5000K
velocity        all create 1.0 4928459 rot yes mom yes dist gaussian

timestep	0.001

fix             1 all nvt/eff temp 1.0 10000.0 1.0
dump            2 all custom 100 ${sname}.nvt.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]

run             100000

"
"Generate a LAMMPS input script for a general simulation of an charge system using buck/coul/long 12.0 pair style with pair coefficients 2 2 1388.77 .3623188 175.0 running for 0 post no steps.","# This example demonstrates the use of various fix qeq variants with 
#   a pair style using charges, in this case pair_style buck/coul/long

units           metal
atom_style      charge

read_data 	data.aC
#replicate  	2 2 2

pair_style 	buck/coul/long 12.0 
pair_coeff 	2 2 1388.77 .3623188 175.0
pair_coeff  	1 2 18003   .2052124  133.5381
pair_coeff 	1 1 0 .1 0

fix        	2 all qeq/shielded    1 10 1.0e-20 10 param.qeq2

include buck.inc

velocity  	all create 300.0 1281937 
run             0 post no

write_restart   qeq.restart

clear

print ""Using fix qeq/point""
read_restart   qeq.restart
fix        	2 all qeq/point    1 10 1.0e-6 100 param.qeq2
include buck.inc

run 100

clear

print ""Using fix qeq/shielded""
read_restart   qeq.restart
fix        	2 all qeq/shielded    1 10 1.0e-6 100 param.qeq2
include buck.inc

run 100


clear

print ""Using fix qeq/slater""
read_restart   qeq.restart
fix        	2 all qeq/shielded    1 10 1.0e-6 100 param.qeq2
include buck.inc

run 100

clear

print ""Using fix qeq/dynamic""
read_restart   qeq.restart
fix        	2 all qeq/dynamic    1 10 1.0e-3 100 param.qeq2
include buck.inc

run 100

clear

print ""Using fix qeq/fire""
read_restart   qeq.restart
fix        	2 all qeq/fire     1 10 1.0e-3 100 param.qeq2
include buck.inc

run 100
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style with pair coefficients 1 1 0.238 3.405 and f p p boundary conditions with a timestep of 0.0 running for 1 steps.","# This test compares Hardy and Cauchy-Born metrics of energy density and stress
# for an Ar system subjected to uniaxial strain deformation.
echo both
units		real	
atom_style	atomic
# create domain
lattice         fcc 5.256227487 origin 0.25 0.25 0.25
region		BOX block -8 8 -2 2 -2 2
boundary	f p p
create_box	1 BOX
# create atoms
region		MD block -7 7 -2 2 -2 2
create_atoms	1 region MD
mass		1 39.95
# specify interal/ghost atoms
region    FREE block -6 6 -2 2 -2 2
group   internal region FREE
# specify inter-atomic potential
pair_style lj/cut 13.5
pair_coeff 1 1 0.238 3.405
# specify neighbor/re-neighboring parameters
neighbor	0.3 bin
neigh_modify	every 10 delay 0 check no
# setup thermal output
thermo		10
thermo_style custom step pe ke press lx ly lz
#           ID  group atc PhysicsType ParameterFile
fix         AtC internal   atc field Ar_CauchyBorn.mat
fix_modify  AtC mesh create 8 1 1 BOX f p p
fix_modify  AtC  fields none 
fix_modify  AtC  fields add displacement 
fix_modify  AtC  fields add internal_energy stress cauchy_born_energy cauchy_born_stress
fix_modify  AtC  gradients add displacement 
fix_modify  AtC  fields add elastic_deformation_gradient
timestep 0.0
fix_modify	AtC  output cb_unistrainFE 1 text tensor_components binary
log       cb_unistrain.log
variable step  equal 0
thermo_style  custom step v_step pe ke press lx ly lz
run 	1
variable step equal ${step}+1
displace_atoms	all ramp x -0.1 0.1 x -100 100
run		1
variable step equal ${step}+1
displace_atoms	all ramp x -0.1 0.1 x -100 100
run		1
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay hbond/dreiding/lj 2 6 6.5 90 lj/cut/coul/long 8.50000  11.5 pair style with pair coefficients 1    1    lj/cut/coul/long        0.015200000256300         2.846421344984478 and p p p boundary conditions running for 100 steps.","units           real
atom_style      full
boundary        p p p
dielectric      1
special_bonds   lj/coul 0.0 0.0 1.0

pair_style      hybrid/overlay hbond/dreiding/lj 2 6 6.5 90 lj/cut/coul/long 8.50000  11.5
bond_style      harmonic
angle_style     harmonic
dihedral_style  harmonic
improper_style  none
kspace_style    pppm 0.001

read_data       data.dreiding

pair_coeff      1    1    lj/cut/coul/long        0.015200000256300         2.846421344984478
pair_coeff      1    2    lj/cut/coul/long        0.001232882795416         2.846421344984478
pair_coeff      1    3    lj/cut/coul/long        0.038019995160237         3.159705878878677
pair_coeff      1    4    lj/cut/coul/long        0.038139744011598         2.939787518071103
pair_coeff      2    2    lj/cut/coul/long     9.99999974737875e-05         2.846421344984478
pair_coeff      2    3    lj/cut/coul/long        0.003083828758188         3.159705878878677
pair_coeff      2    4    lj/cut/coul/long        0.003093541672406         2.939787518071103
pair_coeff      3    3    lj/cut/coul/long        0.095100000500679         3.472990412772877
pair_coeff      3    4    lj/cut/coul/long        0.095399530150179         3.253072051965302
pair_coeff      4    4    lj/cut/coul/long        0.095700003206730         3.033153691157727
pair_coeff      4    4    hbond/dreiding/lj  2  i  4.000    2.750000000000000      4
pair_modify     mix arithmetic
neighbor        2.0 multi
neigh_modify    every 2 delay 4 check yes
variable        input index in.ch3oh.box.dreiding
variable        sname index ch3oh.box.dreiding

compute   hb all pair hbond/dreiding/lj
variable    C_hbond equal c_hb[1] #number hbonds
variable    E_hbond equal c_hb[2] #hbond energy
thermo_style    custom etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong v_E_hbond v_C_hbond press vol
thermo_modify   line multi format float %14.6f

fix      1      all nve

thermo 10

run 100
"
"Generate a LAMMPS input script for a NPT simulation of an full system using lj/charmm/coul/long 8.0 10.0 10.0 pair style with a timestep of 2.0 running for 500 steps.","# Solvated 5-mer peptide
# Demonstrating temper/npt
units           real
atom_style      full

pair_style      lj/charmm/coul/long 8.0 10.0 10.0
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic
kspace_style    pppm 0.0001

read_data       data.peptide

neighbor        2.0 bin
neigh_modify    delay 5

timestep        2.0

thermo_style    custom step temp epair emol etotal press density
thermo          50

variable        temper_T world 275 280 285 290 295 300 305 310
variable        rep world 0 1 2 3 4 5 6 7
fix             myfix all npt temp ${temper_T} ${temper_T} 100.0 iso 1 1 1000
run             500
temper/npt      2000 100 ${temper_T} myfix 0 58728 1
fix             2 all shake 0.0001 10 100 b 4 6 8 10 12 14 18 a 31
group           peptide type <= 12
"
"Generate a LAMMPS input script for a NVE simulation of an molecular system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 running for 5000 steps.","# test of replicating system with periodic bonds in x

dimension       2
atom_style      molecular

read_data       data.bond.x.noloop

replicate       3 3 1
#replicate       3 3 1 bond/periodic

mass            1 1.0
velocity        all create 0.001 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0

bond_style      harmonic
bond_coeff      1 50.0 1.0

special_bonds   fene

fix             1 all nve

write_data      tmp.data.x.non

dump		1 all image 100 tmp.image.x.non.*.ppm type type &
                adiam 0.2 bond type 0.1 zoom 1.6
dump_modify	1 pad 5

#dump		2 all movie 100 tmp.movie.x.non.mpg type type &
#                adiam 0.2 bond type 0.1 zoom 1.6
#dump_modify	2 pad 5

run             5000
"
"Generate a LAMMPS input script for a NVE simulation using zero 1 pair style with pair coefficients * * 1 and p p p boundary conditions with a timestep of 0.0001 running for 10000 steps.","# Test case / example for fix electron/stopping
# One fast atom, no other interactions.
# Stopping only applied in a smaller box in the middle.
#
# Also uses fix dt/reset, as one should when energies are high
# enough to require electronic stopping.

units metal
boundary p p p
timestep 0.0001

lattice fcc 1

region rbox block -100 100 -100 100 -100 100
region rsmallbox block -90 90 -90 90 -90 90

create_box 1 rbox

mass 1 28.0855

create_atoms 1 single 0 0 0
velocity all set 1120 1620 389

pair_style zero 1
pair_coeff * * 1

fix fdt all dt/reset 1 NULL 0.001 0.1 emax 20.0
fix fel all electron/stopping 1.0 Si.Si.elstop minneigh 0 region rsmallbox
fix fnve all nve

compute ek all ke/atom
compute ektot all reduce sum c_ek

thermo 100
thermo_style custom step time dt f_fel c_ektot

#dump mydump all custom 200 elstop.only.dump id x y z vx vy vz fx fy fz c_ek

run 10000
"
"Generate a LAMMPS input script for a NVE simulation using mliap model nn Cu.nn.mliap.model descriptor sna Cu.snap.mliap.descriptor pair style with pair coefficients * * Cu and p p p boundary conditions with a timestep of 0.5e-3 running for ${nsteps} steps.","# Demonstrate MLIAP interface to SNAP nn Cu potential

# Initialize simulation

variable nsteps index 100
variable nrep equal 4
variable a equal 3.621262
units           metal

# generate the box and atom positions using a FCC lattice

variable nx equal ${nrep}
variable ny equal ${nrep}
variable nz equal ${nrep}

boundary        p p p

lattice         fcc $a
region          box block 0 ${nx} 0 ${ny} 0 ${nz}
create_box      1 box
create_atoms    1 box

mass 1 63.546

# choose potential

pair_style mliap model nn Cu.nn.mliap.model descriptor sna Cu.snap.mliap.descriptor
pair_coeff * * Cu

# Setup output

compute  eatom all pe/atom
compute  energy all reduce sum c_eatom

compute  satom all stress/atom NULL
compute  str all reduce sum c_satom[1] c_satom[2] c_satom[3]
variable press equal (c_str[1]+c_str[2]+c_str[3])/(3*vol)

thermo_style    custom step temp epair c_energy etotal press v_press
thermo          10
thermo_modify norm yes

# Set up NVE run

timestep 0.5e-3
neighbor 1.0 bin
neigh_modify once no every 1 delay 0 check yes

# Run MD

velocity all create 300.0 4928459 loop geom
fix 1 all nve
run             ${nsteps}
"
"Generate a LAMMPS input script for a general simulation of an smd system using hybrid/overlay smd/tlsph smd/hertz 1.0 # activate Total-Lagrangian SPH pair style with pair coefficients 1 1 smd/tlsph *COMMON ${rho} ${E} ${nu} ${q1} ${q2} ${hg} ${cp} & and sm sm sm # simulation box boundaries boundary conditions running for 5000 steps.","
####################################################################################################
#
# TLSPH example: Two rubber rings impact each other.
#
# unit system: GPa / mm / ms
#
####################################################################################################

####################################################################################################
# MATERIAL PARAMETERS
####################################################################################################
variable        rho equal 1 # initial mass density
variable        E equal 1.0 # Young's modulus
variable        nu equal 0.3 # Poisson ratio
variable        sigma_yield equal 0.051 # plastic yield stress
variable        contact_stiffness equal 0.2 # contact stress for contact force between rings
variable        q1 equal 0.06 # standard artificial viscosity linear coefficient
variable        q2 equal 0.0  # standard artificial viscosity quadratic coefficient
variable        hg equal 10.0 # hourglass control coefficient
variable        cp equal 1.0 # heat capacity of material -- not used here

####################################################################################################
# INITIALIZE LAMMPS
####################################################################################################
dimension       3
units           si
boundary        sm sm sm # simulation box boundaries
atom_style      smd
atom_modify     map array
comm_modify     vel yes
neigh_modify    every 10 delay 0 check yes # re-build neighbor list every 10 steps
newton          off

####################################################################################################
# READ GEOMETRY
####################################################################################################
read_data       washer_hex_adjusted.data # read geometry of one rubber ring from file
replicate       2 1 1
region          right block 12.2 EDGE EDGE EDGE EDGE EDGE units box
group           right region right
group           left subtract all right
set             group left type 1
set             group right type 2
group           tlsph union left right

####################################################################################################
# DISCRETIZATION PARAMETERS
####################################################################################################
variable        l0 equal 0.3 # we need to set a length scale for the neighbor list skin
variable        skin equal 4.0*${l0} # Verlet list range
neighbor        ${skin} bin
set             group all smd/contact/radius 1.0


####################################################################################################
# DEFINE INITIAL VELOCITY BOUNDARY CONDITIONS
####################################################################################################
variable        vel equal 100.0 # initial velocity
velocity        left set  ${vel} 0 0 sum no units box
velocity        right set -${vel} 0 0 sum no units box

####################################################################################################
# INTERACTION PHYSICS / MATERIAL MODEL
# One rubber ring is linear elastic, the other rubber ring is elastic-ideal plastic.
# Contact forces between both rubber rings are used to realize physical contact.
####################################################################################################
pair_style      hybrid/overlay smd/tlsph smd/hertz 1.0 # activate Total-Lagrangian SPH
pair_coeff      1 1 smd/tlsph *COMMON ${rho} ${E} ${nu} ${q1} ${q2} ${hg} ${cp} &
                *STRENGTH_LINEAR &
                *EOS_LINEAR &
                *END
pair_coeff      2 2 smd/tlsph *COMMON ${rho} ${E} ${nu} ${q1} ${q2} ${hg} ${cp} &
                *STRENGTH_LINEAR_PLASTIC ${sigma_yield} 0.0 &
                *EOS_LINEAR &
                *END
pair_coeff      1 1 smd/hertz ${contact_stiffness}
pair_coeff      2 2 smd/hertz ${contact_stiffness}
pair_coeff      1 2 smd/hertz ${contact_stiffness}

####################################################################################################
# TIME INTEGRATION
####################################################################################################
fix             dtfix tlsph smd/adjust_dt 0.1 # dynamically adjust time increment every step
fix             integration_fix tlsph smd/integrate_tlsph

####################################################################################################
# SPECIFY TRAJECTORY OUTPUT
####################################################################################################
variable        dumpFreq equal 30
compute         S all smd/tlsph/stress # Cauchy stress tensor
compute         nn all smd/tlsph/num/neighs # number of neighbors for each particle
compute         cr all smd/contact/radius
compute         p all smd/plastic/strain
compute         eint all smd/internal/energy
compute         alleint all reduce sum c_eint
variable        etot equal c_alleint+ke+pe

dump            dump_id all custom ${dumpFreq} dump.LAMMPS id type x y z vx vy vz &
                c_S[1] c_S[2] c_S[3] c_S[4] c_S[5] c_S[6] c_S[7] c_nn c_cr proc c_p radius
dump_modify     dump_id first yes

####################################################################################################
# STATUS OUTPUT
####################################################################################################
thermo          100
thermo_style    custom step dt f_dtfix ke pe c_alleint v_etot

####################################################################################################
# PERFORM INITIAL LOAD BALANCING AND RUN SIMULATION
####################################################################################################
run             5000
"
"Generate a LAMMPS input script for a NVE simulation of an electron system using eff/cut 16.207559818252903 limit/eradius pressure/evirials pair style with pair coefficients * * and p p p boundary conditions with a timestep of 0.001 running for 10 steps.","variable        sname index h2bulk.ang

units 		real
newton		on
boundary	p p p

atom_style	electron

read_data  	data.${sname}

pair_style      eff/cut 16.207559818252903 limit/eradius pressure/evirials
pair_coeff	* * 

neigh_modify    one 10000 page 100000

comm_modify	vel yes

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        ecoul equal c_energies[3]
variable        erres equal c_energies[4]

thermo          10
thermo_style    custom step etotal pe ke v_eke v_epauli v_ecoul v_erres press v_press temp
thermo_modify   temp effTemp press effPress flush yes

# structure minimization
min_style	cg
minimize 	0 1.0e-4 10 10

timestep	0.001

velocity	all create 20000.0 4928459 rot yes mom yes dist gaussian

# nve
fix		1 all nve/eff
#fix             2 all imd 8888 trate 1 unwrap on nowait on

compute		peatom all pe/atom
compute		keatom all ke/atom/eff

dump		2 all xyz 1000 ${sname}.nve.xyz
compute         1 all property/atom spin eradius
dump		3 all custom 1000 ${sname}.nve.lammpstrj id type x y z c_1[1] c_1[2] c_peatom c_keatom

run		10

unfix		1
#unfix		2
undump		2
undump		3
"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using granular pair style with pair coefficients * * hertz/material 1e6 0.8 0.4 tangential mindlin  NULL 0.0 0.5 damping coeff_restitution and p p f boundary conditions with a timestep of 1e-9 running for _style 	    verlet steps.","units	        si
atom_style	    sphere

boundary    	p p f
region		    box block 0 80e-3 0 40e-3 0 80e-3 open 3 open 4
create_box	    2 box

read_data	    data.particles add append
group 		    mb type 1

pair_style granular
pair_coeff * * hertz/material 1e6 0.8 0.4 tangential mindlin  NULL 0.0 0.5 damping coeff_restitution
# pair_coeff * * hooke 1e6 0.5 tangential mindlin  1 1.0 0.0 damping coeff_restitution
comm_modify     vel yes

timestep 	    1e-9
fix		        1 all nve/sphere
compute		    s all stress/atom NULL pair

#dump		    1 all custom 2000000 op.dump id x y z vx vy vz
#dump_modify     1 pad 8
thermo_style	custom step ke
run_style 	    verlet
run		        10000000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style and f p p boundary conditions with a timestep of 5.0 running for 400 steps.","#AtC Two temperature Coupling
# DESCRIPTION:
# full overlap of MD and FE regions w/ free ends & lateral periodic bcs
# initial gaussian electron temperature profile and uniform phonon temperature 
# results in fast exchange followed by slower diffusion and finally relaxation
# to equilibrium
#
echo both
units    real
atom_style  atomic

# create domain
#lattice  type reduced density rho* = 4*(sigma/a)^3, 
#   where N = 4 for fcc, 
#         s = 3.405 A (Wagner) 
#         a = 5.25 A (Ashcroft & Mermin, p. 70)
# to create restart :
# write_restart temp.bin
# then : restart2data temp.bin temp.init
#if {restart} 
boundary        f p p
pair_style      lj/cut 13.5
read_data       temp.init
#endif

lattice         fcc 5.405 origin 0.25 0.25 0.25
region     feRegion   block -10 10 -3 3 -3 3
region     mdRegion   block -12 12 -3 3 -3 3
region     mdInternal block -10 10 -3 3 -3 3


# create atoms, NOTE commented out for restart
#if !{restart}
#boundary  f p p
#create_box  1 mdRegion
#create_atoms  1 region mdRegion
#mass    1 39.95
#pair_style  lj/cut 13.5
#pair_coeff    1 1 .238 3.405 13.5
#velocity  internal create 40 87287 mom yes loop geom
#endif

# specify interal/ghost atoms
group    internal region mdInternal
# do not define ghosts if outside fe region
#group    ghost subtract all internal

neighbor  5. bin
neigh_modify  every 10 delay 0 check no

#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc two_temperature  Ar_ttm.mat

#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 10 1  1  feRegion f p p

# fix a temperature
fix_modify AtC  fix temperature          all 20.0
fix_modify AtC  initial temperature      all 20.0
fix_modify AtC  initial electron_temperature all gaussian 0 0 0 1 0 0 5 20 20
fix_modify AtC  fix electron_temperature     all gaussian 0 0 0 1 0 0 5 20 20


# turn on thermostat
fix_modify AtC extrinsic exchange off
fix_modify AtC  control thermal rescale 10

# equilibrate MD field
timestep  5.0
#timestep  0.1
thermo    10
#if !{restart}
#run     1000
#endif

# write restart file (for atoms)
#if !{restart}
#write_restart  gaussianT0.dat
#endif

#output
fix_modify      AtC  output        gaussianIC_ttmFE 10 text

# change thermostat
fix_modify AtC  unfix          temperature all
fix_modify AtC  unfix electron_temperature all
fix_modify AtC  control thermal flux
fix_modify AtC extrinsic exchange on
fix_modify AtC extrinsic electron_integration explicit 10

# run with FE
thermo_style custom step temp pe f_AtC[2] f_AtC[4]
reset_timestep 0
run     400
"
"Generate a LAMMPS input script for a general simulation of an smd system using smd/tlsph pair style with pair coefficients 1 1 *COMMON ${rho} ${E} ${nu} ${q1} ${q2} ${hg} ${cp} & and sm sm p # simulation box boundaries boundary conditions running for 2500 steps.","####################################################################################################
#
# TLSPH example:  elongate a 2d strip of a linear elastic material py pulling its ends apart
#
# unit system: GPa / mm / ms
#
####################################################################################################

####################################################################################################
# MATERIAL PARAMETERS
####################################################################################################
variable        E equal 1.0 # Young's modulus
variable        nu equal 0.3 # Poisson ratio
variable        rho equal 1 # initial mass density
variable        q1 equal 0.06 # standard artificial viscosity linear coefficient
variable        q2 equal 0.0  # standard artificial viscosity quadratic coefficient
variable        hg equal 10.0 # hourglass control coefficient
variable        cp equal 1.0 # heat capacity of material -- not used here

####################################################################################################
# INITIALIZE LAMMPS
####################################################################################################
dimension       2
units           si
boundary        sm sm p # simulation box boundaries
atom_style      smd
atom_modify     map array
comm_modify     vel yes
neigh_modify    every 10 delay 0 check yes # re-build neighbor list every 10 steps
newton          off

####################################################################################################
# CREATE INITIAL GEOMETRY
####################################################################################################
variable        l0 equal 1.0 # lattice spacing for creating particles
lattice         sq ${l0}
region          box block -10 10 -10 10 -0.1 0.1 units box
create_box      1 box
create_atoms    1 box
group           tlsph type 1


####################################################################################################
# DISCRETIZATION PARAMETERS
####################################################################################################
variable        h equal 2.01*${l0} # SPH smoothing kernel radius
variable        vol_one equal ${l0}^2 # volume of one particle -- assuming unit thickness
variable        skin equal ${h} # Verlet list range
neighbor        ${skin} bin
set             group all volume ${vol_one}
set             group all smd/mass/density ${rho}
set             group all diameter ${h} # set SPH kernel radius

####################################################################################################
# DEFINE VELOCITY BOUNDARY CONDITIONS
####################################################################################################
variable        vel0 equal 0.005 # pull velocity
region          top block EDGE EDGE 9.0 EDGE EDGE EDGE units box
region          bot block EDGE EDGE EDGE -9.1 EDGE EDGE units box
group           top region top
group           bot region bot
variable        vel_up equal ${vel0}*(1.0-exp(-0.01*time))
variable        vel_down equal -v_vel_up
fix             veltop_fix top smd/setvel 0 v_vel_up 0
fix             velbot_fix bot smd/setvel 0 v_vel_down 0

####################################################################################################
# INTERACTION PHYSICS / MATERIAL MODEL
####################################################################################################
pair_style      smd/tlsph
pair_coeff      1 1 *COMMON ${rho} ${E} ${nu} ${q1} ${q2} ${hg} ${cp} &
                *STRENGTH_LINEAR &
                *EOS_LINEAR &
                *END

####################################################################################################
# TIME INTEGRATION
####################################################################################################
fix             dtfix tlsph smd/adjust_dt 0.1 # dynamically adjust time increment every step
fix             integration_fix tlsph smd/integrate_tlsph

####################################################################################################
# SPECIFY TRAJECTORY OUTPUT
####################################################################################################
compute         S all smd/tlsph/stress # Cauchy stress tensor
compute         E all smd/tlsph/strain # Green-Lagrange strain tensor
compute         nn all smd/tlsph/num/neighs # number of neighbors for each particle
dump            dump_id all custom 10 dump.LAMMPS id type x y z vx vy vz &
                c_S[1] c_S[2] c_S[4] c_nn &
                c_E[1] c_E[2] c_E[4] &
                vx vy vz
dump_modify     dump_id first yes

####################################################################################################
# STATUS OUTPUT
####################################################################################################
variable        stress equal 0.5*(f_velbot_fix[2]-f_veltop_fix[2])/20 # stress = force / initial width
variable        length equal xcm(top,y)-xcm(bot,y)
variable        strain equal (v_length-${length})/${length} # engineering strain
fix             stress_curve all print 10 ""${strain} ${stress}"" file stress_strain.dat screen no

thermo          100
thermo_style    custom step dt f_dtfix v_strain

####################################################################################################
# RUN SIMULATION
####################################################################################################
run             2500
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using eam pair style with pair coefficients * * Ni_u3.eam with a timestep of 0.001 running for 1000 steps at temperature 750.","
units           metal
atom_style      atomic
read_data       data.sigma5

pair_style      eam
pair_coeff      * * Ni_u3.eam
timestep        0.001

fix integrator  all npt temp 750 750 0.1 iso 0 0 0.1
fix eco         all orient/eco 0.08 0.25 3.6 sigma5.ori

thermo          100
thermo_style    custom step temp etotal press vol f_eco
velocity        all create 750 18527782

#dump            save all custom 100 orient_eco.dump xs ys zs f_eco[1] f_eco[2]
#dump_modify     save sort id

run             1000
"
"Generate a LAMMPS input script for a general simulation of an full system.","# Series of single-point calcs of 2,3,4 UO2 molecules
# with LATTE in MDI plugin mode

variable        files index 2uo2 3uo2 4uo2

label LOOP

  units           metal
  atom_style      full

  read_data       data.${files}

  neighbor        0.3 bin
  neigh_modify    every 1 delay 0 check yes

  fix             1 all mdi/qm virial yes elements U O
  fix_modify      1 energy yes
  
  thermo_style    custom step temp pe etotal press
  thermo          1

  mdi             plugin latte_mdi mdi ""-role ENGINE -name LATTE -method LINK"" &
                  extra latte.in.uo2 command ""run 0""

  #write_dump      all custom dump.series.plugin.${files} &
  #                id type x y z fx fy fz modify sort id

  clear

next            files

jump            SELF LOOP
"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using gran/hertz/history & pair style with pair coefficients * * and p p f boundary conditions with a timestep of ${dt} running for 200000 steps.","variable	name string mixer

thermo_modify	flush yes
variable	seed equal 14314

###############################################
# Particle parameters
################################################

variable	rlo equal 0.3
variable	rhi equal 0.6
variable	dlo equal 2.0*${rlo}
variable	dhi equal 2.0*${rhi}
variable 	skin equal ${rhi}

variable	coeffRes equal 0.1
variable	coeffFric equal 0.5

variable	kn equal 10^5
variable	kt equal 0.2*${kn}

variable	gravity equal 1.0
variable	density equal 1.0

variable	min_mass equal ${density}*4.0/3.0*PI*${rlo}*${rlo}*${rlo}
variable	a equal (-2.0*log(${coeffRes})/PI)^2
variable        gamma_n equal sqrt($a*2*${kn}/${min_mass}/(1+0.25*$a))
variable        gamma_t equal ${gamma_n}*0.5

variable	tcol equal PI/sqrt(2*${kn}/${min_mass}-${gamma_n}/4.0)

variable	dt equal ${tcol}*0.02
timestep	${dt}

###############################################

variable	dumpfreq equal 1000
variable	logfreq equal 1000

newton 		on
atom_style	sphere

boundary	p p f

region		boxreg block 0 20 0 20 0 20
create_box	1 boxreg

pair_style	gran/hertz/history &
		${kn} ${kt} ${gamma_n} ${gamma_t} ${coeffFric} 1
pair_coeff	* *

neighbor        ${skin} multi
thermo 		${logfreq}

comm_style	brick
comm_modify 	mode multi group all vel yes
balance		1.1 shift xyz 20 1.1
fix		bal all balance 10000 1.1 shift xyz 20 1.01

####################### Options specific to pouring #########################

region	     	insreg cylinder z 10 10 8 10 18 side in units box
region	    	cylreg cylinder z 10 10 10 0 20 side in units box

variable	theta equal (step/400000)*2*PI
		
region          b1 block 2 18 9 11 0 4 side out &
                rotate v_theta 10 10 0 0 0 1 units box
region          b2 block 9 11 2 18 0 3.99999 side out &
                rotate v_theta 10 10 0 0 0 1 units box

region		mixer intersect 3 cylreg b1 b2 side in		

fix		grav all gravity ${gravity} vector 0 0 -1
fix		1 all nve/sphere

fix		mixwall all wall/gran/region hertz/history &
                ${kn} ${kt} ${gamma_n} ${gamma_t} ${coeffFric} 1 region mixer

fix		ins all pour 1000 1 42424 region insreg &
		diam range ${dlo} ${dhi} dens ${density} ${density}

#dump		1 all custom ${dumpfreq} ${name}_pour.dump &
#		id type mass diameter x y z

#dump		2 all image 4000 image.*.jpg type type &
#		axes yes 0.8 0.02 view 60 -30 zoom 1.5 &
#                box no 0.0 axes no 0.0 0.0
#dump_modify	2 pad 6

thermo_style	custom step cpu atoms ke v_theta
thermo_modify	flush yes lost warn

run		200000 
unfix 		ins
run		200000
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 1000 steps at temperature 0.65.","# compute stress/cylinder for a cylindrical liquid-vapor interface

units           lj
atom_style      atomic

lattice         fcc 0.8442
region          box block -10 10 -10 10 0 10
region    liquid cylinder z 0 0 5 0 10
create_box      1 box
create_atoms    1 region liquid
mass            1 1.0

velocity        all create 0.65 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    every 20 delay 0 check no

fix             1 all nvt temp 0.65 0.65 0.2

#dump           id all atom 50 dump.cylinder

#dump           2 all image 25 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 25 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

fix 2 all recenter 0 0 NULL units lattice
compute p all stress/cylinder 0 10 15 0.25
fix 3 all ave/time 100 1 100 c_p[*] file cylinder.out mode vector

thermo          50
thermo_style custom step temp epair emol etotal press c_p[15][3] c_p[15][4] c_p[15][5]

run             1000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style and f p p boundary conditions with a timestep of 5.0 running for 4000 steps.","# in this example the electron temperature on the left is ramped up in time 
# and held fixed on the right. the phonon temperature is free on the left 
# and fixed and consistent with the electron temperature on the right. 
# this mimics some simplified pumped system
# also a volume source is added to mimic Joule heating
#echo both
# units
units		real
atom_style	atomic
# create domain
#lattice	type reduced density rho* = 4*(sigma/a)^3, 
#   where N = 4 for fcc, 
#         s = 3.405 A (Wagner) 
#         a = 5.25 A (Ashcroft & Mermin, p. 70)
#if {restart}
boundary        f p p
pair_style      lj/cut 13.5
read_data       temp.init
#endif
lattice         fcc 5.405 origin 0.25 0.25 0.25
region feRegion   block -14 14 -3 3 -3 3
region mdRegion   block -12 12 -3 3 -3 3
region mdInternal block -10 10 -3 3 -3 3
# NOTE: don't define ghosts if they are outside the feRegion
group		internal region mdInternal
group		ghost subtract all internal
# create atoms
#if !{restart}
#boundary	f p p
#create_box	1 mdRegion
#create_atoms	1 region mdRegion
#mass		1 39.95
#pair_style	lj/cut 13.5
#pair_coeff  	1 1 .238 3.405 13.5
#velocity  internal create 40 87287 mom yes loop geom
#endif
# timestep & neighboring
timestep	5.0
thermo		10
neighbor	5. bin
neigh_modify	every 10 delay 0 check no
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal atc two_temperature  Ar_ttm.mat
fix_modify      AtC boundary ghost
#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 14 1  1  feRegion f p p
# fix initial temperatures
#if !{restart}
#velocity	internal create 40 87287 mom yes loop geom
#endif
fix_modify AtC  initial temperature      all 20
fix_modify AtC  fix temperature          all 20
fix_modify AtC  initial electron_temperature all 20
fix_modify AtC  fix electron_temperature     all 20
# equilibrate MD field with rescale
fix_modify AtC extrinsic exchange off
fix_modify	AtC  control thermal rescale 10
#if !{restart}
#run 		1000
#endif
# change thermostat 
fix_modify AtC extrinsic exchange on
fix_modify	AtC  unfix          temperature all
fix_modify	AtC  unfix electron_temperature all
# note does not handle ""inf""s
#fix_modify  AtC mesh create_faceset bndy -8 8 inf inf inf inf
fix_modify  AtC mesh create_faceset bndy box -10 10 -10 10 -10 10
fix_modify  AtC  control thermal flux faceset bndy 
# .. this controls the time filtering ....
#fix_modify	AtC  filter scale 500.0
# add nodesets & boundary temperature controls
#               ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
# NOTE create_nodeset doesn't handle ""inf""
fix_modify      AtC mesh create_nodeset lbc -14.1 -13.9  -INF INF -INF INF
fix_modify      AtC mesh create_nodeset rbc  13.9  14.1  -INF INF -INF INF
fix_modify      AtC  fix electron_temperature lbc 40.
fix_modify      AtC  fix electron_temperature rbc 20.
fix_modify      AtC  fix          temperature rbc 20. 
#fix_modify      AtC  source electron_temperature all 0.0015
fix_modify      AtC  source electron_temperature all 9.50445e-11
# output                                   filename frequency [text output]
fix_modify      AtC  output        bar1d_ttmFE 100 text
# run transient to steady state
thermo		10
reset_timestep 0
run 		4000
"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using granular pair style with pair coefficients * * hertz/material 1e5 0.2 0.3 tangential mindlin NULL 1.0 0.5 damping tsuji heat area 5.0 with a timestep of 0.001 running for 100000 steps.","# pour one types of particles into cylinder and oscillate
# temperature of the bottom plate

variable        name string heat_plate

atom_style      sphere
units           lj

###############################################
# Geometry-related parameters
###############################################

variable        boxx equal 10
variable        boxy equal 10
variable        boxz equal 50

variable        drum_rad equal ${boxx}*0.5
variable        drum_height equal 30

variable        xc equal 0.5*${boxx}
variable        yc equal 0.5*${boxx}
variable        zc equal 0.5*${boxz}

###############################################
# Particle-related parameters
###############################################
variable        rlo equal 0.25
variable        rhi equal 0.5
variable        dlo equal 2.0*${rlo}
variable        dhi equal 2.0*${rhi}

variable        cyl_rad_inner equal ${drum_rad}-1.1*${rhi}

variable        dens equal 1.0

variable skin equal 0.4*${rhi}

#############
processors * * 1
region          boxreg block 0 ${boxx} 0 ${boxy} 0 ${boxz}
create_box      2 boxreg
change_box      all boundary p p f

pair_style      granular
pair_coeff      * * hertz/material 1e5 0.2 0.3 tangential mindlin NULL 1.0 0.5 damping tsuji heat area 5.0

region          curved_wall cylinder z ${xc} ${yc} ${drum_rad} 0 ${drum_height} side in
region          bottom_wall plane ${xc} ${yc} 0 0 0 1 side in

region          insreg cylinder z ${xc} ${yc} ${cyl_rad_inner} ${drum_height} ${boxz}

fix             0 all property/atom temperature heatflow
fix             1 all balance 100 1.0 shift xy 5 1.1
fix             2 all nve/sphere
fix             3 all heat/flow constant 1.0
fix             grav all gravity 10 vector 0 0 -1
fix             ins1 all pour 1000 1 1234 region insreg diam range ${dlo} ${dhi} dens ${dens} ${dens}
fix             ins2 all pour 1000 2 1234 region insreg diam range ${dlo} ${dhi} dens ${dens} ${dens}

comm_modify     vel yes

neighbor        ${skin} bin
neigh_modify    delay 0 every 1 check yes

variable        oscillate equal 1.0*sin(step*0.0001)

fix             4 all wall/gran/region granular hertz/material 1e5 0.1 0.3 tangential mindlin NULL 1.0 0.5 damping tsuji region curved_wall
fix             5 all wall/gran/region granular hertz/material 1e5 0.1 0.3 tangential mindlin NULL 1.0 0.5 damping tsuji heat area 5.0 region bottom_wall temperature v_oscillate

thermo_style    custom step atoms ke pxx pyy pzz
thermo_modify   lost warn
thermo          100

timestep        0.001

compute        1 all property/atom temperature heatflow
#dump           1 all custom 1000 ${name}.dump id type radius mass x y z c_1[*]

run             100000

"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/class2/coul/long 8.5 pair style and p p p boundary conditions running for 200 steps at temperature 800.","# 35,000 atom nylon melt example

units real

boundary p p p

atom_style full

kspace_style pppm 1.0e-4

pair_style lj/class2/coul/long 8.5

angle_style class2

bond_style class2

dihedral_style class2

improper_style class2

special_bonds lj/coul 0 0 1
pair_modify tail yes mix sixthpower

read_data large_nylon_melt.data.gz &
  extra/bond/per/atom 5  &
  extra/angle/per/atom 15 &
  extra/dihedral/per/atom 15 &
  extra/improper/per/atom 25 &
  extra/special/per/atom 25

velocity all create 800.0 4928459 dist gaussian

molecule mol1 rxn1_stp1_unreacted.molecule_template
molecule mol2 rxn1_stp1_reacted.molecule_template
molecule mol3 rxn1_stp2_unreacted.molecule_template
molecule mol4 rxn1_stp2_reacted.molecule_template

thermo 50

# dump 1 all xyz 100 test_vis.xyz
# dump_modify 1 types labels

fix myrxns all bond/react stabilization yes statted_grp .03 &
  react rxn1 all 1 0.0 2.9 mol1 mol2 rxn1_stp1_map &
  react rxn2 all 1 0.0 5.0 mol3 mol4 rxn1_stp2_map

# stable at 800K
fix 1 statted_grp_REACT nvt temp 800 800 100

# in order to customize behavior of reacting atoms,
# you can use the internally created 'bond_react_MASTER_group', like so:
# fix 2 bond_react_MASTER_group temp/rescale 1 800 800 10 1

thermo_style custom step temp press density f_myrxns[*] # cumulative reaction counts

# restart 100 restart1 restart2

run 200

# write_restart restart_longrun
# write_data restart_longrun.data
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using tersoff pair style with pair coefficients * * Si.tersoff Si Si Si Si Si Si Si Si and p p p boundary conditions with a timestep of 1.0e-3 running for 100 steps.","# Simple regression tests for Tersoff potentials

# NOTE: These are not intended to represent real materials

units           metal

atom_style      atomic
atom_modify     map array
boundary        p p p
atom_modify     sort 0 0.0

# temperature

variable t equal 1800.0

# cubic diamond unit cell

variable a equal 5.431
lattice         custom $a               &
                a1 1.0 0.0 0.0          &
                a2 0.0 1.0 0.0          &
                a3 0.0 0.0 1.0          &
                basis 0.0 0.0 0.0       &
                basis 0.0 0.5 0.5       &
                basis 0.5 0.0 0.5       &
                basis 0.5 0.5 0.0       &
                basis 0.25 0.25 0.25    &
                basis 0.25 0.75 0.75    &
                basis 0.75 0.25 0.75    &
                basis 0.75 0.75 0.25

region          myreg block     0 4 &
                                0 4 &
                                0 4

create_box      8 myreg
create_atoms    1 region myreg &
                basis 1 1  &
                basis 2 2  &
                basis 3 3  &
                basis 4 4  &
                basis 5 5  &
                basis 6 6  &
                basis 7 7  &
                basis 8 8

mass            *       28.06

velocity        all create $t 5287287 loop geom

# Equilibrate using Tersoff model for silicon

pair_style      tersoff
pair_coeff      * * Si.tersoff Si Si Si Si Si Si Si Si

thermo_style    custom step temp epair etotal econserve press
thermo          10
fix             1 all nvt temp $t $t 0.1
timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes
run             100

write_restart   restart.equil

# Test Tersoff/Mod model for Si

clear
read_restart    restart.equil

pair_style      tersoff/mod
pair_coeff      * * Si.tersoff.mod Si Si Si Si Si Si Si Si

thermo_style    custom step temp epair etotal econserve press
thermo          10
fix             1 all nvt temp $t $t 0.1
timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes
run             100

# Test Tersoff/Mod/C model for Si

clear
read_restart    restart.equil
newton on on
pair_style      tersoff/mod/c
pair_coeff      * * Si.tersoff.modc Si Si Si Si Si Si Si Si

thermo_style    custom step temp epair etotal econserve press
thermo          10
fix             1 all nvt temp $t $t 0.1
timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes
run             100

# Test Tersoff model for B/N/C 

clear
read_restart    restart.equil

variable        fac equal 0.6
change_box      all x scale ${fac} y scale ${fac} z scale ${fac} remap

pair_style      tersoff
pair_coeff      * * BNC.tersoff N N N C B B C B

thermo_style    custom step temp epair etotal econserve press
thermo          10
fix             1 all nvt temp $t $t 0.1
timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes
run             100

# Test Tersoff model for B/N/C 

clear
read_restart    restart.equil

variable        fac equal 0.6
change_box      all x scale ${fac} y scale ${fac} z scale ${fac} remap

pair_style      tersoff shift 0.05
pair_coeff      * * BNC.tersoff N N N C B B C B

thermo_style    custom step temp epair etotal econserve press
thermo          10
fix             1 all nvt temp $t $t 0.1
timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes
run             100

shell rm restart.equil
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 13.5 pair style and f p p boundary conditions with a timestep of 5 running for 400 steps.","#AtC Thermal Coupling
# This benchmark tests heat conducting into and out of the MD region.  The
# temperature is initially 20 everywhere and the left boundary BC is fixed at
# 40.# The result should show heat diffusing through the FEM to the MD and back
# out # to the FEM on the right.  Insufficient time is captured to reach the
# linear # steady state, but heat crossing both boundaries should be observed.
units           real
atom_style      atomic
# create domain
#lattice        type reduced density rho* = 4*(sigma/a)^3, where N=4 for fcc, s = 3.405 A (Wagner) and a = 5.25 A (Ashcroft & Mermin, p. 70)
# NOTE following 3 lines added for restart
boundary        f p p
pair_style      lj/cut 13.5
read_data       temp.init
lattice         fcc 5.405 origin 0.25 0.25 0.25
region          simRegion block -12 12 -3 3 -3 3
# create atoms, NOTE commented out for restart
#region         mdRegion block -5 5 -3 3 -3 3
#boundary       f p p
#create_box     1 mdRegion
#create_atoms   1 region mdRegion
#mass           1 39.95
# specify interal/ghost atoms
region          mdInternal block -4 4 -3 3 -3 3
group           internal region mdInternal
group           ghost subtract all internal
# velocities have Vcm = 0, NOTE next four lines commented out for restart
#velocity       internal create 40. 87287 mom yes loop geom
#pair_style     lj/cut 13.5
##pair_coeff    1 1 0.010323166 3.405 13.5
#pair_coeff     1 1 .238 3.405 13.5
neighbor        5. bin
neigh_modify    every 10 delay 0 check no
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc thermal     Ar_thermal.mat
#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 4 1  1  mdInternal f p p
fix_modify      AtC  time_integration fractional_step
fix_modify  AtC  internal_atom_integrate off
fix iNVE internal nve
fix_modify      AtC  internal_quadrature off
# fix a temperature
fix_modify      AtC  fix temperature all 20.
# add nodesets
#               ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
fix_modify      AtC mesh create_nodeset lbc -4.1  -3.9   -INF INF   -INF INF
fix_modify      AtC mesh create_nodeset rbc  3.9   4.1   -INF INF   -INF INF
fix_modify      AtC  fix temperature lbc 40.
fix_modify      AtC  fix temperature rbc 20.
# turn on thermostat
fix_modify      AtC  control thermal rescale 10
# equilibrate MD field
#dump            D1 all atom 100 dump.bar1d
#fix_modify      AtC  output bar1dfe 100 text
timestep        5
variable xdof equal 3*count(ghost)
compute_modify thermo_temp extra/dof ${xdof}
thermo_style custom step cpu etotal pe f_AtC[1] temp f_AtC[2]
thermo_modify  format 1 %6i format 2 %7.2g
thermo          100
run             400
# change thermostat to hoover
fix_modify      AtC  unfix temperature all
fix_modify      AtC  fix temperature lbc 40.
fix_modify      AtC  fix temperature rbc 20.
fix_modify      AtC  control thermal flux no_boundary
fix_modify      AtC  control tolerance 1.e-9 # this is to remove looser benchmark tolerance because the lambda solution was reacting to numerical noise, but it results in a slight drift in the constraints
#fix_modify     AtC  thermal control none
fix_modify      AtC  control localized_lambda on
fix_modify      AtC  filter type exponential
fix_modify      AtC  filter scale 1000.0
fix_modify      AtC  filter on
# set up output, should be before a ""run""
fix_modify      AtC  output bar1d_frac_stepFE 200 text
# output command
#dump            D1 all atom 1000 dump.bar1d
# run with FE
reset_timestep 0
thermo          100
run             10000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 5.0 pair style with pair coefficients 1 1 1.0 1.0.","# 3d Lennard-Jones melt

variable	x index 1
variable	y index 1
variable	z index 1

variable	xx equal 20*$x
variable	yy equal 20*$y
variable	zz equal 20*$z

units		lj
atom_style	atomic

lattice		fcc 0.8442
region		box block 0 ${xx} 0 ${yy} 0 ${zz}
create_box	1 box
create_atoms	1 box
mass		1 1.0

pair_style	lj/cut 5.0
pair_coeff	1 1 1.0 1.0

neighbor	0.3 bin

compute         myRDF all rdf 100 cutoff 5.0
fix             2 all ave/time 100 10 1000 c_myRDF[*] file rdf.rerun mode vector

thermo          100

rerun           lj.dump dump x y z

"
"Generate a LAMMPS input script for a NPT simulation of an full system using hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.600 8.0 pair style with pair coefficients 1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H and p p p boundary conditions with a timestep of 0.5 running for 2000 steps.","units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.600 8.0
kspace_style pppm 1.0e-4

comm_modify vel yes
read_data data.ethanol

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H CTO
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    1    4 lj/cut/coul/long 0.105921 3.304542 # C3H OH
pair_coeff    1    5 lj/cut/coul/long 0.000000 0.000000 # C3H HO
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # CTO CTO
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # CTO H
pair_coeff    2    4 lj/cut/coul/long 0.105921 3.304542 # CTO OH
pair_coeff    2    5 lj/cut/coul/long 0.000000 0.000000 # CTO HO
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    3    4 lj/cut/coul/long 0.071413 2.792848 # H OH
pair_coeff    3    5 lj/cut/coul/long 0.000000 0.000000 # H HO
pair_coeff    4    4 lj/cut/coul/long 0.169996 3.120000 # OH OH
pair_coeff    4    5 lj/cut/coul/long 0.000000 0.000000 # OH HO
pair_coeff    5    5 lj/cut/coul/long 0.000000 0.000000 # HO HO
pair_coeff    *  6*8 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    1 thole 2.051000
pair_coeff    1    2 thole 1.580265
pair_coeff    1    4 thole 1.416087
pair_coeff    1    6 thole 2.051000
pair_coeff    1    7 thole 1.580265
pair_coeff    1    8 thole 1.416087
pair_coeff    2    2 thole 1.217570
pair_coeff    2    4 thole 1.091074
pair_coeff    2    6 thole 1.580265
pair_coeff    2    7 thole 1.217570
pair_coeff    2    8 thole 1.091074
pair_coeff    4    4 thole 0.977720
pair_coeff    4    6 thole 1.416087
pair_coeff    4    7 thole 1.091074
pair_coeff    4    8 thole 0.977720
pair_coeff    6    6 thole 2.051000
pair_coeff    6    7 thole 1.580265
pair_coeff    6    8 thole 1.416087
pair_coeff    7    7 thole 1.217570
pair_coeff    7    8 thole 1.091074
pair_coeff    8    8 thole 0.977720

group gETHANOL molecule 1:250
group gATOMS type 1 2 3 4 5
group gDRUDES type 6 7 8

neighbor 2.0 bin

variable vTEMP   equal 300.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gATOMS  create ${vTEMP} 12345
velocity gDRUDES create ${vTEMP_D} 12345

fix fDRUDE all drude C C N C N D D D

fix fSHAKE gATOMS shake 0.0001 20 0 b 2 3 5

fix fNPT all tgnpt/drude temp ${vTEMP} ${vTEMP} 100.0 ${vTEMP_D} 20.0 iso ${vPRESS} ${vPRESS} 1000

compute cTEMP all temp/drude

thermo_style custom step cpu etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2] f_fNPT[1] f_fNPT[2] f_fNPT[3]
thermo 20

timestep 0.5
run 2000
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff NULL pair style with pair coefficients * * ffield.reax C H and p p p boundary conditions with a timestep of ${delta_t} running for 1000 steps.","## This script first constructs a liquid methane structure of a given size. It then uses fix qtb to equilibrate the computational cell to the specified temperature and pressure.
variable                x_rep equal 2                                                                           #x-direction replication number
variable                y_rep equal 2                                                                           #y-direction replication number
variable                z_rep equal 2                                                                           #z-direction replication number
variable                temperature equal 110.0                                                                 #Target quantum temperature (K in real units)
variable                delta_t equal 0.25                                                                      #MD timestep length (fs in real units)
variable                damp_qtb equal 200                                                                      #1/gamma where gamma is the friction coefficient in quantum thermal bath (fs in real units)


## This part defines units, methane structure, and atomic information
#General
units                   real
dimension               3
boundary                p p p
atom_style              charge

#Lattice
lattice                 custom 1.0 &
                        a1      3.9783624 0 0 &
                        a2      0 3.9783624 0 &
                        a3      0 0 3.9783624 &
                        &
                        basis   0.5 0.5 0.5 & 
                        basis   0.663 0.663 0.663 &
                        basis   0.337 0.337 0.663 &
                        basis   0.663 0.337 0.337 &
                        basis   0.337 0.663 0.337

#Computational Cell
region                  simbox block 0 3.9783624 0 3.9783624 0 3.9783624 units box
create_box              2 simbox
create_atoms            1 box & 
                        basis   1 1 &
                        basis   2 2 &
                        basis   3 2 &
                        basis   4 2 &
                        basis   5 2
replicate               ${x_rep} ${y_rep} ${z_rep}

#Atomic Information
mass                    1 12.011150
mass                    2  1.007970


## This part defines the reax pair potential in methane, force field coefficients are specified in ""ffield.reax""
#Pair Potentials
pair_style              reaxff NULL
pair_coeff              * * ffield.reax C H
fix                     0 all qeq/reax 1 0.0 10.0 1.0e-6 reaxff

#Neighbor Style
neighbor                2.5 bin
neigh_modify            every 10 delay 0 check no


## This part equilibrates liquid methane to a temperature of ${temperature}(unit temperatureture) with quantum nuclear effects
#Initialization
velocity                all create ${temperature} 93 dist gaussian sum no mom yes rot yes loop all

#Setup output
thermo_style            custom step temp press etotal vol
thermo                  50

#Colored thermal bath
fix                     scapegoat_qtb all nve                                                                   #NVE does the time integration
fix                     methane_qtb all qtb temp ${temperature} damp ${damp_qtb} seed 35082 f_max 0.3 N_f 50    #Change f_max if your Debye frequency is higher 
timestep                ${delta_t}
run                     1000
unfix                   methane_qtb
unfix                   scapegoat_qtb
"
"Generate a LAMMPS input script for a general simulation using zero ${rcutfac} pair style with pair coefficients * * and p p p boundary conditions running for 0 steps.","# Demonstrate calculation of SNAP bispectrum
# descriptors on a grid for triclinic cell

# This triclinic cell has 6 times the volume of the single
# unit cell used by in.grid
# and contains 12 atoms.  It is a 3x2x1 supercell
# with each unit cell containing 2 atoms and the
# reduced lattice vectors are [1 0 0], [1 1 0], and [1 1 1].
# The grid is listed in x-fastest order

# CORRECTNESS: The atom positions coincide with certain
# gridpoints, so c_b[1][1-5] should match c_mygrid[1][4-8]
# and c_b[7][1-5] should match c_mygrid[13][4-8].
# Local arrays can not be access directly in the script,
# but they are printed out to file dump.blocal.tri

# Initialize simulation

variable     	nrep index 1
variable     	a index 3.316
variable     	ngrid index 2

variable     	nrepx equal 3*${nrep}
variable     	nrepy equal 2*${nrep}
variable     	nrepz equal 1*${nrep}

variable     	ngridx equal 3*${ngrid}
variable     	ngridy equal 2*${ngrid}
variable     	ngridz equal 1*${ngrid}

units	     	metal
atom_modify  	map hash sort 0 0

# generate the box and atom positions using a BCC lattice

variable     	nx equal ${nrepx}
variable     	ny equal ${nrepy}
variable     	nz equal ${nrepz}

boundary     	p p p

lattice		custom $a &
		a1 1 0 0 &
		a2 1 1 0  &
		a3 1 1 1 &
		basis 0 0 0 &
		basis 0.0 0.0 0.5 &
		spacing 1 1 1

box 		tilt large
region		box prism 0 ${nx} 0 ${ny} 0 ${nz} ${ny} ${nz} ${nz}
create_box	1 box
create_atoms	1 box

mass 		1 180.88

# define atom compute and grid compute

group 		snapgroup type 1
variable 	twojmax equal 2
variable 	rcutfac equal 4.67637
variable 	rfac0 equal 0.99363
variable 	rmin0 equal 0
variable 	wj equal 1
variable 	radelem equal 0.5
variable 	bzero equal 0
variable 	quadratic equal 0
variable 	switch equal 1

variable 	snap_options string &
		""${rcutfac} ${rfac0} ${twojmax} ${radelem} &
		${wj} rmin0 ${rmin0} quadraticflag ${quadratic} &
		bzeroflag ${bzero} switchflag ${switch}""

# build zero potential to satisfy compute sna/atom

pair_style      zero ${rcutfac}
pair_coeff      * *

# define atom and grid computes

compute       	b all sna/atom ${snap_options}
compute 	mygrid all sna/grid grid ${ngridx} ${ngridy} ${ngridz} &
	 	${snap_options}
compute 	mygridlocal all sna/grid/local grid ${ngridx} ${ngridy} ${ngridz} &
	 	${snap_options}

# define output

variable	B5atom equal C_b[7][5]
variable	B5grid equal c_mygrid[13][8]

# do not compare x,y,z because assignment of ids
# to atoms is not unnique for different processor grids

variable	rmse_global equal ""sqrt(    &
	 (c_mygrid[13][4] - C_b[7][1])^2 + &
	 (c_mygrid[13][5] - C_b[7][2])^2 + &
	 (c_mygrid[13][6] - C_b[7][3])^2 + &
	 (c_mygrid[13][7] - C_b[7][4])^2 + &
	 (c_mygrid[13][8] - C_b[7][5])^2   &
	 )""

thermo_style	custom step v_B5atom v_B5grid v_rmse_global

# this is the only way to view the local grid

dump 1 all local 1000 dump.blocal.tri c_mygridlocal[*]
dump 2 all custom 1000 dump.batom.tri id x y z c_b[*]

# run

run		0

"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/class2/coul/long 8.5 pair style and p p p boundary conditions running for ${steps} steps.","# two monomer nylon example
# reaction produces a condensed water molecule

units real

boundary p p p

atom_style full

kspace_style pppm 1.0e-4

pair_style lj/class2/coul/long 8.5

angle_style class2

bond_style class2

dihedral_style class2

improper_style class2

special_bonds lj/coul 0 0 1
pair_modify tail yes mix sixthpower

read_data tiny_nylon.data &
  extra/bond/per/atom 5  &
  extra/angle/per/atom 15 &
  extra/dihedral/per/atom 15 &
  extra/improper/per/atom 25 &
  extra/special/per/atom 25

variable runsteps equal 1000
variable prob1 equal step/v_runsteps*2+0.1
variable prob2 equal (step/v_runsteps)>0.5

velocity all create 300.0 4928459 dist gaussian

molecule mol1 rxn1_stp1_unreacted.molecule_template
molecule mol2 rxn1_stp1_reacted.molecule_template
molecule mol3 rxn1_stp2_unreacted.molecule_template
molecule mol4 rxn1_stp2_reacted.molecule_template

thermo 50

# dump 1 all xyz 1 test_vis.xyz
# dump_modify 1 types labels

fix myrxns all bond/react stabilization yes statted_grp .03 &
  react rxn1 all 1 0.0 5.0 mol1 mol2 rxn1_stp1_map prob v_prob1 1234 &
  react rxn2 all 1 0.0 5.0 mol3 mol4 rxn1_stp2_map prob v_prob2 1234

fix 1 statted_grp_REACT nvt temp 300 300 100

# optionally, you can customize behavior of reacting atoms,
# by using the internally-created 'bond_react_MASTER_group', like so:
fix 4 bond_react_MASTER_group temp/rescale 1 300 300 10 1

thermo_style custom step temp press density v_prob1 v_prob2 f_myrxns[*]

# restart 100 restart1 restart2

run ${runsteps}

# write_restart restart_longrun
# write_data restart_longrun.data
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using comb pair style with pair coefficients * * ffield.comb Si and p p p boundary conditions with a timestep of 0.00020 running for 10 steps.","# Pure Si crystal, structure created by LAMMPS, qeq off

units		metal
atom_style	charge
dimension       3
boundary        p p p

lattice  	diamond 5.43
region		box block 0 4 0 4 0 4
create_box	1 box
create_atoms	1 box
mass		1 29.0

pair_style	comb
pair_coeff	* * ffield.comb Si

neighbor	0.5 bin
neigh_modify	every 1 delay 1 check yes 

fix		1 all nve
timestep        0.00020

thermo_style	custom step temp etotal pe evdwl ecoul press vol lx ly lz xz
thermo_modify	norm yes
velocity	all create 10.1 2398378
thermo	  	1

#dump		1 all cfg 10 *.cfg id type xs ys zs q vx vy vz fx fy fz
#dump_modify	1 append yes element Si

#dump		2 all image 10 image.*.jpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	2 pad 2 element Si

#dump		3 all movie 10 movie.mpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	3 pad 2 element Si

run  		10
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using zero 1.0 pair style with pair coefficients * * with a timestep of 0.005 running for 20 steps.","# Point dipoles in a 2d box

units		lj
atom_style  charge	

read_data data.hammersley_sphere
change_box all boundary f f f 

velocity	all create 1.5 49893

neighbor	1.0 bin
neigh_modify	delay 0

fix             1 all nve

# LAMMPS computes pairwise and long-range Coulombics

#pair_style      coul/long 3.0
#pair_coeff      * *
#kspace_style    pppm 1.0e-3

# Scafacos computes entire long-range Coulombics
# use dummy pair style to perform atom sorting

pair_style	zero 1.0
pair_coeff	* * 

#fix		2 all scafacos p3m tolerance field 0.001

kspace_style    scafacos fmm 0.001
kspace_modify scafacos tolerance energy_rel
kspace_modify scafacos fmm_tuning 1

timestep	0.005
thermo          1

run		20
"
"Generate a LAMMPS input script for a NVE simulation of an dpd system using multi/lucy linear 74923 pair style with pair coefficients * * table.multibody KEYWORD 16.00 with a timestep of 0.01 running for 100 steps.","# RDX coarse-grain model

units           metal  # ev, ps
atom_style      dpd
atom_modify     map array

lattice         hcp 6.6520898 origin 0.0833333333333 0.25 0.25 orient z 1 0 0 orient x 0 1 0 orient y 0 0 1
variable        xrep equal 10.0
variable        yrep equal 10.0
variable        zrep equal 10.0
region          box block 0 ${xrep} 0 ${yrep} 0.0 ${zrep} units lattice
create_box      2 box
region          atoms block 0 ${xrep} 0 ${yrep} 0.0 ${zrep} units lattice
create_atoms    1 region atoms
variable        newx equal xhi*0.99998623082367843
variable        newy equal yhi*0.96972098958539854
change_box      all x final 0.0 ${newx} y final 0.0 ${newy} remap units box

comm_modify     vel yes
mass            * 222.12

timestep        0.01

pair_style      multi/lucy linear 74923
pair_coeff      * * table.multibody KEYWORD 16.00

fix		2 all nve

neighbor        0.0 bin 
neigh_modify    every 1 delay 0 check no once no 

variable        totEnergy equal pe+ke

thermo          1
thermo_style    custom step temp press vol pe ke v_totEnergy pxx pyy pzz lx ly lz
thermo_modify   format float %15.8f flush yes

velocity        all create 300.00 9198783 mom yes rot yes dist gaussian

run             100
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 10.0 1.0 2.5 and f f p boundary conditions running for 200 steps.","# 2d circle of particles inside a box with LJ walls

variable        b index 0

variable	x index 50
variable	y index 20
variable	d index 20
variable	v index 5
variable	w index 2
                
units		lj
dimension       2
atom_style	atomic
boundary        f f p

lattice		hex 0.85
region		box block 0 $x 0 $y -0.5 0.5
create_box	1 box
region		circle sphere $(v_d/2+1) $(v_d/2/sqrt(3.0)+1) 0.0 $(v_d/2)
create_atoms	1 region circle
mass		1 1.0

velocity	all create 0.5 87287 loop geom
velocity        all set $v $w 0 sum yes

pair_style	lj/cut 2.5
pair_coeff	1 1 10.0 1.0 2.5

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix		1 all nve

fix             2 all wall/lj93 xlo 0.0 1 1 2.5 xhi $x 1 1 2.5
fix             3 all wall/lj93 ylo 0.0 1 1 2.5 yhi $y 1 1 2.5

comm_style      tiled
fix             10 all balance 50 0.9 rcb

##  read_dump examples using native or adios dump readers
#read_dump       balance_custom.dump 200 x y 
#read_dump       balance_custom.dump 200 x y vx vy ix iy fx fy
#read_dump       balance_atom.bp 200 x y format adios
read_dump       balance_custom.bp 200 x y vx vy fx fy ix iy format adios

compute         1 all property/atom proc
variable        p atom c_1%10
dump            2 all custom 50 balance2.dump id v_p x y z
dump            3 all custom/adios 50 balance_custom2.bp id v_p x y z
dump            4 all atom/adios 50 balance_atom2.bp 

#dump            3 all image 50 image.*.jpg v_p type &
#                adiam 1.0 view 0 0 zoom 1.8 subbox yes 0.02
#variable        colors string &
#                ""red green blue yellow white &
#                purple pink orange lime gray""
#dump_modify     3 pad 5 amap 0 10 sa 1 10 ${colors}

thermo_style    custom step temp epair press f_10[3] f_10
thermo          100                

run		200
write_dump      all atom/adios balance_atom_final2.bp 
write_dump      all atom balance_atom_final2.dump
"
"Generate a LAMMPS input script for a general simulation of an tdpd 2 system using tdpd 1.0 1.58 9872598 pair style with pair coefficients 1 1 18.75 4.5 0.41 1.58 1.58 1.0 1.0E-5 2.0 3.0 1.0E-5 2.0 and p p p boundary conditions with a timestep of 0.01 running for 500 steps.","########################################################################
### Pure diffusion with a reaction source term analog of a periodic  ### 
### Poiseuille flow problem using transport DPD (tDPD) simulation    ###
###                                                                  ### 
### Created  : Zhen Li (zhen_li@brown.edu)                           ### 
###            Division of Applied Mathematics, Brown University.    ###
###                                                                  ###
### tDPD system setup follows Fig.1 in the publication:              ###
### Z. Li, A. Yazdani, A. Tartakovsky and G.E. Karniadakis.          ###
### ""Transport dissipative particle dynamics model for mesoscopic    ###
### advection-diffusion-reaction problems. J. Chem. Phys.,           ###
### 2015, 143: 014101. DOI: 10.1063/1.4923254                        ###
########################################################################
units                   lj
dimension               3
boundary                p p p
neighbor                0.2 bin
neigh_modify        every 1 delay 0 check yes

atom_style              tdpd 2
comm_modify  vel yes

region     tdpd     block -10 10 -10 10 -5 5 units box
create_box          1 tdpd
create_atoms        1 random 16000 276438 NULL
mass                1 1.0
set                 atom * cc 1 1.0
set                 atom * cc 2 1.0

pair_style          tdpd 1.0 1.58 9872598 
pair_coeff          1 1 18.75 4.5 0.41 1.58 1.58 1.0 1.0E-5 2.0 3.0 1.0E-5 2.0

compute             mythermo all temp
thermo              50
thermo_modify       temp mythermo
thermo_modify       flush yes

velocity            all create 1.0 432982 loop local dist gaussian

region upper block -10.0  10.0   0.0 10.0 -5.0 5.0
region lower block -10.0  10.0 -10.0  0.0 -5.0 5.0

fix         mvv     all mvv/tdpd 0.5
fix         upper1  all tdpd/source 1 region upper  0.01
fix         lower1  all tdpd/source 1 region lower -0.01
fix         upper2  all tdpd/source 2 region upper -0.01
fix         lower2  all tdpd/source 2 region lower  0.01

timestep            0.01
run                 500
reset_timestep      0

compute     cc1     all tdpd/cc/atom 1
compute     cc2     all tdpd/cc/atom 2
compute     bin     all chunk/atom bin/1d y 0.0 1.0 
fix         stat    all ave/chunk 1 100 100 bin c_cc1 c_cc2 norm sample file cc.profile

run                 100
"
"Generate a LAMMPS input script for a general simulation of an bond system using lj/cut 2.5 pair style with a timestep of 0.0001 running for 10000 steps.","# Simple rigid body system

units           lj
atom_style      bond

pair_style      lj/cut 2.5

read_data       data.rigid.small

velocity        all create 100.0 4928459

# unconnected bodies

group           clump1 id <> 1 9
group           clump2 id <> 10 18
group           clump3 id <> 19 27
group           clump4 id <> 28 36
group           clump5 id <> 37 45
group           clump6 id <> 46 54
group           clump7 id <> 55 63
group           clump8 id <> 64 72
group           clump9 id <> 73 81

fix 1 all rigid molecule

neigh_modify    exclude group clump1 clump1
neigh_modify    exclude group clump2 clump2
neigh_modify    exclude group clump3 clump3
neigh_modify    exclude group clump4 clump4
neigh_modify    exclude group clump5 clump5
neigh_modify    exclude group clump6 clump6
neigh_modify    exclude group clump7 clump7
neigh_modify    exclude group clump8 clump8
neigh_modify    exclude group clump9 clump9

thermo          100

#dump           1 all atom 50 dump.rigid

#dump           2 all image 100 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 5

#dump           3 all movie 100 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 5

timestep        0.0001
thermo          50
run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 5.0 pair style with pair coefficients 1 1 0.0102701 3.42 with a timestep of 0.001 running for ${nsteps} steps.","# Numerical difference calculation
# of error in forces, virial stress, and Born matrix

# adjustable parameters

variable    nsteps index 500    # length of run
variable    nthermo index 10    # thermo output interval 
variable    ndump index 500     # dump output interval
variable    nlat index 3        # size of box
variable    fdelta index 1.0e-4 # displacement size
variable    vdelta index 1.0e-6 # strain size for numdiff/virial
variable    bdelta index 1.0e-8 # strain size for numdiff Born matrix
variable    temp index 10.0     # temperature
variable    nugget equal 1.0e-6 # regularization for relerr

units  	    metal
atom_style  atomic

atom_modify	map yes
lattice 	fcc 5.358000
region 		box block 0 ${nlat} 0 ${nlat} 0 ${nlat}
create_box  	1 box
create_atoms 	1 box
mass 		1 39.903

velocity     all create ${temp} 2357 mom yes dist gaussian

pair_style      lj/cut 5.0
pair_coeff      1 1 0.0102701 3.42

neighbor     0.0 bin
neigh_modify every 1 delay 0 check no

timestep     0.001
fix	     nve all nve

# define numerical force calculation

fix	     numforce all numdiff ${nthermo} ${fdelta}
variable     ferrx atom f_numforce[1]-fx
variable     ferry atom f_numforce[2]-fy
variable     ferrz atom f_numforce[3]-fz
variable     ferrsq atom v_ferrx^2+v_ferry^2+v_ferrz^2
compute	     faverrsq all reduce ave v_ferrsq
variable     fsq atom fx^2+fy^2+fz^2
compute      favsq all reduce ave v_fsq
variable     frelerr equal sqrt(c_faverrsq/(c_favsq+${nugget}))
dump errors  all custom ${ndump} force_error.dump v_ferrx v_ferry v_ferrz

# define numerical virial stress tensor calculation

compute 	myvirial all pressure NULL virial
fix 		numvirial all numdiff/virial ${nthermo} ${vdelta}
variable 	errxx equal f_numvirial[1]-c_myvirial[1]
variable 	erryy equal f_numvirial[2]-c_myvirial[2]
variable 	errzz equal f_numvirial[3]-c_myvirial[3]
variable 	erryz equal f_numvirial[4]-c_myvirial[6]
variable 	errxz equal f_numvirial[5]-c_myvirial[5]
variable 	errxy equal f_numvirial[6]-c_myvirial[4]
variable 	verrsq equal ""v_errxx^2 + &
                              v_erryy^2 + &
                              v_errzz^2 + &
                              v_erryz^2 + &
                              v_errxz^2 + &
                              v_errxy^2""
variable 	vsq equal ""c_myvirial[1]^2 + &
                           c_myvirial[3]^2 + &
                           c_myvirial[3]^2 + &
		           c_myvirial[4]^2 + &
                           c_myvirial[5]^2 + &
                           c_myvirial[6]^2""
variable     	vrelerr equal sqrt(v_verrsq/(v_vsq+${nugget}))

# define numerical Born matrix calculation

compute         bornnum all born/matrix numdiff ${bdelta} myvirial
compute         born all born/matrix
variable        berr vector c_bornnum-c_born
variable 	berrsq equal ""v_berr[1]^2 + &
 		    	  v_berr[2]^2 + &
 		    	  v_berr[3]^2 + &
 		    	  v_berr[4]^2 + &
 		    	  v_berr[5]^2 + &
 		    	  v_berr[6]^2 + &
 		    	  v_berr[7]^2 + &
 		    	  v_berr[8]^2 + &
 		    	  v_berr[9]^2 + &
 		    	  v_berr[10]^2 + &
 		    	  v_berr[11]^2 + &
 		    	  v_berr[12]^2 + &
 		    	  v_berr[13]^2 + &
 		    	  v_berr[14]^2 + &
 		    	  v_berr[15]^2 + &
 		    	  v_berr[16]^2 + &
 		    	  v_berr[17]^2 + &
 		    	  v_berr[18]^2 + &
 		    	  v_berr[19]^2 + &
 		    	  v_berr[20]^2 + &
 		    	  v_berr[21]^2""

variable 	bsq equal ""c_born[1]^2 + &
 		    	  c_born[2]^2 + &
 		    	  c_born[3]^2 + &
 		    	  c_born[4]^2 + &
 		    	  c_born[5]^2 + &
 		    	  c_born[6]^2 + &
 		    	  c_born[7]^2 + &
 		    	  c_born[8]^2 + &
 		    	  c_born[9]^2 + &
 		    	  c_born[10]^2 + &
 		    	  c_born[11]^2 + &
 		    	  c_born[12]^2 + &
 		    	  c_born[13]^2 + &
 		    	  c_born[14]^2 + &
 		    	  c_born[15]^2 + &
 		    	  c_born[16]^2 + &
 		    	  c_born[17]^2 + &
 		    	  c_born[18]^2 + &
 		    	  c_born[19]^2 + &
 		    	  c_born[20]^2 + &
 		    	  c_born[21]^2""

variable     	brelerr equal sqrt(v_berrsq/(v_bsq+${nugget}))

thermo_style 	custom step temp pe etotal press v_frelerr v_vrelerr v_brelerr
thermo 		${nthermo}
run 		${nsteps}
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/long 8 8 pair style with pair coefficients 1 1 0.069 2.78 and p p f boundary conditions with a timestep of 2 running for 100000 steps at temperature 300.","# The intention is to find the average position of one wall at atmospheric
# pressure.  The output is the wall position over time which can be used to
# find the average position for a run with fixed wall position.
#
# ----------------- Init Section -----------------

atom_style    full
units         real
boundary      p p f
kspace_style  pppm/electrode 1e-4
kspace_modify slab 3.0
pair_style    lj/cut/coul/long 8 8
bond_style    harmonic
angle_style   harmonic
if ""$(extract_setting(world_size) % 2) == 0"" then ""processors * * 2""

# ----------------- Atom Definition Section -----------------

read_data ""data.piston""

# ----------------- Settings Section -----------------

pair_coeff 1 1 0.069 2.78
pair_coeff 2 2 5.29 2.951
pair_coeff 3 3 0.1553 3.166
pair_coeff 4 4 0.0 0.0
bond_coeff 1 600.0 1.0
angle_coeff 1 75.0 109.47
group wall type 1
group gold type 2
group spce type 3:4
group ele union wall gold
fix fRattleSPCE spce shake 0.0001 10 0 b 1 a 1
pair_modify mix arithmetic

# ----------------- Run Section -----------------

neigh_modify every 1 delay 0
timestep 2
fix fxnvt      spce nvt temp 300 300 500
fix fxforce_au gold setforce 0.0 0.0 0.0

# equilibrate z-coordinate of upper electrode while keeping the electrode rigid
fix fxforce_wa wall setforce 0.0 0.0 NULL
variable atm equal 1/68568.415 # 1/force->nktv2p
variable area equal (xhi-xlo)*(yhi-ylo)
variable wall_force equal -v_atm*v_area/count(wall)
print ""Wall force per atom: ${wall_force}""
fix fxpressure wall aveforce 0 0 ${wall_force} # atomspheric pressure: area/force->nktv2p
fix fxdrag     wall viscous 100
fix fxrigid    wall rigid/nve single

# maintain constant potential during equilibration
# 'algo cg' allows for moving electrodes
fix fxele      ele electrode/conp 0.0 1.805 symm on algo cg 1e-4

# setup output and run
variable q atom q
compute qwa wall reduce sum v_q
compute qau gold reduce sum v_q
variable top_wall equal (bound(wall,zmin))
compute temp_mobile spce temp
variable s equal step
fix fxprint    all print 1000 ""${s} ${top_wall}"" file top_wall.csv screen no
thermo_style custom step c_temp_mobile c_qwa c_qau v_top_wall
thermo 5000
run 100000
write_data ""data.piston.final""

"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 2.5 and p s p boundary conditions.","# 2d indenter simulation with minimization instead of dynamics

dimension     2
boundary      p s p

atom_style    atomic
neighbor      0.3 bin
neigh_modify  delay 5

# create geometry

lattice	      hex 0.9
region	      box block 0 20 0 10 -0.25 0.25
create_box    2 box
create_atoms  1 box

mass	      * 1.0

# LJ potentials

pair_style    lj/cut 2.5
pair_coeff    * * 1.0 1.0 2.5

# define groups

region        1 block INF INF INF 1.25 INF INF
group	      lower region 1
group	      mobile subtract all lower
set	      group lower type 2

# initial velocities

fix	      2 lower setforce 0.0 0.0 0.0

# indenter

fix	      5 all enforce2d

# minimize with indenter

thermo	      10

#dump	      1 all atom 10 dump.indent

#dump	      2 all image 25 image.*.jpg type type &
#	      zoom 1.6 adiam 1.5
#dump_modify   2 pad 4

#dump	      3 all movie 25 movie.mpg type type &
#	      zoom 1.6 adiam 1.5
#dump_modify   3 pad 4

minimize      1.0e-6 1.0e-6 1000 1000

variable      k equal 5000.0/xlat
variable      k1 equal 1000.0/xlat

fix           4 all indent $k sphere 10 13.0 0 6.0
fix_modify    4 energy yes
minimize      1.0e-6 1.0e-6 1000 1000

fix           4 all indent ${k1} sphere 10 12.5 0 6.0
fix_modify    4 energy yes
minimize      1.0e-6 1.0e-6 1000 1000

fix           4 all indent ${k1} sphere 10 12.0 0 6.0
fix_modify    4 energy yes
minimize      1.0e-6 1.0e-6 1000 1000

fix           4 all indent ${k1} sphere 10 11.4 0 6.0
fix_modify    4 energy yes
minimize      1.0e-6 1.0e-6 1000 1000

fix           4 all indent ${k1} sphere 10 11.2 0 6.0
fix_modify    4 energy yes
minimize      1.0e-6 1.0e-6 1000 1000

fix	      4 all indent ${k1} sphere 10 11.0 0 6.0
fix_modify    4 energy yes
minimize      1.0e-6 1.0e-6 1000 1000
"
"Generate a LAMMPS input script for a NVT simulation of an molecular system using hybrid lj/relres 0.675e-9 0.725e-9 1.2e-9 1.4e-9 lj/relres 0.675e-9 .725e-9 1.2e-9 1.4e-9 pair style with pair coefficients 1 1 lj/relres 1 3.47385e-22 3.8e-10 2.02372e-20 3.9309e-10 6.75e-10 7.25e-10 1.2e-09 1.4e-09 and p p p boundary conditions with a timestep of 2.0e-15 running for _style respa 2 2 hybrid 1 2 steps at temperature 290.","units           si
atom_style      molecular
boundary        p p p
dielectric      1
special_bonds   lj/coul 0.0 0.0 0.5

pair_style      hybrid lj/relres 0.675e-9 0.725e-9 1.2e-9 1.4e-9 lj/relres 0.675e-9 .725e-9 1.2e-9 1.4e-9
bond_style      harmonic
angle_style     harmonic
dihedral_style  fourier
read_data       Data.22DMH.in.relres
pair_coeff 1 1 lj/relres 1 3.47385e-22 3.8e-10 2.02372e-20 3.9309e-10 6.75e-10 7.25e-10 1.2e-09 1.4e-09
pair_coeff 1 2 lj/relres 1 5.33663e-22 3.85214e-10 1.31068e-20 3.91793e-10 6.22997e-10 6.73146e-10 1.2e-09 1.4e-09
pair_coeff 1 3 lj/relres 2 5.33663e-22 3.85214e-10 0 3.91793e-10 6.75e-10 7.25e-10 7.25e-10 7.25e-10
pair_coeff 1 4 lj/relres 2 5.33663e-22 3.85214e-10 0 3.91793e-10 6.22997e-10 6.73146e-10 6.73146e-10 6.73146e-10
pair_coeff 1 5 lj/relres 2 5.91576e-22 3.87918e-10 0 3.94542e-10 6.75e-10 7.25e-10 7.25e-10 7.25e-10
pair_coeff 1 6 lj/relres 2 6.49898e-22 3.85214e-10 0 3.91793e-10 6.22997e-10 6.73146e-10 6.73146e-10 6.73146e-10
pair_coeff 2 2 lj/relres 1 8.19828e-22 3.905e-10 8.48872e-21 3.905e-10 5.75e-10 6.25e-10 1.2e-09 1.4e-09
pair_coeff 2 3 lj/relres 2 8.19828e-22 3.905e-10 0 3.905e-10 6.22997e-10 6.73146e-10 6.73146e-10 6.73146e-10
pair_coeff 2 4 lj/relres 2 8.19828e-22 3.905e-10 0 3.905e-10 5.75e-10 6.25e-10 6.25e-10 6.25e-10
pair_coeff 2 5 lj/relres 2 9.08797e-22 3.9324e-10 0 3.9324e-10 6.22997e-10 6.73146e-10 6.73146e-10 6.73146e-10
pair_coeff 2 6 lj/relres 2 9.98393e-22 3.905e-10 0 3.905e-10 5.75e-10 6.25e-10 6.25e-10 6.25e-10
pair_coeff 3 3 lj/relres 2 8.19828e-22 3.905e-10 0 3.905e-10 6.75e-10 7.25e-10 7.25e-10 7.25e-10
pair_coeff 3 4 lj/relres 2 8.19828e-22 3.905e-10 0 3.905e-10 6.22997e-10 6.73146e-10 6.73146e-10 6.73146e-10
pair_coeff 3 5 lj/relres 2 9.08797e-22 3.9324e-10 0 3.9324e-10 6.75e-10 7.25e-10 7.25e-10 7.25e-10
pair_coeff 3 6 lj/relres 2 9.98393e-22 3.905e-10 0 3.905e-10 6.22997e-10 6.73146e-10 6.73146e-10 6.73146e-10
pair_coeff 4 4 lj/relres 2 8.19828e-22 3.905e-10 0 3.905e-10 5.75e-10 6.25e-10 6.25e-10 6.25e-10
pair_coeff 4 5 lj/relres 2 9.08797e-22 3.9324e-10 0 3.9324e-10 6.22997e-10 6.73146e-10 6.73146e-10 6.73146e-10
pair_coeff 4 6 lj/relres 2 9.98393e-22 3.905e-10 0 3.905e-10 5.75e-10 6.25e-10 6.25e-10 6.25e-10
pair_coeff 5 5 lj/relres 2 1.00742e-21 3.96e-10 0 3.96e-10 6.75e-10 7.25e-10 7.25e-10 7.25e-10
pair_coeff 5 6 lj/relres 2 1.10674e-21 3.9324e-10 0 3.9324e-10 6.22997e-10 6.73146e-10 6.73146e-10 6.73146e-10
pair_coeff 6 6 lj/relres 2 1.21585e-21 3.905e-10 0 3.905e-10 5.75e-10 6.25e-10 6.25e-10 6.25e-10

pair_modify     shift yes
neighbor        2.0e-10 bin
neigh_modify    every 2 delay 4 check yes

timestep 2.0e-15
thermo 50
thermo_style custom step temp press pe ke etotal epair emol vol
fix 2 all nvt temp 290 290 2.0e-13

run_style respa 2 2 hybrid 1 2

run 500
#write_data Data.22DMH.out.relres pair ij
#pair_write 1 1 1201 r 0.2e-9 1.4e-9  potential.relres LJ11
#pair_write 2 2 1201 r 0.2e-9 1.4e-9  potential.relres LJ22
#pair_write 1 2 1201 r 0.2e-9 1.4e-9  potential.relres LJ12
"
