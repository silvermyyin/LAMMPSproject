"sample","label"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using hybrid/overlay  kolmogorov/crespi/z 14.0 pair style with pair coefficients * * none and p p p boundary conditions with a timestep of 0.0001 running for 10000 steps.","# Initialization
units           metal
boundary        p p p
atom_style      atomic
processors      * * 1     # domain decomposition over x and y

# System and atom definition
# we use 2 atom types so that inter- and intra-layer
# interactions can be specified separately
read_data       data.graphene-adsorbant   # read lammps data file
mass            1 12.0107   # carbon mass (g/mole) | membrane
mass            2 12.0107   # carbon mass (g/mole) | adsorbate
# Neighbor update settings
neighbor        2.0 bin
neigh_modify    every 1
neigh_modify    delay 0
neigh_modify    check yes
# Separate atom groups
group membrane  type 1
group adsorbant type 2

######################## Potential defition ########################
pair_style  hybrid/overlay  kolmogorov/crespi/z 14.0
####################################################################
pair_coeff * * none
pair_coeff 1 2 kolmogorov/crespi/z  CC.KC   C C  # long-range
####################################################################

#### Simulation settings ####
timestep  0.0001
fix       thermostat adsorbant nve
fix       rigid_membrane membrane setforce 0 0 0
compute   COM1 membrane  com
compute   COM2 adsorbant com
############################

# Output
#dump            1 all xyz 100 trajec.xyz
#dump_modify     1 format line ""%s %12.6f %12.6f %12.6f"" element ""C"" ""C""
thermo          100
thermo_style    custom step time etotal pe temp c_COM1[3] c_COM2[3] # spcpu
thermo_modify   line one format float %14.8f

###### Run molecular dynamics ######
run 10000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/cut 5.0 pair style with a timestep of 1.0 running for 10000 steps.","# LJ particles
variable        T0 index 300.0
variable        press index 0.0
variable        lambda index 400.0
variable        eta index -0.01
variable        enthalpy index -30000.0

units           real
atom_style      full
pair_style      lj/cut 5.0

read_data       ""restart_file""

thermo          10
thermo_style    custom step temp pe etotal press vol

velocity        all create ${T0} 12427
timestep        1.0

fix             fxnvt all npt temp ${T0} ${T0} 1000.0 iso ${press} ${press} 10000.0 
fix             fxgREM all grem ${lambda} ${eta} ${enthalpy} fxnvt
thermo_modify   press fxgREM_press
run             10000

write_data      final_restart_file
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/long ${cutLJ} ${cutC} pair style with pair coefficients 2 2 ${epsOO} ${sigOO} and p p p boundary conditions with a timestep of ${dt} running for ${Nprod} steps.","###############################################################################
#
#
#  This input script is a modified version of the example script spce_hex.lmp
#  which is part of the supplementary (open access) material of the paper
# 
#  P. Wirnsberger, D. Frenkel and C. Dellago, 
#  ""An enhanced version of the heat exchange algorithm with excellent energy 
#  conservation properties"", J. Chem. Phys. 143, 124104 (2015).
#
#  The full article is available on arXiv: http://arxiv.org/pdf/1507.07081.
#
#
#  Description: 
#  ------------
# 
#  This file is a LAMMPS input script for carrying out a NEMD simulation of
#  SPC/E water using the HEX/a algorithm. The run produces two files:
#  ""out.Tspce_hex"" contains the temperature profile and ""out.Espce_hex"" the time
#  evolution of the total energy.
#
###############################################################################

log                 log.spce_hex

# energy flux into the reservoir
 variable F         	equal 0.075

# timestep              
 variable dt             equal 3.0  

# simulation time for the production run (1 ns)
 variable tprod      	equal 1000000

# total number of timesteps
 variable Nprod      	equal floor(${tprod}/${dt})

# parameters for the SPC/E model
 variable epsOO       	equal 0.15535
 variable sigOO       	equal 3.166
 variable theta       	equal 109.47

# long-range and short-range cutoffs, respectively
 variable cutC        	equal (xhi-xlo)/2.
 variable cutLJ  	equal 11

# specification of units, spatial dimensions, boundary conditions and atom-style
 units        real
 dimension    3
 boundary     p p p
 atom_style   full
 read_data    ""data.spce""

# group atoms to molecules
 group    O type 2
 group    H type 1
 group    water type 1 2

# define the pair style with long-range Coulomb interaction
# and short-range LJ interaction
 pair_style    	lj/cut/coul/long ${cutLJ} ${cutC}
 pair_coeff    	2 2 ${epsOO} ${sigOO}
 pair_coeff    	1 2 0 0
 pair_coeff    	1 1 0 0

# use Ewald summation with a precision of 1.e-5
 kspace_style   ewald 1.e-5

# use harmonic bonds between sites of a molecules
# NOTE: this will not have any effects as we use RATTLE to keep the bonds fixed,
#       but it is recommended.
 bond_style    	harmonic              
 angle_style   	harmonic              
 bond_coeff    	1 1000.00 1.000
 angle_coeff   	1 100.0 ${theta}

# use standard correction terms for the truncated tail of the LJ potential
 pair_modify tail yes

# increase neigbor skin because of the large timestep
 neighbor  4.5 bin

 variable    Nsamp    equal 10
 variable    Nrepeat  equal floor(${Nprod}/${Nsamp})
 variable    Nevery   equal ${Nsamp}*${Nrepeat}
 
# compute the centre of mass velocity of the box (vcmx, vcmy, vcmz)
 variable vcmx equal ""vcm(all,x)""
 variable vcmy equal ""vcm(all,y)""
 variable vcmz equal ""vcm(all,z)""
 variable vcm2 equal v_vcmx*v_vcmx+v_vcmy*v_vcmy+v_vcmz*v_vcmz

# compute temperature, pressure, potential energy, kinetic energy and total energy
 compute   cT  all temp
 compute   cP  all pressure thermo_temp
 compute   cPe all pe
 compute   cKe all ke
 variable  vE  equal c_cKe+c_cPe

# specify the reservoir extents
 variable Lz          equal zhi-zlo
 variable delta       equal 4 
 variable dz          equal ${Lz}/60
 variable zlo_Thi     equal -${Lz}/4.-${delta}/2.
 variable zhi_Thi     equal ${zlo_Thi}+${delta}
 variable zlo_Tlo     equal ${Lz}/4.-${delta}/2.
 variable zhi_Tlo     equal ${zlo_Tlo}+${delta}

# create regions of low and high temperature and apply thermostats
 region   Thi_region     block INF INF INF INF ${zlo_Thi} ${zhi_Thi}
 region   Tlo_region     block INF INF INF INF ${zlo_Tlo} ${zhi_Tlo}

# compute temperature of reservoirs using 3 degrees of freedom for every atom 
 compute  cTlo   water temp/region Tlo_region
 compute  cThi   water temp/region Thi_region

# rescale temperature to correct for the constraint bonds (6 instead of 9 degrees of freedom per molecule)
 variable  Tlo_act    equal c_cTlo/2*3
 variable  Thi_act    equal c_cThi/2*3

# thermostat the reservoirs using the eHEX algorithm
# NOTE: add the keyword ""hex"" at the end of each of the two following lines
#       if you want to use the HEX algorithm.

 fix fHi all ehex 1  ${F}   region Thi_region com constrain hex
 fix fLo all ehex 1 -${F}   region Tlo_region com constrain hex

# use velocity Verlet integration
 fix fNVE all nve

# calculate the (kinetic) temperature from the kinetic
# energy per atom
# kB is Boltzmann's constant
# NOTE: For simplicity, we do not subtract the centre of mass
#       velocity of the individual slabs in this example script. 
#       However, we did take this into account in the publication. 
#       (The differences are negligible for our setup.)

 variable  kB  equal  0.001987204
 compute   ke  water  ke/atom
 variable  T   atom   c_ke/${kB}

# use RATTLE with a precision of 1.e-10
 fix    fRattle all rattle 1e-10 400 0 b 1 a 1

# output the timestep, temperatures (average, cold reservoir, hot reservoir), energies (kinetic, potential and total),
# pressure and squared com velocity every 100 timesteps
 reset_timestep  0
 timestep        ${dt}

 thermo_style    custom step temp v_Tlo_act v_Thi_act ke pe etotal press v_vcm2
 thermo_modify   flush yes
 thermo          1000

 compute         cchT  all  chunk/atom bin/1d z lower ${dz}
 fix             fchT  all  ave/chunk  ${Nsamp} ${Nrepeat} ${Nevery} cchT v_T file out.Tspce_hex

 fix             fE    all  ave/time 10 500 5000 v_vE file out.Espce_hex
 run             ${Nprod}

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 with a timestep of 0.002 running for 100 steps.","# Kob and Andersen model Phys. Rev. E 51, 4626 (1995)

units           lj
atom_style      atomic

pair_style      lj/cut 2.5
pair_modify     shift yes

read_data       data.widom.lj

pair_coeff      1 1 1.0 1.0 2.5
pair_coeff      1 2 1.5 0.8 2.0 
pair_coeff      2 2 0.5 0.88 2.2

neighbor        0.3 bin
neigh_modify    delay 0 every 5 check yes

fix             mywidom all widom 10 100000 2 29494 0.75

fix             1 all langevin 0.75 0.75 0.1 48279 zero yes
fix             2 all nve

timestep        0.002

thermo_style    custom step temp pe etotal press vol density f_mywidom[1] f_mywidom[2] f_mywidom[3]
thermo          10

run             100
"
"Generate a LAMMPS input script for a general simulation of an atomic system.","# 3d Lennard-Jones melt - MDI driver script

variable        x index 5
variable        y index 5
variable        z index 5

variable        rho index 0.7 0.8 0.9

label LOOP

  units         lj
  atom_style    atomic
  atom_modify   map array

  read_data     data.series.${rho}

  displace_atoms all random 0.1 0.1 0.1 48294

  neighbor      0.3 bin
  neigh_modify  delay 0 every 1 check yes

  fix           1 all mdi/qm add no virial yes
  variable      evirial equal (f_1[1]+f_1[2]+f_1[3])/3

  thermo_style  custom step temp f_1 v_evirial f_1[1] f_1[2] f_1[3]

  mdi           plugin lammps mdi ""-role ENGINE -name LMP2 -method LINK"" &
                infile in.series.engine &
                extra ""-log log.series.engine.plugin"" &
                command ""run 0""

  write_dump    all custom dump.series.driver.plugin &
                id type x y z f_1[1] f_1[2] f_1[3] modify sort id append yes

  clear

next rho

jump SELF LOOP
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff control.reax_c.tatb pair style with pair coefficients * * ffield.reax C H O N with a timestep of 0.0625 running for 25 steps.","# ReaxFF potential for TATB system

units           real

atom_style      charge
read_data       data.tatb

pair_style      reaxff control.reax_c.tatb
pair_coeff      * * ffield.reax C H O N

compute reax all pair reaxff

variable eb      equal c_reax[1]
variable ea      equal c_reax[2]
variable elp     equal c_reax[3]
variable emol    equal c_reax[4]
variable ev      equal c_reax[5]
variable epen    equal c_reax[6]
variable ecoa    equal c_reax[7]
variable ehb     equal c_reax[8]
variable et      equal c_reax[9]
variable eco     equal c_reax[10]
variable ew      equal c_reax[11]
variable ep      equal c_reax[12]
variable efi     equal c_reax[13]
variable eqeq    equal c_reax[14]

neighbor        2.5 bin
neigh_modify    delay 0 every 5 check no

fix             1 all nve
fix             2 all qeq/shielded 1 10.0 1.0e-6 100 reaxff
fix             4 all reaxff/bonds 5 bonds.reaxff
variable nqeq   equal f_2

thermo          5
thermo_style    custom step temp epair etotal press &
                v_eb v_ea v_elp v_emol v_ev v_epen v_ecoa &
                v_ehb v_et v_eco v_ew v_ep v_efi v_eqeq v_nqeq

timestep        0.0625

#dump           1 all custom 100 dump.reaxff.tatb id type q x y z

#dump           2 all image 5 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 5 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

fix             3 all reaxff/species 1 5 5 species.tatb

run             25
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay  aip/water/2dm 16.0 lj/cut/tip4p/long 2 3 1 1 0.1546 10 8.5 pair style with pair coefficients 1 1   none and p p p boundary conditions with a timestep of 1e-3 running for 1000 steps.","# Initialization
units           metal
boundary        p p p
atom_style      full
processors      * * 1     # domain decomposition over x and y
read_data       ./gra_water.data
mass            1 12.0107   # carbon    mass (g/mole) 
mass            2 15.9994   # oxygen    mass (g/mole) 
mass            3 1.008     # hydrogen  mass (g/mole) 
# Separate atom groups
group           gr    molecule 1
group           water molecule 2
######################## Potential defition ##############################
# Interlayer potential
pair_style  hybrid/overlay  aip/water/2dm 16.0 lj/cut/tip4p/long 2 3 1 1 0.1546 10 8.5
####################################################################
pair_coeff  1 1   none
pair_coeff  2 2   lj/cut/tip4p/long    8.0313e-3  3.1589          # O-O
pair_coeff  2 3   lj/cut/tip4p/long    0.0 0.0                    # O-H
pair_coeff  3 3   lj/cut/tip4p/long    0.0 0.0                    # H-H
pair_coeff  * *   aip/water/2dm        COH.DMC.aip.water.2dm C Ow Hw  # C-H2O    
# bond and angle
bond_style        harmonic
bond_coeff        1     0.0  0.9572
angle_style       harmonic
angle_coeff       1     0.0  104.52
# define kspace calculation
kspace_style      pppm/tip4p 1E-5
# Neighbor update settings
neighbor        2.0 bin
neigh_modify every 1 delay 5 check yes page 1000000 one 100000
####################################################################
# Calculate pair energy
compute         1 all pair lj/cut/tip4p/long
compute         2 all pair aip/water/2dm
compute         wt water temp
variable        TIP4P  equal  c_1
variable        EILP   equal  c_2     # total interlayer energy
variable        temp_wt equal c_wt
############# Output ##############
thermo_style    custom step etotal pe ke v_TIP4P v_EILP  v_temp_wt
thermo          100
thermo_modify   lost error

fix             subf gr setforce 0.0 0.0 0.0
fix             1    water shake 0.0001 20 100 b 1 a 1

timestep        1e-3  
velocity        water create 300.0 12345 dist gaussian mom yes rot yes
fix             2 water nve
run             1000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid dpd 1.0 1.0 373692 srp 0.8 1 mid pair style with pair coefficients 1 1 dpd 60.0 4.5 1.0 and p p p boundary conditions with a timestep of 0.01 running for 1000 steps.","units           lj
atom_style      full
boundary p p p

special_bonds lj/coul 1 1 1
newton on on

# save an extra atom type for bond particles
read_data data.chain

neighbor        2.0 bin
neigh_modify    every 10 check yes

bond_style      harmonic
bond_coeff      * 225.0 0.85

comm_modify vel yes
comm_modify cutoff 3.6

# must use pair hybrid, since srp bond particles
# do not interact with other atoms types
pair_style      hybrid dpd 1.0 1.0 373692 srp 0.8 1 mid
pair_coeff      1 1 dpd 60.0 4.5 1.0 
pair_coeff      1 2 none
pair_coeff      2 2 srp 100.0 

# auto normalization of thermo quantities is turned off by pair srp
# just divide by natoms 
variable        natoms equal count(all)
variable        nPotEng equal c_thermo_pe/v_natoms 

thermo 50
thermo_style custom step temp pe v_nPotEng press atoms v_natoms lx ly lz

fix  1 all nve
timestep        0.01

#restart 500	mid-run-*.restart

run          1000

#write_restart   end-run.restart
"
"Generate a LAMMPS input script for a NVE simulation of an full system using born/coul/wolf/cs 0.1 20.0 20.0    # A, rho, sigma=0, C, D pair style with pair coefficients * *      0.0 1.000   0.00  0.00   0.00 and p	p	p boundary conditions with a timestep of 0.002 running for 500 steps.","# Testsystem for core-shell model compared to Mitchel and Finchham
# Shamelessly copied from in.coreshell.dsf but this script uses Wolf summation.

# ------------------------ INITIALIZATION ----------------------------

units 		metal
dimension	3
boundary	p	p	p
atom_style	full

# ----------------------- ATOM DEFINITION ----------------------------

fix csinfo all property/atom i_CSID
read_data data.coreshell fix csinfo NULL CS-Info

group cores type 1 2
group shells type 3 4

neighbor 2.0 bin
comm_modify vel yes

# ------------------------ FORCE FIELDS ------------------------------

pair_style   born/coul/wolf/cs 0.1 20.0 20.0    # A, rho, sigma=0, C, D 
pair_coeff   * *      0.0 1.000   0.00  0.00   0.00
pair_coeff   3 3    487.0 0.23768 0.00  1.05   0.50 #Na-Na
pair_coeff   3 4 145134.0 0.23768 0.00  6.99   8.70 #Na-Cl
pair_coeff   4 4 405774.0 0.23768 0.00 72.40 145.40 #Cl-Cl

bond_style harmonic
bond_coeff 1 63.014 0.0
bond_coeff 2 25.724 0.0

# ------------------------ Equilibration Run -------------------------------

reset_timestep 0

thermo 50
thermo_style custom step etotal pe ke temp press &
             epair evdwl ecoul elong ebond fnorm fmax vol

compute CSequ all temp/cs cores shells 

# output via chunk method

#compute prop all property/atom i_CSID
#compute cs_chunk all chunk/atom c_prop
#compute cstherm all temp/chunk cs_chunk temp internal com yes cdof 3.0
#fix ave_chunk all ave/time 100 1 100 c_cstherm file chunk.dump mode vector 

thermo_modify temp CSequ

# velocity bias option

velocity all create 1427 134 dist gaussian mom yes rot no bias yes temp CSequ
velocity all scale 1427 temp CSequ

fix thermoberendsen all temp/berendsen 1427 1427 0.4
fix nve all nve
fix_modify thermoberendsen temp CSequ

# 2 fmsec timestep

timestep 0.002
run 500

unfix thermoberendsen

# ------------------------ Dynamic Run -------------------------------

run 1000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using ${pairstyle} pair style with pair coefficients * * ${pairlocation} Mg Mg and s	s	s boundary conditions with a timestep of ${tstep} running for 2000 steps.","############################################################################
# Input file for investigating twinning nucleation under uniaxial loading with basal plane vector analysis
# Christopher Barrett, March 2013
# This script requires a Mg pair potential file to be in the same directory.

# fname is the file name.  It is necessary for loops to work correctly. (See jump command)
variable fname index in.basal

######################################
# POTENTIAL VARIABLES
# lattice parameters and the minimum energy per atom which should be obtained with the current pair potential and homogeneous lattice
variable lx equal 3.181269601 
variable b equal sqrt(3)
variable c equal sqrt(8/3)
variable ly equal ${b}*${lx}
variable lz equal ${c}*${lx}
variable pairlocation index almg.liu
variable pairstyle index eam/alloy/opt

######################################
# EQUILIBRATION/DEFORMATION VARIABLES
# eqpress = 10 bar = 1 MPa
# tstep (the timestep) is set to a default value of 0.001 (1 fs) 
# seed randomizes the velocity
# srate is the rate of strain in 1/s
# Ndump is the number of timesteps in between each dump of the atom coordinates
variable tstep equal 0.001
variable seed equal 95812384
variable srate equal 1e9

######################################
# INITIALIZATION
units 		metal
dimension		3
boundary		s	s	s
atom_style		atomic

######################################
# ATOM BUILD
atom_modify map array

# lattice custom scale a1 ""coordinates of a1"" a2 ""coordinates of a2"" a3 ""coordinates of a3"" basis ""atom1 coordinates"" basis ""atom2 coordinates"" basis ""atom3 coordinates"" basis ""atom4 coordinates"" orient x ""crystallagraphic orientation of x axis"" orient y ""crystallagraphic orientation of y axis"" z ""crystallagraphic orientation of z axis""
lattice custom 3.181269601 a1 1 0 0 a2 0 1.732050808 0 a3 0 0 1.632993162 basis 0.0 0.0 0.0 basis 0.5 0.5 0 basis 0 0.3333333 0.5 basis 0.5 0.833333 0.5 orient x 0 1 1 orient y 1 0 0 orient z 0 1 -1
variable multiple equal 20
variable mx equal ""v_lx*v_multiple""
variable my equal ""v_ly*v_multiple""
variable mz equal ""v_lz*v_multiple""

# the simulation region should be from 0 to a multiple of the periodic boundary in x, y and z.
region		whole block 0 ${mz} 0 ${mx} 0 ${my} units box 
create_box		2 whole
create_atoms 1 box basis 1 1 basis 2 1 basis 3 1 basis 4 1 

region fixed1 block INF INF INF INF INF 10 units box
region fixed2 block INF INF INF INF  100 INF units box
group lower region fixed1
group upper region fixed2
group boundary union upper lower
group mobile subtract all boundary

variable natoms equal ""count(all)""
print ""# of atoms are: ${natoms}""

######################################
# INTERATOMIC POTENTIAL
pair_style	${pairstyle}
pair_coeff	* * ${pairlocation} Mg Mg

######################################
# COMPUTES REQUIRED
compute csym all centro/atom 12
compute eng all pe/atom
compute eatoms all reduce sum c_eng
compute basal all basal/atom

######################################
# MINIMIZATION
# Primarily adjusts the c/a ratio to value predicted by EAM potential
reset_timestep	0
thermo 1
thermo_style custom step pe c_eatoms
min_style cg
minimize	1e-15 1e-15 1000 2000
variable eminimum equal ""c_eatoms / count(all)""
print ""%%e(it,1)=${eminimum}""

######################################
# EQUILIBRATION
reset_timestep	0
timestep ${tstep}
# atoms are given a random velocity based on a temperature of 100K.
velocity all create 100 ${seed} mom yes rot no

# temperature and pressure are set to 100 and 0
fix 1 all nve

# Set thermo output
thermo 100
thermo_style custom step lx ly lz press pxx pyy pzz pe temp

# Run for at least 2 picosecond (assuming 1 fs timestep)
run 2000

# Loop to run until pressure is below the variable eqpress (defined at beginning of file)
label loopeq 
variable eq loop 100 
run 250
variable converge equal press
if ""${converge} <= 0"" then ""variable converge equal -press"" else ""variable converge equal press"" 
if ""${converge} <= 50"" then ""jump ${fname} breakeq"" 
next eq 
jump ${fname} loopeq 
label breakeq 

# Store length for strain rate calculations
variable tmp equal ""lx""
variable L0 equal ${tmp}
print ""Initial Length, L0: ${L0}""
unfix 1

######################################
# DEFORMATION
reset_timestep	0
timestep ${tstep}

# Impose constant strain rate 
variable srate1 equal ""v_srate / 1.0e10""
velocity	upper set 0.0 NULL 0.0 units box
velocity        lower set 0.0 NULL 0.0 units box

fix 2 upper setforce 0.0 NULL 0.0
fix 3 lower setforce 0.0 NULL 0.0
fix 1 all nve

# Output strain and stress info to file
# for units metal, pressure is in [bars] = 100 [kPa] = 1/10000 [GPa]
# p2 is in GPa
variable strain equal ""(lx - v_L0)/v_L0""
variable p1 equal ""v_strain""
variable p2 equal ""-pxz/10000""
variable p3 equal ""lx""
variable p4 equal ""temp""
variable p5 equal ""pe""
variable p6 equal ""ke""
fix def1 all print 100 ""${p1} ${p2} ${p3} ${p4} ${p5} ${p6}"" file output.def1.txt screen no
# Dump coordinates to file (for void size calculations)
dump 		1 all custom 1000 output.dump.* id x y z c_basal[1] c_basal[2] c_basal[3]

# Display thermo
thermo_style	custom step v_strain pxz lx temp pe ke
restart 50000 output.restart

# run deformation for 100000 timesteps (10% strain assuming 1 fs timestep and 1e9/s strainrate)
variable runtime equal 0
label loop
displace_atoms	all ramp x 0.0 ${srate1} z 10 100 units box
run		100
variable runtime equal ${runtime}+100
if ""${runtime} < 100000"" then ""jump ${fname} loop""

######################################
# SIMULATION DONE
print ""All done""
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using airebo 3.0 0 0 pair style with pair coefficients * * CH.airebo C H with a timestep of 0.0005 running for 100 steps.","# AIREBO polyethelene benchmark

units               metal
atom_style          atomic

read_data           data.airebo

replicate           17 16 2

neighbor            0.5 bin
neigh_modify        delay 5 every 1

pair_style          airebo 3.0 0 0
pair_coeff          * * CH.airebo C H

velocity            all create 300.0 761341

fix                 1 all nve
timestep            0.0005

thermo              10
run                 100
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using quip pair style with pair coefficients * * gap_example.xml ""Potential xml_label=GAP_2015_2_20_0_10_54_35_765"" 14 and p p p boundary conditions with a timestep of 0.001 running for 40 steps.","# Test of GAP potential for Si system

units		metal
boundary	p p p

atom_style	atomic

read_data	data_gap

pair_style	quip
pair_coeff	* * gap_example.xml ""Potential xml_label=GAP_2015_2_20_0_10_54_35_765"" 14

neighbor	0.3 bin
neigh_modify	delay 10

fix		1 all nve
thermo		10
timestep	0.001

#dump		1 all custom 10 dump.gap id fx fy fz

run		40
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/charmm/coul/long 8.0 10.0 10.0 pair style with a timestep of 2.0 running for 101 steps at temperature 275.0.","# Solvated 5-mer peptide

units		real
atom_style	full

pair_style	lj/charmm/coul/long 8.0 10.0 10.0
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic
kspace_style	pppm 0.0001

read_data	data.peptide

neighbor	2.0 bin
neigh_modify	delay 5

timestep	2.0

group		peptide type <= 12
group		one id 2 4 5 6
group		two id 80 82 83 84
group		ref id 37
group		colvar union one two ref

fix		1 all nvt temp  275.0 275.0 100.0 tchain 1

fix		2 all plumed plumedfile plumed.dat outfile p.log
fix		2a ref setforce 0.0 0.0 0.0

fix		4 all shake 0.0001 10 100 b 4 6 8 10 12 14 18 a 31

#dump		1 colvar custom 1 dump.colvar.lammpstrj id xu yu zu fx fy fz
#dump_modify 1 sort id

thermo_style	custom step temp etotal pe ke epair ebond f_2
thermo		10
variable        step equal step
variable        pe equal pe

run		101
"
"Generate a LAMMPS input script for a general simulation of an electron system using eff/cut 0.529177249 pair style with pair coefficients * * and p p p boundary conditions with a timestep of 0.0001 running for 0 steps.","variable	sname index h_atom.ang

units 		real
newton		on
boundary        p p p

atom_style	electron

read_data  	data.${sname}

pair_style      eff/cut 0.529177249
pair_coeff 	* *

comm_modify	vel yes
timestep 0.0001

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo          1
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp press effPress

run 		0
"
"Generate a LAMMPS input script for a general simulation of an atomic system and f p p boundary conditions with a timestep of ${dt} running for 1 steps.","# needs description
# DESCRIPTION: haynes-schockley
# poisson eqn for E-field: epsilon phi,xx = -e (n - p + N_D - N_A)
# w/ E = phi,x

echo both
units    metal

variable dt equal 0.0000001
variable s equal 1
variable L equal 10.0
variable N equal 40
variable T equal 30000.0
variable E equal 0.5

timestep  ${dt}

atom_style  atomic
lattice         fcc 1.0 
region    simRegion block 0 $L  0 1 0 1
boundary  f p p
create_box  1 simRegion
mass    1 1.0 # need to keep this
atom_modify     sort 0 1

#          ID  group atc PhysicsType ParameterFile
fix        AtC all   atc drift_diffusion-schrodinger  Si_ddm_schrodinger.mat

#          ID  part keywords    nx ny nz region
fix_modify AtC mesh  create $N 1  1  simRegion f p p

variable a equal $L-0.1
variable b equal $L+0.1
fix_modify AtC mesh create_nodeset lbc -0.1 0.1 -INF  INF -INF  INF
fix_modify AtC mesh create_nodeset rbc  $a  $b  -INF  INF -INF  INF

# ics/bcs : density consistent with wave function
fix_modify AtC  initial temperature          all 300.0
fix_modify AtC  fix     temperature          all 300.0
fix_modify AtC  initial electron_temperature all $T
fix_modify AtC  fix     electron_temperature all $T
fix_modify AtC  initial electron_density     all 0.0
#fix_modify AtC  fix     electron_density     lbc 0 
#fix_modify AtC  fix     electron_density     rbc 0 
fix_modify AtC  initial electric_potential   all 0.0
fix_modify AtC  initial electron_wavefunction all 0.0
fix_modify AtC  fix     electron_wavefunction lbc 0 
fix_modify AtC  fix     electron_wavefunction rbc 0 

thermo  $s
# f_AtC:1 thermal energy, 2 avg T, 3 electron energy, 4 avg Te, 5 total n
thermo_style custom step cpu f_AtC[1] f_AtC[2] f_AtC[3] f_AtC[4] f_AtC[5]
thermo_modify  format 1 %5i format 2 %7.2g
fix_modify AtC  output   ddm_schrodingerFE $s text
fix_modify AtC extrinsic electron_integration implicit 1
fix_modify AtC extrinsic schrodinger_poisson_solver self_consistency 1 # 100
fix_modify AtC  unfix   electric_potential all
# ends zero
fix_modify AtC  fix     electric_potential lbc  0 
fix_modify AtC  fix     electric_potential rbc  0 
run 1
# ends from gradient
fix_modify AtC  fix     electric_potential lbc linear 0 0 0 $E 0 0 0
fix_modify AtC  fix     electric_potential rbc linear 0 0 0 $E 0 0 0
run 1

"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff lmp_control pair style with pair coefficients * * ffield.reax.ZnOH H O Zn with a timestep of 0.25 running for 1000 steps.","# REAX potential for ZnOH2 system
# .....

units           real

atom_style      charge
read_data       data.ZnOH2

pair_style      reaxff lmp_control
pair_coeff      * * ffield.reax.ZnOH H O Zn

neighbor        2 bin
neigh_modify    every 10 delay 0 check no

fix             1 all nve
fix             2 all qeq/reax 1 0.0 10.0 1e-6 param.qeq
fix             3 all temp/berendsen 500.0 500.0 100.0

timestep        0.25
thermo  100

#dump           1 all atom 30 dump.reax.znoh

run             1000
"
"Generate a LAMMPS input script for a NVE simulation of an bond system using none pair style and p f p boundary conditions with a timestep of 0.005 running for 2000000 steps.","# 3D simple cubic lattice simulation
dimension   2
boundary    p f p

units		   lj
atom_style	bond
atom_modify sort 0 1.
bond_style  harmonic
pair_style  none
comm_modify cutoff 2.0

# geometry
read_data	data.pos

#
neighbor 0.5 nsq
neigh_modify delay 0 check no

#Langevin random seed
variable r equal 571101

#Langevin Temperature
variable t equal 0.005

# Langevin Damping variable
variable d equal 0.5

# time step
timestep  0.005

# Create velocities and equilibrate 
compute   MyTemp all temp/partial 1 0 0
velocity  all create $t 28711 mom yes rot yes dist gaussian temp MyTemp
velocity  all set NULL 0.0 0.0 units box
#
fix        1 all langevin $t $t $d $r
fix_modify 1 temp MyTemp
fix        2 all setforce NULL 0. 0.
fix        3 all nve
fix        4 all phonon 10 50000 500000 map.in phonon sysdim 1
fix_modify 4 temp MyTemp
#
#                    1    2    3  4
thermo_style  custom step temp pe etotal
thermo_modify temp MyTemp
thermo   100

dump    	4 all atom 50000 dump_LJ_ANA.lammpstrj 

run 		2000000
"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay spin/exchange 3.1 spin/dmi 3.1 pair style with pair coefficients * * spin/exchange exchange 3.1 -0.01593 0.06626915552 1.211 and f f f boundary conditions with a timestep of 0.0001.","
units 		metal
dimension 	3
boundary 	f f f
atom_style 	spin

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice 	sc 3.0
region 		box block 0.0 10.0 0.0 10.0 0.0 4.0
create_box 	2 box
region		reg1 block 0.0 10.0 	0.0 5.0 	0.0 1.0
region		reg2 block 0.0 10.0 	6.0 10.0 	0.0 1.0
create_atoms 	1 region reg1 
create_atoms 	2 region reg2

# setting mass, mag. moments, and interactions for bcc iron

mass		1 55.845
mass		2 55.845
set 		region reg1 spin 2.2 0.0 0.0 1.0
set 		region reg2 spin/random 31 2.2

group 		fixed_spin region reg1

pair_style 	hybrid/overlay spin/exchange 3.1 spin/dmi 3.1
pair_coeff 	* * spin/exchange exchange 3.1 -0.01593 0.06626915552 1.211
pair_coeff	* * spin/dmi dmi 3.1 0.12e-03 0.0 0.0 1.0

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin zeeman 0.0 0.0 0.0 1.0 anisotropy 5e-05 0.0 0.0 1.0 
fix_modify	1 energy yes
fix 		2 fixed_spin setforce/spin 0.0 0.0 0.0
fix 		3 all langevin/spin 0.0 0.1 21
fix		4 all nve/spin lattice frozen 

timestep	0.0001

compute 	out_mag    all spin
variable 	magx      equal c_out_mag[1]
variable 	magy      equal c_out_mag[2]
variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo          100
thermo_style    custom step time v_magx v_magz v_magnorm v_tmag pe v_emag etotal
thermo_modify   format float %20.15g

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
dump 		1 all custom 100 dump.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3] c_outsp[5] c_outsp[6] c_outsp[7]

min_style	spin
min_modify 	alpha_damp 1.0 discrete_factor 20.0
minimize        1.0e-16 1.0e-16 1000 100
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using eam/alloy pair style with pair coefficients * * ptvoterlammps.eam Pt Pt and p p p boundary conditions with a timestep of 0.005 running for 1000 steps.","# 3d EAM surface for local HD

# nearest neighbor distance = a * sqrt(2)/2 = 2.77 Angs for Pt with a = 3.92
# hop event on (100) surface is same distance
# exchange event is 2 atoms moving same distance

variable        Tequil index 400.0
variable        Vmax index 0.4
variable        qfactor index 0.3
variable        cutbond index 3.2
variable        Dcut index 10.0
variable        cutevent index 1.1
variable        alpha index 200.0
variable        boost index 4000.0
variable        ghostcut index 12.0
variable        steps index 2000
variable        nevent index 100
variable        nx index 2
variable        ny index 2
variable        zoom index 1.8
variable        seed index 3875984
variable        tol index 1.0e-15
variable        add index 50

units           metal
atom_style	atomic
atom_modify     map array
boundary        p p p
comm_modify     cutoff ${ghostcut}

lattice		fcc 3.92
region		box block 0 6 0 6 0 4
create_box	2 box
create_atoms	1 box

mass            * 1.0

change_box      all z final -0.1 5.0 boundary p p f 

# replicate in xy

replicate       ${nx} ${ny} 1

# add adatoms

include         adatoms.list.${add}

# define frozen substrate and mobile atoms

region          base block INF INF INF INF 0 1.8
set             region base type 2
group           base type 2
group           mobile type 1

# pair style

pair_style	eam/alloy
pair_coeff	* * ptvoterlammps.eam Pt Pt

neighbor	0.5 bin
neigh_modify    every 1 delay 5 check yes

fix		1 mobile nve
fix		2 mobile langevin ${Tequil} ${Tequil} 1.0 ${seed} zero yes

timestep	0.005

compute         tmobile mobile temp

thermo		100
thermo_modify   temp tmobile

# thermal equilibration

run             1000
reset_timestep  0

# pin base so will not move during quenches

fix             freeze base setforce 0.0 0.0 0.0

# event detection

compute         event all event/displace ${cutevent}

# hyper/local
    
fix             HL mobile hyper/local ${cutbond} ${qfactor} ${Vmax} ${Tequil} &
                ${Dcut} ${alpha} ${boost}

# thermo output

thermo_style    custom step temp pe f_HL f_HL[*]

thermo_modify   lost ignore
thermo_modify   temp tmobile

thermo          ${nevent}

# dump

region          substrate block INF INF INF INF 1.8 3.8
region          adatoms block INF INF INF INF 3.8 INF
variable        acolor atom rmask(base)+2*rmask(substrate)+3*rmask(adatoms)

dump		1 all image 10000000 local.*.jpg v_acolor type size 1024 1024 &
		zoom ${zoom} adiam 2.5 view 0.0 0.0 up 0 1 0 axes yes 0.9 0.01
dump_modify	1 pad 6 amap 1 3 sa 1 3 blue red green

# run

hyper           ${steps} ${nevent} HL event min ${tol} ${tol} 1000 1000 dump 1
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/spica/coul/long 15.0 pair style with pair coefficients 1     1      lj9_6  0.7000 4.3210 # SO4  SO4 with a timestep of 10.0 running for 100 steps at temperature 310.0.","# coarse grained SDS surfactant monolayer

units           real
dimension       3
atom_style      full
processors  * * 1

pair_style      lj/spica/coul/long 15.0
bond_style      harmonic
angle_style     spica 
special_bonds   lj/coul 0.0 0.0 1.0

read_data       data.sds.gz

pair_coeff  1     1      lj9_6  0.7000 4.3210 # SO4  SO4 
pair_coeff  1     2      lj9_6  0.3830 4.4135 # SO4  CM  
pair_coeff  1     3      lj9_6  0.4050 4.4530 # SO4  CT  
pair_coeff  1     4      lj12_4 1.1000 4.1000 # SO4  SOD 
pair_coeff  1     5      lj12_4 1.1000 4.1000 # SO4  W   
pair_coeff  2     2      lj9_6  0.4200 4.5060 # CM   CM  
pair_coeff  2     3      lj9_6  0.4440 4.5455 # CT   CM  
pair_coeff  2     4      lj12_4 0.3400 4.4385 # SOD  CM  
pair_coeff  2     5      lj12_4 0.3400 4.4385 # W    CM  
pair_coeff  3     3      lj9_6  0.4690 4.5850 # CT   CT  
pair_coeff  3     4      lj12_4 0.3600 4.4780 # SOD  CT  
pair_coeff  3     5      lj12_4 0.3600 4.4780 # W    CT  
pair_coeff  4     4      lj12_4 0.3500 4.3710 # SOD  SOD 
pair_coeff  4     5      lj12_4 0.8950 4.3710 # SOD  W   
pair_coeff  5     5      lj12_4 0.8950 4.3710 # W    W   

kspace_style    pppm/cg 0.00001
kspace_modify   order 3 

neighbor        2.0 bin
neigh_modify    delay 4 every 2 check yes

timestep        10.0

fix             1 all nvt temp 310.0 310.0 100.0

thermo          10

run              100
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff lmp_control pair style with pair coefficients * * ffield.reax.V_O_C_H H C O V with a timestep of 0.25 running for 2000 steps.","# REAX potential for VOH system
# .....

units           real

atom_style      charge
read_data       data.VOH

pair_style      reaxff lmp_control
pair_coeff      * * ffield.reax.V_O_C_H H C O V

neighbor        2 bin
neigh_modify    every 10 delay 0 check no

fix             1 all nve
fix             2 all qeq/reax 1 0.0 10.0 1e-6 param.qeq
fix             3 all temp/berendsen 500.0 500.0 100.0

timestep        0.25

#dump           1 all atom 30 dump.reax.voh
thermo 100
run             2000
"
"Generate a LAMMPS input script for a NVE simulation of an hybrid bond ellipsoid oxdna system using hybrid/overlay oxrna2/excv oxrna2/stk oxrna2/hbond oxrna2/xstk oxrna2/coaxstk oxrna2/dh pair style with pair coefficients * * oxrna2/excv 11.92337812042065 5.9626 5.74965 11.92337812042065 4.38677 4.259 11.92337812042065 2.81094 2.72576 and p p p boundary conditions with a timestep of 0.01706 running for 1000000 steps.","# LAMMPS input file in real units via oxdna lj2real.py, date 2024-05-19
variable number	equal 2
variable ofreq	equal 1000
variable efreq	equal 1000
variable T      equal 300.0
variable rhos   equal 0.5

units real

dimension 3

newton on

boundary  p p p

atom_style hybrid bond ellipsoid oxdna
atom_modify sort 0 8.518

# Pair interactions require lists of neighbours to be calculated
neighbor 17.036 bin
neigh_modify every 1 delay 0 check yes

read_data data.duplex2

set atom * mass 315.8376

group all type 1 4

# oxRNA2 bond interactions - FENE backbone
bond_style oxrna2/fene
bond_coeff * 11.92337812042065 2.1295 6.482800913
special_bonds lj 0 1 1

# oxRNA2 pair interactions
pair_style hybrid/overlay oxrna2/excv oxrna2/stk oxrna2/hbond oxrna2/xstk oxrna2/coaxstk oxrna2/dh
pair_coeff * * oxrna2/excv 11.92337812042065 5.9626 5.74965 11.92337812042065 4.38677 4.259 11.92337812042065 2.81094 2.72576
pair_coeff * * oxrna2/stk seqdep ${T} 8.35864576375849 0.005504556 0.70439070204273 3.66274 7.92174 2.9813 6.64404 0.9 0.0 0.95 0.9 0.0 0.95 1.3 0.0 0.8 1.3 0.0 0.8 2.0 0.65 2.0 0.65
pair_coeff * * oxrna2/hbond seqdep 0.0 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0.0 0.7 1.5 0.0 0.7 1.5 0.0 0.7 0.46 3.141592653589793 0.7 4.0 1.5707963267948966 0.45 4.0 1.5707963267948966 0.45
pair_coeff 1 4 oxrna2/hbond seqdep 5.18928666388042 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0.0 0.7 1.5 0.0 0.7 1.5 0.0 0.7 0.46 3.141592653589793 0.7 4.0 1.5707963267948966 0.45 4.0 1.5707963267948966 0.45
pair_coeff 2 3 oxrna2/hbond seqdep 5.18928666388042 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0.0 0.7 1.5 0.0 0.7 1.5 0.0 0.7 0.46 3.141592653589793 0.7 4.0 1.5707963267948966 0.45 4.0 1.5707963267948966 0.45
pair_coeff 3 4 oxrna2/hbond seqdep 5.18928666388042 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0.0 0.7 1.5 0.0 0.7 1.5 0.0 0.7 0.46 3.141592653589793 0.7 4.0 1.5707963267948966 0.45 4.0 1.5707963267948966 0.45
pair_coeff * * oxrna2/xstk 4.92690859644113 4.259 5.1108 3.57756 4.94044 2.25 0.505 0.58 1.7 1.266 0.68 1.7 1.266 0.68 1.7 0.309 0.68 1.7 0.309 0.68
pair_coeff * * oxrna2/coaxstk 6.57330882442206 4.259 5.1108 3.57756 4.94044 2.0 2.592 0.65 1.3 0.151 0.8 0.9 0.685 0.95 0.9 0.685 0.95 2.0 -0.65 2.0 -0.65
pair_coeff * * oxrna2/dh ${T} ${rhos} 1.02455

# NVE ensemble
fix 1 all nve/asphere
#fix 2 all langevin ${T} ${T} 4265.0 457145 angmom 10

timestep 0.01706

#comm_style tiled
fix 3 all balance 1000 1.03 shift xyz 10 1.03
comm_modify cutoff 32.4

compute quat all property/atom quatw quati quatj quatk

compute erot all erotate/asphere
compute ekin all ke
compute epot all pe
variable erot equal c_erot
variable ekin equal c_ekin
variable epot equal c_epot
variable etot equal c_erot+c_ekin+c_epot
fix 5 all print ${efreq} ""$(step)  ekin = ${ekin} |  erot = ${erot} | epot = ${epot} | etot = ${etot}"" screen yes

dump out all custom ${ofreq} out.${number}.lammpstrj id mol type x y z ix iy iz vx vy vz c_quat[1] c_quat[2] c_quat[3] c_quat[4] angmomx angmomy angmomz
dump_modify out sort id
dump_modify out format line ""%d %d %d  %22.15le %22.15le %22.15le  %d %d %d  %22.15le %22.15le %22.15le  %22.15le %22.15le %22.15le %22.15le  %22.15le %22.15le %22.15le""

run 1000000

write_data last_config.${number}.* nocoeff
#write_restart last_config.${number}.*
"
"Generate a LAMMPS input script for a general simulation of an smd system using hybrid/overlay smd/ulsph *DENSITY_CONTINUITY *VELOCITY_GRADIENT *NO_GRADIENT_CORRECTION & pair style with pair coefficients 1 1 smd/ulsph *COMMON ${rho_water} ${c0} ${q1} ${Cp} 0 & and sm sm p boundary conditions running for 10000 steps.","####################################################################################################
#
# combined TLSPH / ULSPH example
#
# A column of water is placed in a container and allowed to collapse unter the
# influence of gravity. Several solid objects are also placed in the container.
# The water flow pushes the solid objects around until the system comes to halt due to
# viscous damping. The solid objects have a lower mass density than water and finally float on
# the water surface.
#
# Water is modelled using the Updated Lagrangian formalism. Solid bodies are modelled using the
# Total Lagrangian formalism. Contact forces between container, solid bodies, and water prevent
# mutual penetration of these physical entities.
#
# unit system: GPa / mm / ms
#
####################################################################################################

####################################################################################################
# MATERIAL PARAMETERS
####################################################################################################
variable        rho_water equal 1000 # mass density water
variable        rho_obj equal 300 # mass density solid objects
variable        c0 equal 10.0 # speed of sound for water
variable        E equal 5*${c0}*${c0}*${rho_water} # Young's modulus for solid objects
variable        nu equal 0.3 # Poisson ratio for solid objects
variable        sigma_yield equal 0.1*${E} # plastic yield stress for solid objects
variable        hardening_parameter equal 0 # plastic hardening parameter for solid objects
variable        contact_stiffness equal 2.5*${c0}^2*${rho_water} # contact force amplitude
variable        q1 equal 1.0 # artificial viscosity
variable        q2 equal 0.0 # artificial viscosity
variable        Hg equal 10 # Hourglass control coefficient for solid objects
variable        Cp equal 1.0 # heat capacity -- not used here

####################################################################################################
# INITIALIZE LAMMPS
####################################################################################################
units           si
dimension       2
boundary        sm sm p
atom_style      smd
neigh_modify    every 5 delay 0 check yes
comm_modify     vel yes
newton          off
atom_modify     map array
comm_style      tiled

####################################################################################################
# CREATE INITIAL GEOMETRY
####################################################################################################
# create simulation box, a container, and a water column
variable        l0 equal 0.05 # initial particle lattice spacing
region          box block 0 6 0 8 -0.01 0.01 units box
create_box      3 box
region          water block 0.25 1 0.25 4 EDGE EDGE units box
region          container block 0.15 5.85 0.15 8 -0.01 0.01 units box side out # container
lattice         sq ${l0}
create_atoms    1 region water
group           water type 1
create_atoms    3 region container
group           container type 3

# create some solid objects to be pushed around
region          obj1 prism 2 2.6 0.25 0.85 EDGE EDGE 0.3 0 0 units box
region          obj2 block 3 3.6 0.25 0.85 EDGE EDGE units box
region          obj3 sphere 4.3 0.5 0 0.25 units box
create_atoms    2 region obj1
create_atoms    2 region obj2
create_atoms    2 region obj3
group           solids type 2
group           tlsph type 2

####################################################################################################
# DISCRETIZATION PARAMETERS
####################################################################################################
variable        h equal 2.5*${l0} # SPH kernel diameter
variable        vol_one equal ${l0}^2 # initial particle volume for 2d simulation
set             group all diameter ${h}
set             group all smd/contact/radius ${l0}
set             group all volume  ${vol_one}
set             group all smd/mass/density ${rho_water}
set             group solids smd/mass/density ${rho_obj}
variable        contact_scale equal 1.5 # scale factor to increase contact gap between bodies
variable        skin equal ${h} # Verlet list range
neighbor        ${skin} bin

####################################################################################################
# DEFINE BOUNDARY CONDITIONS
#
# note that the the particles constituting the container are simply not integrated in time,
# thus these particles never move. This is equivalent to a fixed displacement boundary condition.
####################################################################################################
fix             gfix all gravity -9.81 vector 0 1 0 # add gravity

####################################################################################################
# INTERACTION PHYSICS / MATERIAL MODEL
# 3 different pair styles are used:
#     - updated Lagrangian SPH for water
#     - total Lagrangian SPH for solid objects
#     - a repulsive Hertzian potential for contact forces between different physical bodies
####################################################################################################
pair_style      hybrid/overlay smd/ulsph *DENSITY_CONTINUITY *VELOCITY_GRADIENT *NO_GRADIENT_CORRECTION &
                               smd/tlsph smd/hertz ${contact_scale}
pair_coeff      1 1 smd/ulsph *COMMON ${rho_water} ${c0} ${q1} ${Cp} 0 &
                *EOS_TAIT 7.0 &
                *END
pair_coeff      2 2 smd/tlsph *COMMON ${rho_obj} ${E} ${nu} ${q1} ${q2} ${Hg} ${Cp} &
                *STRENGTH_LINEAR_PLASTIC ${sigma_yield} ${hardening_parameter} &
                *EOS_LINEAR &
                *END
pair_coeff      3 3 none
pair_coeff      1 2 smd/hertz ${contact_stiffness}
pair_coeff      1 3 smd/hertz ${contact_stiffness}
pair_coeff      2 3 smd/hertz ${contact_stiffness}
pair_coeff      2 2 smd/hertz ${contact_stiffness}

####################################################################################################
# TIME INTEGRATION
####################################################################################################
fix             dtfix tlsph smd/adjust_dt 0.1 # dynamically adjust time increment every step
fix             integration_fix_water water smd/integrate_ulsph adjust_radius 1.01 10 15
fix             integration_fix_solids solids smd/integrate_tlsph

####################################################################################################
# SPECIFY TRAJECTORY OUTPUT
####################################################################################################
compute         eint all smd/internal/energy
compute         contact_radius all smd/contact/radius
compute         S solids smd/tlsph/stress
compute         nn water smd/ulsph/num/neighs
compute         epl solids smd/plastic/strain
compute         vol all smd/vol
compute         rho all smd/rho

dump            dump_id all custom 100 dump.LAMMPS id type x y &
                fx fy vx vy c_eint c_contact_radius mol &
                c_S[1] c_S[2] c_S[4] mass radius c_epl c_vol c_rho c_nn proc
dump_modify     dump_id first yes


####################################################################################################
# STATUS OUTPUT
####################################################################################################
compute         alleint all reduce sum c_eint
variable        etot equal pe+ke+c_alleint+f_gfix # total energy of the system
thermo          100
thermo_style    custom step ke pe v_etot c_alleint f_dtfix dt
thermo_modify   lost ignore

####################################################################################################
# RUN SIMULATION
####################################################################################################
fix             balance_fix all balance 500 0.9 rcb # load balancing for MPI
run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using comb pair style with pair coefficients * * ffield.comb Cu O and p p p boundary conditions with a timestep of 0.00020 running for 2 steps.","# Cu2O crystal, qeq on, minimizes, then calculates elastic constants

units		metal
atom_style	charge
dimension       3
boundary        p p p

read_data	data.Cu2O
mass		1 63.54
group    	type1 type 1
compute   	charge1 type1 property/atom q
compute   	q1 type1 reduce ave c_charge1
mass		2 16.00
group    	type2 type 2
compute   	charge2 type2 property/atom q
compute   	q2 type2 reduce ave c_charge2

velocity	all create 1.0 277387

pair_style	comb
pair_coeff	* * ffield.comb Cu O

neighbor	0.5 bin
neigh_modify	every 20 delay 0 check no

timestep        0.00020

thermo_style	custom step temp etotal pe evdwl ecoul c_q1 c_q2 lx ly lz vol 
thermo_modify	norm yes
thermo		1
fix   		1 all nve
fix   	 	2 all qeq/comb 1 0.0001

#dump		1 all cfg 1 *.cfg id type xs ys zs q f_2 vx vy vz fx fy fz
#dump_modify	1 element Cu O

run		2

unfix   	1
fix		1 all box/relax aniso 0.0 vmax 0.001
minimize	1.0e-14  1.0e-20  1000  10000
min_modify	dmax 0.2 line quadratic

unfix		1
fix   		1 all nve
run		1

unfix  		1
unfix  		2
#undump	  	1

### copy lines after this to any input script for elastic calculations ###
## 		Elastic constants calculations: strain box, measure box stress
##		strain x, measure s_x, s_y, s_z, s_yz:
##                calculates C11, C12, C13 and C14

fix  		2 all deform 1 x scale 1.0001 remap x 
compute   	perfx all stress/atom NULL pair
compute   	fx all reduce sum &
		c_perfx[1] c_perfx[2] c_perfx[3] &
		c_perfx[4] c_perfx[5] c_perfx[6]
thermo_style	custom  step lx ly lz xy xz yz &
		c_fx[1] c_fx[2] c_fx[3] c_fx[4] c_fx[5] c_fx[6]
run		10

##		strain z, measure s_z: calculates C33

fix  		2 all deform 1 z scale 1.0001 remap x 
compute   	perfz all stress/atom NULL pair
compute   	fz all reduce sum &
		c_perfz[1] c_perfz[2] c_perfz[3] &
		c_perfz[4] c_perfz[5] c_perfz[6]
thermo_style	custom  step lx ly lz xy xz yz &
		c_fz[1] c_fz[2] c_fz[3] c_fz[4] c_fz[5] c_fz[6]
run		10

##		strain yz, measure s_yz: calculates C44

fix  		2 all deform 1 yz erate 0.0001 remap x 
compute   	perfyz all stress/atom NULL pair
compute   	fyz all reduce sum &
		c_perfyz[1] c_perfyz[2] c_perfyz[3] &
		c_perfyz[4] c_perfyz[5] c_perfyz[6]
thermo_style	custom  step lx ly lz xy xz yz &
		c_fyz[1] c_fyz[2] c_fyz[3] c_fyz[4] c_fyz[5] c_fyz[6]
run		10

##		strain xy, measure s_xy: calculates C66

fix  		2 all deform 1 xy erate 0.0001 remap x 
compute   	perfxy all stress/atom NULL pair
compute   	fxy all reduce sum &
		c_perfxy[1] c_perfxy[2] c_perfxy[3] &
		c_perfxy[4] c_perfxy[5] c_perfxy[6]
thermo_style	custom  step lx ly lz xy xz yz &
		c_fxy[1] c_fxy[2] c_fxy[3] c_fxy[4] c_fxy[5] c_fxy[6]
run		10
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 and p p p boundary conditions with a timestep of 0.004 running for _style 	verlet steps.","units lj
dimension 3
boundary p p p
atom_style atomic

# truncated and shifted LJ potential
pair_style lj/cut 2.5
pair_modify shift yes

# fcc lattice
lattice	fcc 0.9731
region my_box block 0 8.0   0 8.0   0 20.0
create_box 1 my_box
region particles block 0 8.0 0 8.0 0 20.0
create_atoms 1 region particles
pair_coeff 1 1 1.0 1.0 2.5
mass 1 1.0
change_box all z final 0.0 34 remap units box

# select particles in one side of the elongated box
region left plane 0 0 10 0 0 1
group left region left

velocity left create 6.0 1 mom yes rot yes

# simulation parameters
neighbor	0.6 bin
timestep	0.004
run_style 	verlet
fix ensemble left nve     # Note: only move particle in left-hand side
fix langevin left langevin 3.0 0.8 100.0 2017

# outout
thermo_style custom step temp pzz pe lz
thermo 100
# dump dumpXYZ all xyz 100 traj.xyz

# run reduced for demonstration purposes
# run 10000
run 5000
write_data data.halfhalf
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using meam/spline pair style with pair coefficients * * TiO.meam.spline O Ti and p p p boundary conditions with a timestep of ${dt} running for 100 steps at temperature 300.","#

variable T_depart equal 300

variable dt equal 0.0002

variable a equal 4.5937
variable c equal 2.9587
variable ca equal ${c}/${a}

variable nx equal 6
variable ny equal 6
variable nz equal 11

variable bx equal ${a}*${nx}
variable by equal ${a}*${ny}
variable bz equal ${c}*${nz}
# =======================================================================

units           metal
atom_style      atomic
dimension       3
boundary        p p p


lattice         sc 1.0
region          box_vide prism 0 ${bx} 0 ${by} 0 ${bz} 0.0 0.0 0.0
create_box      2 box_vide

#lattice         sc 1.0
#region          box_TiO2 block 0 ${bx} 0 ${by} 0 ${bz}

# titanium atoms
lattice         custom ${a} origin 0.0 0.0 0.0 &
                            orient x 1 0 0 orient y 0 1 0 orient z 0 0 1 &
                            a1 1.0  0.0  0.0  &
                            a2 0.0  1.0  0.0  &
                            a3 0.0  0.0 ${ca} &
                            basis 0.0    0.0     0.0 &
                            basis 0.5    0.5     0.5

create_atoms    2 region box_vide

# Oxygen atoms
lattice         custom ${a} origin 0.0 0.0 0.0 &
                            orient x 1 0 0 orient y 0 1 0 orient z 0 0 1 &
                            a1 1.0  0.0  0.0  &
                            a2 0.0  1.0  0.0  &
                            a3 0.0  0.0 ${ca} &
                            basis 0.30478    0.30478     0.0 &
                            basis 0.69522    0.69522     0.0 &
                            basis 0.19522    0.80478     0.5 &
                            basis 0.80478    0.19522     0.5

create_atoms    1 region box_vide


mass            1 16.00
group           Oxy type 1

mass            2 47.867
group           Ti type 2

velocity        all create ${T_depart} 277387

pair_style      meam/spline
pair_coeff      * * TiO.meam.spline O Ti

neighbor        0.5 bin
neigh_modify    every 2 delay 0 check yes

timestep        ${dt}

thermo_style    custom step temp press pe ke etotal lx ly lz vol
thermo          10


#dump            5 all custom 500 boxAlpha_alumina.lammpstrj id type q x y z

fix             3 all nve
run             100

unfix           3
fix             1 all box/relax tri 0.0 vmax 0.001
minimize        1.0e-3 1.0e-5 1000 10000

unfix           1
reset_timestep  0
thermo          50
fix             3 all npt temp 300 300 0.1 aniso 1.0 1.0 1.0
run             500

"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay spin/exchange 6.0 spin/magelec 4.5 spin/dmi 4.5 pair style with pair coefficients * * spin/exchange exchange 6.0 -0.01575 0.0 1.965 and p p f boundary conditions with a timestep of 0.0002 running for 500 steps.","# layer sc iron atoms (in the [001] plane) in bismuth oxide 

units 		metal
atom_style 	spin
dimension 	3
boundary 	p p f

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice 	sc 3.96
region 		box block 0.0 34.0 0.0 34.0 0.0 5.0
create_box 	1 box
create_atoms 	1 box

# setting mass, mag. moments, and interactions for bfo

mass		1 1.0
set 		group all spin/random 11 2.50

#pair_style 	hybrid/overlay spin/exchange 6.0 spin/magelec 4.5
pair_style 	hybrid/overlay spin/exchange 6.0 spin/magelec 4.5 spin/dmi 4.5
pair_coeff 	* * spin/exchange exchange 6.0 -0.01575 0.0 1.965
pair_coeff 	* * spin/magelec magelec 4.5 0.000109 1.0 1.0 1.0
pair_coeff 	* * spin/dmi dmi 4.5 0.00005 1.0 1.0 1.0

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin zeeman 0.0 0.0 0.0 1.0 anisotropy 0.00033 0.0 0.0 1.0
fix_modify      1 energy yes
fix 		2 all langevin/spin 0.0 0.1 21
fix 		3 all nve/spin lattice frozen

timestep	0.0002

compute 	out_mag	 all spin
compute 	out_pe	 all pe
compute 	out_ke	 all ke
compute 	out_temp all temp

variable 	magz	 equal c_out_mag[3]
variable 	magnorm	 equal c_out_mag[4]
variable 	emag	 equal c_out_mag[5]
variable 	tmag	 equal c_out_mag[6]

thermo_style    custom step time v_magnorm pe v_emag temp etotal
thermo          50

compute outsp all property/atom spx spy spz sp fmx fmy fmz
dump 		1 all custom 100 dump_bfo.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3]

run 		500
"
"Generate a LAMMPS input script for a general simulation of an atomic system using eam pair style with pair coefficients * * ../../../../potentials/Cu_u3.eam and p p p boundary conditions with a timestep of 0.0 # 0.001 running for 1 steps.","# This test calculates Hardy fields for a system subjected
# to a volumetric stretch.
echo both
units		metal	
atom_style	atomic
# create domain
lattice         fcc 3.615 origin 0.25 0.25 0.25
region		simRegion  block -3 3 -3 3 -3 3
region		feRegion   block -3 3 -3 3 -3 3
region		mdRegion   block -3 3 -3 3 -3 3
region		mdInternal block -3 3 -3 3 -3 3
boundary	p p p
create_box	1 simRegion
# create atoms
create_atoms	1 region mdRegion
mass		1 63.550 
# specify interal atoms
group		internal region mdInternal
# specify inter-atomic potential
pair_style	eam
pair_coeff  	* * ../../../../potentials/Cu_u3.eam
# specify neighbor/re-neighboring parameters
neighbor	0.3 bin
neigh_modify	every 10 delay 0 check no
# setup thermal output
thermo		10
thermo_style custom step pe ke press lx ly lz
# time integrator
# fix		NVE all nve 
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc field
fix_modify      AtC  fields none 
fix_modify      AtC  fields add mass_density
fix_modify      AtC  fields add internal_energy
fix_modify      AtC  fields add stress
#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 2 2 2 feRegion p p p
log		eam_volume_stretch.log
# equilibrate MD field
timestep 0.0 # 0.001
reset_timestep	0	
run 		1
# stretch system 
change_box	all x scale 1.001 y scale 1.001 z scale 1.001 remap
fix_modify	AtC  output eam_volume_stretchFE 1 text tensor_components
run		1
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using edip/multi pair style with pair coefficients * * SiC.edip Si C and p p p boundary conditions with a timestep of 0.001 running for 100 steps.","# Test of MEAM potential for SiC system

units		metal
boundary	p p p

atom_style	atomic

read_data	data.SiC

pair_style	edip/multi
pair_coeff	* * SiC.edip Si C

mass 1 28.085
mass 2 12.001

neighbor	1.0 bin
neigh_modify	delay 1

fix		1 all nve
thermo		10
timestep	0.001

#dump		1 all atom 50 dump.meam

#dump		2 all image 10 image.*.jpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	2 pad 3 element Si C

#dump		3 all movie 10 movie.mpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	3 pad 3 element Si C

run		100
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/cut 6.0 pair style with pair coefficients 1 1 0.13506 3.166 with a timestep of 1.0 running for 10 steps.","# MM for water dimer

units		real
atom_style	full

bond_style      harmonic
angle_style     harmonic

read_data       data.water.mm

group           mm molecule 1
group           qm molecule 2

# pair style must define stand-alone short-range Coulombics

pair_style      lj/cut/coul/cut 6.0
pair_coeff      1 1 0.13506 3.166         
pair_coeff      2 2 0.0 1.0         

velocity        all create 300.0 458732

neighbor	1.0 bin
neigh_modify	delay 0 every 1 check yes

fix		1 all nve

timestep        1.0

thermo_style    custom step cpu temp ke evdwl ecoul epair emol elong &
                pe etotal press

thermo          1

run		10
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using pace product pair style with pair coefficients * * Cu-PBE-core-rep.ace Cu with a timestep of 0.0005 running for 100 steps.","# simple test of fcc Cu with ACE product

units           metal
atom_style      atomic

neighbor        0.3 bin
neigh_modify    every 2 delay 10 check yes

variable        a equal 3.597
lattice         fcc $a
region          box block 0 4 0 4 0 4
create_box      1 box
create_atoms    1 box

mass            1 26.98

pair_style      pace product
pair_coeff  * * Cu-PBE-core-rep.ace Cu

velocity        all create 300 8728 loop geom
timestep        0.0005
fix             1 all nve

compute         eatom all pe/atom
compute         energy all reduce sum c_eatom
variable        delenergy equal c_energy-pe

compute         satom all stress/atom NULL
compute         str all reduce sum c_satom[1] c_satom[2] c_satom[3]
variable        delpress equal -(c_str[1]+c_str[2]+c_str[3])/(3*vol)-press

thermo          10
thermo_style    custom step temp epair etotal press v_delenergy v_delpress

run             100

"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay          & pair style with pair coefficients 1     1     lj/cut           0.5 1.775 3.268        # HG   HG with a timestep of 0.002 running for 2000 steps.","# Ionic surfactant system: S12S

units           lj
dimension       3
atom_style      full

read_data       data.gauss-diel

pair_style      hybrid/overlay          &
                lj/cut 3.5              &
                coul/long 18.0          &
                gauss/cut 3.4           &
                coul/diel 2.5
pair_modify    shift yes

dielectric      0.4255
kspace_style    pppm/cg 0.0001
kspace_modify   mesh 12 12 12 order 3

bond_style      harmonic
angle_style     harmonic
dihedral_style  opls

pair_coeff  1     1     lj/cut           0.5 1.775 3.268        # HG   HG  
pair_coeff  1     1     coul/long                               # HG   HG  
pair_coeff  1     1     gauss/cut        0.1 2.549 0.1525           
pair_coeff  1     2     lj/cut           0.31623 1.5329 1.7206  # HG   CM  
pair_coeff  1     3     lj/cut           0.31623 1.5329 1.7206  # HG   CT  
pair_coeff  1     4     lj/cut           0.05 1.75 4.375        # HG   CI  
pair_coeff  1     4     coul/long                               # HG   CI  
pair_coeff  1     4     gauss/cut        0.2805 1.45 0.112 
pair_coeff  1     4     coul/diel        78. 1.375 0.112 
pair_coeff  2     2     lj/cut           0.2000 1.2910 3.2275   # CM   CM  
pair_coeff  2     3     lj/cut           0.2000 1.2910 3.2275   # CM   CT  
pair_coeff  2     4     lj/cut           0.4472 1.1455 1.28585  # CM   CI  
pair_coeff  3     3     lj/cut           1.95 1.291 3.2275      # CT   CT  
pair_coeff  3     4     lj/cut           0.4472 1.1455 1.28585  # CT   CI  
pair_coeff  4     4     lj/cut           1.0 10. 1.12246        # CI   CI 
pair_coeff  4     4     coul/long                               # CI   CI 

bond_coeff  1      12650.0000   0.7500 # HG CM FROM TOP
bond_coeff  2      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  3      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  4      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  5      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  6      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  7      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  8      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  9      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  10     12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  11     12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  12     12650.0000   0.5000 # CM CT FROM TOP

angle_coeff 1           85.7600 109.5000 # HG CM CM FROM TOP
angle_coeff 2           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 3           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 4           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 5           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 6           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 7           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 8           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 9           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 10          85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 11          85.7600 111.0000 # CM CM CT FROM TOP

dihedral_coeff 1     5.7431 -2.53241 5.0742 0.0 # HG CM CM CM FROM TOP
dihedral_coeff 2     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 3     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 4     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 5     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 6     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 7     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 8     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 9     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 10    5.7431 -2.53241 5.0742 0.0 # CM CM CM CT FROM TOP

timestep        0.002  

reset_timestep  0

group           cions type 4
group           sds subtract all cions

velocity        all create 1. 87287 dist gaussian

neighbor        1.5 multi
neigh_modify    exclude molecule/intra sds
neigh_modify    every 5 delay 0 check yes

fix             1 all nve/limit 0.2
fix             2 all langevin 1.0 1.0 0.05 18273

thermo_style    multi
thermo          500

run             2000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using meam pair style with pair coefficients * * library.meam Si C SiC.meam Si C and p p p boundary conditions with a timestep of 0.001 running for 100 steps.","# Test of MEAM potential for SiC system

units		metal
boundary	p p p

atom_style	atomic

read_data	data.meam

pair_style	meam
pair_coeff	* * library.meam Si C SiC.meam Si C

neighbor	0.3 bin
neigh_modify	delay 10

fix		1 all nve
thermo		10
timestep	0.001

#dump		1 all atom 50 dump.meam

#dump		2 all image 10 image.*.jpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	2 pad 3 element Si C

#dump		3 all movie 10 movie.mpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	3 pad 3 element Si C

run		100
"
"Generate a LAMMPS input script for a general simulation of an atomic system using eam pair style with pair coefficients * * ../../../../potentials/Cu_u3.eam and f p p boundary conditions with a timestep of 0.001 running for 1 steps.","# This test calculates several Hardy fields for a system subjected to
# unaxial strain using the ""cell"" Hardy localization function.
units		metal	
atom_style	atomic
# create domain
lattice         fcc 3.615 origin 0.25 0.25 0.25
region		simRegion block -18 18 -3 3 -3 3
region		feRegion block -18 18 -3 3 -3 3
boundary	f p p
create_box	1 simRegion
# create atoms
region		mdRegion block -17 17 -3 3 -3 3
create_atoms	1 region mdRegion
mass		1 63.550 
# specify interal atoms
region		mdInternal block -16 16 -3 3 -3 3
group		internal region mdInternal
# specify inter-atomic potential
pair_style	eam
pair_coeff  	* * ../../../../potentials/Cu_u3.eam
# specify neighbor/re-neighboring parameters
neighbor	0.3 bin
neigh_modify	every 10 delay 0 check no
# setup thermal output
thermo		10
thermo_style custom step pe ke press lx ly lz
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal atc hardy
fix_modify	AtC  kernel cell 7.23 7.23 7.23 
# fix_modify      AtC atom_element_map eulerian 1
fix_modify      AtC  fields none 
fix_modify      AtC  fields add mass_density displacement stress internal_energy
fix_modify      AtC  gradients add displacement 
# fix_modify	AtC  on_the_fly kernel on
# fix_modify	AtC  on_the_fly bond on
#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh  create 9 1 1 feRegion f p p
fix_modify      AtC mesh  lammps_partition
# equilibrate MD field
timestep 0.001
reset_timestep	0	
run 		1
displace_atoms	all ramp x -0.6507 0.6507 x -65.07 65.07
fix_modify	AtC  output eam_unistrain_cellFE 1 text  tensor_components
run		1
"
"Generate a LAMMPS input script for a general simulation of an atomic system using eam/fs pair style with pair coefficients * * ../../../../potentials/Fe_mm.eam.fs Fe running for 0 steps.","units metal
atom_style atomic
atom_modify map array sort 0 0.0
neigh_modify every 2 delay 10 check yes page 1000000 one 100000

## read in path data using fix property/atom- here 4th image of a NEB
fix pa all property/atom d_nx d_ny d_nz d_dnx d_dny d_dnz d_ddnx d_ddny d_ddnz
read_data pafipath.4.data fix pa NULL PafiPath

## EAM potential
pair_style    eam/fs
pair_coeff * * ../../../../potentials/Fe_mm.eam.fs Fe

mass * 55.85
thermo 100
min_style fire


compute pe all pe
variable pe equal pe
run 0
print ""energy=${pe}""

## compute property/atom to access relevant fields
compute pa all property/atom d_nx d_ny d_nz d_dnx d_dny d_dnz d_ddnx d_ddny d_ddnz
run 0

## fix name group-id pafi compute-id temperature tdamp seed overdamped 0/1 com 0/1
fix hp all pafi pa 500.0 0.01 434 overdamped no com yes

run 0
minimize 0 0 1000 1000 # best if using NEB path
compute dx all displace/atom
compute dmag all reduce max c_dx[4]
variable maxjump equal sqrt(c_dmag)

thermo_style custom step pe temp v_maxjump


variable dn equal f_hp[4]*f_hp[4] # should be zero to float precision


fix af all ave/time 1 1000 1000 f_hp[1] f_hp[2] f_hp[3] v_dn

variable adn equal sqrt(f_af[4]) # should be very small (approx. 1e-6 A)
variable apf equal f_af[1]


run 1000
minimize 0 0 1000 1000

variable s_pe equal ${pe}
variable s_apf equal ${apf}
variable s_adn equal ${adn}
variable s_maxjump equal ${maxjump}

unfix hp
unfix pa
unfix af
minimize 0 0 1000 1000


print """"""
---------- PAFI RESULTS --------

During run:
  Average Distance From Hyperplane = ${s_adn}A (Should be very small, around 1e-5A),
  Average Force Projection Along MFEP = ${s_apf} eV/A
""""""
print """"""
In-plane minimization post-run:
energy = ${s_pe} eV

""""""
if ""${s_maxjump} > 0.1"" then &
""print 'Max Atomic Displacement = ${s_maxjump}A > 0.1A'"" &
""print ' => Possible shallow in-plane metastability: Reduce time in basin and/or decrease tdamp'"" &
else &
""print 'Max Atomic Displacement = ${s_maxjump}A < 0.1A => No in-plane jumps'""
print """"""

Full minimization after removal of PAFI fixes:
energy = ${pe} eV

----- END PAFI ----
""""""
"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using granular pair style with pair coefficients 1 * jkr 1000.0 50.0 0.3 10 tangential mindlin 800.0 1.0 0.5 rolling sds 500.0 200.0 0.5 twisting marshall with a timestep of 0.001 running for 5000 steps.","# pour two types of particles (cohesive and non-cohesive) on flat wall

variable        name string pour_two_types

atom_style      sphere
units           lj

###############################################
# Geometry-related parameters
###############################################

variable        boxx equal 20
variable        boxy equal 20
variable        boxz equal 30

variable        xc1 equal 0.3*${boxx}
variable        xc2 equal 0.7*${boxx}
variable        yc equal 0.5*${boxy}

###############################################
# Particle-related parameters
###############################################
variable        rlo equal 0.25
variable        rhi equal 0.5
variable        dlo equal 2.0*${rlo}
variable        dhi equal 2.0*${rhi}

variable        dens equal 1.0

variable skin equal 0.3*${rhi}

#############
processors      * * 1
region          boxreg block 0 ${boxx} 0 ${boxy} 0 ${boxz}
create_box      2 boxreg
change_box      all boundary p p f

pair_style      granular
pair_coeff      1 * jkr 1000.0 50.0 0.3 10 tangential mindlin 800.0 1.0 0.5 rolling sds 500.0 200.0 0.5 twisting marshall
pair_coeff      2 2 hertz 200.0 20.0 tangential linear_history 300.0 1.0 0.1 rolling sds 200.0 100.0 0.1 twisting marshall

comm_modify     vel yes

region          insreg1 cylinder z ${xc1} ${yc} 5 15 ${boxz}
region          insreg2 cylinder z ${xc2} ${yc} 5 15 ${boxz}

fix             1 all nve/sphere
fix             grav all gravity 10.0 vector 0 0 -1
fix             ins1 all pour 1500 1 3123 region insreg1 diam range ${dlo} ${dhi} dens ${dens} ${dens}
fix             ins2 all pour 1500 2 3123 region insreg2 diam range ${dlo} ${dhi} dens ${dens} ${dens}

neighbor        ${skin} bin
neigh_modify    delay 0 every 1 check yes

fix             3 all wall/gran granular hertz/material 1e5 1e3 0.3 tangential mindlin NULL 1.0 0.5 zplane 0 NULL

thermo_style    custom step atoms ke
thermo_modify   lost warn
thermo          100

timestep        0.001

#dump           1 all custom 100 ${name}.dump id type radius mass x y z

run             5000
"
"Generate a LAMMPS input script for a general simulation of an electron system using eff/cut 529.177249 ecp 1 Si pair style with pair coefficients * * and f f f boundary conditions.","
# Created 2011-01-07

# General parameters

variable	sname index SiH4.ang
log		${sname}.log

units		real
newton		on
boundary	f f f

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 529.177249 ecp 1 Si 
pair_coeff      * *

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

comm_modify	vel yes

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo          1
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp press effPress

# Minimization

min_style       cg
dump            1 all xyz 1 ${sname}.min.xyz
compute         1 all property/atom spin eradius erforce
dump            2 all custom 1 ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
min_modify      line quadratic
minimize        0 1.0e-5 1000 10000

undump		1
undump		2

"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 13.0 pair style with pair coefficients 1 1 0.2381 3.405 and p p p boundary conditions with a timestep of 4.0 running for 1000 steps at temperature 30.","# This test calculates Hardy fields for a system 
# underdoing dynamics at a finite temperature.
units   real
atom_style  atomic
echo both
dimension 3
boundary  p p p
lattice         fcc  5.376 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
region          box block 0 5 0 5 0 5
read_data       nvt.init
pair_style  lj/cut 13.0
pair_coeff      1 1 0.2381 3.405
group           internal region box

fix         ATC internal atc field
fix_modify  ATC mesh create 1 1 1 box p p p
fix_modify  ATC atom_element_map eulerian 100
fix_modify  ATC fields none
fix_modify  ATC fields add mass_density energy stress temperature kinetic_temperature
fix_modify  ATC fields add velocity thermal_energy kinetic_energy
fix_modify  ATC output nvtFE 100 text
fix         PP  internal atc field
fix_modify  PP  filter type step # defaults to running
fix_modify  PP  filter on
fix_modify  PP  mesh create 1 1 1 box p p p
fix_modify  PP  atom_element_map eulerian 100
fix_modify  PP  fields add mass_density energy stress temperature kinetic_temperature
fix_modify  PP  fields add velocity thermal_energy kinetic_energy
fix_modify  PP  output nvtPP 100 text
thermo          100
compute_modify  thermo_temp extra/dof 0
thermo_style    custom step temp etotal ke pe press vol
timestep        4.0
reset_timestep  0
# NOTE fixes performing time integration (init_integrate/final_integrate) should be defined after atc
fix             NVT all nvt temp 30 30 10.0 drag 0.2 tchain 1
log             nvt.log
run             1000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using eam pair style with pair coefficients * * Ni_u3.eam and s s p boundary conditions with a timestep of 0.001 running for 100 steps.","# 3d metal shear simulation

units		metal
boundary	s s p

atom_style	atomic
lattice		fcc 3.52
region		box block 0 16.0 0 10.0 0 2.828427
create_box	3 box

lattice		fcc 3.52 orient	x 1 0 0 orient y 0 1 1 orient z 0 -1 1 &
		origin 0.5 0 0 
create_atoms	1 box

pair_style	eam
pair_coeff	* * Ni_u3.eam

neighbor	0.3 bin
neigh_modify	delay 5

region		lower block INF INF INF 0.9 INF INF
region		upper block INF INF 6.1 INF INF INF
group		lower region lower
group		upper region upper
group		boundary union lower upper
group		mobile subtract all boundary

set		group lower type 2
set		group upper type 3

# void

region		void cylinder z 8 3.535534 2.5 INF INF
delete_atoms	region void

# temp controllers

compute		new3d mobile temp
compute		new2d mobile temp/partial 0 1 1

# equilibrate

velocity	mobile create 300.0 5812775 temp new3d
fix		1 all nve
fix		2 boundary setforce 0.0 0.0 0.0

fix		3 mobile temp/rescale 10 300.0 300.0 10.0 1.0
fix_modify	3 temp new3d

thermo		25
thermo_modify	temp new3d

timestep	0.001
run		100

# shear

velocity	upper set 1.0 0 0
velocity	mobile ramp vx 0.0 1.0 y 1.4 8.6 sum yes

unfix		3
fix		3 mobile temp/rescale 10 300.0 300.0 10.0 1.0
fix_modify	3 temp new2d

#dump		1 all atom 100 dump.shear.void

#dump		2 all image 100 image.*.jpg type type &
#		axes yes 0.8 0.02 view 0 0 zoom 1.5 up 0 1 0 adiam 2.0
#dump_modify	2 pad 4

#dump		3 all movie 100 movie.mpg type type &
#		axes yes 0.8 0.02 view 0 0 zoom 1.5 up 0 1 0 adiam 2.0
#dump_modify	3 pad 4

thermo		100
thermo_modify	temp new2d

reset_timestep	0
run		3000
"
"Generate a LAMMPS input script for a general simulation using lj/cut 1.2 pair style with pair coefficients * * 1.0 1.0 running for 0 steps.","# orthogonal box for fcc lattice unit cell

lattice       fcc 1.1

region        mybox block 0 1 0 1 0 1
create_box    1 mybox
create_atoms  1 box

mass          * 1.0

write_data    tmp.data.fcc.orthog

pair_style    lj/cut 1.2
pair_coeff    * * 1.0 1.0

neighbor      0.0 bin

thermo_style  custom step pe avecx avecy avecz bvecx bvecy bvecz &
              cvecx cvecy cvecz pxx pyy pzz vol

dump          1 all custom 100 tmp.dump.fcc.orthog id type x y z

run           0
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 2.8015 pair style with pair coefficients * * 1.0 1.0 and p p p boundary conditions with a timestep of 0.00044905847 running for 1000 steps at temperature 1.00888.","variable ibead uloop 32 pad

units lj
atom_style atomic
atom_modify map yes
boundary p p p
pair_style lj/cut 2.8015
read_data data.lj${ibead}

pair_coeff    * * 1.0 1.0
pair_modify shift yes

mass 1 1.0

timestep 0.00044905847

fix 1 all pimd/langevin ensemble nvt integrator obabo temp 1.00888 lj 0.00965188 3.4 39.948 4.135667403e-3 1.03646168908e-4 thermostat PILE_L ${ibead}

thermo_style custom step temp f_1[*] vol press
thermo 100
thermo_modify norm no

#dump dcd all custom 1 ${ibead}.lammpstrj id type x y z vx vy vz ix iy iz fx fy fz
#dump_modify dcd sort id format line ""%d %d %.16f %.16f %.16f %.16f %.16f %.16f %d %d %d %.16f %.16f %.16f""

run 1000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style and f p p boundary conditions with a timestep of 5 running for 400 steps.","#AtC Thermal Coupling
# This benchmark tests heat conducting into and out of the MD region.  The
# temperature is initially 20 everywhere and the left boundary BC is fixed at
# 40.# The result should show heat diffusing through the FEM to the MD and back
# out # to the FEM on the right.  Insufficient time is captured to reach the
# linear # steady state, but heat crossing both boundaries should be observed.
echo both
units           real
atom_style      atomic
# create domain
#lattice        type reduced density rho* = 4*(sigma/a)^3, where N=4 for fcc, s = 3.405 A (Wagner) and a = 5.25 A (Ashcroft & Mermin, p. 70)
# NOTE following 3 lines added for restart
boundary        f p p
pair_style      lj/cut 13.5
read_data       temp.init
lattice         fcc 5.405 origin 0.25 0.25 0.25
region          simRegion block -12 12 -3 3 -3 3
# create atoms, NOTE commented out for restart
#region         mdRegion block -5 5 -3 3 -3 3
#boundary       f p p
#create_box     1 mdRegion
#create_atoms   1 region mdRegion
#mass           1 39.95
# specify interal/ghost atoms
region          mdInternal block -4 4 -3 3 -3 3
group           internal region mdInternal
group           ghost subtract all internal
# velocities have Vcm = 0, NOTE next three lines commented out for restart
#velocity       internal create 40. 87287 mom yes loop geom
#pair_style     lj/cut 13.5
#pair_coeff     1 1 .238 3.405 13.5
neighbor        5. bin
neigh_modify    every 10 delay 0 check no
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc thermal     Ar_thermal.mat
fix_modify      AtC boundary ghost
# numerical parameters
fix_modify      AtC  time_integration fractional_step
fix_modify      AtC  internal_quadrature off
#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 12 1  1  simRegion f p p
fix_modify      AtC mesh create_faceset ibndy box -4.0 4.0 -INF INF -INF INF in
fix_modify      AtC mesh create_faceset obndy box -4.0 4.0 -INF INF -INF INF outward
# fix a temperature
fix_modify      AtC  fix temperature all 20.
#fix_modify     AtC  fix temperature all linear 0 0 0 -0.154 0 0 30.
#fix_modify     AtC  fix temperature all quadratic 0 0 0 -0.154 0 0 30. 0.01 0.0 0.0 0 0 0 
# turn on thermostat
fix_modify      AtC  control thermal rescale 10
# output
thermo          100
variable xdof equal 3*count(ghost)
compute_modify thermo_temp extra/dof ${xdof}
thermo_style custom step cpu etotal pe f_AtC[1] temp f_AtC[2]
thermo_modify  format 1 %6i format 2 %7.2g
# equilibrate MD field
#fix_modify      AtC  output bar1d_lumped_initFE 1 text
timestep        5
run             400
#run            100
# change thermostat to hoover
fix_modify      AtC  unfix temperature all
#fix_modify     AtC  thermal control flux interpolate
fix_modify      AtC  control thermal flux faceset obndy
fix_modify      AtC  control localized_lambda on
fix_modify      AtC  filter type exponential
fix_modify      AtC  filter scale 10000.0
fix_modify      AtC  filter on
# add nodesets
#               ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
fix_modify      AtC mesh create_nodeset lbc -12.1  -11.9   -INF INF   -INF INF
fix_modify      AtC mesh create_nodeset rbc  11.9   12.1   -INF INF   -INF INF
fix_modify      AtC  fix temperature lbc 80.
fix_modify      AtC  fix temperature rbc 80.
# initialize
thermo          10
run             100
# relax
fix_modify      AtC  unfix temperature all
# output
fix_modify      AtC  output bar1d_lumpedFE 100 text
# run with FE
reset_timestep 0
thermo          100
run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an peri system using peri/ves pair style with pair coefficients * * 14.9e9 14.9e9 0.0015001 0.0005 0.25 0.5 0.001 and s s s boundary conditions with a timestep of 1.0e-7 running for 1000 steps.","# small Peridynamic cylinder hit by projectile

units           si
boundary        s s s
atom_style      peri
atom_modify     map array
neighbor        0.0010 bin

# small target

lattice         sc 0.0005
region          target cylinder y 0.0 0.0 0.0050 -0.0050 0.0 units box
create_box      1 target
create_atoms    1 region target

pair_style      peri/ves
pair_coeff      * * 14.9e9 14.9e9 0.0015001 0.0005 0.25 0.5 0.001
set             group all density 2200
set             group all volume 1.25e-10
velocity        all set 0.0 0.0 0.0 sum no units box
fix             1 all nve

# spherical indenter to shatter target

variable        y0 equal 0.00155
variable        vy equal -100
variable        y equal ""v_y0 + step*dt*v_vy""

fix             2 all indent 1e17 sphere 0.0000 v_y 0.0000 0.0015 units box

compute         1 all damage/atom
timestep        1.0e-7
thermo          100

#dump            1 all custom 100 dump.peri id type x y z c_1

#dump           2 all image 50 image.*.jpg type type &
#               axes yes 0.8 0.02 view 80 -30 adiam 0.0006
#dump_modify    2 pad 4

#dump           3 all movie 50 movie.mpg type type &
#               axes yes 0.8 0.02 view 80 -30 adiam 0.0006
#dump_modify    3 pad 4

run             1000
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 with a timestep of ${ts} running for 0 steps.","#LAMMPS input script
#in.GD
#see README for details

###############################################################################
#initialize variables
clear

#frequency for outputting info (timesteps)
variable        dump_rate       equal 50
variable        thermo_rate     equal 10

#equilibration time (timesteps)
variable        equil           equal 1000

#stabilization time (timesteps to reach steady-state)
variable        stabil          equal 1000

#data collection time (timesteps)
variable        run             equal 2000

#length of pipe
variable        L               equal 30

#width of pipe
variable        d               equal 20

#flux (mass/sigma*tau)
variable        J               equal 0.1

#simulation box dimensions
variable        Lx              equal 100
variable        Ly              equal 40

#bulk fluid density
variable        dens            equal 0.8

#lattice spacing for wall atoms
variable        aWall           equal 1.0 #1.7472

#timestep
variable        ts              equal 0.001

#temperature
variable        T               equal 2.0

#thermostat damping constant
variable        tdamp           equal ${ts}*100

units           lj
dimension       2
atom_style      atomic


###############################################################################
#create box

#create lattice with the spacing aWall
variable        rhoWall         equal ${aWall}^(-2)
lattice         sq ${rhoWall}

#modify input dimensions to be multiples of aWall
variable        L1 equal round($L/${aWall})*${aWall}
variable        d1 equal round($d/${aWall})*${aWall}
variable        Ly1 equal round(${Ly}/${aWall})*${aWall}
variable        Lx1 equal round(${Lx}/${aWall})*${aWall}

#create simulation box
variable        lx2 equal ${Lx1}/2
variable        ly2 equal ${Ly1}/2
region          simbox block -${lx2} ${lx2} -${ly2} ${ly2} -0.1 0.1 units box
create_box      2 simbox

#####################################################################
#set up potential

mass            1 1.0           #fluid atoms
mass            2 1.0           #wall atoms

pair_style      lj/cut 2.5
pair_modify     shift yes
pair_coeff      1 1 1.0 1.0 2.5
pair_coeff      1 2 1.0 1.0 1.12246
pair_coeff      2 2 0.0 0.0

neigh_modify  exclude type 2 2

timestep        ${ts}

#####################################################################
#create atoms

#create wall atoms everywhere
create_atoms    2 box

#define region which is ""walled off""
variable        dhalf equal ${d1}/2
variable        Lhalf equal ${L1}/2
region          walltop block -${Lhalf} ${Lhalf} ${dhalf} EDGE -0.1 0.1 &
                units box
region          wallbot block -${Lhalf} ${Lhalf} EDGE -${dhalf} -0.1 0.1 &
                units box
region          outsidewall union 2 walltop wallbot side out

#remove wall atoms outside wall region
group           outside region outsidewall
delete_atoms    group outside

#remove wall atoms that aren't on edge of wall region
variable        x1 equal ${Lhalf}-${aWall}
variable        y1 equal ${dhalf}+${aWall}
region          insideTop block -${x1} ${x1} ${y1} EDGE -0.1 0.1 units box
region          insideBot block -${x1} ${x1} EDGE -${y1} -0.1 0.1 units box
region          insideWall union 2 insideTop insideBot
group           insideWall region insideWall
delete_atoms    group insideWall

#define new lattice, to give correct fluid density
#y lattice const must be a multiple of aWall
variable        atrue equal ${dens}^(-1/2)
variable        ay equal round(${atrue}/${aWall})*${aWall}

#choose x lattice const to give correct density
variable        ax equal (${ay}*${dens})^(-1)

#change Lx to be multiple of ax
variable        Lx1 equal round(${Lx}/${ax})*${ax}
variable        lx2 equal ${Lx1}/2
change_box      all x final -${lx2} ${lx2} units box

#define new lattice
lattice         custom ${dens} &
                a1 ${ax} 0.0 0.0 a2 0.0 ${ay} 0.0 a3 0.0 0.0 1.0 &
                basis 0.0 0.0 0.0

#fill in rest of box with bulk particles
variable        delta equal 0.001
variable        Ldelt equal ${Lhalf}+${delta}
variable        dDelt equal ${dhalf}-${delta}
region          left block EDGE -${Ldelt} EDGE EDGE -0.1 0.1 units box
region          right block ${Ldelt} EDGE EDGE EDGE -0.1 0.1 units box
region          pipe block -${Ldelt} ${Ldelt} -${dDelt} ${dDelt} -0.1 0.1 &
                units box

region          bulk union 3 left pipe right
create_atoms    1 region bulk

group           bulk type 1
group           wall type 2

#remove atoms that are too close to wall
delete_atoms    overlap 0.9 bulk wall

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes
neigh_modify    exclude group wall wall

velocity        bulk create $T 78915 dist gaussian rot yes mom yes loop geom

#####################################################################
#set up PUT
#see Evans and Morriss, Phys. Rev. Lett. 56(20) 1986, p. 2172

#average number of particles per box, Evans and Morriss used 2.0
variable        NperBox equal 8.0

#calculate box sizes
variable        boxSide equal sqrt(${NperBox}/${dens})
variable        nX equal round(lx/${boxSide})
variable        nY equal round(ly/${boxSide})
variable        dX equal lx/${nX}
variable        dY equal ly/${nY}

#temperature of fluid (excluding wall)
compute         myT bulk temp

#profile-unbiased temperature of fluid
compute         myTp bulk temp/profile 1 1 0 xy ${nX} ${nY}

#thermo setup
thermo          ${thermo_rate}
thermo_style    custom step c_myT c_myTp etotal press

#dump initial configuration
# dump            55 all custom 1 all.init.lammpstrj id type x y z vx vy vz
# dump            56 wall custom 1 wall.init.lammpstrj id type x y z
# dump_modify     55 sort id
# dump_modify     56 sort id
run             0
# undump          55
# undump          56

#####################################################################
#equilibrate without GD

fix             nvt bulk nvt temp $T $T ${tdamp}
fix_modify      nvt temp myTp
fix             2 bulk enforce2d

run             ${equil}

#####################################################################
#initialize the COM velocity and run to achieve steady-state

#calculate velocity to add: V=J/rho_total
variable        Vadd            equal $J*lx*ly/count(bulk)

#first remove any COM velocity, then add back the streaming velocity
velocity        bulk zero linear
velocity        bulk set ${Vadd} 0.0 0.0 units box sum yes mom no

fix             GD bulk flow/gauss 1 0 0 #energy yes
#fix_modify     GD energy yes

run             ${stabil}

#####################################################################
#collect data

#print the applied force and total flux to ensure conservation of Jx
variable        Fapp equal f_GD[1]
compute         vxBulk bulk reduce sum vx
compute         vyBulk bulk reduce sum vy
variable        invVol equal 1.0/(lx*ly)
variable        jx equal c_vxBulk*${invVol}
variable        jy equal c_vyBulk*${invVol}
variable        curr_step equal step
variable        p_Fapp format Fapp %.3f
variable        p_jx format jx %.5g
variable        p_jy format jy %.5g
fix             print_vCOM all print ${dump_rate} &
                ""${curr_step} ${p_Fapp} ${p_jx} ${p_jy}"" file GD.out screen no &
                title ""timestep Fapp Jx Jy""

#compute IK1 pressure profile
#see Todd, Evans, and Davis, Phys. Rev. E 52(2) 1995, p. 1627
#use profile-unbiased temperature to remove the streaming velocity
#from the kinetic part of the pressure
compute         spa bulk stress/atom myTp

#for the pressure profile, use the same grid as the PUT
compute         chunkX bulk chunk/atom bin/1d x lower ${dX} units box

#output pressure profile and other profiles
#the pressure profile is (-1/2V)*(c_spa[1] + c_spa[2]), where
#V is the volume of a slice
fix             profiles bulk ave/chunk 1 1 ${dump_rate} chunkX &
                vx density/mass  c_spa[1] c_spa[2] &
                file x_profiles ave running overwrite

#compute velocity profile across the pipe with a finer grid
variable        dYnew equal ${dY}/10
compute         chunkY bulk chunk/atom bin/1d y center ${dYnew} units box &
                region pipe
fix             velYprof bulk ave/chunk 1 1 ${dump_rate} chunkY &
                vx file Vy_profile ave running overwrite

#full trajectory
# dump          7 bulk custom ${dump_rate} bulk.lammpstrj id type x y z
# dump_modify     7 sort id

run             ${run}
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff lmp_control pair style with pair coefficients * * ffield.reax.AB H B N with a timestep of 0.25 running for 2000 steps.","# REAX potential for Nitroamines system
# .....

units           real

atom_style      charge
read_data       data.AB

pair_style      reaxff lmp_control
pair_coeff      * * ffield.reax.AB H B N

neighbor        2 bin
neigh_modify    every 10 delay 0 check no

fix             1 all nve
fix             2 all qeq/reax 1 0.0 10.0 1e-6 param.qeq
fix             3 all temp/berendsen 500.0 500.0 100.0

timestep        0.25
thermo 100
#dump           1 all atom 30 dump.reax.ab

run             2000
"
"Generate a LAMMPS input script for a general simulation of an atomic system and f p p boundary conditions running for 5000 steps.","atom_style  atomic
lattice         fcc 1.0
region    simRegion block -50 50  0 1 0 1
boundary  f p p
create_box  1 simRegion
mass    1 39.95 # need to keep this
atom_modify     sort 0 1

lattice         fcc 5.405 origin 0.25 0.25 0.25
region          atcRegion block -6.25 19.25 -3 3 -3 3
fix             AtC all   atc shear     Ar_visc_no_atoms.mat
#               ID  part keywords    nx ny nz region    periodicity
fix_modify      AtC mesh create 12 1  1   atcRegion f p p
# add nodesets
#               ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
fix_modify      AtC mesh create_nodeset rbc  19.2  19.3   -INF  INF   -INF  INF
fix_modify	AtC mesh create_nodeset lbc -6.3 -6.2 -INF INF -INF INF
fix_modify     AtC  fix velocity x all 0.
fix_modify     AtC  initial velocity y all 0.
fix_modify     AtC  fix velocity z all 0.

# turn on kinetostat
reset_timestep 0
fix_modify      AtC  reset_time
fix_modify      AtC  fix velocity y rbc 0.1
fix_modify	AtC fix velocity y lbc 0.

# output commands
fix_modify      AtC  output shear_no_atomsFE 200 text binary
# set-up non-equilibrium IC
thermo          100
run             5000
"
"Generate a LAMMPS input script for a NVE simulation of an electron system using eff/cut 100.0 pair style with pair coefficients * * and f f f boundary conditions with a timestep of 0.001 running for 200000 steps.","variable	sname index adamantane_ionized

units 		electron
newton		on
boundary        f f f

atom_style	electron

read_data  	data.${sname}

pair_style      eff/cut 100.0
pair_coeff 	* *

comm_modify	vel yes

compute		effTemp all temp/eff

thermo		1000
thermo_style	custom step pe temp press
thermo_modify	temp effTemp

# Minimization
min_style       cg
dump            1 all xyz 500 ${sname}.min.xyz
compute         1 all property/atom spin eradius erforce
dump            2 all custom 500 ${sname}.min.lammpstrj id type x y z c_1[1] c_1[2] fx fy fz c_1[3]
min_modify	line quadratic
minimize        0.0 1.0e-5 10000 100000

undump		1
undump		2

#restart		timestep

# set velocities for nve
#velocity	all create 300.0 4928459 dist uniform

# NVE
timestep	0.001

fix		1 all nve/eff
dump            1 all xyz 1000 ${sname}.nve.xyz
dump            2 all custom 1000 ${sname}.nve.lammpstrj id type x y z c_1[1] c_1[2] fx fy fz c_1[3]
#restart		1000 ${sname}.nve.restart1 ${sname}.nve.restart2

run		200000

unfix		1
undump		1
undump		2

"
"Generate a LAMMPS input script for a general simulation of an rheo system using rheo ${cut} artificial/visc ${zeta} #rho/damp ${Dr} pair style with pair coefficients * * and f s p boundary conditions with a timestep of ${dt_max} running for 30000 steps.","# ------ 2D dam break ------ #

dimension          2
units              lj
atom_style         rheo
boundary           f s p
comm_modify        vel yes
newton             off

# ------ Create simulation box ------ #

variable           n equal 1.0
variable           cut equal 2.2
variable           dx equal 3.0

region             box block -1 150 -1 80 -0.1 0.1 units box
create_box         2 box
lattice            hex ${n}

region             fluid block $(xlo+v_dx+1.0) $(xlo+40.0) $(ylo+v_dx+1.0) $(yhi-20.0) EDGE EDGE units box
region             walls1 block $(xlo+v_dx) $(xhi-v_dx) $(ylo+v_dx) $(yhi-v_dx) EDGE EDGE side out units box
region             walls2 block EDGE EDGE EDGE $(yhi-v_dx) EDGE EDGE side in units box
region             walls intersect 2 walls1 walls2

create_atoms       1 region fluid
create_atoms       2 region walls

group              fluid type 1
group              rig type 2

# ------ Model parameters ------ #

variable           rho0 equal 1.0
variable           mp equal ${rho0}/${n}
variable           cs equal 1.0
variable           zeta equal 0.1
variable           dt_max equal  0.1*${cut}/${cs}/3
variable           eta equal 0.1
variable           Dr equal 0.1

mass               1 ${mp}
mass               2 $(2*v_mp)
set                group all rheo/rho ${rho0}

set                group all rheo/status 0
set                group rig rheo/status 1

timestep           ${dt_max}

pair_style         rheo ${cut} artificial/visc ${zeta} #rho/damp ${Dr}
pair_coeff         * *

# ------ Fixes & computes ------ #

fix                1 all rheo ${cut} quintic 10 &
                              surface/detection coordination 22 8 &
                              rho/sum
fix                2 all rheo/viscosity * constant ${eta}
fix                3 all rheo/pressure * linear
fix                4 all gravity 1e-3 vector 0 -1 0
fix                5 rig setforce 0.0 0.0 0.0
fix                6 all enforce2d

compute            rho all rheo/property/atom rho
compute            p all rheo/property/atom pressure
compute            surf all rheo/property/atom surface
compute            sn all rheo/property/atom surface/n/x surface/n/y

# ------ Output & Run ------ #

thermo             20
thermo_style       custom step time ke press

#dump               1 all custom 200 atomDump id type x y vx vy fx fy c_rho c_surf c_p c_sn[*]

run                30000
"
"Generate a LAMMPS input script for a NVE simulation of an full system with a timestep of 0.00025.","# AIMD test of two UO2 molecules with LATTE in MDI stand-alone mode

units           metal
atom_style      full

read_data       data.2uo2

velocity        all create 300.0 87287 loop geom

neighbor        1.0 bin
neigh_modify    every 1 delay 0 check yes

timestep        0.00025

fix             1 all nve

fix             2 all mdi/qm virial yes elements U O

thermo_style    custom step temp pe etotal press
thermo          5

#dump            1 all custom 1 dump.aimd.mpi &
#                id type x y z vx vy vz fx fy fz

mdi             plugin latte_mdi mdi ""-role ENGINE -name LATTE -method LINK"" &
                extra latte.in.uo2 command ""run 20""
"
"Generate a LAMMPS input script for a NVE simulation of an spin system using spin/exchange 4.0 pair style with pair coefficients * * exchange 4.0 0.3593 1.135028015e-05 1.064568567 and p p p boundary conditions with a timestep of 0.0001 running for 1000 steps.","# fcc cobalt in a 3d periodic box

units 		metal
atom_style 	spin

dimension 	3
boundary	p p p

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice 	hcp 2.5071
region 		box block 0.0 5.0 0.0 5.0 0.0 5.0
create_box 	1 box
create_atoms 	1 box

# setting mass, mag. moments, and interactions for cobalt

mass		1 58.93

set 		group all spin/random 31 1.72

pair_style	spin/exchange 4.0
pair_coeff 	* * exchange 4.0 0.3593 1.135028015e-05 1.064568567

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin zeeman 0.0 0.0 0.0 1.0
fix 		2 all langevin/spin 100.0 0.01 21

fix 		3 all nve/spin lattice frozen
timestep	0.0001

# compute and output options

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo_style    custom step time v_magnorm pe v_emag temp etotal
thermo          100

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
dump 		100 all custom 1 dump.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3] c_outsp[4] c_outsp[5] c_outsp[6] c_outsp[7]

run 		1000
write_restart 	restart_hcp_cobalt.equil
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut ${rc} pair style with pair coefficients * * 1 1 running for 5000 steps.","# sample LAMMPS input script for viscosity of 2d LJ liquid
# Muller-Plathe via fix viscosity

# settings

variable	x equal 20
variable	y equal 20

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

lattice         sq2 ${rho}
region          simbox block 0 $x 0 $y -0.1 0.1
create_box      1 simbox
create_atoms    1 box

pair_style      lj/cut ${rc}
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        3 all enforce2d

# equilibration run

thermo          1000
run	        5000

unfix		2

# turn on Muller-Plathe driving force and equilibrate some more

velocity	all scale $t

fix		4 all viscosity 100 x y 20

compute         layers all chunk/atom bin/1d y center 0.05 units reduced
fix		5 all ave/chunk 20 50 1000 layers vx file profile.mp.2d

# equilibration run

variable	dVx equal f_5[11][3]-f_5[1][3]

thermo          1000
thermo_style	custom step temp epair etotal press f_4 v_dVx
run		20000

# data gathering run
# reset fix viscosity to zero flux accumulation

unfix		4
fix		4 all viscosity 100 x y 20

variable	visc equal -(f_4/(2*(step*0.005-125)*lx+1.0e-10))/(v_dVx/(ly/2))
fix		vave all ave/time 1000 1 1000 v_visc ave running start 26000

thermo_style	custom step temp f_4 v_dVx v_visc f_vave

# only need to run for 10000 steps to make a good 100-frame movie

#dump	        1 all custom 100 dump.mp.2d id type x y z vx

#dump		2 all image 100 image.*.jpg vx type zoom 1.6 adiam 1.2
#dump_modify	2 pad 5 amap -0.7 0.7 ca 0.0 2 min blue max red

run	        50000
"
"Generate a LAMMPS input script for a general simulation with a timestep of ${delta_t} running for 500 steps.","## This script first uses fix qtb to equilibrate liquid methane to an initial state with quantum nuclear correction and then simulate shock induced chemical reactions through the quantum thermal bath multi-scale shock technique
#The default system size may take a while to run you can change to a smaller size
variable                x_rep equal 5                                                                           #x-direction replication number
variable                y_rep equal 5                                                                           #y-direction replication number
variable                z_rep equal 10                                                                          #z-direction replication number
variable                temperature equal 110.0                                                                 #Target quantum temperature (K in real units)
variable                delta_t equal 0.25                                                                      #MD timestep length (fs in real units)
variable                damp_qtb equal 200                                                                      #1/gamma where gamma is the friction coefficient in quantum thermal bath (fs in real units)
variable                v_msst equal 0.122                                                                      #Shock velocity (Angstrom/fs in metal units)
variable                q_msst equal 25.0                                                                       #Box mass-like parameter in the MSST (mass^2/length^4, where mass=grams/mole and length=Angstrom in real units)
variable                mu_msst equal 0.9                                                                       #Artificial viscosity in the MSST (mass/length/time, where mass=grams/mole, length=Angstrom and time=fs in real units)
variable                tscale_msst equal 0.01                                                                  #Temperature reduction parameter in the MSST (unitless)
variable                eta_qbmsst equal 1.0                                                                    #Coupling constant between the shock and the quantum thermal bath (unitless constant)


##The included part first constructs a liquid methane structure of a given size. It then uses fix qtb to equilibrate the computational cell to the specified temperature and pressure.
include                 methane_qtb.mod


##Shock compression with quantum nuclear corrections
reset_timestep          0
fix                     shock all qbmsst z ${v_msst} q ${q_msst} mu ${mu_msst} tscale ${tscale_msst} damp ${damp_qtb} f_max 0.3 N_f 50 seed 35082 eta ${eta_qbmsst} beta 400 T_init ${temperature}
fix_modify              shock energy yes                
variable                dhug equal f_shock[1]
variable                dray equal f_shock[2]
variable                lgr_vel equal f_shock[3]
variable                lgr_pos equal f_shock[4]
variable                T_qm equal f_shock[5]                                                                   #Temperature with quantum nuclear correction
thermo_style            custom step v_T_qm press etotal vol lx ly lz pzz v_dhug v_dray v_lgr_vel v_lgr_pos
thermo                  20
timestep                ${delta_t}
#restart                 1000 restart
run                     500
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using eam/opt pair style with pair coefficients * * cuu3.eam and p p p boundary conditions with a timestep of 2e-3 running for 6500000 steps.","# 3D copper block simulation
boundary    p p p
units       metal
atom_style  atomic

# geometry
read_data	data.pos

# EAM potential
pair_style  	eam/opt
pair_coeff   	* * cuu3.eam
neighbor       0.5 nsq
neigh_modify   every 1 delay 0 check yes

#Langevin random seed
variable r equal 57085
variable t equal 300
variable d equal 1

# initialize
velocity all create $t 28459 rot yes dist gaussian mom yes
reset_timestep 0

# fixes 
fix      1 all npt temp $t $t $d iso 1. 1. 1. pchain 8 drag 1.0
fix      2 all phonon 10 50000 500000 map.in CuPhonon

#
timestep 2e-3

# output
#                    1    2    3  4  5     6   7  8  9  10 11 12
thermo_style  custom step temp pe ke press vol lx ly lz xy xz yz
thermo  100

restart 2000000 restart.one restart.two

# execution
run 	 6500000
write_restart Restart.final
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using smatb pair style with pair coefficients 1 1 2.89	10.85	3.18	0.1031	1.1895	4.08707719	5.0056268338740553 and p p p boundary conditions with a timestep of 0.005 running for 10000 steps.","# -*- lammps -*-

units           metal
atom_style      atomic
boundary	p p p

read_data	AgCuPancake.data

pair_style	smatb
#   	         NN     p	    q	    a  	    qsi	    cutOff_Start	cutOff_End
pair_coeff	1 1 2.89	10.85	3.18	0.1031	1.1895	4.08707719	5.0056268338740553
pair_coeff	1 2 2.725	10.70	2.805	0.0977	1.2275	4.08707719	4.4340500673763259
pair_coeff	2 2 2.56	10.55	2.43	0.0894	1.2799	3.62038672	4.4340500673763259


neighbor	8.0 bin
neigh_modify	every 1 delay 0 check yes

thermo          1
minimize       1.0e-8 1.0e-10 10000 100000

velocity            all create 600.0 761341 rot yes mom yes

fix		1 all nve
thermo		10
timestep	0.005

#dump		1 all atom 50 dump.smatb

#dump		2 all image 10 image.*.jpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	2 pad 3 element Ag Cu

#dump		3 all movie 10 movie.mpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	3 pad 3 element Ag Cu

run		10000"
"Generate a LAMMPS input script for a NVE simulation of an molecular system using hybrid dpd  1.0  1.0  ${rseeddpd} srp/react 0.8 * mid break pair style with pair coefficients *5     *5   dpd   78.000    4.5   1.0 and p  p  p boundary conditions with a timestep of 0.02 running for ${mainsteps} steps.","## srp_react example script
## Author: Vaibhav Palkar
##
## Simulates controlled degradation of a nanogel particle 
## in a simulation box and prints statistics regarding
## the fraction of bonds broken over time.

variable       rseeddpd  equal  26817
variable       rseedvel  equal  5991
variable       breakstep equal  10
variable       probbreak  equal 0.0009
variable       rseedbreak equal 6777

# simulation time 
#***********************************************
variable       mainsteps     equal  10000

# simulation setup
#***********************************************
units          lj
atom_style     molecular
boundary       p  p  p
bond_style     harmonic
#lattice        fcc   3.0
comm_modify    cutoff 4.0 vel yes

# initial nanogel
#***********************************************
read_data   gel_equil.dat

# define groups, create solvent atoms 
#**************************************************
group          Npoly         type   1 2 3 4
group          water         type   5
group          N_all         type   1 2 3 4 5

# density check
#***********************************************
variable       N_atoms  equal  count(all)
variable       tdens equal count(all)/vol
print          ""The system density is now ${tdens}""

# bond break settings
# #***********************************************
fix            break  N_all     bond/break  ${breakstep}   2   0  prob   ${probbreak}    ${rseedbreak}

# interaction parameter setting
#***********************************************
mass             *   1.0
bond_coeff       *   500.0   0.70
special_bonds  lj   1  1  1
newton         on

pair_style     hybrid dpd  1.0  1.0  ${rseeddpd} srp/react 0.8 * mid break
#***********************************************
pair_coeff     *5     *5   dpd   78.000    4.5   1.0
pair_coeff     *4      5   dpd   79.500    4.5   1.0
pair_coeff     *5      6   none
pair_coeff      6      6   srp/react   80.00 0.800

# initial velocity
#***********************************************
velocity       all create 1.0 ${rseedvel} dist gaussian mom yes

# integrator control
#***********************************************
neighbor       0.3 bin
neigh_modify   every 1 delay 5 check  no
timestep       0.02

# Access variables of fix bond/break
#**********************************************
variable      Nbreak    equal  f_break[2]   # Number of bonds broken
variable      TIME      equal  time

# ensemble setting
#***********************************************
fix            1  all  nve

# print bonds breaking stats
# ***********************************************
variable TotBreak equal 100 # total breakable bonds in current system
fix print_bonds_broken all print 100 ""${TIME} ${Nbreak} $((v_TotBreak-v_Nbreak)/v_TotBreak)"" file bonds_broken.txt screen no title ""time bonds_broken fraction_bonds_intact""

# thermo output
#***********************************************
thermo         100
thermo_style   custom step temp pe ke etotal epair
thermo_modify  flush  yes  norm  no

reset_timestep 0
#dump          1 Npoly   custom 5000 traj.lammpstrj id type x y z
#*********************************************
run           ${mainsteps}
#***********************************************
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 10 steps.","# 3d Lennard-Jones melt - MDI driver script

variable        x index 5
variable        y index 5
variable        z index 5

units           lj
atom_style      atomic

lattice         fcc 0.8442
region          box block 0 $x 0 $y 0 $z
create_box      1 box
create_atoms    1 box
mass            1 1.0

velocity        all create 1.44 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

# NVE
fix             1 all nve
# NPT
#fix             1 all npt temp 1.0 1.0 0.1 iso 1.0 1.0 1.0

thermo_style    custom step temp pe etotal press vol
thermo          1

run             10
"
"Generate a LAMMPS input script for a general simulation of an atomic system and f p p boundary conditions with a timestep of 20 running for 3000 steps.","# needs description
#AtC thermal Coupling
# DESCRIPTION: no atoms, FE region with full periodic boundary conditions.
units       real
atom_style  atomic
# create domain
lattice         fcc 5.25623 origin 0.25 0.25 0.25
region          feRegion block 0 100 0 10 0 10 
boundary        f p p
create_box      1 feRegion
atom_modify     sort 0 1
mass            1 39.95 # need to keep this
#               ID  group atc PhysicsType ParameterFile
fix             AtC all   atc elastic     Ar_CauchyBorn.mat
#               ID  part  keywords    nx ny nz region
fix_modify      AtC mesh  create 25  1  1 feRegion f p p
fix_modify      AtC mesh  quadrature face
# initial conditions 
fix_modify  AtC  initial displacement x all 0.0
fix_modify  AtC  initial displacement y all 0.0
fix_modify  AtC  initial displacement z all 0.0
fix_modify  AtC  initial velocity x all 0.0
fix_modify  AtC  initial velocity y all 0.0
fix_modify  AtC  initial velocity z all 0.0
# set node sets and bcs
#           ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
fix_modify  AtC mesh create_nodeset lbc   -1    1   -1   11   -1   11
fix_modify  AtC mesh create_nodeset rbc1  83   85   -1   11   -1   11
fix_modify  AtC mesh create_nodeset rbc2  88   89   -1   11   -1   11
fix_modify  AtC mesh create_nodeset rbc3  92   93   -1   11   -1   11
fix_modify  AtC mesh create_nodeset rbc4  95   97   -1   11   -1   11
fix_modify  AtC mesh create_nodeset rbc5  99  101   -1   11   -1   11
fix_modify  AtC  fix displacement x lbc 0.0
fix_modify  AtC  initial displacement x rbc1 0.0004
fix_modify  AtC  initial displacement x rbc2 0.0014
fix_modify  AtC  initial displacement x rbc3 0.0026
fix_modify  AtC  initial displacement x rbc4 0.0036
fix_modify  AtC  initial displacement x rbc5 0.004
thermo_style  custom step cpu
fix_modify    AtC  output no_atoms_cbFE 500 text
timestep   20
thermo		100
run 	   3000
"
"Generate a LAMMPS input script for a NVE simulation of an bond system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 and p p f boundary conditions running for 10000 steps.","# sample surface deposition script for molecules

units		lj
atom_style      bond
boundary        p p f

lattice		fcc 1.0
region          box block 0 5 0 5 0 10
create_box      3 box bond/types 1 extra/bond/per/atom 1

region		substrate block INF INF INF INF INF 3
create_atoms	1 region substrate

pair_style	lj/cut 2.5
pair_coeff	* * 1.0 1.0
pair_coeff	1 2 1.0 1.0 5.0
mass		* 1.0

bond_style	harmonic
bond_coeff      1 5.0 1.0

neigh_modify	delay 0

group		addatoms type 2
region          mobile block 0 5 0 5 2 INF
group		mobile region mobile

compute		add addatoms temp
compute_modify	add dynamic/dof yes extra/dof 0

fix		1 addatoms nve
fix		2 mobile langevin 0.1 0.1 0.1 587283
fix		3 mobile nve

molecule        dimer molecule.dimer
region          slab block 0 5 0 5 8 9
fix		4 addatoms deposit 100 0 100 12345 region slab near 1.0 &
                mol dimer vz -1.0 -1.0
fix		5 addatoms wall/reflect zhi EDGE

thermo_style	custom step atoms temp epair etotal press
thermo          100
thermo_modify	temp add lost/bond ignore lost warn

#dump		1 all atom 50 dump.deposit.atom

#dump		2 all image 50 image.*.jpg type type &
#		axes yes 0.8 0.02 view 80 -30
#dump_modify	2 pad 5

#dump		3 all movie 50 movie.mpg type type &
#		axes yes 0.8 0.02 view 80 -30
#dump_modify	3 pad 5

run             10000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/cut 13.000000 pair style and f f f boundary conditions with a timestep of 0.0005 running for ${nsteps} steps at temperature 300.0.","# AtC electric field module and BCs
# This benchmark using fix_charge to set up a charged surface
# and computes the resulting double layer dynamics
log double_layer.log
echo both

units 		metal
atom_style 	full
dimension 	3
neighbor 	2 bin
neigh_modify 	every 1 check yes 
boundary 	f f f

timestep	0.0005
thermo          100
dielectric      81.

newton off

pair_style lj/cut 13.000000
pair_modify mix arithmetic
read_data waternve.atm
reset_timestep 0

variable nsteps equal 1000
variable dumpfreq equal ${nsteps}/10
variable nx equal 4
variable ny equal 4
variable nz equal 4
variable x_min equal -19.38
variable x_max equal 19.38
variable x_goldmin equal -11.22
variable x_goldmax equal 11.22
variable x_fluidmin equal ${x_goldmin}
variable x_fluidmax equal ${x_goldmax}
variable x_wallmin equal ${x_goldmin}-1.5
variable x_wallmax equal ${x_goldmax}+1.5
variable y_min equal -19.38
variable y_max equal 19.38
variable y_goldmin equal -11.22
variable y_goldmax equal 11.22
variable surface_charge equal -0.3125/(4.08*4.08)
variable y_fluidmin equal ${y_goldmin}
variable y_fluidmax equal ${y_goldmax}
variable y_wallmin equal ${y_goldmin}-1.5
variable y_wallmax equal ${y_goldmax}+1.5
variable downshift equal 2.5
variable zshiftlatt equal 1-${downshift}/4.08
variable z_min equal -20.4-${downshift}+0.25*4.08
variable z_max equal 22.44+1.5
variable z_goldmin equal -12.24-${downshift}+0.25*4.08
variable z_goldmax equal -${downshift}+0.25*4.08
variable z_goldtopmin equal ${z_goldmax}-0.5*4.08
variable z_goldtopmax equal ${z_goldmax}
variable z_fluidmin equal 0.
variable z_fluidmax equal 22.44
variable z_wallmax equal ${z_max}

lattice sc 8.16 origin 0 0 0.75

group pos type 4
group neg type 5
group allfluid type 3 4 5

compute fluidT allfluid temp
thermo_style custom step epair emol etotal press c_fluidT

fix zhiwall allfluid wall/lj93 zhi ${z_wallmax} 0.0195 3.45 10.000000 units box
fix xlowall allfluid wall/lj93 xlo ${x_wallmin} 0.0195 3.45 10.000000 units box
fix xhiwall allfluid wall/lj93 xhi ${x_wallmax} 0.0195 3.45 10.000000 units box
fix ylowall allfluid wall/lj93 ylo ${y_wallmin} 0.0195 3.45 10.000000 units box
fix yhiwall allfluid wall/lj93 yhi ${y_wallmax} 0.0195 3.45 10.000000 units box

group solvent type 3
fix fluidnvt solvent nvt temp 300.0 300.0 0.100 drag 0.2

##########################################################################
region ATC_BOX block ${x_wallmin} ${x_wallmax} ${y_wallmin} ${y_wallmax} ${z_goldtopmin} ${z_wallmax} units box
group ATC_ATOMS type 4 5
fix ATC ATC_ATOMS atc species_electrostatic Ar_species_dl.mat
fix_modify ATC add_species P group pos
fix_modify ATC add_species N group neg
fix_modify ATC mesh create ${nx} ${ny} ${nz} ATC_BOX f f f
fix_modify ATC atom_element_map eulerian 1
fix_modify ATC internal_quadrature off

fix_modify ATC initial mass_density all 0.
fix_modify ATC mesh create_faceset BOTTOM_FACE -INF INF -INF INF ${z_goldtopmin} INF
## OLD
fix_modify ATC extrinsic fix_charge BOTTOM_FACE ${surface_charge}
## NEW
# ERROR: Poisson solver needs Dirichlet data
#fix_modify ATC  control charge conductor ${surface_charge}
#fix_modify ATC  control charge effective_charge ATC_ATOMS BOTTOM_FACE
## END

fix_modify ATC output double_layerFE ${dumpfreq} text binary
dump chargenve all atom ${dumpfreq} double_layer.dmp 

run ${nsteps}
"
"Generate a LAMMPS input script for a general simulation of an electron system using eff/cut 1000.0 limit/eradius pressure/evirials pair style with pair coefficients * * and p p p boundary conditions running for 0 steps.","# Created 2010-11-28

# General parameters

variable	sname index CH4fc.bohr

units		electron
newton		on
boundary	p p p

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 1000.0 limit/eradius pressure/evirials
pair_coeff      * *

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

comm_modify	vel yes

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo          10
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp press effPress

run	0


"
"Generate a LAMMPS input script for a NVT simulation of an full                                 #Molecule + charge system using lj/cut/coul/long 15.0 15.0           #LJ with 15.0ang cutoff, Coulomb with 15.0ang cutoff pair style with pair coefficients 1 1 0.053654828567 2.8000            #Carbon-Carbon LJ (dispersion) parameters and p p p				     #Periodic Boundaries boundary conditions running for 60000 steps.","# TraPPE Carbon Dioxide NVT

#NOTES:
# The variable ""infile"" is read from the command line argument:
#  E.G., ""lmp_serial -in foo -var infile bar1 -var temp bar2
#  foo = input filename
#  bar1 = input value for variable infile (Input configuration and molecular topology)
#  bar2 = put value for variable temp (temperature, in Kelvin units)
# The input file specifies the following:
#   System volume, conformation, atom types, bond types, angles types
#   Initial configuration
#   The molecular topology
# The configuration in the restart file is not assumed to be a relaxed configuration

units		real	                             #Angstroms, g/mol, etc.
atom_style	full                                 #Molecule + charge

#timestep	2.0				     #Set the integrator time step (default = 1.0fs for real units)

boundary        p p p				     #Periodic Boundaries
read_data       ${infile}

replicate	1 1 1				     #cell replication (none = 1 1 1)

variable        dt equal dt
variable        ext_temp equal ${temp}
variable        Tdamp equal 100.0*${dt}		     #units are time units, LAMMPS suggestion is 100 time steps 
		      	    			     #(e.g. 50fs if time step is 0.5fs)


pair_style	lj/cut/coul/long 15.0 15.0           #LJ with 15.0ang cutoff, Coulomb with 15.0ang cutoff
pair_modify     tail yes			     #Analytic Long-range Tail corrections, for the LJ interactions
bond_style      harmonic
angle_style     harmonic
kspace_style	pppm 1.0e-4                          #PPPM Ewald, relative error in forces
#kspace_style	ewald 1.0e-4                         #Conventional Ewald method , relative error in forces = 1.0e-04
                                                     #kspace uses tinfoil/conducting boundary conditions by default
						     #NOTE: This script lets LAMMPS set the Ewald damping parameter
						     # and number of k-vectors automatically.
group           carbon type 1
group           oxygen type 2

pair_coeff      1 1 0.053654828567 2.8000            #Carbon-Carbon LJ (dispersion) parameters
pair_coeff	2 2 0.156990053954 3.05000           #Oxygen-Oxygen LJ (dispersion) parameters
pair_coeff	1 2 0.091778398502 2.9250            #Carbon-Oxygen LJ (dispersion) parameters [Lorentz-Berthelot Mixing Rule]

bond_style	harmonic   			     #Sets the bond type as harmonic
angle_style	harmonic			     #Sets the triplet bond type as harmonic
dihedral_style	none				     #TraPPE CO2 has no dihedrals (quadruplets)
improper_style	none				     #TraPPE CO2 has no improper quadruplets

bond_coeff	1 5000.00 1.160                      #Oxygen-Carbon bond parameters (1.160~ang)
angle_coeff	1 500.0 180.00			     #Oxygen-Carbon-Oxygen angle parameters (angle=180.0deg)
		  				     #NOTE: harmonic moduli do not matter, since the rigid bonds are preserved by rigid fix

#Neighbor List Parameters
#neighbor        2.0 bin			     #Skin (default = 2.0 bin for real units)
#neigh_modify    delay 1 every 1 check no
                                                     #  delay N =  never delay until at least N steps after previous build
                                                     #  every N =  build list every N steps
                                                     #  check no = build whenever delay/every criteria are met
                                                     #  check yes = build whenever delay/every criteria are met and atom moved > skin/2

#Create initial velocity distribution
velocity all create ${ext_temp} 432567 dist uniform
		      	    	      	      	     #Set uniform distribution with T = {ext_temp}
		      	    	      	      	     #Seed integer = 432567
						     #dist uniform is the LAMMPS Default

#Reset the time step counter
reset_timestep  0                                    #Reset the time step counter to 0

#Ensemble set-up: NVT ensemble, thermostatted by Nose-Hoover a chained thermostat, set at temperature $ext_temp
fix             2 all rigid/nvt molecule temp ${ext_temp} ${ext_temp} ${Tdamp}
		      	       		   	     #start temperature = ext_temp
		      	       		   	     #end temperature = ext_temp
		      	    	      	      	     #Tdamp (in time units, fs)

#Output Style
variable        Nevery equal 20                      #Specify the distance (in timesteps) between samples for computing ensemble aver$
                                                     #  (Interval between samples in a block)
variable        Nrepeat equal 50                     #Specify the number of samples per output  of thermodynamic averages
                                                     #  (Samples per block output)
variable        Nfreq equal ${Nevery}*${Nrepeat}     #Specify the dump interval (in timesteps)
                                                     #  (Some people call these blocks)
variable        PotentialEnergy equal epair          #Call the intermolecular potential energy $PotentialEnergy
variable        Pressure equal press                 #Call the pressure $Pressure
variable        Temperature equal temp               #Call the instantaneous temperature $Temperature
variable        Density equal density                #Call the instantaneous density $Density (will not change for NVT)

fix             3 all ave/time ${Nevery} ${Nrepeat} ${Nfreq} v_Temperature v_Density v_PotentialEnergy v_Pressure file ave.dens_18.0molL.out format %.8g
thermo          1000                                 #Specify the interval between screen output of thermodynamic averages
#thermo  100
thermo_style    custom step temp density epair press #Format for screen output of thermodynamics
                                                     #  (MD step, temperature, internal energy, pressure)
#Run it!
run		60000
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using comb pair style with pair coefficients * * ffield.comb Cu and p p p boundary conditions with a timestep of 0.00020 running for 10 steps.","# Pure Cu crystal, structure created by LAMMPS, qeq off

units		metal
atom_style	charge
dimension       3
boundary        p p p

lattice  	fcc 3.615
region		box block 0 4 0 4 0 4
create_box	1 box
create_atoms	1 box
mass		1 63.54

pair_style	comb
pair_coeff	* * ffield.comb Cu

neighbor	0.5 bin
neigh_modify	every 1 delay 1 check yes 

fix		1 all nve
timestep        0.00020

thermo_style	custom step temp etotal pe evdwl ecoul press vol lx ly lz xz
thermo_modify	norm yes
velocity	all create 10.1 2398378
thermo	  	1

#dump		1 all custom 10 tmp.dump id type xs ys zs q vx vy vz fx fy fz
#dump_modify	1 append yes element Cu

#dump		2 all image 10 image.*.jpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	2 pad 2 element Cu

#dump		3 all movie 10 movie.mpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	3 pad 2 element Cu

run  		10
"
"Generate a LAMMPS input script for a general simulation of an hybrid rheo bond system using hybrid/overlay rheo ${cut} artificial/visc ${zeta} rheo/solid pair style with pair coefficients * * rheo and m m p boundary conditions with a timestep of 0.1 running for 30000 steps.","# ------ 2D water balloon ------ #

dimension          2
units              lj
atom_style         hybrid rheo bond
boundary           m m p
comm_modify        vel yes
newton             off

region             box block -40 40 0 80 -0.01 0.01 units box
create_box         1 box bond/types 1 extra/bond/per/atom 15 extra/special/per/atom 50

region             fluid sphere -10 40 0 30 units box side in
lattice            hex 1.0
create_atoms       1 region fluid

region             shell sphere -10 40 0 27 units box side out
group              shell region shell

set                group shell rheo/status 1
set                group all vx 0.005 vy -0.04

# ------ Model parameters ------#

variable           cut equal 3.0
variable           n equal 1.0
variable           rho0 equal 1.0
variable           cs equal 1.0
variable           mp equal ${rho0}/${n}
variable           zeta equal 0.05
variable           kappa equal 0.01*${rho0}/${mp}
variable           dt_max equal 0.1*${cut}/${cs}/3
variable           eta equal 0.05
variable           Cv equal 1.0
variable           L equal 1.0
variable           Tf equal 1.0

mass               * ${mp}
timestep           0.1

pair_style         hybrid/overlay rheo ${cut} artificial/visc ${zeta} rheo/solid
pair_coeff         * * rheo
pair_coeff         * * rheo/solid 1.0 1.0 1.0

special_bonds      lj 0.0 1.0 1.0 coul 0.0 1.0 1.0
create_bonds       many shell shell 1 0 1.5
special_bonds      lj 0.0 1.0 1.0 coul 1.0 1.0 1.0

bond_style         bpm/spring
bond_coeff         1 1.0 1.0 1.0

# A lower critical strain allows the balloon to pop
#bond_coeff         1 1.0 0.05 1.0

# ------ Drop balloon ------#

fix             1 all rheo ${cut} quintic 0 &
                           shift &
                           surface/detection coordination 22 8
fix             2 all rheo/viscosity * constant ${eta}
fix             3 all rheo/pressure * linear
fix             4 all wall/harmonic ylo EDGE 2.0 1.0 1.0
fix             5 all enforce2d

compute         rho all rheo/property/atom rho
compute         phase all rheo/property/atom phase
compute         nbond all nbond/atom

# ------ Output & Run ------ #

thermo          200
thermo_style    custom step time ke press atoms

#dump            1 all custom 200 atomDump id type x y vx vy fx fy c_phase c_nbond c_rho
run             30000
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using sw pair style with pair coefficients * * Si.sw Si Si Si Si Si Si Si Si and p p p boundary conditions with a timestep of 1.0e-3 running for 100 steps.","# Simple regression tests for threebody potentials

# NOTE: These are not intended to represent real materials

units           metal

atom_style      atomic
atom_modify     map array
boundary        p p p
atom_modify     sort 0 0.0

# temperature

variable t equal 1800.0

# cubic diamond unit cell

variable a equal 5.431
lattice         custom $a               &
                a1 1.0 0.0 0.0          &
                a2 0.0 1.0 0.0          &
                a3 0.0 0.0 1.0          &
                basis 0.0 0.0 0.0       &
                basis 0.0 0.5 0.5       &
                basis 0.5 0.0 0.5       &
                basis 0.5 0.5 0.0       &
                basis 0.25 0.25 0.25    &
                basis 0.25 0.75 0.75    &
                basis 0.75 0.25 0.75    &
                basis 0.75 0.75 0.25

region          myreg block     0 4 &
                                0 4 &
                                0 4

create_box      8 myreg
create_atoms    1 region myreg &
                basis 1 1  &
                basis 2 2  &
                basis 3 3  &
                basis 4 4  &
                basis 5 5  &
                basis 6 6  &
                basis 7 7  &
                basis 8 8

mass            *       28.06

velocity        all create $t 5287287 loop geom

# Equilibrate using Stillinger-Weber model for silicon

pair_style      sw
pair_coeff      * * Si.sw Si Si Si Si Si Si Si Si

thermo_style    custom step temp epair etotal econserve press
thermo          10
fix             1 all nvt temp $t $t 0.1
timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes
run             100

write_restart   restart.equil

# Test Stillinger-Weber model for Cd/Te/Zn/Se/Hg/S

clear
read_restart    restart.equil

pair_style      sw
pair_coeff      * * CdTeZnSeHgS0.sw Cd Zn Hg Cd Te S Se Te

thermo_style    custom step temp epair etotal econserve press
thermo          10
fix             1 all nvt temp $t $t 0.1
timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes
run             100

# Test Vashishta model for In/P

clear
read_restart    restart.equil

pair_style      vashishta
pair_coeff      * * InP.vashishta In In In In P P P P

thermo_style    custom step temp epair etotal econserve press
thermo          10
fix             1 all nvt temp $t $t 0.1
timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes
run             100

# Test Tersoff model for B/N/C 

clear
read_restart    restart.equil

variable        fac equal 0.6
change_box      all x scale ${fac} y scale ${fac} z scale ${fac} remap

pair_style      tersoff
pair_coeff      * * BNC.tersoff N N N C B B C B

thermo_style    custom step temp epair etotal econserve press
thermo          10
fix             1 all nvt temp $t $t 0.1
timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes
run             100

# Test Tersoff/ZBL model for SiC

clear
read_restart    restart.equil

variable        fac equal 0.6
change_box      all x scale ${fac} y scale ${fac} z scale ${fac} remap

pair_style      tersoff/zbl
pair_coeff      * * SiC.tersoff.zbl C C C C Si Si Si Si

thermo_style    custom step temp epair etotal econserve press
thermo          10
fix             1 all nvt temp $t $t 0.1
timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes
run             100

shell rm restart.equil
"
"Generate a LAMMPS input script for a general simulation of an rheo system using rheo ${cut} artificial/visc ${zeta} rho/damp ${Dr} pair style with pair coefficients * * and p p p boundary conditions with a timestep of ${dt_max} running for 20000 steps.","# ------ 2D Poiseuille flow ------ #

dimension          2
units              lj
atom_style         rheo
boundary           p p p
comm_modify        vel yes

# ------ Create simulation box ------ #

variable           n equal 1.0
variable           cut equal 3.0

region             box block 0 20 -10 10 -0.01 0.01
create_box         2 box
lattice            sq ${n}

region             inner   block INF INF -7.5 7.5 INF INF units box
region             walls   block INF INF -7.5 7.5 INF INF units box side out

create_atoms       2 region walls
create_atoms       1 region inner

group              fluid type 1
group              rig type 2

displace_atoms     fluid random 0.1 0.1 0 135414 units box

# ------ Model parameters ------ #

variable           rho0 equal 1.0
variable           cs equal 1.0
variable           mp equal ${rho0}/${n}
variable           zeta equal 1.0
variable	       kappa equal 1.0*${rho0}/${mp}
variable           fext equal 1e-4/${n}
variable           dt_max equal  0.1*${cut}/${cs}/3
variable           Dr equal 0.05*${cut}*${cs}

variable           eta equal 0.1
variable           gd0 equal 5e-4
variable           npow equal 0.5
variable           K equal 0.001

mass               * ${mp}
set                group all rheo/rho ${rho0}
set                group all rheo/status 0
set                group rig rheo/status 1

timestep           ${dt_max}

pair_style         rheo ${cut} artificial/visc ${zeta} rho/damp ${Dr}
pair_coeff         * *

# ------ Fixes & computes ------ #

fix                1 all rheo ${cut} quintic 0 shift
fix                2 all rheo/viscosity * constant ${eta}
#fix                2 all rheo/viscosity * power ${eta} ${gd0} ${K} ${npow}
fix                3 all rheo/pressure * linear
fix                4 rig setforce 0.0 0.0 0.0
fix                5 fluid addforce ${fext} 0.0 0.0
fix                6 all enforce2d

compute            rho all rheo/property/atom rho

# ------ Output & Run ------ #

thermo             200
thermo_style       custom step time ke press

#dump               1 all custom 200 atomDump id type x y vx vy fx fy c_rho

run                20000

"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay eam/alloy spin/exchange 4.0 pair style with pair coefficients * * eam/alloy Ni99.eam.alloy Ni and p p p boundary conditions with a timestep of 0.0001 running for 1000 steps.","# fcc nickel in a 3d periodic box

clear
units           metal
atom_style      spin

dimension       3
boundary        p p p

# necessary for the serial algorithm (sametag)
atom_modify     map array

lattice         fcc 3.524
region          box block 0.0 5.0 0.0 5.0 0.0 5.0
create_box      1 box
create_atoms    1 box

# setting mass, mag. moments, and interactions for cobalt

mass            1 58.69

set             group all spin/random 31 0.63
#set            group all spin 0.63 0.0 0.0 1.0
velocity        all create 100 4928459 rot yes dist gaussian

pair_style      hybrid/overlay eam/alloy spin/exchange 4.0
pair_coeff      * * eam/alloy Ni99.eam.alloy Ni
pair_coeff      * * spin/exchange exchange 4.0 0.50 0.2280246862 1.229983475

neighbor        0.1 bin
neigh_modify    every 10 check yes delay 20

fix             1 all precession/spin cubic -0.0001 0.0 1.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 1.0 &
                                      zeeman 0.0 0.0 0.0 1.0
fix_modify      1 energy yes
fix             2 all langevin/spin 0.0 0.0 21

fix             3 all nve/spin lattice moving
timestep        0.0001

# compute and output options

compute         out_mag    all spin
compute         out_pe     all pe
compute         out_ke     all ke
compute         out_temp   all temp

variable        magz      equal c_out_mag[3]
variable        magnorm   equal c_out_mag[4]
variable        emag      equal c_out_mag[5]
variable        tmag      equal c_out_mag[6]

thermo_style    custom step time v_magnorm pe v_emag temp v_tmag etotal
thermo          50

compute         outsp all property/atom spx spy spz sp fmx fmy fmz
dump            1 all custom 50 dump.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3] c_outsp[4] c_outsp[5] c_outsp[6] c_outsp[7]

run             1000

"
"Generate a LAMMPS input script for a NVT simulation of an molecular system using lj/relres 5.75 6.25 12.0 14.0 pair style with pair coefficients 6    6  0.175  3.905  0.0     0.0 and p p p boundary conditions with a timestep of 1.0 running for 1000 steps at temperature 290.","# Example: use of lj/relres for simulation of 2,2-dimethylhexane: C3H7-C5H11 
# with various Rso setting as well as run of reference system for time comparison (real units)
# The first run writes restart file that is used by all subsequent runs.

# Run relres with Rso=6.25

units           real
atom_style      molecular
boundary        p p p
dielectric      1
special_bonds   lj/coul 0.0 0.0 0.5
bond_style      harmonic
angle_style     harmonic
dihedral_style  fourier

pair_style      lj/relres 5.75 6.25 12.0 14.0
read_data       Data.22DMH.in.real

pair_coeff      6    6  0.175  3.905  0.0     0.0   
pair_coeff      4    4  0.118  3.905  0.0     0.0  
pair_coeff      2    2  0.118  3.905  1.2218  3.905  
pair_coeff      5    5  0.145  3.960  0.0     0.0
pair_coeff      3    3  0.118  3.905  0.0     0.0
pair_coeff      1    1  0.05   3.8    2.9128  3.9309
pair_modify     shift yes
neighbor        2.0 bin
neigh_modify    every 2 delay 4 check yes

timestep 1.0
thermo 100
thermo_style custom step temp press pe ke etotal epair emol vol
fix 2 all nvt temp 290 290 2.0e+02

run 1000

write_restart	restart.relres.real

# Run relres with Rso=7.25

clear
read_restart	restart.relres.real

pair_style      lj/relres 6.75 7.25 12.0 14.0

pair_coeff      6    6  0.175  3.905  0.0     0.0  
pair_coeff      4    4  0.118  3.905  0.0     0.0  
pair_coeff      2    2  0.118  3.905  1.2218  3.905  
pair_coeff      5    5  0.145  3.960  0.0     0.0
pair_coeff      3    3  0.118  3.905  0.0     0.0
pair_coeff      1    1  0.05   3.8    2.9128  3.9309
pair_modify     shift yes
neighbor        2.0 bin
neigh_modify    every 2 delay 4 check yes

timestep 1.0
thermo 100
thermo_style custom step temp press pe ke etotal epair emol vol
fix 2 all nvt temp 290 290 2.0e+02

run 1000

# Run relres with mixed Rso: 6.25 for C3H7 group and 7.25 for C5H11 group

clear
read_restart	restart.relres.real

pair_style      lj/relres 6.75 7.25 12.0 14.0

pair_coeff      6    6  0.175  3.905  0.0     0.0    5.75 6.25 12.0 14.0
pair_coeff      4    4  0.118  3.905  0.0     0.0    5.75 6.25 12.0 14.0
pair_coeff      2    2  0.118  3.905  1.2218  3.905  5.75 6.25 12.0 14.0
pair_coeff      5    5  0.145  3.960  0.0     0.0
pair_coeff      3    3  0.118  3.905  0.0     0.0
pair_coeff      1    1  0.05   3.8    2.9128  3.9309
pair_modify     shift yes
neighbor        2.0 bin
neigh_modify    every 2 delay 4 check yes

timestep 1.0
thermo 100
thermo_style custom step temp press pe ke etotal epair emol vol
fix 2 all nvt temp 290 290 2.0e+02

run 1000

# Run reference system with lj/smooth

clear
read_restart	restart.relres.real

pair_style      lj/smooth 12.0 14.0

pair_coeff      6    6  0.175  3.905  
pair_coeff      4    4  0.118  3.905  
pair_coeff      2    2  0.118  3.905  
pair_coeff      5    5  0.145  3.960  
pair_coeff      3    3  0.118  3.905  
pair_coeff      1    1  0.05   3.8    
pair_modify     shift yes
neighbor        2.0 bin
neigh_modify    every 2 delay 4 check yes

timestep 1.0
thermo 100
thermo_style custom step temp press pe ke etotal epair emol vol
fix 2 all nvt temp 290 290 2.0e+02

run 1000

"
"Generate a LAMMPS input script for a general simulation of an spin system using hybrid/overlay spin/exchange 3.1 spin/dmi 3.1 pair style with pair coefficients * * spin/exchange exchange 3.1 0.01593 0.06626915552 1.211 and p p f boundary conditions with a timestep of 0.0001.","
units 		metal
dimension 	3
boundary 	p p f
atom_style 	spin

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

# setting mass, mag. moments, and interactions for bcc iron
# (mass not necessary for fixed lattice calculation)

read_data       initial.skyrmion
mass		1 55.845

pair_style 	hybrid/overlay spin/exchange 3.1 spin/dmi 3.1
pair_coeff 	* * spin/exchange exchange 3.1 0.01593 0.06626915552 1.211
pair_coeff 	* * spin/dmi dmi 3.1 0.12e-03 0.0 0.0 1.0

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin zeeman 0.0 0.0 0.0 1.0 anisotropy 5e-05 0.0 0.0 1.0 
fix_modify	1 energy yes
fix 		2 all langevin/spin 0.0 0.0 21
fix		3 all neb/spin 1.0  

timestep	0.0001

compute 	out_mag    all spin
variable 	magx      equal c_out_mag[1]
variable 	magy      equal c_out_mag[2]
variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]

thermo          100
thermo_style    custom step time v_magx v_magz v_magnorm etotal
thermo_modify   format float %20.15g

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
variable	u universe 1 2 3 4
dump 		1 all custom 1 dump.$u type x y z c_outsp[1] c_outsp[2] c_outsp[3]

min_style	spin
min_modify 	alpha_damp 1.0 discrete_factor 10.0
neb/spin	1.0e-9 1.0e-9 10000 10000 10 final final.skyrmion
"
"Generate a LAMMPS input script for a NVT simulation running for 2000 steps at temperature 300.0.","# demo for atom style template simulating a cyclohexane methane mixture
# part 3: continuing from restart file

# run the first part and write out restart
include in.molecular-mix
write_restart molecular-mix.restart

# now restart
clear
molecule cychex cyclohexane.mol
read_restart molecular-mix.restart

thermo 100

fix 1 all nvt temp 300.0 300.0 1.0
# dump 1 all custom 100 custom template-mix.lammpstrj id xu yu zu
run 2000

# clean up
shell rm molecular-mix.restart
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using dpd ${T} ${rc} 3854262 pair style with pair coefficients 1 1 25.0 4.5  1.2 and p p p boundary conditions with a timestep of 0.01 running for _style    verlet steps.","# DPD Fluid

variable T    equal 1.0
variable rc   equal 1.0
variable rcD  equal 1.2

units        lj
boundary     p p p
atom_style   atomic
dimension    3
newton       on
comm_modify  vel yes

### create box and configuration
variable     L equal 5.0
lattice      fcc 3.0
region       simBox block 0 ${L} 0 ${L} 0 ${L}
create_box   2 simBox
#create_atoms 1 region simBox
create_atoms 1 random 100 12456 simBox
create_atoms 2 random 100 13245 simBox
mass         1 1.0
mass         2 2.0
###

pair_style       dpd ${T} ${rc} 3854262

pair_coeff   1 1 25.0 4.5  1.2
pair_coeff   1 2 25.1 4.51 1.21
pair_coeff   2 2 25.2 4.52 1.22

timestep     0.01
run_style    verlet

velocity all create ${T} 68768932

thermo_style custom step time temp press
thermo       100

fix 1 all    nve

run          5000

"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.600 8.0 pair style with pair coefficients 1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H and p p p boundary conditions with a timestep of 0.5 running for 2000 steps.","units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.600 8.0
kspace_style pppm 1.0e-4

read_data data.ethanol


pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H CTO
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    1    4 lj/cut/coul/long 0.105921 3.304542 # C3H OH
pair_coeff    1    5 lj/cut/coul/long 0.000000 0.000000 # C3H HO
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # CTO CTO
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # CTO H
pair_coeff    2    4 lj/cut/coul/long 0.105921 3.304542 # CTO OH
pair_coeff    2    5 lj/cut/coul/long 0.000000 0.000000 # CTO HO
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    3    4 lj/cut/coul/long 0.071413 2.792848 # H OH
pair_coeff    3    5 lj/cut/coul/long 0.000000 0.000000 # H HO
pair_coeff    4    4 lj/cut/coul/long 0.169996 3.120000 # OH OH
pair_coeff    4    5 lj/cut/coul/long 0.000000 0.000000 # OH HO
pair_coeff    5    5 lj/cut/coul/long 0.000000 0.000000 # HO HO
pair_coeff    *  6*8 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    1 thole 2.051000
pair_coeff    1    2 thole 1.580265
pair_coeff    1    4 thole 1.416087
pair_coeff    1    6 thole 2.051000
pair_coeff    1    7 thole 1.580265
pair_coeff    1    8 thole 1.416087
pair_coeff    2    2 thole 1.217570
pair_coeff    2    4 thole 1.091074
pair_coeff    2    6 thole 1.580265
pair_coeff    2    7 thole 1.217570
pair_coeff    2    8 thole 1.091074
pair_coeff    4    4 thole 0.977720
pair_coeff    4    6 thole 1.416087
pair_coeff    4    7 thole 1.091074
pair_coeff    4    8 thole 0.977720
pair_coeff    6    6 thole 2.051000
pair_coeff    6    7 thole 1.580265
pair_coeff    6    8 thole 1.416087
pair_coeff    7    7 thole 1.217570
pair_coeff    7    8 thole 1.091074
pair_coeff    8    8 thole 0.977720

group gETHANOL molecule 1:250
group gATOMS type 1 2 3 4 5
group gDRUDES type 6 7 8


neighbor 2.0 bin

variable vTEMP   equal 300.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gATOMS  create ${vTEMP} 12345
velocity gDRUDES create ${vTEMP_D} 12345

fix fDRUDE all drude C C N C N D D D

fix fSHAKE gATOMS shake 0.0001 20 0 b 2 3 5

comm_modify vel yes
compute cTEMP_ATOM gATOMS temp
compute cTEMP all temp/drude

fix fDTDIR all drude/transform/direct
fix fNPT gATOMS npt temp ${vTEMP} ${vTEMP} 100 iso ${vPRESS} ${vPRESS} 500
fix_modify fNPT temp cTEMP_ATOM press thermo_press
fix fNVT gDRUDES nvt temp ${vTEMP_D} ${vTEMP_D} 100.0
fix fDTINV all drude/transform/inverse

thermo_style custom step cpu etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 20

timestep 0.5
run 2000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 1.12246 pair style with pair coefficients * * 1.0 1.0 1.12246 and p s p boundary conditions with a timestep of 0.003 running for 10000 steps.","# 2-d LJ flow simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
region		box block 0 20 0 10 -0.25 0.25
create_box	3 box
create_atoms	1 box

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	     1 block INF INF INF 1.25 INF INF
group	     lower region 1
region	     2 block INF INF 8.75 INF INF INF
group	     upper region 2
group	     boundary union lower upper
group	     flow subtract all boundary

set	     group lower type 2
set	     group upper type 3

# initial velocities

compute	     mobile flow temp
velocity     flow create 1.0 482748 temp mobile
fix	     1 all nve
fix	     2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify   2 temp mobile

# Couette flow

velocity     lower set 0.0 0.0 0.0
velocity     upper set 3.0 0.0 0.0
fix	     3 boundary setforce 0.0 0.0 0.0
fix	     4 all enforce2d

# Poiseuille flow

#velocity     boundary set 0.0 0.0 0.0
#fix	     3 lower setforce 0.0 0.0 0.0
#fix	     4 upper setforce 0.0 NULL 0.0
#fix	     5 upper aveforce 0.0 -1.0 0.0
#fix	     6 flow addforce 0.5 0.0 0.0
#fix	     7 all enforce2d

# Run

timestep	0.003
thermo		500
thermo_modify	temp mobile

#dump		1 all atom 500 dump.flow

#dump		2 all image 100 image.*.jpg type type &
#		zoom 1.6 adiam 1.2
#dump_modify	2 pad 5

#dump		3 all movie 100 movie.mpg type type &
#		zoom 1.6 adiam 1.2
#dump_modify	3 pad 5

run		10000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.5 pair style with a timestep of 0.0001 running for 10000 steps.","# Simple rigid body system

units           lj
atom_style      atomic

pair_style      lj/cut 2.5

read_data       data.rigid

velocity        all create 100.0 4928459

# unconnected bodies

group           clump1 id <> 1 9
group           clump2 id <> 10 18
group           clump3 id <> 19 27
group           clump4 id <> 28 36
group           clump5 id <> 37 45
group           clump6 id <> 46 54
group           clump7 id <> 55 63
group           clump8 id <> 64 72
group           clump9 id <> 73 81

fix 1 all rigid group 9 clump1 clump2 clump3 clump4 clump5 &
                      clump6 clump7 clump8 clump9

# 1 chain of connected bodies

#group          clump1 id <> 1 9
#group          clump2 id <> 9 18
#group          clump3 id <> 18 27
#group          clump4 id <> 27 36
#group          clump5 id <> 36 45
#group          clump6 id <> 45 54
#group          clump7 id <> 54 63
#group          clump8 id <> 63 72
#group          clump9 id <> 72 81

#fix 1 all poems group clump1 clump2 clump3 clump4 clump5 &
#                     clump6 clump7 clump8 clump9

# 2 chains of connected bodies

#group          clump1 id <> 1 9
#group          clump2 id <> 9 18
#group          clump3 id <> 18 27
#group          clump4 id <> 27 36
#group          clump5 id <> 37 45
#group          clump6 id <> 45 54
#group          clump7 id <> 54 63
#group          clump8 id <> 63 72
#group          clump9 id <> 72 81

#fix 1 all poems group clump1 clump2 clump3 clump4
#fix 2 all poems group clump5 clump6 clump7 clump8 clump9

neigh_modify    exclude group clump1 clump1
neigh_modify    exclude group clump2 clump2
neigh_modify    exclude group clump3 clump3
neigh_modify    exclude group clump4 clump4
neigh_modify    exclude group clump5 clump5
neigh_modify    exclude group clump6 clump6
neigh_modify    exclude group clump7 clump7
neigh_modify    exclude group clump8 clump8
neigh_modify    exclude group clump9 clump9

thermo          100

#dump           1 all atom 50 dump.rigid

#dump           2 all image 100 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 5

#dump           3 all movie 100 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 5

timestep        0.0001
thermo          50
run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay lj/cut 8.0 quip pair style with pair coefficients 1 1 lj/cut 0.0028619844 3.5 # CT and p p p boundary conditions with a timestep of 0.0001 # 0.1 fs running for 10 steps.","units metal
atom_style full
boundary p p p
timestep 0.0001 # 0.1 fs

read_data methane-box-8.data

# DISCLAIMER: This potential mixes parameters from methane and silane
# potentials and is NOT intended to be a realistic representation of either
# system.  It is meant to demonstrate the use of hybrid QUIP/LAMMPS potentials,
# including the use of separate 'special_bonds' settings.

pair_style hybrid/overlay lj/cut 8.0 quip

# exclusion setting for quip; cannot be exactly 1.0 1.0 1.0,
# since that would not flag 1-2, 1-3, and 1-4 pairs in lj/cut
special_bonds lj/coul 0.999999999 0.999999999 0.999999999

# Intermolecular: OPLS (JACS 118 (45), p. 11225 (1996))
# Coulomb interactions omitted for simplicity
pair_coeff 1 1 lj/cut 0.0028619844 3.5 # CT
pair_coeff 2 2 lj/cut 0.0013009018 2.5 # HC
pair_coeff 1 2 lj/cut 0.0019295487 2.95
pair_modify shift no
# change exclusion settings for lj/cut only: exclude bonded pairs
pair_modify pair lj/cut special lj/coul 0.0 0.0 0.0

# Intramolecular
# Tell QUIP to pretend this is silane (which is covered by the parameter file)
pair_coeff * * quip sw_example.xml ""IP SW"" 14 1
bond_style none
angle_style none

fix 1 all nve

# Include diagnostics that allow us to compare to a pure QUIP run
compute equip all pair quip
compute evdw all pair lj/cut
compute vir all pressure NULL virial

thermo_style custom step epair ke etotal temp press c_vir c_evdw c_equip
thermo 1

# dump 1 all custom 1 dump.molecular id type x y z fx fy fz
# dump_modify 1 sort id

run 10
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay              & pair style with pair coefficients 1     1     lj/cut/coul/long 0.5 1.775 3.268        # HG   HG with a timestep of 0.002 running for 2000 steps.","# Ionic surfactant system: S12S

units           lj
dimension       3
atom_style      full

read_data       data.gauss-diel

pair_style      hybrid/overlay              &
                lj/cut 3.5                  &
                lj/cut/coul/long 8.0 18.0   &
                gauss/cut 3.4               &
                coul/diel 2.5
pair_modify    shift yes

dielectric      0.4255
kspace_style    pppm/cg 0.0001
kspace_modify   mesh 12 12 12 order 3

bond_style      harmonic
angle_style     harmonic
dihedral_style  opls

pair_coeff  1     1     lj/cut/coul/long 0.5 1.775 3.268        # HG   HG  
pair_coeff  1     1     gauss/cut        0.1 2.549 0.1525           
pair_coeff  1     2     lj/cut           0.31623 1.5329 1.7206  # HG   CM  
pair_coeff  1     3     lj/cut           0.31623 1.5329 1.7206  # HG   CT  
pair_coeff  1     4     lj/cut/coul/long 0.05 1.75 4.375        # HG   CI  
pair_coeff  1     4     gauss/cut        0.2805 1.45 0.112 
pair_coeff  1     4     coul/diel        78. 1.375 0.112 
pair_coeff  2     2     lj/cut           0.2000 1.2910 3.2275   # CM   CM  
pair_coeff  2     3     lj/cut           0.2000 1.2910 3.2275   # CM   CT  
pair_coeff  2     4     lj/cut           0.4472 1.1455 1.28585  # CM   CI  
pair_coeff  3     3     lj/cut           1.95 1.291 3.2275      # CT   CT  
pair_coeff  3     4     lj/cut           0.4472 1.1455 1.28585  # CT   CI  
pair_coeff  4     4     lj/cut/coul/long 1.0 10. 1.12246          # CI   CI 

bond_coeff  1      12650.0000   0.7500 # HG CM FROM TOP
bond_coeff  2      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  3      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  4      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  5      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  6      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  7      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  8      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  9      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  10     12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  11     12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  12     12650.0000   0.5000 # CM CT FROM TOP

angle_coeff 1           85.7600 109.5000 # HG CM CM FROM TOP
angle_coeff 2           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 3           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 4           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 5           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 6           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 7           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 8           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 9           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 10          85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 11          85.7600 111.0000 # CM CM CT FROM TOP

dihedral_coeff 1     5.7431 -2.53241 5.0742 0.0 # HG CM CM CM FROM TOP
dihedral_coeff 2     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 3     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 4     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 5     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 6     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 7     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 8     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 9     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 10    5.7431 -2.53241 5.0742 0.0 # CM CM CM CT FROM TOP

timestep        0.002  

reset_timestep  0

group           cions type 4
group           sds subtract all cions

velocity        all create 1. 87287 dist gaussian

neighbor        1.5 multi
neigh_modify    exclude molecule/intra sds
neigh_modify    every 5 delay 0 check yes

fix             1 all nve/limit 0.2
fix             2 all langevin 1.0 1.0 0.05 18273

thermo_style    multi
thermo          500

run             2000
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff NULL pair style with pair coefficients * * ffield.reax.hns C H O N and p p p boundary conditions with a timestep of 0.1 running for $t steps.","# Pure HNS crystal, ReaxFF tests for benchmarking LAMMPS
# See README for more info

variable x index 2
variable y index 2
variable z index 2
variable t index 100


units             real
atom_style        charge
atom_modify sort  100 0.0 # optional
dimension         3
boundary          p p p

read_data         data.hns-equil
replicate         $x $y $z bbox


pair_style        reaxff NULL
pair_coeff        * * ffield.reax.hns C H O N

compute           reax all pair reaxff

neighbor          1.0 bin
neigh_modify      every 20 delay 0 check no

timestep          0.1

thermo_style      custom step temp pe press evdwl ecoul vol
thermo_modify     norm yes
thermo            10

velocity          all create 300.0 41279 loop geom

fix               1 all nve
fix               2 all qeq/reax 1 0.0 10.0 1e-6 reaxff

run               $t
"
"Generate a LAMMPS input script for a NVE simulation using lj/cut 4.0 pair style with pair coefficients * *  1.0 1.0 and f f f boundary conditions running for 1000 post no steps.","
units           lj
lattice         fcc 0.8442
boundary        f f f

region          ball   sphere   0.0 0.0 0.0 5.0
region          box    block  -10 10 -10 10 -10 10
region          half   block  -10  0 -10 10 -10 10

# add molecule ids so we can use chunk/atom
fix             0   all property/atom mol ghost yes

create_box      2  box
create_atoms    1  region ball

pair_style      lj/cut 4.0
pair_coeff      * *  1.0 1.0
mass            *    1.0
set             group all mol 1

# label half the sphere with a different type for better visualization
set             region half   type 2

# use a dynamic group (may require a patch to fix addtorque with older versions of LAMMPS)
group           ball   dynamic all   region ball

neigh_modify    delay 2  every 1  check yes

minimize        0.0  0.0    1000  10000
reset_timestep  0

velocity        all create 1.2 12351235

fix             1   all  nve
fix             2   all  wall/reflect  xlo EDGE xhi EDGE ylo EDGE yhi EDGE zlo EDGE zhi EDGE

compute 1 all chunk/atom molecule
compute 2 ball omega/chunk 1
compute 3 ball inertia/chunk 1

# compute rotational kinetic energy: 1/2 * I * omega**2
variable r_ke_x equal c_2[1][1]*c_2[1][1]*c_3[1][1]*0.5
variable r_ke_y equal c_2[1][2]*c_2[1][2]*c_3[1][2]*0.5
variable r_ke_z equal c_2[1][3]*c_2[1][3]*c_3[1][3]*0.5

# output moments of inertia for x,y,z and angular velocity as well as rotational kinertic energy

thermo_style custom step ke pe c_3[1][1] c_3[1][2] c_3[1][3] c_2[1][1] c_2[1][2] c_2[1][3] v_r_ke_x v_r_ke_y v_r_ke_z
thermo 500

# dump 1 all atom 100 dump.lammpstrj

# dump 2 all movie 10 ball.mp4 type mass

# equilibration w/o torque added
run 1000 post no

# start spinning the ball. rotation around z should increase and Erot_z should grow
fix 4 ball addtorque 0.0 0.0 200.0
run 10000 upto  post no

# continue without adding more torque. rotation continues at fixed speed
unfix 4
run 5000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 1000 steps.","# 2d Lennard-Jones melt and subsequent energy minimization,
# followed by box relaxation to a target stress state
#
units		lj
dimension	2
atom_style	atomic

lattice		sq2 0.8442
region		box block 0 20 0 20 -0.1 0.1
create_box	1 box
create_atoms	1 box
mass		1 1.0

velocity	all create 5.0 87287 loop geom

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0 2.5
pair_modify	shift yes

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix		1 all nve
fix		2 all enforce2d

#dump		1 all atom 500 dump.min

#dump		2 all image 500 image.*.jpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	2 pad 4

#dump		3 all movie 500 movie.mpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	3 pad 4

thermo		100

run		1000

# perform the box relaxation by progressively
# adding more degrees of freedom, for smoother
# convergence

neigh_modify	delay 0 every 1 check yes

velocity	all create 0.0 1
thermo		50

# atoms only

minimize	1.0e-6 0.001 1000 10000

# isotropic volume relaxation to hydrostatic target

fix             3 all box/relax iso 1.5 vmax 1.0e-3

variable        emin equal pe+f_3/atoms
thermo_style    custom step temp pe pxx pyy pxy f_3 v_emin

# anisotropic volume relaxation to hydrostatic target

minimize	0.0 10.0e0 10000 100000

fix             3 all box/relax aniso 1.5 vmax 1.0e-3

minimize	0.0 10.0 10000 100000

# anisotropic volume relaxation to non-hydrostatic target

fix             3 all box/relax x 1.0 y 2.0 vmax 1.0e-3

minimize	0.0 10.0 10000 100000

minimize	0.0 1.0 10000 100000

minimize	0.0 1.0e-2 10000 100000

# Final refinement uses nreset to eliminate stress offset

fix             3 all box/relax x 1.0 y 2.0 vmax 1.0e-3 nreset 100

minimize	0.0 1.0e-4 10000 100000

"
"Generate a LAMMPS input script for a NVE simulation using sw pair style with pair coefficients * * Si.sw Si and p p p boundary conditions with a timestep of 0.0001 running for 5000 steps.","# Test case / example for fix electron/stopping
# Perfect Si lattice with one primary knock-on atom.
#
# Also uses fix dt/reset, as one should when energies are high
# enough to require electronic stopping.

units metal
boundary p p p
timestep 0.0001

lattice fcc 5.431

region rbox block -10 10 -10 10 -10 10
create_box 1 rbox

mass 1 28.0855

create_atoms 1 box

velocity all create 300 42534 mom yes rot yes

group gPKA id 1
velocity gPKA set 1120 1620 389

pair_style sw
pair_coeff * * Si.sw Si

fix fdt all dt/reset 1 NULL 0.001 0.1 emax 20.0
fix fel all electron/stopping 1.0 Si.Si.elstop
fix fnve all nve

thermo 10
thermo_style custom step time dt f_fel

#compute ek all ke/atom
#dump mydump all custom 200 elstop.dump id x y z vx vy vz fx fy fz c_ek

run 5000
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff control.reax_c.rdx pair style with pair coefficients * * ffield.reax C H O N with a timestep of 1.0 running for 100 steps.","# ReaxFF potential for RDX system

units           real

atom_style      charge
read_data       data.rdx

pair_style      reaxff control.reax_c.rdx
pair_coeff      * * ffield.reax C H O N

compute reax all pair reaxff

variable eb      equal c_reax[1]
variable ea      equal c_reax[2]
variable elp     equal c_reax[3]
variable emol    equal c_reax[4]
variable ev      equal c_reax[5]
variable epen    equal c_reax[6]
variable ecoa    equal c_reax[7]
variable ehb     equal c_reax[8]
variable et      equal c_reax[9]
variable eco     equal c_reax[10]
variable ew      equal c_reax[11]
variable ep      equal c_reax[12]
variable efi     equal c_reax[13]
variable eqeq    equal c_reax[14]

neighbor        2.5 bin
neigh_modify    every 10 delay 0 check no

fix             1 all nve
fix             2 all qeq/shielded 1 10.0 1.0e-6 100 reaxff
variable nqeq   equal f_2

thermo          10
thermo_style    custom step temp epair etotal press &
                v_eb v_ea v_elp v_emol v_ev v_epen v_ecoa &
                v_ehb v_et v_eco v_ew v_ep v_efi v_eqeq v_nqeq

timestep        1.0

#dump           1 all atom 10 dump.reaxff.rdx

#dump           2 all image 25 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 25 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

run             100
"
"Generate a LAMMPS input script for a general simulation of an atomic system using meam/sw/spline pair style with pair coefficients * * Ti.meam.sw.spline Ti and p p p boundary conditions running for 0 steps.","# Ti beta phase (bcc)

units           metal
boundary        p p p

atom_style      atomic
lattice         bcc 3.27169
region          box block 0 1 0 1 0 1
create_box              1 box
create_atoms    1 box

pair_style      meam/sw/spline
pair_coeff      * * Ti.meam.sw.spline Ti
mass            * 47.90

variable        cohesive_energy equal pe/atoms
run                     0

print           ""====================================================""
print           ""Calculated cohesive energy: ${cohesive_energy} eV/atom""
print           ""Reference cohesive energy:  -4.720 eV/atom""
print           ""====================================================""

#dump           1 all custom 1 beta.dump id type x y z fx fy fz
#run            0


"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using meam/sw/spline pair style with pair coefficients * * Ti.meam.sw.spline Ti and p p p boundary conditions with a timestep of 0.002 running for 2000 steps.","# bulk Ti lattice

variable        x index 1
variable        y index 1
variable        z index 1

variable        xx equal 20*$x
variable        yy equal 20*$y
variable        zz equal 20*$z

units           metal
atom_style      atomic

variable       a equal 2.28806
variable       covera equal 1.58111
variable       sqrt3 equal sqrt(3.)
variable       theta equal PI/2.
variable       cos_theta equal round(cos(${theta}))
variable       sin_theta equal round(sin(${theta}))
variable       Dx equal 1.
variable       Dy equal ${covera}
variable       Dz equal sqrt(3.)

lattice        custom ${a} a1 1 0 0 a2 0 ${sqrt3} 0 a3 0 0 ${covera} &
               basis 0.0 0.0 0.0 &
               basis 0.5 0.5 0.0 &
               basis 0.5 0.833333 0.5 &
               basis 0.0 0.333333 0.5 &
               orient x  1             0             0 &
               orient y  0  ${cos_theta}  ${sin_theta} &
               orient z  0 -${sin_theta}  ${cos_theta} &
               spacing ${Dx} ${Dy} ${Dz} &
               origin 0.25 0.25 0.15

variable       Xlo equal -round(9./(${a}*${Dx}))
variable       Xhi equal  round(9./(${a}*${Dx}))
variable       Ylo equal -round(9./(${a}*${Dy}))
variable       Yhi equal  round(9./(${a}*${Dy}))
variable       Zlo equal -round(3./(${a}*${Dz}))
variable       Zhi equal  round(3./(${a}*${Dz}))

region         box prism  ${Xlo} ${Xhi} ${Ylo} ${Yhi} ${Zlo} ${Zhi} 0.0 0.0 0.0

boundary       p p p

create_box      1 box
create_atoms    1 box

pair_style      meam/sw/spline
pair_coeff      * * Ti.meam.sw.spline Ti
mass            * 47.90

velocity        all create 300.0 376847 loop geom

neighbor        1.0 bin
neigh_modify    every 1 delay 5 check yes

fix             1 all nve

thermo 1
thermo_style    custom step vol etotal press pxx pyy pxz
thermo_modify   format 2 %14.8f
thermo_modify   format 3 %14.8f
thermo_modify   format 4 %14.8f
thermo_modify   format 5 %14.8f
thermo_modify   format 6 %14.8f
thermo_modify   format 7 %14.8f


timestep        0.002
thermo          10

run             2000

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 250 steps.","# 3d Lennard-Jones melt

units           lj
atom_style      atomic

lattice         fcc 0.8442
region          box block 0 10 0 10 0 10
create_box      1 box
create_atoms    1 box
mass            * 1.0

velocity        all create 3.0 87287

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    every 20 delay 0 check no

fix             1 all python/move py_nve.NVE

thermo          50
run             250
"
"Generate a LAMMPS input script for a general simulation of an sphere system using soft 1.12 pair style with pair coefficients 1 1 0.0 with a timestep of 0.001 running for 1000 steps.","# SRD diffusion demo - dimer particles

units           lj
atom_style      sphere
atom_modify     map array first big
dimension       2

# read in clusters of rigid bodies

fix             molprop all property/atom mol ghost yes
read_data       data.dimer fix molprop NULL Molecules

set             type 1 mass 1.0
group           big type 1
velocity        big create 1.44 87287 loop geom

# equilibrate big particles

pair_style      soft 1.12
pair_coeff      1 1 0.0 
pair_coeff      2 2 0.0 0.0
pair_coeff      1 2 0.0 0.0

variable        prefactor equal ramp(0,60)
fix             soft all adapt 1 pair soft a * * v_prefactor

fix             1 big rigid molecule
fix             2 all enforce2d

#dump           1 all atom 10 dump.dimer.equil

thermo          100
run             1000

#undump         1
unfix           soft
unfix           1
unfix           2

# add small particles as hi density lattice

region          plane block INF INF INF INF -0.001 0.001 units box
lattice         sq 85.0
create_atoms    2 region plane

set             type 2 mass 0.1
group           small type 2
velocity        small create 1.0 593849 loop geom

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0
pair_coeff      2 2 0.0 1.0 0.0
pair_coeff      1 2 0.0 1.0 0.5

delete_atoms    overlap 0.5 small big

# SRD run

reset_timestep  0

neighbor        0.3 multi
neigh_modify    delay 0 every 1 check yes

comm_modify     mode multi group big vel yes
neigh_modify    include big

# no pairwise interactions with small particles

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0
pair_coeff      2 2 0.0 1.0 0.0
pair_coeff      1 2 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones
# if comment out, big particles won't see SRD particles

timestep        0.001

fix             1 big rigid molecule
fix             2 small srd 20 big 1.0 0.25 49894 shift yes 54979 &
                  search 0.2 collision slip inside ignore overlap yes
fix             3 all enforce2d

# diagnostics

compute         tbig big temp/sphere
variable        pebig equal pe*atoms/count(big)
variable        ebig equal etotal*atoms/count(big)
thermo_style    custom step temp f_2[8] etotal v_pebig v_ebig press &
                f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] &
                f_2[6] f_2[7] f_2[8] f_2[9] f_2[10] f_2[11] f_2[12]

thermo_modify   temp tbig
thermo          1000

#dump           1 all atom 1000 dump.dimer

#dump           1 all image 1000 image.*.jpg type type zoom 1.6
#dump_modify    1 pad 6 adiam 1 1 adiam 2 0.2

run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an amoeba system using amoeba pair style with pair coefficients * * amoeba_ubiquitin.prm amoeba_ubiquitin.key and p p p boundary conditions running for 10 steps.","# solvated ubiquitin molecule with AMOEBA force field

units           real
boundary        p p p
atom_modify     sort 0 0.0

atom_style      amoeba

bond_style      class2
angle_style     amoeba
dihedral_style  fourier
improper_style  amoeba

# per-atom properties required by AMOEBA or HIPPO

fix             amtype all property/atom i_amtype ghost yes
fix             extra all property/atom i_amgroup d_redID d_pval ghost yes
fix             extra2 all property/atom i_polaxe d2_xyzaxis 3

fix             pit all amoeba/pitorsion
fix_modify      pit energy yes
fix             bit all amoeba/bitorsion bitorsion.ubiquitin.data
fix_modify      bit energy yes

# read data file

read_data       data.ubiquitin fix amtype NULL ""Tinker Types"" &
                fix pit ""pitorsion types"" ""PiTorsion Coeffs"" &
                fix pit pitorsions PiTorsions &
                fix bit bitorsions BiTorsions

pair_style      amoeba
pair_coeff      * * amoeba_ubiquitin.prm amoeba_ubiquitin.key

special_bonds   lj/coul 0.5 0.5 0.5 one/five yes

# thermo output

compute         virial all pressure NULL virial

thermo_style    custom step temp epair ebond eangle edihed eimp &
                emol etotal press c_virial[*]

#dump            1 all custom 10 dump.ubiquitin id type x y z fx fy fz
#dump_modify     1 sort id

# dynamics

fix            1 all nve

thermo         1
run            10
"
"Generate a LAMMPS input script for a NVE simulation of an hybrid bond ellipsoid oxdna system using hybrid/overlay oxdna/excv oxdna/stk oxdna/hbond oxdna/xstk oxdna/coaxstk pair style with pair coefficients * * oxdna/excv 11.92337812042065 5.9626 5.74965 11.92337812042065 4.38677 4.259 11.92337812042065 2.81094 2.72576 and p p p boundary conditions with a timestep of 0.01706 running for 1000000 steps.","# LAMMPS input file in real units via oxdna lj2real.py, date 2024-05-19
variable number	equal 1
variable ofreq	equal 1000
variable efreq	equal 1000
variable T      equal 300.0

units real

dimension 3

newton on

boundary  p p p

atom_style hybrid bond ellipsoid oxdna
atom_modify sort 0 8.518

# Pair interactions require lists of neighbours to be calculated
neighbor 17.036 bin
neigh_modify every 1 delay 0 check yes

read_data data.duplex1

set atom * mass 315.8376

group all type 1 4

# oxDNA bond interactions - FENE backbone
bond_style oxdna/fene
bond_coeff * 11.92337812042065 2.1295 6.409795
special_bonds lj 0 1 1

# oxDNA pair interactions
pair_style hybrid/overlay oxdna/excv oxdna/stk oxdna/hbond oxdna/xstk oxdna/coaxstk
pair_coeff * * oxdna/excv 11.92337812042065 5.9626 5.74965 11.92337812042065 4.38677 4.259 11.92337812042065 2.81094 2.72576
pair_coeff * * oxdna/stk seqav ${T} 8.01727944817084 0.005279604 0.70439070204273 3.4072 7.6662 2.72576 6.3885 1.3 0.0 0.8 0.9 0.0 0.95 0.9 0.0 0.95 2.0 0.65 2.0 0.65
pair_coeff * * oxdna/hbond seqav 0.0 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0.0 0.7 1.5 0 0.7 1.5 0 0.7 0.46 3.141592654 0.7 4.0 1.570796327 0.45 4.0 1.570796327 0.45
pair_coeff 1 4 oxdna/hbond seqav 6.42073911784652 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0 0.7 1.5 0.0 0.7 1.5 0 0.7 0.46 3.141592654 0.7 4.0 1.570796327 0.45 4.0 1.570796327 0.45
pair_coeff 2 3 oxdna/hbond seqav 6.42073911784652 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0 0.7 1.5 0.0 0.7 1.5 0 0.7 0.46 3.141592654 0.7 4.0 1.570796327 0.45 4.0 1.570796327 0.45
pair_coeff * * oxdna/xstk 3.9029021145006 4.89785 5.74965 4.21641 5.57929 2.25 0.791592654 0.58 1.7 1.0 0.68 1.7 1.0 0.68 1.5 0 0.65 1.7 0.875 0.68 1.7 0.875 0.68
pair_coeff * * oxdna/coaxstk 3.77965257404268 3.4072 5.1108 1.87396 4.94044 2.0 2.541592654 0.65 1.3 0 0.8 0.9 0 0.95 0.9 0 0.95 2 -0.65 2 -0.65

# NVE ensemble
fix 1 all nve/asphere
#fix 2 all langevin ${T} ${T} 4265.0 457145 angmom 10

timestep 0.01706

#comm_style tiled
fix 3 all balance 1000 1.03 shift xyz 10 1.03
comm_modify cutoff 32.4

compute quat all property/atom quatw quati quatj quatk

compute erot all erotate/asphere
compute ekin all ke
compute epot all pe
variable erot equal c_erot
variable ekin equal c_ekin
variable epot equal c_epot
variable etot equal c_erot+c_ekin+c_epot
fix 5 all print ${efreq} ""$(step)  ekin = ${ekin} |  erot = ${erot} | epot = ${epot} | etot = ${etot}"" screen yes

dump out all custom ${ofreq} out.${number}.lammpstrj id mol type x y z ix iy iz vx vy vz c_quat[1] c_quat[2] c_quat[3] c_quat[4] angmomx angmomy angmomz
dump_modify out sort id
dump_modify out format line ""%d %d %d  %22.15le %22.15le %22.15le  %d %d %d  %22.15le %22.15le %22.15le  %22.15le %22.15le %22.15le %22.15le  %22.15le %22.15le %22.15le""

run 1000000

write_data last_config.${number}.* nocoeff
#write_restart last_config.${number}.*
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using hybrid/overlay dpd 1.0 1.0 245455 coul/slater/long 0.929 3.0 pair style with pair coefficients * * dpd 25.0 4.5 and p p p boundary conditions with a timestep of 0.02 running for 100000 steps.","# Bulk polyelectrolyte as described in section IV of J. Chem. Phys. 125, 224107 (2006)

boundary        p p p

units           lj
atom_style      charge

region 			    my_sim_box block 0.0 10.0 0.0 10.0 0.0 10.0
create_box 		  3 my_sim_box

create_atoms 	  1 random 2804 100 my_sim_box
create_atoms    2 random 98 200 my_sim_box
create_atoms    3 random 98 300 my_sim_box

set				      type 2 charge -1.0
set 			      type 3 charge  1.0

comm_modify     mode single vel yes

mass            1 1.0
mass			      2 1.0
mass			      3 1.0

pair_style      hybrid/overlay dpd 1.0 1.0 245455 coul/slater/long 0.929 3.0
pair_coeff      * * dpd 25.0 4.5
pair_coeff		  * * coul/slater/long

kspace_style    ewald 0.00001
dielectric      1.0

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check no once no

timestep        0.02

fix             2 all nve

thermo          10
thermo_style    custom step spcpu temp press etotal pe ke ecoul elong evdwl
thermo_modify   line one

run             100000
write_data		  data.after_equilibration

compute         RDF_1_1 all rdf 50 1 1 cutoff 3.0
compute         RDF_1_2 all rdf 50 1 2 cutoff 3.0
compute         RDF_1_3 all rdf 50 1 3 cutoff 3.0
compute         RDF_2_2 all rdf 50 2 2 cutoff 3.0
compute         RDF_2_3 all rdf 50 2 3 cutoff 3.0
compute         RDF_3_3 all rdf 50 3 3 cutoff 3.0

fix             11 all ave/time 50 1 50 c_RDF_1_1[*] file tmp_1_1.rdf mode vector
fix             12 all ave/time 50 1 50 c_RDF_1_2[*] file tmp_1_2.rdf mode vector
fix             13 all ave/time 50 1 50 c_RDF_1_3[*] file tmp_1_3.rdf mode vector
fix             14 all ave/time 50 1 50 c_RDF_2_2[*] file tmp_2_2.rdf mode vector
fix             15 all ave/time 50 1 50 c_RDF_2_3[*] file tmp_2_3.rdf mode vector
fix             16 all ave/time 50 1 50 c_RDF_3_3[*] file tmp_3_3.rdf mode vector

run				      10000
write_data		  data.after_production_run
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using quip pair style with pair coefficients * * sw_example.xml ""IP SW"" 14 and p p p boundary conditions with a timestep of 0.001 running for 100 steps.","# Test of SW potential for Si system

units		metal
boundary	p p p

atom_style	atomic

read_data	data_sw

pair_style	quip
pair_coeff	* * sw_example.xml ""IP SW"" 14

velocity        all create 10.0 355311
neighbor	0.3 bin
neigh_modify	delay 10

fix		1 all nve
thermo		10
timestep	0.001

#dump		1 all custom 10 dump.sw id fx fy fz

run		100
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 2.5 running for 250 steps.","# 3d Lennard-Jones melt

units           lj
atom_style      atomic
processors      * 1 1

lattice         fcc 0.8442
region          box block 0 10 0 10 0 10
create_box      3 box
create_atoms    1 box
mass            * 1.0

region          long block 3 6 0 10 0 10
set             region long type 2

velocity        all create 1.0 87287

pair_style      lj/cut 2.5
pair_coeff      * * 1.0 1.0 2.5
pair_coeff      * 2 1.0 1.0 5.0

comm_style      tiled

neighbor        0.3 bin
neigh_modify    every 2 delay 4 check yes
fix             p all property/atom d_WEIGHT
fix             0 all balance 50 1.0 rcb weight neigh 0.8 weight store WEIGHT
compute         p all property/atom d_WEIGHT
variable        maximb equal f_0[1]
variable        iter   equal f_0[2]
variable        prev   equal f_0[3]
variable        final  equal f_0

#fix            3 all print 50 ""${iter} ${prev} ${final} ${maximb}""

fix             1 all nve

#dump           id all atom 50 dump.melt
#dump           id all custom 50 dump.lammpstrj id type x y z c_p

#dump           2 all image 25 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 25 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

thermo          50

run             250
run             250

"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using gran/hooke/history 2000.0 NULL 50.0 NULL 0.5 0 pair style with pair coefficients * * and p p fm boundary conditions with a timestep of 0.001 running for 25000 steps.","# Pour granular particles into chute container, then induce flow

atom_style	sphere
boundary	p p fm
newton		off
comm_modify	vel yes

region		reg block -10 10 -10 10 -0.5 16 units box
create_box	1 reg

neighbor	0.2 bin
neigh_modify	delay 0

# IMPORTANT NOTE: these values of stiffness (2000) and timestep (0.001)
# are used in this example file to produce a quick simulation and movie.
# More appropriate values for realistic simulations would be
# k = 2.0e5 and dt = 0.0001, as in bench/in.chute.

pair_style      gran/hooke/history 2000.0 NULL 50.0 NULL 0.5 0
pair_coeff	* *

timestep	0.001

fix		1 all nve/sphere
fix		2 all gravity 1.0 spherical 0.0 -180.0
fix		zlower all wall/gran hooke/history 2000.0 NULL 50.0 NULL 0.5 0 &
		zplane 0.0 2000.0 

region		slab block -9.0 9.0 -9.0 9.0 10.0 15.0 units box
fix		ins all pour 3000 1 300719 vol 0.13 50 region slab

compute		1 all erotate/sphere
thermo_style	custom step atoms ke c_1 vol
thermo		1000
thermo_modify	lost ignore norm no
compute_modify	thermo_temp dynamic/dof yes

#dump		id all atom 1000 dump.pour

#dump		2 all image 1000 image.*.jpg type type &
#		axes yes 0.8 0.02 view 80 -30
#dump_modify	2 pad 5

#dump		3 all movie 1000 movie.mpg type type &
#		axes yes 0.8 0.02 view 80 -30
#dump_modify	3 pad 5

run		25000

unfix		ins
fix		2 all gravity 1.0 chute 26.0
run		25000
"
"Generate a LAMMPS input script for a NVT simulation of an full                                 #Molecule + charge system using lj/cut/coul/long 15.0 15.0           #LJ with 15.0ang cutoff, Coulomb with 15.0ang cutoff pair style with pair coefficients * 1 0.0000 0.0000                    #Ghost-(anything) LJ (dispersion) parameters and p p p				     #Periodic Boundaries boundary conditions running for 60000 steps.","# TraPPE Nitrogen NVT

#NOTES:
# The variable ""infile"" is read from the command line argument:
#  E.G., ""lmp_serial -in foo -var infile bar1 -var temp bar2
#  foo = input filename
#  bar1 = input value for variable infile (Input configuration and molecular topology)
#  bar2 = put value for variable temp (temperature, in Kelvin units)
# The input file specifies the following:
#   System volume, conformation, atom types, bond types, angles types
#   Initial configuration
#   The molecular topology
# The configuration in the restart file is not assumed to be a relaxed configuration

units		real	                             #Angstroms, g/mol, etc.
atom_style	full                                 #Molecule + charge

#timestep	2.0				     #Set the integrator time step (default = 1.0fs for real units)

boundary        p p p				     #Periodic Boundaries
read_data       ${infile}

replicate	1 1 1				     #cell replication (none = 1 1 1)

variable        dt equal dt
variable        ext_temp equal ${temp}
variable        Tdamp equal 100.0*${dt}		     #units are time units, LAMMPS suggestion is 100 time steps 
		      	    			     #(e.g. 50fs if time step is 0.5fs)


pair_style	lj/cut/coul/long 15.0 15.0           #LJ with 15.0ang cutoff, Coulomb with 15.0ang cutoff
pair_modify     tail yes			     #Analytic Long-range Tail corrections, for the LJ interactions
bond_style      harmonic
angle_style     harmonic
kspace_style	pppm 1.0e-4                          #PPPM Ewald, relative error in forces
#kspace_style	ewald 1.0e-4                         #Conventional Ewald method , relative error in forces = 1.0e-04
                                                     #kspace uses tinfoil/conducting boundary conditions by default
						     #NOTE: This script lets LAMMPS set the Ewald damping parameter
						     # and number of k-vectors automatically.

pair_coeff      * 1 0.0000 0.0000                    #Ghost-(anything) LJ (dispersion) parameters
pair_coeff	2 2 0.07153934924399673 3.31000      #Nitrogen-Nitrogen LJ (dispersion) parameters

bond_style	harmonic   			     #Sets the bond type as harmonic
angle_style	harmonic			     #Sets the triplet bond type as harmonic
dihedral_style	none				     #TraPPE N2 has no dihedrals (quadruplets)
improper_style	none				     #TraPPE N2 has no improper quadruplets

bond_coeff	1 5000.00 0.550                      #Nitrogen-Ghost bond parameters (0.55~ang)
angle_coeff	1 500.0 180.00			     #Nitrogen-Ghost-Nitrogen angle parameters (angle=180.0deg)
		  				     #NOTE: harmonic moduli do not matter, since the rigid bonds are preserved by rigid fix

group ghost    type 1
group nitrogen type 2				     #Create a group called ""nitrogen"" that includes only the nitrogen atoms

#Neighbor List Parameters
#neighbor        2.0 bin			     #Skin (default = 2.0 bin for real units)
#neigh_modify    delay 1 every 1 check no
                                                     #  delay N =  never delay until at least N steps after previous build
                                                     #  every N =  build list every N steps
                                                     #  check no = build whenever delay/every criteria are met
                                                     #  check yes = build whenever delay/every criteria are met and atom moved > skin/2

#Create initial velocity distribution
velocity nitrogen create ${ext_temp} 432567 dist uniform
	 	  	 	     	    	     #Only give velocities to the atomic nitrogens
		      	    	      	      	     #Set uniform distribution with T = {ext_temp}
		      	    	      	      	     #Seed integer = 432567
						     #dist uniform is the LAMMPS Default

#Reset the time step counter
reset_timestep  0                                    #Reset the time step counter to 0

#Ensemble set-up: NVT ensemble, thermostatted by Nose-Hoover a chained thermostat, set at temperature $ext_temp
fix             2 all rigid/nvt molecule temp ${ext_temp} ${ext_temp} ${Tdamp}
		      	       		   	     #start temperature = ext_temp
		      	       		   	     #end temperature = ext_temp
		      	    	      	      	     #Tdamp (in time units, fs)

#Output Style
variable        Nevery equal 20                      #Specify the distance (in timesteps) between samples for computing ensemble aver$
                                                     #  (Interval between samples in a block)
variable        Nrepeat equal 50                     #Specify the number of samples per output  of thermodynamic averages
                                                     #  (Samples per block output)
variable        Nfreq equal ${Nevery}*${Nrepeat}     #Specify the dump interval (in timesteps)
                                                     #  (Some people call these blocks)
variable        PotentialEnergy equal epair          #Call the intermolecular potential energy $PotentialEnergy
variable        Pressure equal press                 #Call the pressure $Pressure
variable        Temperature equal temp               #Call the instantaneous temperature $Temperature
variable        Density equal density                #Call the instantaneous density $Density (will not change for NVT)

fix             3 all ave/time ${Nevery} ${Nrepeat} ${Nfreq} v_Temperature v_Density v_PotentialEnergy v_Pressure file ave.dens_22.0molL.out format %.8g
thermo          1000                                 #Specify the interval between screen output of thermodynamic averages
thermo_style    custom step temp density epair press #Format for screen output of thermodynamics
                                                     #  (MD step, temperature, internal energy, pressure)
#Run it!
run             60000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using hybrid/overlay zbl 0.1 0.2 snap pair style with pair coefficients 1 1 zbl 10 10 and p p p boundary conditions running for 500 steps.","#Carbon SNAP example: 216 atom diamond unit cell simulated NVT at ~1,000GPa and 5,000K

units           metal
atom_style      atomic
boundary        p p p

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#      Crystal orientation and MD box creation       #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
lattice diamond 2.845
region Bbox block 0 3 0 3 0 3
create_box 1 Bbox
create_atoms 1 region Bbox basis 1 1

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#         Interatomic potential parameters           #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
# Specify hybrid with SNAP, ZBL, and long-range C_SNAP_2021.10.15.quadratic.ulomb

pair_style hybrid/overlay zbl 0.1 0.2 snap
pair_coeff 1 1 zbl 10 10
pair_coeff * * snap C_SNAP_2021.10.15.quadratic.snapcoeff C_SNAP_2021.10.15.quadratic.snapparam C

mass * 12.01
velocity all create 8000.0 3412461  loop geom

fix     NVE all nve
fix     NVT all langevin 5000.0 5000.0 0.1 3216548
thermo  50
thermo_style    custom step temp ke pe etotal press pxx pyy pzz
run 500
"
"Generate a LAMMPS input script for a NPT simulation of an electron system using eff/cut 20.88 limit/eradius pressure/evirials pair style with pair coefficients * * and p p p boundary conditions running for 100 steps at temperature 3000.0.","variable        sname index Li.bohr

units           electron
newton          off
boundary        p p p
dielectric	1.0

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 20.88 limit/eradius pressure/evirials
pair_coeff      * *

comm_modify	vel yes

neigh_modify	one 2000 page 20000

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

thermo          10
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain press v_press temp
thermo_modify   temp effTemp press effPress

min_style	cg
minimize	0 1e-6 100 200

fix 		0 all temp/rescale/eff 1 0.0 3000.0 0.02 0.5

fix		1 all npt/eff temp 3000.0 3000.0 0.1 iso 1e7 1e7 1.0

compute         1 all property/atom spin eradius
dump            1 all custom 100 ${sname}.spe.lammpstrj &
                id type q c_1[1] c_1[2] x y z

run 		100

"
"Generate a LAMMPS input script for a general simulation of an mdpd system using hybrid/overlay mdpd/rhosum mdpd 1.0 1.0 9872598 pair style with pair coefficients 1 1 mdpd/rhosum  0.75 and p p p boundary conditions with a timestep of 0.01 running for 4000 steps.","########################################################################
#### 3D droplet oscilation using many-body DPD simulation            ###
####                                                                 ### 
#### Created  : Zhen Li (zhen_li@brown.edu)                          ### 
####            Division of Applied Mathematics, Brown University.   ###
####                                                                 ###
#### mDPD parameters follow the choice of the publication:           ###
#### Z. Li et al. ""Three dimensional flow structures in a moving     ###
#### droplet on substrate: a dissipative particle dynamics study""    ###
#### Physics of Fluids, 2013, 25: 072103. DOI: 10.1063/1.4812366     ###
########################################################################
units 		        lj
dimension	        3
boundary	        p p p
neighbor	        0.3 bin
neigh_modify        every 1 delay 0 check yes

atom_style	        mdpd
comm_modify vel yes

region     mdpd     block -25 25 -10 10 -10 10 units box
create_box          1 mdpd

lattice             fcc 6 
region     film     block -20 20 -7.5 7.5 -2.0 2.0 units box
create_atoms        1 region film 

pair_style          hybrid/overlay mdpd/rhosum mdpd 1.0 1.0 9872598 
pair_coeff          1 1 mdpd/rhosum  0.75
pair_coeff          1 1 mdpd         -40 25 18.0 1.0 0.75 
mass                1 1.0

compute             mythermo all temp
thermo              100
thermo_modify       temp mythermo
thermo_modify       flush yes

velocity            all create 1.0 38497 loop local dist gaussian

fix         mvv     all mvv/dpd

#dump        mydump  all atom 100 atom.lammpstrj

#dump       jpg      all image 200 image.*.jpg type type zoom 5 adiam 0.5 &
#                    view 90 90 box no 0 size 600 200
#dump_modify         jpg pad 4

#dump       avi      all movie 200 movie.avi type type zoom 5 adiam 0.5 &
#                    view 90 90 box no 0 size 600 200
#dump_modify         avi pad 4

timestep            0.01
run                 4000
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff lmp_control pair style with pair coefficients * * ffield.reax.Fe_O_C_H H O Fe with a timestep of 0.25 running for 3000 steps.","# REAX potential for Fe/O/H system
# .....

units           real

atom_style      charge
read_data       data.FeOH3

pair_style      reaxff lmp_control
pair_coeff      * * ffield.reax.Fe_O_C_H H O Fe

neighbor        2 bin
neigh_modify    every 10 delay 0 check no

fix             1 all nve
fix             2 all qeq/reax 1 0.0 10.0 1e-6 param.qeq
fix             3 all temp/berendsen 500.0 500.0 100.0

timestep        0.25
thermo 100

#dump           1 all atom 30 dump.reax.feoh

run             3000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 8.5 pair style with pair coefficients * * 0.01 3.4 8.5 and p f p boundary conditions running for 10000 steps.","units		metal
dimension	3
boundary	p f p

atom_style	atomic
neighbor	2.0 bin

# create geometry

lattice		sc 10
region		box block 0 10 0 10 0 10
create_box	1 box
create_atoms	1 box

mass		1 39.95

# LJ potentials

pair_style	lj/cut 8.5
pair_coeff	* * 0.01 3.4 8.5

# initial velocities

velocity	all create 300 482748 
fix		1 all nve

# diffusive reflection
# upper wall velocity = 0.1, lower wall fixed

fix ywalls all wall/reflect/stochastic diffusive 2308 &
     ylo EDGE 300 0 0 0 yhi EDGE 300 0.1 0 0

# run

thermo		1000
run		10000
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using eam/alloy pair style with pair coefficients * * NiAlH_jea.eam.alloy Ni Al and p p p boundary conditions with a timestep of 0.002 running for 1000 steps at temperature 600.0.","units		metal
atom_style	atomic
atom_modify	map array

# Box and atom positions:
boundary p p p

# Defining lattice and creating simulation
# box with atoms inside
lattice          fcc 4.05
region           simbox prism 0 5 0 5 0 5 0 0 0 units lattice
create_box       2 simbox
create_atoms     2 box

# Atomic mass:
mass 1 58.69
mass 2 26.98154

# Potential, Al fcc crystal
pair_style eam/alloy
pair_coeff * * NiAlH_jea.eam.alloy Ni Al
neigh_modify delay 5

thermo 100
thermo_style custom step temp pxx pyy pzz pxy pxz pyz
compute cna all cna/atom 2.8

fix 1 all npt/cauchy temp 600.0 600.0 1.0 &
                     x 0.0 0.0 0.1 &
                     y 0.0 0.0 0.1 &
                     z 0.0 0.0 0.1 &
                     couple none alpha 0.001 continue no

# dump 1 all cfg 1000 test*.cfg mass type xs ys zs type c_cna

timestep 0.002

variable px equal pxx
variable py equal pyy
variable pz equal pzz
variable sxy equal pxy
variable sxz equal pxz
variable syz equal pyz
variable t equal temp

fix avg all ave/time 1 100 100 v_t v_px v_py v_pz v_sxy v_sxz v_syz file avg.txt

variable lx equal lx
variable ly equal ly
variable lz equal ly
variable xy equal xy
variable xz equal xz
variable yz equal yz

fix box all ave/time 1 100 100 v_lx v_ly v_lz v_xy v_xz v_yz file box.txt

velocity all create 1200 4928459 rot yes dist gaussian

run 1000

fix 1 all npt/cauchy temp 600.0 600.0 1.0 &
                     x 0.0 0.0 0.1 &
                     y 0.0 0.0 0.1 &
                     z 0.0 0.0 0.1 &
                     xy -10000.0 -10000.0 0.1 &
                     couple none alpha 0.001 continue yes

run 1000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay nb3b/harmonic lj/cut/coul/long 10.0 pair style with pair coefficients * * nb3b/harmonic MOH.nb3b.harmonic M O H with a timestep of 1.0 running for _style       respa 2 2 pair 1 kspace 2 steps.","# test of NB3B pair style with pair hybrid and KSpace solver

units           real
atom_style      full

bond_style      morse
angle_style     none
dihedral_style  none
improper_style  none
 
read_data       data.nb3b

pair_style      hybrid/overlay nb3b/harmonic lj/cut/coul/long 10.0
pair_coeff      * * nb3b/harmonic MOH.nb3b.harmonic M O H
pair_modify     mix arithmetic
 
pair_coeff      1 1 lj/cut/coul/long 0.000000903 5.264325869
pair_coeff      1 2 lj/cut/coul/long 0.000374621 4.214922978
pair_coeff      1 3 lj/cut/coul/long 0 2.632162934
pair_coeff      2 2 lj/cut/coul/long 0.155416412 3.165520088
pair_coeff      2 3 lj/cut/coul/long 0 1.582760044
pair_coeff      3 3 lj/cut/coul/long 0 0

kspace_style    ewald/disp 0.0001
 
neighbor        2.0 bin
neigh_modify    delay 5
special_bonds   lj/coul 0.0 0.0 1.0

thermo_style    custom step etotal ke temp pe ebond eangle edihed eimp &
                evdwl ecoul elong press lx ly lz xy xz yz vol

timestep        1.0
run_style       respa 2 2 pair 1 kspace 2

thermo          50

### Minimize forces in structure ###

minimize        1.0e-06 1.0e-08 1000 10000

### Run NVE to equilibrate velocities ###

velocity        all create 298.0 4928459 mom yes rot yes dist gaussian

fix             1 all nve
fix             2 all temp/rescale 10 298.0 298.0 25.0 1.0

run             100
"
"Generate a LAMMPS input script for a NVT simulation of an charge system using lj/polysoft 2.03 pair style with pair coefficients 1 1 1.0 1.0 2.025 1.25 0.2 with a timestep of 0.01 running for 100000 steps.","# Example script of liquid droplet propagation in glass 2d-NVT simulation
# see C. Herrero et al. ( https://doi.org/10.48550/arXiv.2210.04775 ) for details

# parameters set

variable	Ti equal 0.035		# Initial glass temperature
variable        Ta equal 0.11		# Annealing temperature
variable	P equal 2.31052		# Pressure
variable 	radius equal 80		# bubble radius
variable	seed equal 4115699	# RNG seed

# problem setup

units           lj
atom_style      charge
atom_modify 	map array

dimension 	2

pair_style      lj/polysoft 2.03
read_data       Ti${Ti}.lmps		# initial glass config equlibrated with swap MC
pair_coeff      1 1 1.0 1.0 2.025 1.25 0.2

neighbor        0.3 bin
neigh_modify    every 1 delay 0 check yes

# define liquid (bubble) region
region 		bubble sphere 0.0 0.0 0.0 ${radius} side in
group		bubble dynamic all region bubble

velocity 	all create ${Ti} ${seed}

timestep        0.01
reset_timestep  0

# Perform simulation
# 1st let the system expand quickly

fix             1 all npt temp ${Ta} ${Ta} 1.0 iso $P $P 1.0

# track pressure inside the bubble
compute		peratomb bubble stress/atom NULL
compute		pb bubble reduce sum c_peratomb[1] c_peratomb[2]
variable	pressb equal -(c_pb[1]+c_pb[2])/(2*3.14159265359*v_radius^2)

compute         tempb bubble temp

variable	thermofreq equal logfreq2(100,18,10)
thermo          v_thermofreq
thermo_style    custom step temp pe ke etotal press vol v_pos v_pressb c_tempb
thermo_modify   flush yes

run             100000

# Replicate the system

replicate	3 3 1

# large system, only dump original box
variable	x0 equal -xlo
variable 	y0 equal -ylo
region 		originalbox block INF ${x0} INF ${y0} INF INF
group		all0 region originalbox


# 2nd freeze all the particles and create liquid bubble of radius R
unfix 		1
fix		1 bubble nvt temp 0.8 0.8 1.0

run		100000

# 3rd equilibrate the liquid inside the cavity at Ta (only with md in this example)

unfix		1
fix		1 bubble nvt temp ${Ta} ${Ta} 1.0

run		1000000

# 4th study bubble propagation from this configuration

unfix		1
reset_timestep	0

velocity	all create ${Ta} ${seed} rot yes dist gaussian

fix		1 all nvt temp ${Ta} ${Ta} 1.0

dump		traj all0 custom 500000 bubble.lammpstrj x y c_epot c_patom[1] c_patom[2] c_patom[4]
dump_modify	traj sort id first yes pbc yes

restart         5000000 bubble.*.restart

run             10000000

write_data      bubble.end
"
"Generate a LAMMPS input script for a general simulation of an atomic system using eam pair style with pair coefficients * * Au_u3.eam and f p p boundary conditions with a timestep of 0.0 running for 1 steps.","# This test compares Hardy and Cauchy-Born metrics of energy density and stress
# for an Ar system subjected to uniaxial strain deformation.
echo both
units		real	
atom_style	atomic
# create domain
lattice         fcc 4.08 origin 0.25 0.25 0.25
region		BOX block -8 8 -2 2 -2 2
boundary	f p p
create_box	1 BOX
# create atoms
region		MD block -7 7 -2 2 -2 2
create_atoms	1 region MD
pair_style  eam
pair_coeff  * * Au_u3.eam
mass          *  196.97
# specify interal/ghost atoms
region    FREE block -6 6 -2 2 -2 2
group   internal region FREE
# specify inter-atomic potential
# specify neighbor/re-neighboring parameters
neighbor	0.3 bin
neigh_modify	every 10 delay 0 check no
# setup thermal output
thermo		10
thermo_style custom step pe ke press lx ly lz
#           ID  group atc PhysicsType ParameterFile
fix         PP1 internal   atc field Au_eam_linear.mat
fix_modify  PP1 mesh create 8 1 1 BOX f p p
fix_modify  PP1  fields add displacement 
fix_modify  PP1  fields add internal_energy stress cauchy_born_energy cauchy_born_stress
fix_modify  PP1  gradients add displacement 
fix_modify  PP1  set reference_potential_energy 0 # correct cb and messes pe
#           ID  group atc PhysicsType ParameterFile
fix         PP2 internal   atc field Au_eam.mat
fix_modify  PP2 mesh create 8 1 1 BOX f p p
fix_modify  PP2  fields add cauchy_born_energy cauchy_born_stress internal_energy
fix_modify  PP2  set reference_potential_energy
timestep 0.0
fix_modify  PP1  output cb_unistrain_eam_linearFE 1 text tensor_components binary
fix_modify  PP2  output cb_unistrain_eam_refFE    1 text tensor_components 
log       cb_unistrain_eam_linear.log
variable step  equal 0
thermo_style  custom step v_step pe ke press lx ly lz
run 	1
variable step equal ${step}+1
displace_atoms	all ramp x -0.1 0.1 x -100 100
run		1
variable step equal ${step}+1
displace_atoms	all ramp x -0.1 0.1 x -100 100
run		1
"
"Generate a LAMMPS input script for a NVE simulation of an dpd system using hybrid/overlay dpd/fdt/energy 16.00 234324 exp6/rx 16.00 pair style with pair coefficients * * dpd/fdt/energy 0.0 0.05 10.0 16.00 and p p p boundary conditions with a timestep of 0.001 running for 10 steps.","# Example for running DPD-RX

boundary        p p p
units           metal  # ev, ps
atom_style      dpd
atom_modify     map array
fix             4 all rx kinetics.dpdrx none dense lammps_rk4 1

lattice         hcp 6.6520898 origin 0.0833333333333 0.25 0.25 orient z 1 0 0 orient x 0 1 0 orient y 0 0 1
region          box block 0 6.0 0 6.0 0.0 6.0 units lattice
create_box      2 box
region          atoms block 0 6.0 0 6.0 0.0 6.0 units lattice
create_atoms    1 region atoms

comm_modify     mode single vel yes
mass            * 222.12

#Set concentrations
set             atom * d_rdx 1.00
set             atom * d_h2 0.0
set             atom * d_no2 0.0
set             atom * d_n2 0.0
set             atom * d_hcn 0.0
set             atom * d_no 0.0
set             atom * d_h2o 0.0
set             atom * d_co 0.0
set             atom * d_co2 0.0

#Set the kinetic temperature of the particles
velocity	all create 2065.0 875661 dist gaussian

#Set the internal temperature of the particles
set             atom * dpd/theta 2065.00

timestep        0.001

pair_style      hybrid/overlay dpd/fdt/energy 16.00 234324 exp6/rx 16.00
pair_coeff      * * dpd/fdt/energy 0.0 0.05 10.0 16.00
pair_coeff      * * exp6/rx params.exp6 1fluid 1fluid exponent 1.0 1.0 16.00

fix             1 all shardlow
fix             2 all nve
fix             3 all eos/table/rx linear table.eos 4001 KEYWORD thermo.dpdrx

compute         dpdU all dpd
compute         dpdUatom all dpd/atom
compute         crdx all property/atom d_rdx

variable        totEnergy equal pe+c_dpdU[1]+c_dpdU[2]+c_dpdU[3]

thermo          1
thermo_style    custom step temp press vol pe ke c_dpdU[1] c_dpdU[2] c_dpdU[3] v_totEnergy c_dpdU[4] 
thermo_modify   format float %15.8f flush yes

dump            2 all custom 1 dump.dpdrx id x y z vx vy vz c_dpdUatom[1] c_dpdUatom[2] c_dpdUatom[3] c_dpdUatom[4] c_crdx
dump_modify     2 sort id

run             10
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using hdnnp ${hdnnpCutoff} dir ${hdnnpDir} showew no showewsum 5 resetew no maxew 100 cflength 1.8897261328 cfenergy 0.0367493254 pair style with pair coefficients * * H O and p p p boundary conditions with a timestep of ${dt} running for ${numSteps} steps.","###############################################################################
# MD simulation for HDNNP water
###############################################################################

###############################################################################
# VARIABLES
###############################################################################
clear
# Configuration files
variable cfgFile         string ""data.H2O-360mol""
# Timesteps
variable numSteps        equal  10
variable dt              equal  0.0005
# HDNNP
variable hdnnpCutoff     equal  6.36
variable hdnnpDir        string ""hdnnp-data""

###############################################################################
# GENERAL SETUP
###############################################################################
units metal
boundary p p p
atom_style atomic
read_data ${cfgFile}
timestep ${dt}
thermo 1

###############################################################################
# HDNNP
###############################################################################
pair_style hdnnp ${hdnnpCutoff} dir ${hdnnpDir} showew no showewsum 5 resetew no maxew 100 cflength 1.8897261328 cfenergy 0.0367493254
pair_coeff * * H O

###############################################################################
# INTEGRATOR
###############################################################################
fix INT all nve

###############################################################################
# OUTPUT
###############################################################################
# dump 1 all atom 1 dump.hdnnp

###############################################################################
# SIMULATION
###############################################################################
run ${numSteps}
"
"Generate a LAMMPS input script for a NVE simulation of an full system using zero 1.0 pair style with pair coefficients * * with a timestep of 0.00025 running for 100 steps.","# simple water model with LATTE

units           metal
atom_style      full

read_data       data.water

# replicate system if requested

variable        x index 1
variable        y index 1
variable        z index 1

variable        nrep equal v_x*v_y*v_z
if              ""${nrep} > 1"" then ""replicate $x $y $z""

# initialize system

velocity        all create 0.0 87287 loop geom

pair_style      zero 1.0
pair_coeff      * *

neighbor        1.0 bin
neigh_modify    every 1 delay 0 check yes

timestep        0.00025

fix             1 all nve

fix             2 all mdi/qm virial yes elements O H
fix_modify      2 energy yes

thermo_style    custom step temp pe etotal press

# dynamics

thermo          10
run             100
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 500 steps.","# 3d Lennard-Jones melt

units		lj
atom_style	atomic

lattice		fcc 0.8442
region		box block 0 10 0 10 0 10
create_box	1 box
create_atoms	1 box
mass		1 1.0

velocity	all create 1.44 87287 loop geom

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0 2.5

neighbor	0.3 bin
neigh_modify	delay 0 every 20 check no

fix		1 all nve

# load balancing

comm_style      tiled
fix             100 all balance 100 0.9 rcb

# fix ave/grid

fix             ave all ave/grid 10 10 100 5 5 5 vx vy vz

# dump grid

compute         ave all property/grid 5 5 5 id ix iy
#dump            ave all grid 100 tmp.dump.3d &
#                c_ave:grid:data[*] f_ave:grid:count f_ave:grid:data[*]
#dump_modify     ave sort 1

#dump            vtk1 all grid/vtk 100 tmp.dump1.3d.*.vtr f_ave:grid:count

#dump            vtk2 all grid/vtk 100 tmp.dump2.3d.*.vtr f_ave:grid:data[*]

#dump            10 all image 100 tmp.image.*.3d.png type type &
#                grid f_ave:grid:count view 60 -30 shiny 0.0 &
#                subbox yes 0.01

# run

thermo          100

run		500
"
"Generate a LAMMPS input script for a general simulation of an full system using buck6d/coul/gauss/dsf     0.9000    12.0000 pair style with pair coefficients 1     1           10304       3.0612245       457.17971       4.5218516      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW and p p p boundary conditions running for 0 steps.","clear
units real
boundary p p p
atom_style full
read_data hkust1.data

neighbor 2.0 bin


# ------------------------ MOF-FF FORCE FIELD ------------------------------

pair_style buck6d/coul/gauss/dsf     0.9000    12.0000

pair_coeff     1     1           10304       3.0612245       457.17971       4.5218516      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW
pair_coeff     1     2           10304       3.0612245       457.17971       4.5218516      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene
pair_coeff     1     3       6157.8178       3.4682081       129.19572      0.78772886      0.73006542    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene
pair_coeff     1     4       23689.598       2.8436019        1636.052       12.696549      0.42066711    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW
pair_coeff     1     5       10576.399       3.1746032       377.27092       2.7176691      0.61999948    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW
pair_coeff     1     6           10304       3.0769231       443.36171       4.2093581      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW
pair_coeff     2     2           10304       3.0612245       457.17971       4.5218516      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene <--> buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene
pair_coeff     2     3       6157.8178       3.4682081       129.19572      0.78772886      0.73006542    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene <--> buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene
pair_coeff     2     4       23689.598       2.8436019        1636.052       12.696549      0.42066711    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene <--> buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW
pair_coeff     2     5       10576.399       3.1746032       377.27092       2.7176691      0.61999948    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene <--> buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW
pair_coeff     2     6           10304       3.0769231       443.36171       4.2093581      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW
pair_coeff     3     3            3680               4          32.805      0.10690769       0.9771554    # buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene <--> buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene
pair_coeff     3     4       14157.243       3.1914894       489.18197       2.5231391      0.45538909    # buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene <--> buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW
pair_coeff     3     5       6320.6076       3.6144578       103.50278      0.44181916      0.75109952    # buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene <--> buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW
pair_coeff     3     6       6157.8178       3.4883721        124.7792      0.72632262      0.73006542    # buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW
pair_coeff     4     4           54464       2.6548673       5679.4311       33.208515      0.34105936    # buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW <--> buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW
pair_coeff     4     5       24315.863       2.9411765       1371.5617       7.9168726      0.42457748    # buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW <--> buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW
pair_coeff     4     6       23689.598       2.8571429       1590.0769        11.87959      0.42066711    # buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW
pair_coeff     5     5           10856       3.2967033        308.7755       1.6022517      0.63272774    # buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW <--> buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW
pair_coeff     5     6       10576.399       3.1914894       365.45138       2.5231391      0.61999948    # buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW
pair_coeff     6     6           10304       3.0927835       429.89352       3.9170177      0.60800971    # buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW

bond_style hybrid class2 morse

bond_coeff     5 morse    50.000000    1.451345     1.914000    # morse->(cu5_cu1o4@cu2,o2_c1cu1@co2)|CuPW
bond_coeff     4 class2     2.536000    75.465060  -192.435903   286.248406    # mm3->(cu5_cu1o4@cu2,cu5_cu1o4@cu2)|CuPW
bond_coeff     3 class2     1.094000   390.634200  -996.117210  1481.724350    # mm3->(c3_c2h1@ph,h1_c1@ph)|benzene
bond_coeff     6 class2     1.278000   585.591600 -1493.258580  2221.222138    # mm3->(c3_c1o2@co2,o2_c1cu1@co2)|CuPW
bond_coeff     1 class2     1.394000   509.335200 -1298.804760  1931.972080    # mm3->(c3_c2h1@ph,c3_c2h1@ph)|benzene
bond_coeff     2 class2     1.485000   360.635220  -919.619811  1367.934469    # mm3->(c3_c1o2@co2,c3_c3@ph)|CuPW

angle_style hybrid class2/p6 cosine/buck6d

angle_coeff     2 class2/p6      117.711000    57.408120   -46.049402    10.553745    -7.558563    13.610890    # mm3->(c3_c1o2@co2,c3_c3@ph,c3_c2h1@ph)|CuPW
angle_coeff     2 class2/p6 bb 0.0 1.0 1.0
angle_coeff     2 class2/p6 ba 0.0 0.0 1.0 1.0
angle_coeff     6 class2/p6      126.814000    13.740540   -11.021849     2.526022    -1.809130     3.257744    # mm3->(c3_c1o2@co2,o2_c1cu1@co2,cu5_cu1o4@cu2)|CuPW
angle_coeff     6 class2/p6 bb 0.0 1.0 1.0
angle_coeff     6 class2/p6 ba 0.0 0.0 1.0 1.0
angle_coeff     7 class2/p6      123.490000   111.075360   -89.098091    20.419778   -14.624589    26.334856    # mm3->(o2_c1cu1@co2,c3_c1o2@co2,o2_c1cu1@co2)|CuPW
angle_coeff     7 class2/p6 bb    14.244120     1.278000     1.278000
angle_coeff     7 class2/p6 ba     3.309240     3.309240     1.278000     1.278000
angle_coeff     1 class2/p6      127.050000    53.307540   -42.760159     9.799907    -7.018666    12.638684    # mm3->(c3_c2h1@ph,c3_c2h1@ph,c3_c2h1@ph)|benzene
angle_coeff     1 class2/p6 bb    71.796120     1.394000     1.394000
angle_coeff     1 class2/p6 ba     6.762360     6.762360     1.394000     1.394000
angle_coeff     4 class2/p6       84.336000    29.351520   -23.544055     5.395900    -3.864529     6.958951    # mm3->(cu5_cu1o4@cu2,cu5_cu1o4@cu2,o2_c1cu1@co2)|CuPW
angle_coeff     4 class2/p6 bb 0.0 1.0 1.0
angle_coeff     4 class2/p6 ba 0.0 0.0 1.0 1.0
angle_coeff     3 class2/p6      120.350000    36.185820   -29.026127     6.652298    -4.764358     8.579296    # mm3->(c3_c2h1@ph,c3_c2h1@ph,h1_c1@ph)|benzene
angle_coeff     3 class2/p6 bb    93.378120     1.394000     1.094000
angle_coeff     3 class2/p6 ba   -25.179000    53.523360     1.394000     1.094000
angle_coeff     8 class2/p6      115.098000    79.493700   -63.765149    14.613896   -10.466432    18.847160    # mm3->(c3_c3@ph,c3_c1o2@co2,o2_c1cu1@co2)|CuPW
angle_coeff     8 class2/p6 bb 0.0 1.0 1.0
angle_coeff     8 class2/p6 ba 0.0 0.0 1.0 1.0
angle_coeff     5 cosine/buck6d       1.978350     4   180.000000   # fourier->(o2_c1cu1@co2,cu5_cu1o4@cu2,o2_c1cu1@co2)|CuPW

dihedral_style opls

dihedral_coeff     3     0.000000     0.000000     0.000000     0.000000    # cos3->(c3_c3@ph,c3_c2h1@ph,c3_c3@ph,c3_c1o2@co2)|CuPW
dihedral_coeff     9     0.000000     4.528000     0.000000     0.000000    # cos3->(o2_c1cu1@co2,c3_c1o2@co2,o2_c1cu1@co2,cu5_cu1o4@cu2)|CuPW
dihedral_coeff     8     0.000000     0.000000     0.000000     0.000000    # cos3->(o2_c1cu1@co2,cu5_cu1o4@cu2,o2_c1cu1@co2,c3_c1o2@co2)|CuPW
dihedral_coeff     5     0.000000     1.741000     0.000000     0.000000    # cos3->(o2_c1cu1@co2,c3_c1o2@co2,c3_c3@ph,c3_c2h1@ph)|CuPW
dihedral_coeff     2     0.000000     6.316000     0.000000     0.000000    # cos3->(c3_c2h1@ph,c3_c2h1@ph,c3_c2h1@ph,h1_c1@ph)|benzene
dihedral_coeff     1     0.000000     4.379000     0.000000     0.000000    # cos3->(c3_c2h1@ph,c3_c2h1@ph,c3_c2h1@ph,c3_c2h1@ph)|benzene
dihedral_coeff     6     0.000000     0.000000     0.000000     0.609000    # cos4->(o2_c1cu1@co2,cu5_cu1o4@cu2,cu5_cu1o4@cu2,o2_c1cu1@co2)|CuPW
dihedral_coeff     4     0.000000     0.000000     0.000000     0.000000    # cos3->(h1_c1@ph,c3_c2h1@ph,c3_c3@ph,c3_c1o2@co2)|CuPW
dihedral_coeff    10     0.000000     0.000000     0.000000     0.000000    # cos3->(c3_c3@ph,c3_c1o2@co2,o2_c1cu1@co2,cu5_cu1o4@cu2)|CuPW
dihedral_coeff     7     0.000000     0.000000     0.000000     0.000000    # cos3->(cu5_cu1o4@cu2,cu5_cu1o4@cu2,o2_c1cu1@co2,c3_c1o2@co2)|CuPW

improper_style inversion/harmonic

improper_coeff     1    18.776340     0.000000    # harm->(c3_c3@ph,c3_c2h1@ph,c3_c2h1@ph,c3_c1o2@co2)|CuPW
improper_coeff     3    41.005800     0.000000    # harm->(c3_c1o2@co2,c3_c3@ph,o2_c1cu1@co2,o2_c1cu1@co2)|CuPW
improper_coeff     2     4.100580     0.000000    # harm->(c3_c2h1@ph,c3_c2h1@ph,c3_c2h1@ph,h1_c1@ph)|benzene

special_bonds lj 0.0 0.0 1.0 coul 1.0 1.0 1.0

# ------------------------ MOF-FF FORCE FIELD END --------------------------

run 0
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.2.","units lj
dimension 2
atom_style atomic

read_data data.lammps
mass * 1.0

pair_style lj/cut 2.5
pair_coeff * * 1.0 1.2
pair_coeff 1 1 1.0 1.0
pair_coeff 2 2 1.0 1.0
pair_coeff 3 3 1.0 1.0
pair_coeff 4 4 1.0 1.0
pair_coeff 5 5 1.0 1.0
pair_coeff 6 6 1.0 1.0
pair_coeff 7 7 1.0 1.0
pair_coeff 8 8 1.0 1.0
pair_coeff 9 9 1.0 1.0
pair_coeff 10 10 1.0 1.0
pair_coeff 11 11 1.0 1.0
pair_coeff 12 12 1.0 1.0
pair_coeff 13 13 1.0 1.0
pair_coeff 14 14 1.0 1.0
pair_coeff 15 15 1.0 1.0
pair_coeff 16 16 1.0 1.0
pair_coeff 17 17 1.0 1.0
pair_coeff 18 18 1.0 1.0
pair_coeff 19 19 1.0 1.0
pair_coeff 20 20 1.0 1.0
pair_coeff 21 21 1.0 1.0
pair_coeff 22 22 1.0 1.0
pair_coeff 23 23 1.0 1.0
pair_coeff 24 24 1.0 1.0
pair_coeff 25 25 1.0 1.0
pair_coeff 26 26 1.0 1.0
pair_coeff 27 27 1.0 1.0
pair_coeff 28 28 1.0 1.0
pair_coeff 29 29 1.0 1.0
pair_coeff 30 30 1.0 1.0
pair_coeff 31 31 1.0 1.0
pair_coeff 32 32 1.0 1.0
pair_coeff 33 33 1.0 1.0
pair_coeff 34 34 1.0 1.0
pair_coeff 35 35 1.0 1.0
pair_coeff 36 36 1.0 1.0
pair_coeff 37 37 1.0 1.0
pair_coeff 38 38 1.0 1.0
pair_coeff 39 39 1.0 1.0
pair_coeff 40 40 1.0 1.0
pair_coeff 41 41 1.0 1.0
pair_coeff 42 42 1.0 1.0
pair_coeff 43 43 1.0 1.0
pair_coeff 44 44 1.0 1.0
pair_coeff 45 45 1.0 1.0
pair_coeff 46 46 1.0 1.0
pair_coeff 47 47 1.0 1.0
pair_coeff 48 48 1.0 1.0
pair_coeff 49 49 1.0 1.0
pair_coeff 50 50 1.0 1.0
pair_coeff 51 51 1.0 1.0
pair_coeff 52 52 1.0 1.0
pair_coeff 53 53 1.0 1.0
pair_coeff 54 54 1.0 1.0
pair_coeff 55 55 1.0 1.0
pair_coeff 56 56 1.0 1.0
pair_coeff 57 57 1.0 1.0
pair_coeff 58 58 1.0 1.0
pair_coeff 59 59 1.0 1.0
pair_coeff 60 60 1.0 1.0
pair_coeff 61 61 1.0 1.0
pair_coeff 62 62 1.0 1.0
pair_coeff 63 63 1.0 1.0
pair_coeff 64 64 1.0 1.0
pair_coeff 65 65 1.0 1.0
pair_coeff 66 66 1.0 1.0
pair_coeff 67 67 1.0 1.0
pair_coeff 68 68 1.0 1.0
pair_coeff 69 69 1.0 1.0
pair_coeff 70 70 1.0 1.0
pair_coeff 71 71 1.0 1.0
pair_coeff 72 72 1.0 1.0
pair_coeff 73 73 1.0 1.0
pair_coeff 74 74 1.0 1.0
pair_coeff 75 75 1.0 1.0
pair_coeff 76 76 1.0 1.0
pair_coeff 77 77 1.0 1.0
pair_coeff 78 78 1.0 1.0
pair_coeff 79 79 1.0 1.0
pair_coeff 80 80 1.0 1.0
pair_coeff 81 81 1.0 1.0
pair_coeff 82 82 1.0 1.0
pair_coeff 83 83 1.0 1.0
pair_coeff 84 84 1.0 1.0
pair_coeff 85 85 1.0 1.0
pair_coeff 86 86 1.0 1.0
pair_coeff 87 87 1.0 1.0
pair_coeff 88 88 1.0 1.0
pair_coeff 89 89 1.0 1.0
pair_coeff 90 90 1.0 1.0
pair_coeff 91 91 1.0 1.0
pair_coeff 92 92 1.0 1.0
pair_coeff 93 93 1.0 1.0
pair_coeff 94 94 1.0 1.0
pair_coeff 95 95 1.0 1.0
pair_coeff 96 96 1.0 1.0
pair_coeff 97 97 1.0 1.0
pair_coeff 98 98 1.0 1.0
pair_coeff 99 99 1.0 1.0
pair_coeff 100 100 1.0 1.0

compute da all displace/atom

dump 1 all atom 10 dump.md
dump 2 all image 10 image_lammps.*.ppm type type zoom 1.6
dump_modify 2 pad 4 acolor * red/green/blue/aqua/magenta/yellow
thermo 1
"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay eam/alloy spin/exchange 3.5 pair style with pair coefficients * * eam/alloy Fe_Mishin2006.eam.alloy Fe and p p p boundary conditions with a timestep of 0.0001 running for 100000 steps.","# bcc iron in a 3d periodic box

clear 
units 		metal
atom_style 	spin
# atom_style 	spin/kk

dimension 	3
boundary 	p p p

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice 	bcc 2.8665
region 		box block 0.0 3.0 0.0 3.0 0.0 3.0
create_box 	1 box
create_atoms 	1 box

# setting mass, mag. moments, and interactions for bcc iron

mass		1 55.845
set 		group all spin/random 31 2.2
velocity 	all create 100 4928459 rot yes dist gaussian

pair_style 	hybrid/overlay eam/alloy spin/exchange 3.5
pair_coeff 	* * eam/alloy Fe_Mishin2006.eam.alloy Fe
pair_coeff 	* * spin/exchange exchange 3.4 0.02726 0.2171 1.841

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin zeeman 0.0 0.0 0.0 1.0
fix 		2 all langevin/spin 0.0 0.00 21
fix 		3 all nve/spin lattice moving
timestep	0.0001

# compute and output options

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo_style    custom step time v_tmag temp v_emag ke pe etotal
thermo          200

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
dump 		1 all custom 10 dump_iron.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3]

run 		100000
# run 		1
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 13.5 pair style with pair coefficients 1 1 0.238 3.405 and p p p boundary conditions with a timestep of ${dt} running for 3500 steps.","# This test evaluates Hardy fields for a small block of LJ material
# that's undergoing translation in the x-direction through the
# periodic boundary.
echo both
log            log.flying_cube
units          real
atom_style     atomic
variable       lattice_constant equal 5.256227487
variable       c equal 6
variable       L equal (${lattice_constant}*$c)
variable       V equal $L*$L*$L
print          ""Volume : $V""
variable       s equal 10
variable       dt equal 0.1
variable       v equal 0.1
variable       m equal 39.95
# create system
lattice        fcc ${lattice_constant}  origin 0.01 0.01 0.01
region         box block 0 $c 0 $c 0 $c
boundary       p p p
# boundary       p s s
create_box     1 box
create_atoms   1 region box
mass           1 $m
group          all region box
pair_style     lj/cut 13.5
pair_coeff     1 1 0.238 3.405
# define region
neighbor       1.0 bin
neigh_modify   delay 0 every 200 check no
# neigh_modify   delay 0 every $n
reset_timestep 0
thermo         $s
compute_modify thermo_temp extra/dof 0
thermo_style   custom step temp pxx pyy pzz etotal lx ly lz
timestep       ${dt}
min_modify     line quadratic
minimize       0. 0. 1000 1000
reset_timestep 0
variable       xLO equal xlo
variable       xHI equal xhi
variable       yLO equal ylo
variable       yHI equal yhi
variable       zLO equal zlo
variable       zHI equal zhi
# region         BOX block ${xLO} ${xHI} ${yLO} ${yHI} ${zLO} ${zHI} units box
region         BOX block ${xLO} ${xHI} -0.5 31.7 -0.5 31.7 units box
fix            ATC all atc field
fix_modify     ATC mesh create 1 1 1 box p p p
fix_modify     ATC  fields add stress velocity displacement
fix_modify     ATC  fields add temperature kinetic_temperature
fix_modify     ATC  fields add internal_energy energy
fix_modify     ATC  output flying_cubeFE $s text binary tensor_components
# fix_modify     ATC  atomic_output flying_cubeMD $m text binary tensor_components
dump           dumpfc all atom $s flying_cube.dmp
velocity       all set $v 0.0 0.0 units box
fix            NVE all nve
run            3500
variable       c equal 48.88821291*48.88821291/(3.*0.0019872067)
variable       T equal $m*$v*$v*$c
print  ""kinetic temperature: $T""
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay  aip/water/2dm/opt 16.0 lj/cut/tip4p/long 2 3 1 1 0.1546 10 8.5 pair style with pair coefficients 1 1   none and p p p boundary conditions with a timestep of 1e-3 running for 1000 steps.","# Initialization
units           metal
boundary        p p p
atom_style      full
processors      * * 1     # domain decomposition over x and y
read_data       ./gra_water.data
mass            1 12.0107   # carbon    mass (g/mole) 
mass            2 15.9994   # oxygen    mass (g/mole) 
mass            3 1.008     # hydrogen  mass (g/mole) 
# Separate atom groups
group           gr    molecule 1
group           water molecule 2
######################## Potential defition ##############################
# Interlayer potential
pair_style  hybrid/overlay  aip/water/2dm/opt 16.0 lj/cut/tip4p/long 2 3 1 1 0.1546 10 8.5
####################################################################
pair_coeff  1 1   none
pair_coeff  2 2   lj/cut/tip4p/long    8.0313e-3  3.1589          # O-O
pair_coeff  2 3   lj/cut/tip4p/long    0.0 0.0                    # O-H
pair_coeff  3 3   lj/cut/tip4p/long    0.0 0.0                    # H-H
pair_coeff  * *   aip/water/2dm/opt    COH.DMC.aip.water.2dm C Ow Hw  # C-H2O    
# bond and angle
bond_style        harmonic
bond_coeff        1     0.0  0.9572
angle_style       harmonic
angle_coeff       1     0.0  104.52
# define kspace calculation
kspace_style      pppm/tip4p 1E-5
# Neighbor update settings
neighbor        2.0 bin
neigh_modify every 1 delay 5 check yes page 1000000 one 100000
####################################################################
# Calculate pair energy
compute         1 all pair lj/cut/tip4p/long
compute         2 all pair aip/water/2dm/opt
compute         wt water temp
variable        TIP4P  equal  c_1
variable        EILP   equal  c_2     # total interlayer energy
variable        temp_wt equal c_wt
############# Output ##############
thermo_style    custom step etotal pe ke v_TIP4P v_EILP  v_temp_wt
thermo          100
thermo_modify   lost error

fix             subf gr setforce 0.0 0.0 0.0
fix             1    water shake 0.0001 20 100 b 1 a 1

timestep        1e-3  
velocity        water create 300.0 12345 dist gaussian mom yes rot yes
fix             2 water nve
run             1000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using hybrid lj/cut/coul/long 10.0 10.0 lj/cut/coul/long/soft 1 0.5 10.0 10.0 10.0 pair style with pair coefficients 1    1  lj/cut/coul/long    0.0660   3.5000  # C-CF C-CF and p p p boundary conditions with a timestep of 1.0 running for 200000 steps.","# created by fftool

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
special_bonds lj/coul 0.0 0.0 0.5

read_data data.0.lmp
# read_restart restart.*.lmp
# reset_timestep 0

pair_style hybrid lj/cut/coul/long 10.0 10.0 lj/cut/coul/long/soft 1 0.5 10.0 10.0 10.0
pair_modify tail yes
kspace_style pppm 1.0e-4

pair_coeff    1    1  lj/cut/coul/long    0.0660   3.5000  # C-CF C-CF
pair_coeff    1    2  lj/cut/coul/long    0.0445   2.9580  # C-CF H-D
pair_coeff    1    3  lj/cut/coul/long    0.0591   3.2133  # C-CF FD-
pair_coeff    1    4  lj/cut/coul/long    0.0000   1.8708  # C-CF Hw
pair_coeff    1    5  lj/cut/coul/long    0.1013   3.3286  # C-CF Ow
pair_coeff    2    2  lj/cut/coul/long    0.0300   2.5000  # H-D H-D
pair_coeff    2    3  lj/cut/coul/long    0.0399   2.7157  # H-D FD-
pair_coeff    2    4  lj/cut/coul/long/soft    0.0000   1.5811  1.0  # H-D Hw
pair_coeff    2    5  lj/cut/coul/long/soft    0.0683   2.8131  1.0  # H-D Ow
pair_coeff    3    3  lj/cut/coul/long    0.0530   2.9500  # FD- FD-
pair_coeff    3    4  lj/cut/coul/long/soft    0.0000   1.7176  0.0  # FD- Hw
pair_coeff    3    5  lj/cut/coul/long/soft    0.0908   3.0559  0.0  # FD- Ow
pair_coeff    4    4  lj/cut/coul/long    0.0000   1.0000  # Hw Hw
pair_coeff    4    5  lj/cut/coul/long    0.0000   1.7792  # Hw Ow
pair_coeff    5    5  lj/cut/coul/long    0.1554   3.1655  # Ow Ow

variable TK equal 300.0
variable PBAR equal 1.0

neighbor 2.0 bin

timestep 1.0

velocity all create ${TK} 12345

fix SHAKE all shake 0.0001 20 0 b 3 a 4

fix NPT all npt temp ${TK} ${TK} 100 iso ${PBAR} ${PBAR} 500

thermo_style custom step cpu etotal ke pe evdwl ecoul elong temp press vol density
thermo 1000

run 200000

reset_timestep 0
unfix NPT
fix NVT all nvt temp ${TK} ${TK} 100

variable dlambda equal  1.0
variable minusdl equal -1.0
variable dqC equal  (0.48+0.24)*v_dlambda
variable dqH equal -0.06*v_dlambda
variable dqF equal -0.12*v_dlambda

compute FEP all fep ${TK} &
    pair lj/cut/coul/long/soft lambda 2 4*5 v_minusdl &
    pair lj/cut/coul/long/soft lambda 3 4*5 v_dlambda &
    atom charge 1 v_dqC &
    atom charge 2 v_dqH &
    atom charge 3 v_dqF

fix FEP all ave/time 1 1 100 c_FEP[1] c_FEP[2] file bar01.fep

dump TRAJ all custom 5000 dump.lammpstrj id mol type element xu yu zu
dump_modify TRAJ element C H F H O

run 500000

# write_restart restart.*.lmp
write_data data.*.lmp
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay buck 6.5 lj/cut 6.5 coul/cut 6.5 pair style with pair coefficients 1 1 buck 3150.462646 0.35032282 626.7519553 with a timestep of 0.0001 running for 2 steps.","# QMMM for SiO2 zeolite with one methane molecule

units		metal
atom_style	full

bond_style      harmonic
angle_style     harmonic

read_data       data.zeolite

# MM atoms are Si,O
# QM atoms are C,H

group           mm type 1 2
group           qm type 3 4

# pair style must define stand-alone short-range Coulombics
# must specify mixing explicitly b/c hybrid/overlay
# MM Si,O = types 1,2
# QM C,H = types 3,4
# MM Si,O atoms do not LJ interact with each other (just via Buckingham)
# QM C,H atoms do not LJ interact with each other
# MM Si,O and QM C,H do LJ interact with each other

pair_style      hybrid/overlay buck 6.5 lj/cut 6.5 coul/cut 6.5

pair_coeff      1 1 buck 3150.462646 0.35032282 626.7519553
pair_coeff      2 2 buck 659.595398 0.38609055 26.836679
pair_coeff      1 2 buck 27029.419922 0.19385082 148.099091

pair_coeff      1 3 lj/cut 0.09087 3.613
pair_coeff      1 4 lj/cut 0.0344258 3.238
pair_coeff      2 3 lj/cut 0.1419429 3.1
pair_coeff      2 4 lj/cut 0.035857762359063315 1.932779

pair_coeff      3 3 lj/cut 0.0 3.4
pair_coeff      4 4 lj/cut 0.0 2.65
pair_coeff      * * coul/cut

bond_style      harmonic
bond_coeff      1 29.40 1.09

angle_style     harmonic
angle_coeff     1 0.172325 109.5

# remove bonds/angles in QM methane molecule

delete_bonds    qm multi remove special

neighbor	1.0 bin
neigh_modify	delay 0 every 1 check yes

velocity        all create 300.0 458732

# QMMM dynamics with small timestep
# dynamic or frozen zeolite

#fix		1 all nve
fix		1 qm nve

fix             2 qm mdi/qmmm potential elements Si O C H
fix_modify      2 energy yes

timestep        0.0001

thermo_style    custom step cpu temp ke evdwl ecoul epair emol elong &
                f_2 pe etotal press
thermo          1

run		2
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/charmm/coul/long 8 10 pair style with a timestep of 8 running for _style respa 3 2 8 bond 1 dihedral 2 pair 2 kspace 3 steps at temperature 200.","
units           real

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic

pair_style      lj/charmm/coul/long 8 10
pair_modify     mix arithmetic
kspace_style    pppm 1e-4

read_data       data.bpti

special_bonds   charmm
neigh_modify    delay 2 every 1


# ------------- MINIMIZE ----------

minimize 	1e-4 1e-6 1000 10000
reset_timestep  0

# ------------- RUN ---------------

thermo          100
thermo_style    multi
timestep	8

run_style respa 3 2 8 bond 1 dihedral 2 pair 2 kspace 3

velocity        all create 200.0 12345678 dist uniform
#dump            dump1 all atom 100 4pti.dump

fix             1 all nvt temp 200 300 25
fix             cor all filter/corotate m 1.0

run             1000

unfix           cor
unfix           1

"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/class2/coul/long 8.5 pair style and p p p boundary conditions running for 1000 steps.","# two monomer nylon example
# reaction produces a condensed water molecule

units real

boundary p p p

atom_style full

kspace_style pppm 1.0e-4

pair_style lj/class2/coul/long 8.5

angle_style class2

bond_style class2

dihedral_style class2

improper_style class2

special_bonds lj/coul 0 0 1
pair_modify tail yes mix sixthpower

read_data tiny_nylon.data &
  extra/bond/per/atom 5  &
  extra/angle/per/atom 15 &
  extra/dihedral/per/atom 15 &
  extra/improper/per/atom 25 &
  extra/special/per/atom 25


velocity all create 300.0 4928459 dist gaussian

molecule mol1 rxn1_stp1_unreacted.molecule_template
molecule mol2 rxn1_stp1_reacted.molecule_template
molecule mol3 rxn1_stp2_unreacted.molecule_template
molecule mol4 rxn1_stp2_reacted.molecule_template

thermo 50

# dump 1 all xyz 1 test_vis.xyz
# dump_modify 1 types labels

fix myrxns all bond/react stabilization no &
  react rxn1 all 1 0.0 2.9 mol1 mol2 rxn1_stp1_map &
  react rxn2 all 1 0.0 5.0 mol3 mol4 rxn1_stp2_map

fix 1 all nve/limit .03

thermo_style custom step temp press density f_myrxns[*]

# restart 100 restart1 restart2

run 1000

# write_restart restart_longrun
# write_data restart_longrun.data
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using hybrid/overlay reaxff control checkqeq no table linear 11000 pair style with pair coefficients * * reaxff ffield.ci-reax.CH C H with a timestep of 0.25 running for 3000 steps.","#ci-reax potential for CH systems with tabulated ZBL correction
atom_style      charge
units           real

read_data       CH4.dat

pair_style      hybrid/overlay reaxff control checkqeq no table linear 11000
pair_coeff      * * reaxff ffield.ci-reax.CH C H
pair_coeff      1 1 table ci-reaxFF_ZBL.dat CC_cireaxFF 
pair_coeff      1 2 table ci-reaxFF_ZBL.dat CH_cireaxFF 
pair_coeff      2 2 table ci-reaxFF_ZBL.dat HH_cireaxFF

timestep        0.25
fix             1 all nve
fix             2 all temp/berendsen 500.0 500.0 100.0

#dump           1 all atom 30 dump.ci-reax.lammpstrj

run             3000
"
"Generate a LAMMPS input script for a NVE simulation using pod pair style with pair coefficients * * Ta_param.pod Ta_coeff.pod Ta and p p p boundary conditions with a timestep of 0.5e-3 running for ${nsteps} steps.","# Demonstrate POD Ta potential

# Initialize simulation

variable nsteps index 100
variable nrep equal 4
variable a equal 3.316
units           metal

# generate the box and atom positions using a BCC lattice

variable nx equal ${nrep}
variable ny equal ${nrep}
variable nz equal ${nrep}

boundary        p p p

lattice         bcc $a
region          box block 0 ${nx} 0 ${ny} 0 ${nz}
create_box      1 box
create_atoms    1 box

mass 1 180.88


# POD potential
pair_style pod
pair_coeff * * Ta_param.pod Ta_coeff.pod Ta

# Setup output

thermo          10
thermo_modify norm yes

# Set up NVE run

timestep 0.5e-3
neighbor 1.0 bin
neigh_modify once no every 1 delay 0 check yes

# Run MD

velocity all create 300.0 4928459 loop geom
fix 1 all nve
run             ${nsteps}

"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay eam/alloy spin/exchange 4.0 spin/neel 4.0 pair style with pair coefficients * * eam/alloy Fe_Mishin2006.eam.alloy Fe and p p p boundary conditions with a timestep of 0.001 running for 200000 steps.","# bcc iron in a 3d periodic box

clear 
units 		metal
atom_style 	spin
# atom_style 	spin/kk

dimension 	3
boundary 	p p p

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice 	bcc 2.8665
region 		box block 0.0 3.0 0.0 3.0 0.0 3.0
create_box 	1 box
create_atoms 	1 box

# setting mass, mag. moments, and interactions for bcc iron

mass		1 55.845
set 		group all spin 2.2 0.0 0.0 1.0
velocity 	all create 0 4928459 rot yes dist gaussian

# pair_style 	hybrid/overlay eam/alloy spin/exchange 3.5
pair_style 	hybrid/overlay eam/alloy spin/exchange 4.0 spin/neel 4.0
pair_coeff 	* * eam/alloy Fe_Mishin2006.eam.alloy Fe
pair_coeff 	* * spin/exchange exchange 3.4 0.1 0.2171 1.841
pair_coeff 	* * spin/neel neel 4.0 0.02 0.0 1.841 0.0 0.0 1.0 

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin zeeman 0.0 0.0 0.0 1.0
fix             2 all langevin 0.0 0.0 0.0 48279
fix 		3 all langevin/spin 200.0 0.01 321
fix 		4 all nve/spin lattice moving
timestep	0.001

# compute and output options

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo_style    custom step time v_tmag temp v_emag ke pe etotal
thermo          200

run 		200000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using hybrid/overlay eam/fs lj/charmm/coul/long 10.0 12.0 momb 12.0 0.75 20.0 morse 5.5 pair style with pair coefficients *   *  eam/fs Ag_O1X5.5_O2X0.55.eam.fs NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL O1 NULL NULL NULL O2 Ag and p p p boundary conditions with a timestep of 0.001 running for 100 steps at temperature 413.0.","
# ----------------- Settings Section -----------------

units           metal 
boundary        p p p
neigh_modify    delay 0 every 1 check yes

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic
pair_style      hybrid/overlay eam/fs lj/charmm/coul/long 10.0 12.0 momb 12.0 0.75 20.0 morse 5.5
kspace_style    pppm 1e-5

# ----------------- Atom Definition Section -----------------

read_data system.data

pair_coeff   *   *  eam/fs Ag_O1X5.5_O2X0.55.eam.fs NULL NULL NULL NULL NULL NULL NULL NULL NULL NULL O1 NULL NULL NULL O2 Ag
pair_coeff  1*4   16     morse   0.00480  1.30   1.94 # HGA1, HGA2, HGA3
pair_coeff    5   16     morse   0.00722  1.14   4.85 # CG2R53  
pair_coeff  6*8   16     morse   0.00244  1.01   4.92 # CG311, CG321, CG331
pair_coeff    9   16     morse   0.00230  1.03   4.92 # CG3C52
pair_coeff   10   16     morse   0.00492  1.76   3.26 # NG2R53
pair_coeff   11   16     morse   0.00325  3.34   2.65 # OG2D1
pair_coeff   12   16     morse   0.00480  1.30   1.94 # HCA2
pair_coeff   13   16     morse   0.00448  1.06   2.13 # HCP1
pair_coeff   14   16     morse   0.00216  1.26   4.99 # CC32A
pair_coeff   15   16     morse   0.00217  2.09   3.43 # OC311
pair_coeff  1*4   16     momb    0.0 1.0 1.0 10.2847 2.361 # H
pair_coeff  5*9   16     momb    0.0 1.0 1.0 36.3619 2.812 # C
pair_coeff   10   16     momb    0.0 1.0 1.0 30.4846 2.757 # N
pair_coeff   11   16     momb    0.0 1.0 1.0 22.9973 2.702 # O
pair_coeff   12   16     momb    0.0 1.0 1.0 10.2847 2.361 # HCA2
pair_coeff   13   16     momb    0.0 1.0 1.0 10.2847 2.361 # HCP1
pair_coeff   14   16     momb    0.0 1.0 1.0 36.3619 2.812 # CC32A
pair_coeff   15   16     momb    0.0 1.0 1.0 22.9973 2.702 # OC311

# arithmetic mixing for CHARMM pair coeffs
pair_coeff   1   1  lj/charmm/coul/long    0.001520  2.387609  0.001520  2.387609 #HRA2  HRA2  
pair_coeff   1   2  lj/charmm/coul/long    0.001722  2.387609  0.001722  2.387609 #HRA2  HGA1  
pair_coeff   1   3  lj/charmm/coul/long    0.001520  2.387609  0.001520  2.387609 #HRA2  HGA2  
pair_coeff   1   4  lj/charmm/coul/long    0.001257  2.387609  0.001257  2.387609 #HRA2  HGA3  
pair_coeff   1   5  lj/charmm/coul/long    0.001150  3.153782  0.001150  3.153782 #HRA2  CG2R53
pair_coeff   1   6  lj/charmm/coul/long    0.001454  2.975602  0.000808  2.886512 #HRA2  CG311 
pair_coeff   1   7  lj/charmm/coul/long    0.001922  2.984511  0.000808  2.886512 #HRA2  CG321 
pair_coeff   1   8  lj/charmm/coul/long    0.002267  3.020147  0.000808  2.886512 #HRA2  CG331 
pair_coeff   1   9  lj/charmm/coul/long    0.001988  2.993420  0.000808  2.886512 #HRA2  CG3C52
pair_coeff   1  10  lj/charmm/coul/long    0.003630  2.841967  0.003630  2.841967 #HRA2  NG2R53
pair_coeff   1  11  lj/charmm/coul/long    0.002811  2.708333  0.002811  2.441063 #HRA2  OG2D1 
pair_coeff   1  12  lj/charmm/coul/long    0.001520  2.387609  0.001520  2.387609 #HRA2  HCA2  
pair_coeff   1  13  lj/charmm/coul/long    0.001739  1.393811  0.001739  1.393811 #HRA2  HCP1  
pair_coeff   1  14  lj/charmm/coul/long    0.001922  2.984511  0.000808  2.886512 #HRA2  CC32A 
pair_coeff   1  15  lj/charmm/coul/long    0.003558  2.766240  0.003558  2.766240 #HRA2  OC311 
pair_coeff   2   2  lj/charmm/coul/long    0.001950  2.387609  0.001950  2.387609 #HGA1  HGA1  
pair_coeff   2   3  lj/charmm/coul/long    0.001722  2.387609  0.001722  2.387609 #HGA1  HGA2  
pair_coeff   2   4  lj/charmm/coul/long    0.001424  2.387609  0.001424  2.387609 #HGA1  HGA3  
pair_coeff   2   5  lj/charmm/coul/long    0.001302  3.153782  0.001302  3.153782 #HGA1  CG2R53
pair_coeff   2   6  lj/charmm/coul/long    0.001646  2.975602  0.000916  2.886512 #HGA1  CG311 
pair_coeff   2   7  lj/charmm/coul/long    0.002177  2.984511  0.000916  2.886512 #HGA1  CG321 
pair_coeff   2   8  lj/charmm/coul/long    0.002567  3.020147  0.000916  2.886512 #HGA1  CG331 
pair_coeff   2   9  lj/charmm/coul/long    0.002252  2.993420  0.000916  2.886512 #HGA1  CG3C52
pair_coeff   2  10  lj/charmm/coul/long    0.004112  2.841967  0.004112  2.841967 #HGA1  NG2R53
pair_coeff   2  11  lj/charmm/coul/long    0.003184  2.708333  0.003184  2.441063 #HGA1  OG2D1 
pair_coeff   2  12  lj/charmm/coul/long    0.001722  2.387609  0.001722  2.387609 #HGA1  HCA2  
pair_coeff   2  13  lj/charmm/coul/long    0.001970  1.393811  0.001970  1.393811 #HGA1  HCP1  
pair_coeff   2  14  lj/charmm/coul/long    0.002177  2.984511  0.000916  2.886512 #HGA1  CC32A 
pair_coeff   2  15  lj/charmm/coul/long    0.004030  2.766240  0.004030  2.766240 #HGA1  OC311 
pair_coeff   3   3  lj/charmm/coul/long    0.001520  2.387609  0.001520  2.387609 #HGA2  HGA2  
pair_coeff   3   4  lj/charmm/coul/long    0.001257  2.387609  0.001257  2.387609 #HGA2  HGA3  
pair_coeff   3   5  lj/charmm/coul/long    0.001150  3.153782  0.001150  3.153782 #HGA2  CG2R53
pair_coeff   3   6  lj/charmm/coul/long    0.001454  2.975602  0.000808  2.886512 #HGA2  CG311 
pair_coeff   3   7  lj/charmm/coul/long    0.001922  2.984511  0.000808  2.886512 #HGA2  CG321 
pair_coeff   3   8  lj/charmm/coul/long    0.002267  3.020147  0.000808  2.886512 #HGA2  CG331 
pair_coeff   3   9  lj/charmm/coul/long    0.001988  2.993420  0.000808  2.886512 #HGA2  CG3C52
pair_coeff   3  10  lj/charmm/coul/long    0.003630  2.841967  0.003630  2.841967 #HGA2  NG2R53
pair_coeff   3  11  lj/charmm/coul/long    0.002811  2.708333  0.002811  2.441063 #HGA2  OG2D1 
pair_coeff   3  12  lj/charmm/coul/long    0.001520  2.387609  0.001520  2.387609 #HGA2  HCA2  
pair_coeff   3  13  lj/charmm/coul/long    0.001739  1.393811  0.001739  1.393811 #HGA2  HCP1  
pair_coeff   3  14  lj/charmm/coul/long    0.001922  2.984511  0.000808  2.886512 #HGA2  CC32A 
pair_coeff   3  15  lj/charmm/coul/long    0.003558  2.766240  0.003558  2.766240 #HGA2  OC311 
pair_coeff   4   4  lj/charmm/coul/long    0.001040  2.387609  0.001040  2.387609 #HGA3  HGA3  
pair_coeff   4   5  lj/charmm/coul/long    0.000951  3.153782  0.000951  3.153782 #HGA3  CG2R53
pair_coeff   4   6  lj/charmm/coul/long    0.001202  2.975602  0.000669  2.886512 #HGA3  CG311 
pair_coeff   4   7  lj/charmm/coul/long    0.001590  2.984511  0.000669  2.886512 #HGA3  CG321 
pair_coeff   4   8  lj/charmm/coul/long    0.001875  3.020147  0.000669  2.886512 #HGA3  CG331 
pair_coeff   4   9  lj/charmm/coul/long    0.001644  2.993420  0.000669  2.886512 #HGA3  CG3C52
pair_coeff   4  10  lj/charmm/coul/long    0.003003  2.841967  0.003003  2.841967 #HGA3  NG2R53
pair_coeff   4  11  lj/charmm/coul/long    0.002326  2.708333  0.002326  2.441063 #HGA3  OG2D1 
pair_coeff   4  12  lj/charmm/coul/long    0.001257  2.387609  0.001257  2.387609 #HGA3  HCA2  
pair_coeff   4  13  lj/charmm/coul/long    0.001439  1.393811  0.001439  1.393811 #HGA3  HCP1  
pair_coeff   4  14  lj/charmm/coul/long    0.001590  2.984511  0.000669  2.886512 #HGA3  CC32A 
pair_coeff   4  15  lj/charmm/coul/long    0.002943  2.766240  0.002943  2.766240 #HGA3  OC311 
pair_coeff   5   5  lj/charmm/coul/long    0.000870  3.919954  0.000870  3.919954 #CG2R53CG2R53
pair_coeff   5   6  lj/charmm/coul/long    0.001100  3.741775  0.000612  3.652685 #CG2R53CG311 
pair_coeff   5   7  lj/charmm/coul/long    0.001454  3.750684  0.000612  3.652685 #CG2R53CG321 
pair_coeff   5   8  lj/charmm/coul/long    0.001715  3.786320  0.000612  3.652685 #CG2R53CG331 
pair_coeff   5   9  lj/charmm/coul/long    0.001504  3.759593  0.000612  3.652685 #CG2R53CG3C52
pair_coeff   5  10  lj/charmm/coul/long    0.002746  3.608140  0.002746  3.608140 #CG2R53NG2R53
pair_coeff   5  11  lj/charmm/coul/long    0.002127  3.474505  0.002127  3.207235 #CG2R53OG2D1 
pair_coeff   5  12  lj/charmm/coul/long    0.001150  3.153782  0.001150  3.153782 #CG2R53HCA2  
pair_coeff   5  13  lj/charmm/coul/long    0.001316  2.159984  0.001316  2.159984 #CG2R53HCP1  
pair_coeff   5  14  lj/charmm/coul/long    0.001454  3.750684  0.000612  3.652685 #CG2R53CC32A 
pair_coeff   5  15  lj/charmm/coul/long    0.002692  3.532413  0.002692  3.532413 #CG2R53OC311 
pair_coeff   6   6  lj/charmm/coul/long    0.001390  3.563595  0.000430  3.385415 #CG311 CG311 
pair_coeff   6   7  lj/charmm/coul/long    0.001838  3.572504  0.000430  3.385415 #CG311 CG321 
pair_coeff   6   8  lj/charmm/coul/long    0.002168  3.608140  0.000430  3.385415 #CG311 CG331 
pair_coeff   6   9  lj/charmm/coul/long    0.001901  3.581413  0.000430  3.385415 #CG311 CG3C52
pair_coeff   6  10  lj/charmm/coul/long    0.003471  3.429960  0.001931  3.340870 #CG311 NG2R53
pair_coeff   6  11  lj/charmm/coul/long    0.002688  3.296326  0.001495  2.939966 #CG311 OG2D1 
pair_coeff   6  12  lj/charmm/coul/long    0.001454  2.975602  0.000808  2.886512 #CG311 HCA2  
pair_coeff   6  13  lj/charmm/coul/long    0.001663  1.981804  0.000925  1.892714 #CG311 HCP1  
pair_coeff   6  14  lj/charmm/coul/long    0.001838  3.572504  0.000430  3.385415 #CG311 CC32A 
pair_coeff   6  15  lj/charmm/coul/long    0.003403  3.354233  0.001893  3.265143 #CG311 OC311 
pair_coeff   7   7  lj/charmm/coul/long    0.002430  3.581413  0.000430  3.385415 #CG321 CG321 
pair_coeff   7   8  lj/charmm/coul/long    0.002866  3.617049  0.000430  3.385415 #CG321 CG331 
pair_coeff   7   9  lj/charmm/coul/long    0.002514  3.590322  0.000430  3.385415 #CG321 CG3C52
pair_coeff   7  10  lj/charmm/coul/long    0.004590  3.438869  0.001931  3.340870 #CG321 NG2R53
pair_coeff   7  11  lj/charmm/coul/long    0.003555  3.305235  0.001495  2.939966 #CG321 OG2D1 
pair_coeff   7  12  lj/charmm/coul/long    0.001922  2.984511  0.000808  2.886512 #CG321 HCA2  
pair_coeff   7  13  lj/charmm/coul/long    0.002199  1.990713  0.000925  1.892714 #CG321 HCP1  
pair_coeff   7  14  lj/charmm/coul/long    0.002430  3.581413  0.000430  3.385415 #CG321 CC32A 
pair_coeff   7  15  lj/charmm/coul/long    0.004499  3.363142  0.001893  3.265143 #CG321 OC311 
pair_coeff   8   8  lj/charmm/coul/long    0.003380  3.652685  0.000430  3.385415 #CG331 CG331 
pair_coeff   8   9  lj/charmm/coul/long    0.002964  3.625958  0.000430  3.385415 #CG331 CG3C52
pair_coeff   8  10  lj/charmm/coul/long    0.005413  3.474505  0.001931  3.340870 #CG331 NG2R53
pair_coeff   8  11  lj/charmm/coul/long    0.004192  3.340871  0.001495  2.939966 #CG331 OG2D1 
pair_coeff   8  12  lj/charmm/coul/long    0.002267  3.020147  0.000808  2.886512 #CG331 HCA2  
pair_coeff   8  13  lj/charmm/coul/long    0.002593  2.026349  0.000925  1.892714 #CG331 HCP1  
pair_coeff   8  14  lj/charmm/coul/long    0.002866  3.617049  0.000430  3.385415 #CG331 CC32A 
pair_coeff   8  15  lj/charmm/coul/long    0.005306  3.398778  0.001893  3.265143 #CG331 OC311 
pair_coeff   9   9  lj/charmm/coul/long    0.002600  3.599231  0.000430  3.385415 #CG3C52CG3C52
pair_coeff   9  10  lj/charmm/coul/long    0.004748  3.447778  0.001931  3.340870 #CG3C52NG2R53
pair_coeff   9  11  lj/charmm/coul/long    0.003677  3.314144  0.001495  2.939966 #CG3C52OG2D1 
pair_coeff   9  12  lj/charmm/coul/long    0.001988  2.993420  0.000808  2.886512 #CG3C52HCA2  
pair_coeff   9  13  lj/charmm/coul/long    0.002275  1.999622  0.000925  1.892714 #CG3C52HCP1  
pair_coeff   9  14  lj/charmm/coul/long    0.002514  3.590322  0.000430  3.385415 #CG3C52CC32A 
pair_coeff   9  15  lj/charmm/coul/long    0.004654  3.372051  0.001893  3.265143 #CG3C52OC311 
pair_coeff  10  10  lj/charmm/coul/long    0.008670  3.296325  0.008670  3.296325 #NG2R53NG2R53
pair_coeff  10  11  lj/charmm/coul/long    0.006714  3.162691  0.006714  2.895421 #NG2R53OG2D1 
pair_coeff  10  12  lj/charmm/coul/long    0.003630  2.841967  0.003630  2.841967 #NG2R53HCA2  
pair_coeff  10  13  lj/charmm/coul/long    0.004154  1.848169  0.004154  1.848169 #NG2R53HCP1  
pair_coeff  10  14  lj/charmm/coul/long    0.004590  3.438869  0.001931  3.340870 #NG2R53CC32A 
pair_coeff  10  15  lj/charmm/coul/long    0.008498  3.220598  0.008498  3.220598 #NG2R53OC311 
pair_coeff  11  11  lj/charmm/coul/long    0.005200  3.029056  0.005200  2.494516 #OG2D1 OG2D1 
pair_coeff  11  12  lj/charmm/coul/long    0.002811  2.708333  0.002811  2.441063 #OG2D1 HCA2  
pair_coeff  11  13  lj/charmm/coul/long    0.003217  1.714535  0.003217  1.447265 #OG2D1 HCP1  
pair_coeff  11  14  lj/charmm/coul/long    0.003555  3.305235  0.001495  2.939966 #OG2D1 CC32A 
pair_coeff  11  15  lj/charmm/coul/long    0.006581  3.086964  0.006581  2.819694 #OG2D1 OC311 
pair_coeff  12  12  lj/charmm/coul/long    0.001520  2.387609  0.001520  2.387609 #HCA2  HCA2  
pair_coeff  12  13  lj/charmm/coul/long    0.001739  1.393811  0.001739  1.393811 #HCA2  HCP1  
pair_coeff  12  14  lj/charmm/coul/long    0.001922  2.984511  0.000808  2.886512 #HCA2  CC32A 
pair_coeff  12  15  lj/charmm/coul/long    0.003558  2.766240  0.003558  2.766240 #HCA2  OC311 
pair_coeff  13  13  lj/charmm/coul/long    0.001990  0.400014  0.001990  0.400014 #HCP1  HCP1  
pair_coeff  13  14  lj/charmm/coul/long    0.002199  1.990713  0.000925  1.892714 #HCP1  CC32A 
pair_coeff  13  15  lj/charmm/coul/long    0.004071  1.772443  0.004071  1.772443 #HCP1  OC311 
pair_coeff  14  14  lj/charmm/coul/long    0.002430  3.581413  0.000430  3.385415 #CC32A CC32A 
pair_coeff  14  15  lj/charmm/coul/long    0.004499  3.363142  0.001893  3.265143 #CC32A OC311 
pair_coeff  15  15  lj/charmm/coul/long    0.008330  3.144872  0.008330  3.144872 #OC311 OC311 


special_bonds   charmm

# ----------------- Run Section -----------------

timestep        0.001

minimize	1.0e-3 1.0e-5 1000 10000
reset_timestep  0

velocity        all create 413.0 12378 dist gaussian

thermo          10
thermo_style    custom step pe ke etotal temp press pxx pyy pzz

variable STEP equal step
variable PE equal pe
variable KE equal ke
variable ETOTAL equal etotal
variable TEMP equal temp
variable VOL equal vol
variable PRESS equal press
variable LX equal lx
variable LZ equal lz
variable PXX equal pxx
variable PYY equal pyy
variable PZZ equal pzz

fix             1 all nvt temp 413.0 413.0 0.1 fixedpoint 0.0 0.0 0.0
#fix 			thermo_output all print 2000 ""${STEP} ${PE} ${KE} ${ETOTAL} ${TEMP} ${VOL} ${PRESS} ${LX} ${LZ} ${PXX} ${PYY} ${PZZ}"" file thermo.lammps title ""# Step PotEng KinEng TotEng Temp Volume Press Lx Lz Pxx Pyy Pzz""

#dump		    1 all custom 10 traj_npt.lammpstrj id mol type x y z ix iy iz

run             100
"
"Generate a LAMMPS input script for a general simulation using vashishta/table 100000 0.2 pair style with pair coefficients * * InP.vashishta In P and p p p boundary conditions running for 0 steps.","# calculate the energy volume curve for InP zincblende

# define volume range and filename

variable	ndelta equal 100
variable	volatom_min equal 20.0
variable	volatom_max equal 29.0
variable	evsvolfile string evsvol.dat

# set up cell 

units		metal
 
boundary	p p p

# setup loop variables for box volume

variable	amin equal ${volatom_min}^(1/3)*2
variable 	delta equal (${volatom_max}-${volatom_min})/${ndelta} 
variable	scale equal (${delta}/v_volatom+1)^(1/3)

# set up 8 atom InP zincblende unit cell

lattice diamond ${amin}

region		box prism &
	 	0 1 &
		0 1 &
		0 1 &
		0 0 0

create_box	2 box

create_atoms	1	box       &
			basis 5 2 &
			basis 6 2 &
			basis 7 2 &
			basis 8 2

mass 		1 114.76
mass 		2 30.98

# choose potential

pair_style 	vashishta/table 100000 0.2
pair_coeff 	* * InP.vashishta In P

# setup neighbor style

neighbor 	1.0 nsq
neigh_modify 	once no every 1 delay 0 check yes

# setup output

thermo_style 	custom step temp pe press vol
thermo_modify 	norm no
variable 	volatom equal vol/atoms
variable 	eatom equal pe/atoms
print 		""# Volume [A^3/atom] Energy [eV/atom]"" file ${evsvolfile}

# loop over range of volumes

label 		loop
variable 	i loop ${ndelta}

change_box 	all x scale ${scale} y scale ${scale} z scale ${scale} remap

# calculate energy
# no energy minimization needed for zincblende
 
run 		0
print 		""${volatom} ${eatom}"" append ${evsvolfile}

next 		i
jump 		SELF loop
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using hybrid/overlay lj/cut 2.5 tracker pair style with pair coefficients * * lj/cut 1.0 1.0 2.5 running for 1000 #0 steps.","# 3d Lennard-Jones melt with tracking

units		lj
atom_style	atomic

lattice		fcc 0.8442
region		box block 0 4 0 4 0 4
create_box	2 box
create_atoms	2 box
mass		1 1.0
mass            2 1.0
velocity	all create 2.0 87287 loop geom

pair_style	hybrid/overlay lj/cut 2.5 tracker
pair_coeff	* * lj/cut 1.0 1.0 2.5
pair_coeff  * * tracker 2.5

neighbor	0.3 bin
neigh_modify	every 20 delay 0 check no

fix		1 all nve
fix     2 all pair/tracker 1000 id1 id2 time/created time/broken time/total time/min 0.5
fix     3 all ave/histo 1000 1 1000 0 6 30 f_2[5] mode vector kind local file lifetime_hist.dat 

dump 1 all local 1000 contact_history.dat f_2[1] f_2[2] f_2[3] f_2[4] 
dump_modify 1 header no

# compute 1 all property/local patom1 patom2
# dump 2 all local 1 pairs.dat c_1[1] c_1[2]

# dump 3 all atom 1 atoms.dat

thermo		50
run 		1000 #0
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 3.0 pair style with pair coefficients * * 1.0 1.0 running for 10000 steps.","# GCMC for LJ simple fluid, no dynamics
# T = 2.0
# rho ~ 0.5
# p ~ 1.5
# mu_ex ~ 0.0
# comparable to Frenkel and Smit GCMC Case Study, Figure 5.8

# variables modifiable using -var command line switch

variable        mu index -1.25
variable        temp index 2.0
variable        disp index 1.0
variable        lbox index 5.0

# global model settings

units           lj
atom_style      atomic
pair_style      lj/cut 3.0
pair_modify     tail no # turn of to avoid triggering full_energy

# box

region          box block 0 ${lbox} 0 ${lbox} 0 ${lbox}
create_box      1 box

# lj parameters

pair_coeff      * * 1.0 1.0
mass            * 1.0

# we recommend setting up a dedicated group for gcmc

group           gcmcgroup type 1

# gcmc

fix             mygcmc gcmcgroup gcmc 1 100 100 1 29494 ${temp} ${mu} ${disp}

# atom count

variable        type1 atom ""type==1""
group           type1 dynamic gcmcgroup var type1
variable        n1 equal count(type1)

# averaging

variable        rho equal density
variable        p equal press
variable        nugget equal 1.0e-8
variable        lambda equal 1.0
variable        muex equal ${mu}-${temp}*ln(density*${lambda}+${nugget})
fix             ave all ave/time 10 100 1000 v_rho v_p v_muex v_n1 ave one file rho_vs_p.dat
variable        rhoav equal f_ave[1]
variable        pav equal f_ave[2]
variable        muexav equal f_ave[3]
variable        n1av equal f_ave[4]

# output

variable        tacc equal f_mygcmc[2]/(f_mygcmc[1]+${nugget})
variable        iacc equal f_mygcmc[4]/(f_mygcmc[3]+${nugget})
variable        dacc equal f_mygcmc[6]/(f_mygcmc[5]+${nugget})
compute_modify  thermo_temp dynamic/dof yes
thermo_style    custom step temp press pe ke density atoms v_iacc v_dacc v_tacc v_rhoav v_pav v_muexav v_n1av
thermo          1000

# run

run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an peri system using peri/lps pair style with pair coefficients * * 14.9e9 14.9e9 0.0015001 0.0005 0.25 and s s s boundary conditions with a timestep of 1.0e-7 running for 1000 steps.","# small Peridynamic cylinder hit by projectile

units           si
boundary        s s s
atom_style      peri
atom_modify     map array
neighbor        0.0010 bin

# small target

lattice         sc 0.0005
region          target cylinder y 0.0 0.0 0.0050 -0.0050 0.0 units box
create_box      1 target
create_atoms    1 region target

pair_style      peri/lps
pair_coeff      * * 14.9e9 14.9e9 0.0015001 0.0005 0.25
set             group all density 2200
set             group all volume 1.25e-10
velocity        all set 0.0 0.0 0.0 sum no units box
fix             1 all nve

# spherical indenter to shatter target

variable        y0 equal 0.00155
variable        vy equal -100
variable        y equal ""v_y0 + step*dt*v_vy""

fix             2 all indent 1e17 sphere 0.0000 v_y 0.0000 0.0015 units box

compute         1 all damage/atom
timestep        1.0e-7
thermo          100

#dump            1 all custom 100 dump.peri id type x y z c_1

#dump           2 all image 50 image.*.jpg type type &
#               axes yes 0.8 0.02 view 80 -30 adiam 0.0006
#dump_modify    2 pad 4

#dump           3 all movie 50 movie.mpg type type &
#               axes yes 0.8 0.02 view 80 -30 adiam 0.0006
#dump_modify    3 pad 4

run             1000
"
"Generate a LAMMPS input script for a NVT simulation of an charge system using comb pair style with pair coefficients * * ffield.comb Hf O and p p p boundary conditions with a timestep of 0.00020 running for 1 steps at temperature 300.0.","units		metal
atom_style	charge
dimension       3
boundary        p p p

read_data  	data.m-HfO2
#read_data  	data.t-HfO2
#read_data  	data.c-HfO2

mass		1 178.0
group    	type1 type 1
compute   	charge1 type1 property/atom q
compute   	q1 type1 reduce ave c_charge1
mass		2 16.00
group    	type2 type 2
compute   	charge2 type2 property/atom q
compute   	q2 type2 reduce ave c_charge2

pair_style	comb
pair_coeff	* * ffield.comb Hf O

neighbor	0.5 bin
neigh_modify	every 10 delay 10 check yes 

timestep        0.00020

thermo_style	custom step temp etotal pe evdwl ecoul press vol lx ly lz xz c_q1 c_q2
thermo_modify	norm yes

fix		1 all nvt temp 300.0 300.0 0.1
thermo      	1
run    		1
fix  		2 all qeq/comb 1 0.003 file fq.out
run    		5

unfix    	1
fix		1 all box/relax aniso 0.0 vmax 0.0002

# should minimize to higher tolerance in practice

#minimize	1.0e-12  1.0e-18  1000  10000
minimize	1.0e-4  1.0e-6  1000  10000
min_modify	dmax 0.005 line quadratic

#dump		1 all cfg 10 *.cfg id type xs ys zs q vx vy vz fx fy fz
#dump_modify	1 element Hf O

#dump		2 all image 10 image.*.jpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	2 pad 2 element Hf O

#dump		3 all movie 10 movie.mpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	3 pad 2 element Hf O

velocity	all create 300.1 2398378
run  		10
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/long 12.0 12.0 pair style with pair coefficients 1    1      0.210939     3.183950  # ODw ODw and p p p boundary conditions with a timestep of 1.0 running for 2000 steps.","units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
special_bonds lj/coul 0.0 0.0 0.5

pair_style lj/cut/coul/long 12.0 12.0
kspace_style pppm 1.0e-3

comm_modify vel yes
read_data data.swm4-ndp

pair_coeff    1    1      0.210939     3.183950  # ODw ODw
pair_coeff    *   2*      0.000000     0.0

group ATOMS type 1:3
group CORES type 1
group DRUDES type 4

variable TK equal 300.0
variable TDK equal 1.0
variable PBAR equal 1.0

neighbor 2.0 bin

timestep 1.0

fix DRUDE all drude C N N D

velocity ATOMS create ${TK} 12345
velocity DRUDES create ${TDK} 12345

delete_bonds ATOMS multi

fix TEMP all langevin/drude ${TK} 100. 1256 ${TDK} 20. 13977 zero yes
fix NPH ATOMS rigid/nph/small molecule iso ${PBAR} ${PBAR} 500.
fix NVE DRUDES nve

compute TEMP all temp/drude

thermo_style custom step cpu etotal ke pe ebond eangle evdwl ecoul elong press vol temp c_TEMP[1] c_TEMP[2]
thermo 20

run 2000

"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/smooth/linear 5.456108274435118 pair style with pair coefficients * * 0.7242785984051078 2.598146797350056 and p p p boundary conditions with a timestep of 0.0 running for 1 steps.","# This test calculates the J-integral for a sequence of different loads
# for a system with a crack tip.
#
# loops around crack and one around undefected material
# loop 0 - does not include crack
# loop 1 - smallest contour around left crack tip
# loop 2 - medium   contour around left crack tip
# loop 3 - largest  contour around left crack tip
# loop 4 - medium   contour around right crack tip
#for Lennard-Jones potential for gold:
# surface energy (gamma) of 0.1599 eV/^2 = 2.56191 J/m2.
# 2*gamma = 0.3198 eV/^2 = 5.12382 J/m2
# using the internal nktv2p conversion factor,
# the units of eshelby_stress are eV/^3, and
# the resulting boundary integral is eV/ since we also include thickness (a
# boundary surface area rather than a periphery). If we multiply the 2*gamma
# quantity times the thickness t = 3*4.08 = 12.24 , we obtain 2*gamma*t =
# 3.914352 eV/, which agrees with the mesh calculation.
echo both
log    eshelby_static.log
units    metal
dimension  3
boundary  p p p
atom_style      atomic
# create system
#lattice fcc 3.615 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
#lattice fcc 3.615 origin 0.2 0.2 0.2 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
lattice fcc 4.08 origin 0.25 0.25 0.25
region    SYSTEM    block -10 10 -10 10 0 3
region    UPPER     block -10 10   0 10 0 3
region    LOWER     block -10  0 -10 10 0 3
create_box  1 SYSTEM
create_atoms  1 region SYSTEM
mass    1 63.55
group    internal region SYSTEM
group    upper region UPPER
group    lower region LOWER
#pair_style  eam
#pair_coeff  * * ../../../../potentials/Cu_u3.eam
#pair_style lj/smooth 8.0 10.0
#pair_coeff * * 10.0 1.5
pair_style  lj/smooth/linear 5.456108274435118
pair_coeff    * * 0.7242785984051078 2.598146797350056
# define region
region  abovecrack block -2.01 2.01  0 8 INF INF units lattice
group   abovecrack region abovecrack
region  belowcrack block -2.01 2.01 -8 0 INF INF units lattice
group   belowcrack region belowcrack
neighbor  1.0 bin
neigh_modify  delay 1000000
neigh_modify  exclude group abovecrack belowcrack
thermo    10
compute_modify  thermo_temp extra/dof 0
region  FORCECHECK block -6  0  6 10 0 3
group   FORCECHECK region FORCECHECK
compute   fxsum FORCECHECK reduce sum fx
compute   fysum FORCECHECK reduce sum fy
compute   fzsum FORCECHECK reduce sum fz
thermo_style  custom step ke pe press c_fxsum c_fysum c_fzsum
thermo_modify  format 1 %4i  format 2 %3.1g  format 3 %20.16g
timestep  0.0
# (1) minimize the system to get a relaxed configuration
min_modify line quadratic
variable tol equal 1.e-11
minimize  0.0 ${tol} 100000 1000000
write_restart  eshelby.restart
# (2) pull crack apart
reset_timestep  0
fix             PK1 internal atc field
# NOTE tune this relative to lattice size
fix_modify      PK1 mesh create 10 10 1 SYSTEM p f p
fix_modify      PK1 fields none
fix_modify      PK1 fields add mass_density internal_energy temperature stress displacement
fix_modify      PK1 fields add eshelby_stress transformed_stress
fix_modify      PK1 gradients add displacement
fix_modify      PK1 set reference_potential_energy
fix_modify      PK1 output eshelby_staticFE 1 text binary tensor_components
#fix_modify     PK1  on_the_fly
#-- make concentric loops around one/both of the crack tips
#-- & another around undefected material (loop0)
fix_modify      PK1 mesh create_faceset loop0 box -6  0  6 10 -INF INF outward
fix_modify      PK1 output boundary_integral eshelby_stress faceset loop0
fix_modify      PK1 output boundary_integral         stress faceset loop0
fix_modify      PK1 output boundary_integral         internal_energy faceset loop0
#fix_modify      PK1  output boundary_integral displacement_gradient faceset loop0
fix_modify      PK1 mesh create_faceset loop1 box -6  0 -2 2 -INF INF outward
fix_modify      PK1 output boundary_integral eshelby_stress faceset loop1
fix_modify      PK1 output boundary_integral         stress faceset loop1
fix_modify      PK1 output boundary_integral         internal_energy faceset loop1
#fix_modify      PK1  output boundary_integral displacement_gradient faceset loop1
fix_modify      PK1 mesh create_faceset loop2 box -8  0 -4 4 -INF INF outward
fix_modify      PK1 output boundary_integral eshelby_stress faceset loop2
fix_modify      PK1 output boundary_integral         stress faceset loop2
fix_modify      PK1 output boundary_integral         internal_energy faceset loop2
#fix_modify      PK1  output boundary_integral displacement_gradient faceset loop2
fix_modify      PK1 mesh create_faceset loop3 box -10 0 -6 6 -INF INF outward
fix_modify      PK1 output boundary_integral eshelby_stress faceset loop3
fix_modify      PK1 output boundary_integral         stress faceset loop3
fix_modify      PK1 output boundary_integral         internal_energy faceset loop3
#fix_modify      PK1  output boundary_integral displacement_gradient faceset loop3
fix_modify      PK1 mesh create_faceset loop4 box  0  8 -6 6 -INF INF outward
fix_modify      PK1 output boundary_integral eshelby_stress faceset loop4
fix_modify      PK1 output boundary_integral         stress faceset loop4
fix_modify      PK1 output boundary_integral         internal_energy faceset loop4
#fix_modify      PK1  output boundary_integral displacement_gradient faceset loop4
#-- compute across crack jumps in displacement
#fix             PK1upper internal atc hardy
#fix_modify      PK1upper mesh create 10 5 1 UPPER p f p
#fix_modify      PK1upper fields none
#fix_modify      PK1upper fields add displacement
#fix             PK1lower lower atc hardy
#fix_modify      PK1lower mesh create 10 5 1 LOWER p f p
#fix_modify      PK1lower fields none
#fix_modify      PK1lower fields add displacement
# initial (1)
run   1
# increment (2)
variable L equal 20
variable n equal 10
variable i loop $n
# NOTE this does not generate KE
# NOTE crack is complete at i =8 / 10
variable s equal 0.08*$L/$n
label loop_i
  variable strain equal $i*$s
  print "">>> step $i, total strain ${strain}""
  change_box all y delta 0 $s remap units lattice
  minimize  0.0 ${tol} 100000 1000000
# reset_timestep  $i
  run 1
next i
jump in.eshelby_static loop_i
"
"Generate a LAMMPS input script for a NVT simulation of an electron system using eff/cut 50.112 pair style with pair coefficients * * and p p p boundary conditions with a timestep of 0.005 running for 100 steps at temperature 300.0.","variable        sname index Li-dendritic

units 		electron
newton		on
boundary        p p p

atom_style	electron

read_data  	data.${sname}
#read_restart	${sname}.min.restart

pair_style      eff/cut 50.112
pair_coeff	* * 

comm_modify	vel yes

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo          10
thermo_style    custom step pe temp press
thermo_modify   temp effTemp press effPress

print		""Starting minimizer""
min_style       cg

compute         1 all property/atom spin eradius
#dump            1 all custom 100 ${sname}.min.lammpstrj id type x y z q c_1[1] c_1[2]
#dump            2 all xyz 100 ${sname}.min.xyz
min_modify      line quadratic dmax 0.05
minimize        0 1.0e-7 100 100

write_restart	${sname}.min.restart

#undump		1
#undump		2

# NVT
reset_timestep	0
timestep	0.005

print		""Starting nvt""
fix		1 all nvt/eff temp 300.0 300.0 0.1
dump            1 all custom 100 ${sname}.nvt.lammpstrj id type x y z c_1[1] c_1[2]
dump            2 all xyz 100 ${sname}.nvt.xyz
restart		100 ${sname}.nvt.restart1 ${sname}.nvt.restart2

run		100

undump		1
undump		2

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system and f f f boundary conditions with a timestep of 0.001 running for $r steps.","# needs description
# STEP THE GATE VOLTAGE UP
# NEED TO TURN OFF T EQNS FOR VACUUM
# HACK need to define well and open bcs
echo both
#variable iter equal 2 # need two for potential to affect density
variable iter1 equal 4  # NOTE <<<<
variable iter2 equal 25 # NOTE <<<<
variable r    equal 1
variable nx equal 12 # 30 40 10
variable mx equal 4  # 4  2
#variable ny equal ${nx}
variable ny equal 12 # 30 40
variable my equal 8 # 12 6
variable nz equal 1
variable hx  equal 1.0
variable hy  equal ${hx}*${nx}/${ny}
variable l  equal -${hx}*${nx}
variable u  equal  ${hx}*${nx}
variable w  equal  ${hy}*${my}
variable q  equal  ${hx}*${mx}
variable y equal ${nx}+1-${mx}
variable T  equal 300
variable S equal 1
variable n0 equal 0.00007
variable v0 equal 1000.0
variable J0 equal ${n0}*${v0}
print ""prescribed flux: ${J0}""
variable Vs equal 1.0
#variable Vg equal 1.0 # 10.0 0.0
variable tol equal 0.01
#################################################
atom_style      atomic
timestep  0.001
boundary      f f f
lattice       fcc 1.0
region        BOX block ${l} ${u} ${l} ${u} 0 1
create_box  1 BOX
mass          * 12.01
atom_modify     sort 0 1
#    ID  group atc PhysicsType ParameterFile
fix  AtC all   atc convective_drift_diffusion-schrodinger SiVacuum_cddm_schrodinger.mat
#            ID  part keywords    nx ny nz region
fix_modify   AtC mesh create ${nx} ${ny} ${nz}  BOX f f p
# surfaces & regions
variable a equal $l-${tol}
variable b equal $l+$q+${tol}
variable c equal -$w-${tol}
variable d equal  $w+${tol}
variable e equal $l+$q-${tol}
fix_modify AtC mesh create_nodeset bot -INF INF $a $b -INF INF
fix_modify AtC mesh create_nodeset lbc   $a $b -INF INF -INF INF
variable a equal $u-$q-${tol}
variable b equal $u+${tol}
variable e equal $u-$q+${tol}
fix_modify AtC mesh create_nodeset top -INF INF $a $b -INF INF 
fix_modify AtC mesh create_nodeset rbc   $a $b -INF INF -INF INF
variable a equal -$w-${tol}
variable b equal  $w+${tol}
variable c equal  $l+$q-${tol}
variable d equal  $u-$q+${tol}
fix_modify AtC mesh create_elementset wire $c $d $a $b  -INF INF
fix_modify AtC mesh create_nodeset    wire $c $d $a $b  -INF INF
variable e equal $c+2*${tol}
variable f equal $c+${tol}
fix_modify AtC mesh create_nodeset lwire   $c $e $a $b  -INF INF
fix_modify AtC mesh create_faceset lwire   $f INF $a $b  -INF INF
variable e equal $d-2*${tol}
variable f equal $d-${tol}
fix_modify AtC mesh create_nodeset rwire   $e $d $a $b  -INF INF
fix_modify AtC mesh create_faceset rwire   -INF $f $a $b  -INF INF
variable e equal $a+2*${tol}
fix_modify AtC mesh create_nodeset bwire   $c $d $a $e  -INF INF
variable e equal $b-2*${tol}
fix_modify AtC mesh create_nodeset twire   $c $d $e $b  -INF INF
# new material
fix_modify AtC material wire Si
# simplify
fix_modify  AtC extrinsic one_dimensional x wire $y
#fix_modify  AtC extrinsic poisson_solver iterative 
fix_modify AtC  internal_quadrature off 
fix_modify AtC control  thermal none
fix_modify AtC extrinsic electron_integration implicit 1
fix_modify AtC extrinsic schrodinger_poisson_solver self_consistency ${iter1}
#fix_modify AtC extrinsic conserve density 10
fix_modify AtC extrinsic schrodinger_poisson_solver conserve flux ${iter2}
fix_modify AtC extrinsic schrodinger_poisson_solver initial_fermi_level 0.1
fix_modify AtC extrinsic schrodinger_poisson_solver safe_fermi_increment 0.1
#fix_modify AtC extrinsic initial_fermi_level 0.5
# isolate system: 
# diffusion: dn/dx = 0
# drift    : n = 0
# fix temperature
fix_modify AtC  fix temperature          all $T
fix_modify AtC  initial electron_temperature all $T
fix_modify AtC  fix electron_temperature all $T # <<<
#fix_modify AtC  unfix electron_temperature wire
fix_modify AtC  fix electron_temperature lbc $T
fix_modify AtC  fix electron_temperature rbc $T
### NOTE there seems to be leakage into the vacuum
# electric potential ic
fix_modify AtC  initial electric_potential   all 0.0
fix_modify AtC  fix electric_potential lbc 0
fix_modify AtC  fix electric_potential rbc ${Vs}
#fix_modify AtC  fix electric_potential bot ${Vg} # remove this if Vg=0
# electron density ic
fix_modify AtC  initial electron_density all 0
fix_modify AtC  fix electron_density all 0 
fix_modify AtC  unfix electron_density wire
fix_modify AtC  initial electron_density wire ${n0}
fix_modify AtC  fix electron_density twire 0.0
fix_modify AtC  fix electron_density bwire 0.0
fix_modify AtC  fix electron_density lwire ${n0}
fix_modify AtC  fix electron_density rwire ${n0}
#fix_modify AtC  fix electron_density lbc ${n0}
#fix_modify AtC  fix electron_density rbc ${n0}
fix_modify AtC  unfix electron_density lwire 
fix_modify AtC  unfix electron_density rwire
fix_modify AtC  fix_flux electron_density lwire  ${J0} # <<<<
fix_modify AtC  fix_flux electron_density rwire -${J0} # <<<<
# HACK
#fix_modify AtC  fix electron_density all 0 
# electron wavefunction ic/bcs
fix_modify AtC  initial electron_wavefunction all 0.0
fix_modify AtC  fix electron_wavefunction top 0.0
fix_modify AtC  fix electron_wavefunction bot 0.0
fix_modify AtC  fix electron_wavefunction all 0 
fix_modify AtC  unfix electron_wavefunction wire
#fix_modify AtC  fix electron_wavefunction lwire 0.0 # <<<< bit of hack
#fix_modify AtC  fix electron_wavefunction rwire 0.0 # <<<< bit of hack
fix_modify AtC  fix electron_wavefunction twire 0.0
fix_modify AtC  fix electron_wavefunction bwire 0.0

fix_modify AtC initial electron_velocity x all 0.0
fix_modify AtC initial electron_velocity y all 0.0
fix_modify AtC initial electron_velocity z all 0.0
fix_modify AtC fix electron_velocity x all ${v0}
fix_modify AtC fix electron_velocity y all 0.0
fix_modify AtC fix electron_velocity z all 0.0
fix_modify AtC initial electron_velocity x wire ${v0}
fix_modify AtC fix     electron_velocity x wire ${v0}

thermo  1
# f_AtC:1 thermal energy, 2 avg T, 3 electron energy, 4 avg Te, 5 total n
thermo_style custom step cpu f_AtC[1] f_AtC[2] f_AtC[3] f_AtC[4] f_AtC[5]
thermo_modify  format 1 %5i format 2 %7.2g
fix_modify AtC  output schrodinger-poisson2d_convectiveFE $r full_text binary tensor_components
fix_modify AtC mesh output schrodinger-poisson2dMESH
run     $r
# NOW BIAS
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/cut/coul/long 12.0 12.0 pair style with pair coefficients 1 1  0.1553  3.166 # O O and p p p boundary conditions with a timestep of 1.0 running for 300000 steps.","
units        real
boundary p p p

atom_style   full
bond_style   harmonic
angle_style  harmonic

special_bonds lj/coul 0.0 0.0 0.5

pair_style   lj/cut/coul/long 12.0 12.0
pair_modify tail no
kspace_style pppm 1.0e-5

read_data data.spce # 8x8x16 SPCE molecules in a 30x30x100 box

bond_coeff   1    517.630258   1.0
angle_coeff  1    37.950526    109.47
pair_coeff   1 1  0.1553  3.166 # O O
pair_coeff   1 2  0.0     1.0   # O H
pair_coeff   2 2  0.0     1.0   # H H

# don't use fix shake with compute fep/ta
# fix SHAKE all shake 0.0001 20 0 b 1

neighbor 2.0 bin
# neigh_modify delay 0 every 1 check yes

timestep 1.0

variable TK equal 300.0
compute TA all fep/ta ${TK} xy 1.0005

velocity all create ${TK} 12345

thermo_style custom step temp press etotal pe c_TA[*]
thermo 5000

fix NVT all nvt temp ${TK} ${TK} 100
run 300000

reset_timestep 0

variable gamma_v equal 100*(pzz-0.5*(pxx+pyy))/2/100 # surface tension via the mechanical route

fix FEP all ave/time 100 1000 100000 c_TA[*] v_gamma_v ave running file spce.fep.ta

run 2000000

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut ${rc} pair style with pair coefficients * * 1 1 running for 10000 steps.","# sample LAMMPS input script for viscosity of 2d LJ liquid
# Green-Kubo method via fix ave/correlate

# settings

variable	x equal 20
variable	y equal 20

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

variable    p equal 400     # correlation length
variable    s equal 5       # sample interval
variable    d equal $p*$s   # dump interval 

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

lattice         sq2 ${rho}
region          simbox block 0 $x 0 $y -0.1 0.1
create_box      1 simbox
create_atoms    1 box

pair_style      lj/cut ${rc}
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287

# equilibration run

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        3 all enforce2d

thermo          $d
run	        10000

velocity	all scale $t

unfix		2

# Green-Kubo viscosity calculation

reset_timestep  0

# Define distinct components of symmetric traceless stress tensor
 
variable         pxy equal pxy
variable         pxx equal pxx-press

fix              SS all ave/correlate $s $p $d &
                 v_pxy v_pxx type auto file profile.gk.2d ave running

# Diagonal components of SS are larger by factor 2-2/d,
# which is 4/3 for d=3, but 1 for d=2.
# See Daivis and Evans, J.Chem.Phys, 100, 541-547 (1994)

variable         scale equal 1.0/$t*vol*$s*dt
variable         diagfac equal 2-2/2
variable         vxy equal trap(f_SS[3])*${scale}
variable         vxx equal trap(f_SS[4])*${scale}/${diagfac}

thermo_style     custom step temp press pxy v_vxy v_vxx

run              500000

variable         etaxy equal v_vxy
variable         etaxx equal v_vxx
variable         eta equal 0.5*(${etaxy}+${etaxx})
print            ""running average viscosity: ${eta}""
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/long 13.0 13.0 pair style with pair coefficients 1 * 0.0 0.0 and p p f boundary conditions with a timestep of 0.0005 running for ${nsteps} steps.","###
echo both
log log.polarize

variable nstepsequil equal 1000000
variable nsteps equal 100
variable temp equal 300.0
variable tdamp equal 0.100
variable x_dim equal 50
variable y_dim equal 50
variable z_fluid equal 37.7919
variable efieldz equal -0.0723725329978652551934
variable x_max equal ${x_dim}/2
variable y_max equal ${y_dim}/2
variable fluid_half_thickness equal ${z_fluid}/2
variable buffer equal 2.45
variable zhiwall equal ${fluid_half_thickness}+${buffer}
variable zlowall equal -${fluid_half_thickness}-${buffer}
variable zmaxatc equal ${fluid_half_thickness}+10
variable zmaxsub equal ${zmaxatc}-0.1
variable zmaxsup equal ${zmaxatc}+0.1

variable cellatc equal 5


units metal
atom_style full
dimension 3
newton off
neighbor 2 bin
neigh_modify every 1 delay 1 check no 
boundary p p f
kspace_style pppm 1e-5
kspace_modify slab 3.0
pair_style lj/cut/coul/long 13.0 13.0 
bond_style harmonic
angle_style harmonic
read_data waterequil.init


#velocity all create 0.0 482748 dist uniform

lattice sc 0.05

#region ATC block EDGE EDGE EDGE EDGE -${zmaxatc} ${zmaxatc} units box
#variable nelemelec equal round(2*${zmaxatc}/0.05)
region ATC block EDGE EDGE EDGE EDGE EDGE EDGE units box
# region ATC block EDGE EDGE EDGE EDGE 0.0 0.05 units box
#region ATC block -${fem_atc} ${fem_atc} -${fem_atc} ${fem_atc} -${fem_atc} ${fem_atc} units box
variable nelem equal 2
# variable nelem equal 1

group water type 1 2
group hyd type 1
group oxy type 2

timestep 0.0005
dielectric 1.0

pair_coeff 1 * 0.0 0.0
pair_coeff 2 2 0.006596 3.1507

bond_coeff 1 19.513855 0.957200

angle_coeff 1 2.385027 104.519997

special_bonds amber

#fix 2 all nvt temp ${temp} ${temp} ${tdamp}

fix lowall oxy wall/lj1043 zlo ${zlowall} 0.1351 3.1507 11.0275 units box
fix hiwall oxy wall/lj1043 zhi ${zhiwall} 0.1351 3.1507 11.0275 units box

fix efield all efield 0. 0. v_efieldz

# assign SHAKE fixes
fix 1 all shake  0.00001 500 5000 b 1 a 1

thermo 100
thermo_style custom step temp ke pe etotal f_efield f_lowall f_hiwall

variable dumpfreq equal 1

#dump 1 all atom 500 waterequil.dump
#dump_modify 1 image yes scale no flush yes

#run ${nstepsequil}

#write_restart waterequil.restart

#unfix 2
fix 3 all nve

fix AtC all atc hardy
fix_modify AtC mesh create 1 1 ${nelem} ATC p p f 
#fix_modify AtC_half mesh create 1 1 ${nelem} ATC p p f
fix_modify AtC kernel cell 25 25 ${cellatc}
fix_modify AtC atom_element_map eulerian ${dumpfreq}
fix_modify AtC fields none
fix_modify AtC fields add dipole_moment mass_density
fix_modify AtC add_molecule small Water water
fix_modify AtC output polarizeFE ${dumpfreq} text vector_components
run ${nsteps}


#fix AtCH hyd atc field
#fix_modify AtCH mesh create 1 1 ${nelemelec} ATC p p f
#fix_modify AtCH atom_element_map eulerian ${dumpfreq}
#fix_modify AtCH fields add number_density
#fix_modify AtCH output FEH ${dumpfreq} text binary

#fix AtCO oxy atc field
#fix_modify AtCO mesh create 1 1 ${nelemelec} ATC p p f
#fix_modify AtCO atom_element_map eulerian ${dumpfreq}
#fix_modify AtCO fields add number_density
#fix_modify AtCO output FEO ${dumpfreq} text binary

#run ${nsteps}

#write_restart waterendpolarize.restart
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/smooth/linear 5.456108274435118 pair style with pair coefficients * * 0.7242785984051078 2.598146797350056 and p p p boundary conditions with a timestep of 1.0 running for 1 steps.","# This test compares Hardy and Cauchy-Born metrics of energy density and stress
# for an Ar system subjected to shear deformation.
#
# NOTE possible problems with large shear and handling a non-ortho box
echo both
units       metal 
atom_style  atomic
variable lattice_constant equal 4.08 
variable c equal 6 # minimum size
variable Ly equal $c*${lattice_constant}
variable d equal 0.005
variable V0 equal ($c*${lattice_constant})^3
# create system
lattice        fcc ${lattice_constant} origin 0.25 0.25 0.25
# NOTE rect box + lagrangian is necessary to fool ATC's mesh
region         rectbox block 0 $c 0 $c 0 3
region         box prism 0 $c 0 $c 0 3 0 0 0 
boundary       p p p
create_box   1 box 
create_atoms 1 region box 
mass         1 196.97 
group      all region box
pair_style     lj/smooth/linear 5.456108274435118
pair_coeff     * * 0.7242785984051078 2.598146797350056
neighbor  1.0 bin
#neigh_modify  delay 1000000
log       cb_shear.log  
thermo    100
variable gamma equal 0.0
variable step  equal 0
thermo_style  custom step v_step pxx pyy pzz pxy pxz pyz v_gamma pe xy xz yz
timestep  1.0 
fix         AtC all   atc field Au_CauchyBorn.mat 
fix_modify  AtC mesh create $c $c 1 rectbox p p p
fix_modify  AtC  fields add mass_density internal_energy stress
fix_modify  AtC  fields add displacement
fix_modify  AtC  fields add cauchy_born_energy cauchy_born_stress
fix_modify  AtC  gradients add displacement
fix_modify  AtC  set reference_potential_energy 0.
#fix_modify  AtC  fields add elastic_deformation_gradient
fix_modify  AtC  output cb_shearFE 1 text binary tensor_components
min_modify      line quadratic
variable dgamma equal $d/${Ly}
print ""depsilon_12: ${dgamma}""
timestep 0.0
variable i loop 4
label loop_i
  print "">>> step $i""
  minimize 1.e-20 1.e-20 1000 1000
  run  1
  variable step equal ${step}+1
  change_box all xy delta $d remap
  variable gamma equal $i*${dgamma}
next i
jump in.cb_shear loop_i
"
"Generate a LAMMPS input script for a NVT simulation of an full system using hybrid/overlay  lj/sdk 15.0  coul/long 26.5 # ""lj/sdk"" is compatible with ""lj/spica"" pair style with pair coefficients 1     4    coul/long # SO4  SOD with a timestep of 10.0 running for 100 steps at temperature 310.0.","# coarse grained SDS surfactant monolayer

units           real
dimension       3
atom_style      full
processors  * * 1

pair_style hybrid/overlay  lj/sdk 15.0  coul/long 26.5 # ""lj/sdk"" is compatible with ""lj/spica""
bond_style      harmonic
angle_style     sdk # compatible with ""spica""
special_bonds   lj/coul 0.0 0.0 1.0

read_data       data.sds.gz

pair_coeff  1     4    coul/long # SO4  SOD 
pair_coeff  4     4    coul/long # SOD  SOD 
pair_coeff  1     1    lj/sdk  lj9_6  0.7000 4.3210 # SO4  SO4 
pair_coeff  1     2    lj/sdk  lj9_6  0.3830 4.4135 # SO4  CM  
pair_coeff  1     3    lj/sdk  lj9_6  0.4050 4.4530 # SO4  CT  
pair_coeff  1     4    lj/sdk  lj12_4 1.1000 4.1000 # SO4  SOD 
pair_coeff  1     5    lj/sdk  lj12_4 1.1000 4.1000 # SO4  W   
pair_coeff  2     2    lj/sdk  lj9_6  0.4200 4.5060 # CM   CM  
pair_coeff  2     3    lj/sdk  lj9_6  0.4440 4.5455 # CT   CM  
pair_coeff  2     4    lj/sdk  lj12_4 0.3400 4.4385 # SOD  CM  
pair_coeff  2     5    lj/sdk  lj12_4 0.3400 4.4385 # W    CM  
pair_coeff  3     3    lj/sdk  lj9_6  0.4690 4.5850 # CT   CT  
pair_coeff  3     4    lj/sdk  lj12_4 0.3600 4.4780 # SOD  CT  
pair_coeff  3     5    lj/sdk  lj12_4 0.3600 4.4780 # W    CT  
pair_coeff  4     4    lj/sdk  lj12_4 0.3500 4.3710 # SOD  SOD 
pair_coeff  4     5    lj/sdk  lj12_4 0.8950 4.3710 # SOD  W   
pair_coeff  5     5    lj/sdk  lj12_4 0.8950 4.3710 # W    W   


group charged   type 1 4
atom_modify     first charged

kspace_style    pppm/cg 0.00001
kspace_modify   order 3 

neighbor        2.0 multi
neigh_modify    delay 4 every 2 check yes

comm_modify     mode multi

timestep        10.0

fix             1 all nvt temp 310.0 310.0 100.0

thermo          10

run              100
"
"Generate a LAMMPS input script for a general simulation of an sphere system using gran/hertz/history 4000.0 NULL 100.0 NULL 0.5 0 pair style with pair coefficients * * and f fm p boundary conditions with a timestep of 0.001 running for 25000 steps.","# Pour 2d granular particles into container

dimension	2
atom_style	sphere
atom_modify     map array
boundary	f fm p
newton		off
comm_modify	vel yes cutoff 2.5

fix             prop all property/atom mol ghost yes

region		reg block 0 100 0 50 -0.5 0.5 units box
create_box	1 reg

neighbor	0.2 bin
neigh_modify	delay 0

# IMPORTANT NOTE: these values of stiffness (4000) and timestep (0.001)
# are used in this example file to produce a quick simulation and movie.
# More appropriate values for realistic simulations would be
# k = 4.0e5 and dt = 0.0001, as in bench/in.chute (if it were Hertzian).

pair_style      gran/hertz/history 4000.0 NULL 100.0 NULL 0.5 0
pair_coeff	* *

timestep	0.001

fix		2 all gravity 1.0 spherical 0.0 -180.0
fix		xwalls all wall/gran hertz/history 4000.0 NULL 100.0 NULL 0 1 &
		xplane 0 100
fix		ywalls all wall/gran hertz/history 4000.0 NULL 100.0 NULL 0 1 &
		yplane 0 NULL

molecule        object molecule.vshape
fix             3 all rigid/small molecule mol object

# ensure region size + molecule size does not overlap wall

region          slab block 3.0 97.0 30 34.5 -0.5 0.5 units box
fix             ins all pour 500 0 4767548 vol 0.8 10 &
	        region slab mol object rigid 3

fix             4 all enforce2d

compute		1 all erotate/sphere
compute         Tsphere all temp/sphere
thermo_style	custom step atoms ke c_1 vol
thermo_modify	lost ignore norm no temp Tsphere
compute_modify	Tsphere dynamic/dof yes

thermo		1000

#dump		id all atom 100 tmp.dump

#variable        colors string &
#                ""red green blue yellow white &
#                purple pink orange lime gray""
#variable	mol2 atom mol%10
#dump		2 all image 250 image.*.jpg v_mol2 type &
#		zoom 1.6 adiam 1.5
#dump_modify	2 pad 5 amap 0 10 sa 1 10 ${colors}

#variable        colors string &
#                ""red green blue yellow white &
#                purple pink orange lime gray""
#variable	mol3 atom mol%10
#dump		3 all movie 250 movie.mpg v_mol3 type &
#		zoom 1.6 adiam 1.5
#dump_modify	3 pad 5 amap 0 10 sa 1 10 ${colors}

run	        25000
"
"Generate a LAMMPS input script for a NVE simulation of an ellipsoid system using gayberne 1.0 3.0 1.0 4.0 pair style with pair coefficients 1 1 1.0 1.0 1 1 1 1 1 1 with a timestep of 0.0005 running for 1000 steps.","# SRD diffusion demo - ellipsoids

units           lj
atom_style      ellipsoid
atom_modify     first big
dimension       2

# create big ellipsoidal particles

lattice         sq 0.14
region          box block 0 10 0 10 -0.5 0.5
create_box      2 box
create_atoms    1 region box

set             type 1 mass 1.0
set             type 1 shape 3.0 1.0 1.0
group           big type 1
set             group big quat/random 29898

velocity        big create 1.44 87287 loop geom

# equilibrate big particles

pair_style      gayberne 1.0 3.0 1.0 4.0
pair_coeff      1 1 1.0 1.0 1 1 1 1 1 1
pair_coeff      1 2 1.0 1.0 1 1 1 1 1 1 0.0
pair_coeff      2 2 1.0 1.0 1 1 1 1 1 1 0.0

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

fix             1 big nve/asphere
fix             2 all enforce2d

compute         rot big temp/asphere
compute         0 all property/atom quatw quati quatj quatk shapex shapey shapez

#dump           1 all custom 10 dump.ellipsoid.equil id type x y z c_0[*]
#dump_modify    1 colname c_0[1] quatw colname c_0[2] quati colname c_0[3] quatj colname c_0[4] quatk &
#                 colname c_0[5] shapex colname c_0[6] shapey colname c_0[7] shapez

thermo_style    custom step temp c_rot epair etotal press
thermo          100

run             1000

#undump         1
unfix           1
unfix           2

# add small particles as hi density lattice

region          plane block INF INF INF INF -0.001 0.001 units box
lattice         sq 120.0
create_atoms    2 region plane

set             type 2 mass 0.01
group           small type 2
velocity        small create 1.0 593849 loop geom

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0
pair_coeff      2 2 0.0 1.0 0.0
pair_coeff      1 2 0.0 1.0 2.0

neigh_modify    one 10000

delete_atoms    overlap 1.6 small big

# SRD run

reset_timestep  0

neighbor        0.3 multi
neigh_modify    delay 0 every 1 check yes

comm_modify     mode multi group big vel yes
neigh_modify    include big

# no pairwise interactions with small particles

pair_style      gayberne 1.0 3.0 1.0 4.0
pair_coeff      1 1 1.0 1.0 1 1 1 1 1 1
pair_coeff      1 2 1.0 1.0 1 1 1 1 1 1 0.0
pair_coeff      2 2 1.0 1.0 1 1 1 1 1 1 0.0

# use fix SRD to push small particles out from inside big ones
# if comment out, big particles won't see SRD particles

timestep        0.0005

fix             1 big nve/asphere
fix             2 small srd 20 big 1.0 0.25 49894 shift yes 54979 &
                  collision noslip search 0.2 inside ignore exact no bounce 50
fix             3 all enforce2d

# diagnostics

compute         tbig big temp/asphere
variable        pebig equal pe*atoms/count(big)
variable        ebig equal etotal*atoms/count(big)
thermo_style    custom step temp c_rot f_2[9] etotal v_pebig v_ebig press &
                f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] &
                f_2[6] f_2[7] f_2[8] f_2[9] f_2[10] f_2[11] f_2[12]

thermo_modify   temp tbig
thermo          1000

#dump           1 all custom 1000 dump.ellipsoid id type x y z c_0[*]
#dump_modify    1 colname c_0[1] quatw colname c_0[2] quati colname c_0[3] quatj colname c_0[4] quatk &
#                 colname c_0[5] shapex colname c_0[6] shapey colname c_0[7] shapez

#dump           2 all image 1000 image.*.jpg type type zoom 1.6
#dump_modify    2 pad 6 adiam 1 1 adiam 2 0.2

run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 1.0 pair style with pair coefficients * * 1.0 1.0 1.0 and p p p boundary conditions with a timestep of 0.003 running for 100000 steps.","# Test compute momentum with by comparing it's output with compute reduce

# Script will output the two computations of the total momentum as
# thermo vars - they should be identical

# 3D LJ Poiseuille flow simulation
dimension	3
boundary	p p p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry
lattice		hcp 0.5
region		box block 0 20 0 10 0 10
create_box	3 box
create_atoms	1 box

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials
pair_style	lj/cut 1.0
pair_coeff	* * 1.0 1.0 1.0

# define groups
region	     1 block INF INF INF 1.0 INF INF
group	     lower region 1
region	     2 block INF INF 9.0 INF INF INF
group	     upper region 2
group	     boundary union lower upper
group	     liquid subtract all boundary

set	     group lower type 2
set	     group upper type 3

# temperature settings
compute      mobile liquid temp
velocity     liquid create 1.0 100 temp mobile
fix          1 all nve
fix          2 liquid temp/rescale 200 1.0 2.0 0.02 1.0
fix_modify   2 temp mobile

velocity     boundary set 0.0 0.0 0.0
fix	     4 lower setforce 0.0 0.0 0.0
fix	     5 upper setforce 0.0 0.0 0.0
fix	     6 liquid addforce 0.1 0.0 0.0

# Compute total momentum
compute mom liquid momentum

# Comparison (momentum variables + compute reduce)
variable mx atom mass*vx
variable my atom mass*vy
variable mz atom mass*vz
compute mom_red liquid reduce sum v_mx v_my v_mz

# Run
timestep	0.003
thermo		1000
thermo_style custom step c_mom_red[*] c_mom[*]

run		100000
"
"Generate a LAMMPS input script for a NVE simulation of an peri system using peri/eps pair style with pair coefficients * * 14.9e9 14.9e9 0.0015001 0.0005 0.25 10.0e8 and s s s boundary conditions with a timestep of 1.0e-7 running for 1000 steps.","# small Peridynamic cylinder hit by projectile

units           si
boundary        s s s
atom_style      peri
atom_modify     map array
neighbor        0.0010 bin

# small target

lattice         sc 0.0005
region          target cylinder y 0.0 0.0 0.0050 -0.0050 0.0 units box
create_box      1 target
create_atoms    1 region target

pair_style      peri/eps
pair_coeff      * * 14.9e9 14.9e9 0.0015001 0.0005 0.25 10.0e8
set             group all density 2200
set             group all volume 1.25e-10
velocity        all set 0.0 0.0 0.0 sum no units box
fix             1 all nve

# spherical indenter to shatter target

variable        y0 equal 0.00155
variable        vy equal -100
variable        y equal ""v_y0 + step*dt*v_vy""

fix             2 all indent 1e17 sphere 0.0000 v_y 0.0000 0.0015 units box

compute         1 all damage/atom
timestep        1.0e-7
thermo          100

#dump            1 all custom 100 dump.peri id type x y z c_1

#dump           2 all image 50 image.*.jpg type type &
#               axes yes 0.8 0.02 view 80 -30 adiam 0.0006
#dump_modify    2 pad 4

#dump           3 all movie 50 movie.mpg type type &
#               axes yes 0.8 0.02 view 80 -30 adiam 0.0006
#dump_modify    3 pad 4

run             1000
"
"Generate a LAMMPS input script for a NVT simulation of an electron system using eff/cut 529.177249 ecp 1 Si pair style with pair coefficients * * and f f f boundary conditions with a timestep of 0.001 running for 200000 steps at temperature 300.0.","
# Created 2011-01-07

# General parameters

variable        sname index Si2H6.ang

units           real
newton          on
boundary        f f f

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 529.177249 ecp 1 Si
pair_coeff      * *

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

comm_modify     vel yes

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo          10
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp press effPress

# Minimization

min_style       cg
#dump            1 all xyz 10 ${sname}.min.xyz
compute         1 all property/atom spin eradius erforce
#dump            2 all custom 10 ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
min_modify      line quadratic
minimize        0 1.0e-6 2000 10000

#undump          1
#undump          2

# Equilibrate at 300K
velocity        all create 300.0 4928459 rot yes mom yes dist gaussian

timestep        0.001

#dump            1 all custom 1000 ${sname}.nvt.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
#fix            0 all langevin/eff 300.0 300.0 0.1
fix             1 all nvt/eff temp 300.0 300.0 0.1

run             200000


"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 2.5 and s s p boundary conditions with a timestep of 0.003 running for 5000 steps.","# 2d LJ crack simulation

dimension	2
boundary	s s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.93
region		box block 0 100 0 40 -0.25 0.25
create_box	5 box
create_atoms	1 box

mass		1 1.0
mass		2 1.0
mass		3 1.0
mass		4 1.0
mass		5 1.0

# LJ potentials

pair_style	lj/cut 2.5
pair_coeff	* * 1.0 1.0 2.5

# define groups

region	        1 block INF INF INF 1.25 INF INF
group		lower region 1
region		2 block INF INF 38.75 INF INF INF
group		upper region 2
group		boundary union lower upper
group		mobile subtract all boundary

region		leftupper block INF 20 20 INF INF INF
region		leftlower block INF 20 INF 20 INF INF
group		leftupper region leftupper
group		leftlower region leftlower

set		group leftupper type 2
set		group leftlower type 3
set		group lower type 4
set		group upper type 5

# initial velocities

compute	  	new mobile temp
velocity	mobile create 0.01 887723 temp new
velocity	upper set 0.0 0.3 0.0
velocity	mobile ramp vy 0.0 0.3 y 1.25 38.75 sum yes

# fixes

fix		1 all nve
fix		2 boundary setforce NULL 0.0 0.0

# run

timestep	0.003
thermo		200
thermo_modify	temp new

neigh_modify	exclude type 2 3

#dump		1 all atom 500 dump.crack

#dump		2 all image 250 image.*.jpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	2 pad 4

#dump		3 all movie 250 movie.mpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	3 pad 4

run		5000
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using rann pair style with pair coefficients * * TiZr_2.rann Ti Zr and p p p boundary conditions with a timestep of 0.001 running for 250 steps at temperature 300.","units           metal
dimension       3
boundary        p p p
atom_style      atomic

lattice         hcp 2.995 origin 0.5 0.5 0.5
region          whole block 0 4 0 2 0 1.94  units lattice
create_box      2 whole
create_atoms    2 box
timestep        0.001
set             group all type 1
set             group all type/fraction 2 0.10 486

pair_style      rann
pair_coeff      * * TiZr_2.rann Ti Zr
velocity                        all create 300 12345 mom yes rot no loop geom

compute peratom all pe/atom
#dump           1 all custom 10 rann.dump id type x y z c_peratom
#dump_modify    1 element  Ti Zr

thermo          25
thermo_style            custom step lx ly lz press pxx pyy pzz pxy pxz pyz pe temp

fix                             1 all box/relax  aniso 0.0
min_style                       cg
minimize                        1.0e-10 1.0e-10 250 1000
unfix                           1
#write_restart                   TiZr.min
#-------------------------EQUILIBRATION--------------------------------

fix                             1 all npt temp 300 300 0.1 aniso 0 0 1
run 250
unfix                           1
"
"Generate a LAMMPS input script for a general simulation of an dpd system using dpd/fdt/energy 10.0 234324 pair style with pair coefficients 1 1 0.075 0.022 3.2E-5 10.0 and p p p boundary conditions with a timestep of 0.001 running for 100 steps.","# Input File for DPD fluid under isoenthalpic conditions using the VV-SSA integration scheme

boundary        p p p

units           metal  # ev, ps
atom_style      dpd
read_data       data.dpdh

comm_modify     mode single vel yes
mass            1 100.0

pair_style      dpd/fdt/energy 10.0 234324 
pair_coeff      1 1 0.075 0.022 3.2E-5 10.0

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check no once no

timestep        0.001

compute         dpdU all dpd
variable        totEnergy equal pe+ke+c_dpdU[1]+c_dpdU[2]+press*vol

thermo          1
thermo_style    custom step temp press vol pe ke v_totEnergy cella cellb cellc
thermo_modify   format float %15.10f

fix             1 all shardlow
fix             0 all nph iso 0.0 0.0 1000.0
fix             2 all eos/cv 0.0005

run             100
"
"Generate a LAMMPS input script for a general simulation of an full system using hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.600 8.0 pair style with pair coefficients 1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H and p p p boundary conditions with a timestep of 0.5 running for 2000 steps.","units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.600 8.0
kspace_style pppm 1.0e-4

comm_modify vel yes
read_data data.ethanol

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H CTO
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    1    4 lj/cut/coul/long 0.105921 3.304542 # C3H OH
pair_coeff    1    5 lj/cut/coul/long 0.000000 0.000000 # C3H HO
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # CTO CTO
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # CTO H
pair_coeff    2    4 lj/cut/coul/long 0.105921 3.304542 # CTO OH
pair_coeff    2    5 lj/cut/coul/long 0.000000 0.000000 # CTO HO
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    3    4 lj/cut/coul/long 0.071413 2.792848 # H OH
pair_coeff    3    5 lj/cut/coul/long 0.000000 0.000000 # H HO
pair_coeff    4    4 lj/cut/coul/long 0.169996 3.120000 # OH OH
pair_coeff    4    5 lj/cut/coul/long 0.000000 0.000000 # OH HO
pair_coeff    5    5 lj/cut/coul/long 0.000000 0.000000 # HO HO
pair_coeff    *  6*8 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    1 thole 2.051000
pair_coeff    1    2 thole 1.580265
pair_coeff    1    4 thole 1.416087
pair_coeff    1    6 thole 2.051000
pair_coeff    1    7 thole 1.580265
pair_coeff    1    8 thole 1.416087
pair_coeff    2    2 thole 1.217570
pair_coeff    2    4 thole 1.091074
pair_coeff    2    6 thole 1.580265
pair_coeff    2    7 thole 1.217570
pair_coeff    2    8 thole 1.091074
pair_coeff    4    4 thole 0.977720
pair_coeff    4    6 thole 1.416087
pair_coeff    4    7 thole 1.091074
pair_coeff    4    8 thole 0.977720
pair_coeff    6    6 thole 2.051000
pair_coeff    6    7 thole 1.580265
pair_coeff    6    8 thole 1.416087
pair_coeff    7    7 thole 1.217570
pair_coeff    7    8 thole 1.091074
pair_coeff    8    8 thole 0.977720

group gETHANOL molecule 1:250
group gATOMS type 1 2 3 4 5
group gDRUDES type 6 7 8

neighbor 2.0 bin

variable vTEMP   equal 300.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gATOMS  create ${vTEMP} 12345
velocity gDRUDES create ${vTEMP_D} 12345

fix fDRUDE all drude C C N C N D D D

fix fSHAKE gATOMS shake 0.0001 20 0 b 2 3 5

fix fLANG all langevin/drude ${vTEMP} 100.0 200611 ${vTEMP_D} 20.0 260514 zero yes
fix fNPH all nph iso ${vPRESS} ${vPRESS} 500.0

compute cTEMP all temp/drude

thermo_style custom step cpu etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 20

timestep 0.5
run 2000
"
"Generate a LAMMPS input script for a NPT simulation of an charge system using lj/polysoftmd 2.03 pair style with pair coefficients 1 1 1.0 1.0 2.025 1.25 0.2 with a timestep of 0.01 running for 200000000 steps.","# Example script of bulk devitrification 2d-NPT simulation
# see C. Herrero et al. ( https://doi.org/10.48550/arXiv.2210.04775 ) for details

# parameters set

variable	Ti equal 0.035		# Initial glass temperature
variable        Ta equal 0.11		# Annealing temperature
variable	P equal 2.31052		# Pressure
variable	seed equal 4115699	# RNG seed

# problem setup

units           lj
atom_style      charge
atom_modify 	map array

dimension 	2

pair_style      lj/polysoftmd 2.03
read_data       Ti${Ti}.lmps		# initial glass config equlibrated with swap MC
pair_coeff      1 1 1.0 1.0 2.025 1.25 0.2

neighbor        0.3 bin
neigh_modify    every 1 delay 0 check yes

timestep        0.01
reset_timestep  0

# perform NPT simulation with T=Ta

velocity 	all create ${Ti} ${seed}

fix             1 all npt temp ${Ta} ${Ta} 1.0 iso $P $P 1.0

dump		traj all xyz 10000000 bulk.xyz
dump_modify	traj sort id first yes pbc yes

thermo          10000000
thermo_style    custom step temp pe ke etotal press vol
thermo_modify   flush yes

restart         50000000 bulk.*.restart

run             200000000

write_data      bulk.end
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using mliap model linear Ni_Mo.mliap.model descriptor so3 Ni_Mo.mliap.descriptor pair style with pair coefficients * * Mo Ni and p p p boundary conditions running for 3 steps.","# ---------- Initialize Simulation --------------------- 
clear 
units metal 
dimension 3 
boundary p p p
atom_style atomic
read_data Ni_Mo.data

#change_box all x scale 0.9 y scale 0.9 z scale 0.9

pair_style mliap model linear Ni_Mo.mliap.model descriptor so3 Ni_Mo.mliap.descriptor
pair_coeff * * Mo Ni

variable        e equal pe
variable N equal count(all)

thermo_style custom pe pxx pyy pzz pxy pxz pyz
thermo 1

# dump 1 all custom 1 dump.myforce.* id type fx fy fz

velocity all create 300.0 4928459 loop geom
fix 1 all nve

run             3
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut ${cutoff} pair style with pair coefficients 1 1 1.0 1.0 with a timestep of ${dt} running for 100 steps.","# Ar in lj units

# simulation params in reduced units
# settable from command line
# epsilon = sigma = mass = 1.0

variable	x index 5
variable	y index 5
variable	z index 5
variable        rhostar index 0.8842
variable        dt index 0.005
variable        cutoff index 2.5
variable        skin index 0.3
variable        tinitial index 1.0
variable        nthermo index 10
variable        nsteps index 100

# script

units		lj
atom_style	atomic

lattice		fcc ${rhostar}
region		box block 0 $x 0 $y 0 $z
create_box	1 box
create_atoms	1 box
mass		1 1.0

velocity	all create ${tinitial} 12345

pair_style	lj/cut ${cutoff}
pair_coeff	1 1 1.0 1.0

neighbor	${skin} bin
neigh_modify	delay 0 every 20 check no

fix		1 all nve

timestep	${dt}

thermo		10

run		100
"
"Generate a LAMMPS input script for a NVT simulation of an full system using table linear 10000 pair style with pair coefficients 1 * pair.table PAIR_H2 with a timestep of 0.001 running for 10000 steps at temperature 25.0.","variable ibead uloop 32 pad
variable out_freq string 100
variable job_name string H2

units      real
atom_style full
pair_style table linear 10000

neighbor 2.0 bin
neigh_modify every 1 delay 0 check no

read_data H2.data

pair_coeff 1 * pair.table PAIR_H2

timestep        0.001

velocity all create 1.0 1985 rot yes dist gaussian

fix 1 all pimd/nvt method nmpimd fmass 1.0 temp 25.0 nhc 4

thermo_style    custom step temp pe etotal pzz f_1[1] f_1[2] f_1[3]
thermo_modify   colname f_1[1] espring colname f_1[2] T_ring colname f_1[3] virial
thermo          ${out_freq}

#dump dcd all dcd ${out_freq} ${job_name}_${ibead}.dcd

#restart ${out_freq} ${job_name}_${ibead}.restart1 ${job_name}_${ibead}.restart2

run 10000
"
"Generate a LAMMPS input script for a NVE simulation using uf3 3 pair style with pair coefficients * * Nb.uf3 Nb and p p p boundary conditions with a timestep of 0.5e-3 running for ${nsteps} steps.","# Demonstrate UF3 W potential

# # ============= Initialize simulation

variable        nsteps index 100
variable        nrep equal 4
variable        a equal 3.3005
units           metal

# generate the box and atom positions using a BCC lattice

variable        nx equal ${nrep}
variable        ny equal ${nrep}
variable        nz equal ${nrep}

boundary        p p p

lattice         bcc $a
region          box block 0 ${nx} 0 ${ny} 0 ${nz}
create_box      1 box
create_atoms    1 box

mass            1 92.906

# # ============= set pair style

pair_style      uf3 3
pair_coeff      * * Nb.uf3 Nb


# # ============= Setup output

thermo          10
thermo_modify   norm yes

# # ============= Set up NVE run

timestep        0.5e-3
neighbor        1.0 bin
neigh_modify    once no every 1 delay 0 check yes

# # ============= Run MD

velocity        all create 300.0 2367804 loop geom
fix             1 all nve
run             ${nsteps}
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay sw/mod sw/mod ilp/tmd 16.0 pair style with pair coefficients * * sw/mod 1 tmd.sw.mod Mo S S NULL NULL NULL and p p f boundary conditions with a timestep of 1e-3 running for 1000 steps.","units           metal
atom_style      full
processors      * * 1
boundary        p p f
read_data       ./bilayer_MoS2_AAprime_stacking.data

mass            * 32.065  # mass of sulphur atom , uint: a.u.=1.66X10^(-27)kg
mass            1 95.94   # mass of molebdenum atom , uint: a.u.=1.66X10^(-27)kg
mass            4 95.94

# Define potentials
pair_style     	hybrid/overlay sw/mod sw/mod ilp/tmd 16.0
pair_coeff     	* * sw/mod 1 tmd.sw.mod Mo S S NULL NULL NULL
pair_coeff     	* * sw/mod 2 tmd.sw.mod NULL NULL NULL Mo S S
pair_coeff     	* * ilp/tmd  TMD.ILP Mo S S Mo S S

# Calculate the pair potential
compute   	0 all pair ilp/tmd
compute   	1 all pair sw/mod 1
compute   	2 all pair sw/mod 2
variable  	SW1 equal c_1
variable  	SW2 equal c_2
variable  	ILP equal c_0
variable  	Eatt equal c_0[1]
variable  	Erep equal c_0[2]

thermo_style    custom step etotal pe ke v_SW1 v_SW2 v_ILP v_Erep v_Eatt temp

thermo          100
thermo_modify   lost error

timestep	1e-3

velocity  	all create 300.0 12345
fix             intall all nve
run 		1000
"
"Generate a LAMMPS input script for a NVE simulation of an bond system using soft 1.12246 pair style with pair coefficients * * 0.0 1.12246 running for 500 steps.","# 2d micelle simulation

dimension	2

neighbor	0.3 bin
neigh_modify	delay 5

atom_style	bond

# Soft potential push-off

read_data	data.micelle
special_bonds	fene

pair_style	soft 1.12246
pair_coeff	* * 0.0 1.12246

bond_style 	harmonic
bond_coeff	1 50.0 0.75

velocity	all create 0.45 2349852

variable	prefactor equal ramp(1.0,20.0)

fix		1 all nve
fix		2 all temp/rescale 100 0.45 0.45 0.02 1.0
fix		3 all adapt 1 pair soft a * * v_prefactor
fix		4 all enforce2d

thermo		50
run		500

unfix		3

# Main run

pair_style	lj/cut 2.5

# solvent/head - full-size and long-range

pair_coeff	1 1 1.0 1.0 2.5
pair_coeff	2 2 1.0 1.0 2.5
pair_coeff	1 2 1.0 1.0 2.5

# tail/tail - size-averaged and long-range

pair_coeff	3 3 1.0 0.75 2.5
pair_coeff	4 4 1.0 0.50 2.5
pair_coeff	3 4 1.0 0.67 2.5

# solvent/tail - full-size and repulsive

pair_coeff	1 3 1.0 1.0 1.12246
pair_coeff	1 4 1.0 1.0 1.12246

# head/tail - size-averaged and repulsive

pair_coeff	2 3 1.0 0.88 1.12246
pair_coeff	2 4 1.0 0.75 1.12246

thermo		50

#dump		1 all atom 2000 dump.micelle

#dump		2 all image 2000 image.*.jpg type type zoom 1.6
#dump_modify	2 pad 5 adiam 1 0.5 adiam 2 1.5 adiam 3 1.0 adiam 4 0.75

#dump		3 all movie 2000 movie.mpg type type zoom 1.6
#dump_modify	3 pad 5 adiam 1 0.5 adiam 2 1.5 adiam 3 1.0 adiam 4 0.75

reset_timestep	0
group solvent   molecule 0
group solute    subtract all solvent
unfix 1
unfix 2
unfix 4
fix		1 solvent nve
fix		2 solvent temp/rescale 100 0.45 0.45 0.02 1.0
fix		5 solute rigid molecule langevin 0.45 0.45 0.5 112211
fix		4 all enforce2d
run		500
unfix 2
unfix 4
unfix 5
fix		5 solute rigid/small molecule
fix		4 all enforce2d
run		500
"
"Generate a LAMMPS input script for a NPT simulation of an full system using lj/cut/coul/cut 10.0 pair style with pair coefficients 1 1 0.1553 3.166 and p p p boundary conditions with a timestep of 0.2 running for 20000 steps at temperature 300.","# Example for an alchemical transformation of two water molecules into a hydronium and hydroxyl ion
# WARNING: This input is intended for demonstrating the method only,
# the force field parameters are mostly made up and NOT suitable for production simulations.

# set up different names for two partitions
variable name world twowater twoions

units real
atom_style full
atom_modify map array
region box block -5 5 -5 5 -5 5
boundary p p p
create_box 2 box bond/types 2 angle/types 2 &
    extra/bond/per/atom 3 extra/angle/per/atom 3 extra/special/per/atom 3

mass 1 15.9994
mass 2 1.008

pair_style lj/cut/coul/cut 10.0
pair_coeff 1 1 0.1553 3.166
pair_coeff 1 2 0.0    1.0
pair_coeff 2 2 0.0    1.0

bond_style harmonic
bond_coeff * 1000.0 1.0

angle_style harmonic
angle_coeff * 100.0 109.47

molecule water h2o.mol

# create the two molecules we want to transform ...
create_atoms 0 single -2.0 0.0 0.0 mol water 453624
create_atoms 0 single  2.0 0.0 0.0 mol water 767353

# ... and put them in a group
group transform id 1:6

# now fill the rest of the box with more water
create_atoms 0 random 32 34564 NULL mol water 25367 overlap 1.33

# change topology and settings for the two states
# we cannot simply create a different topology directly or
# load a different data file because the order and position
# of all atoms must be maintained across both replica

# we first have to remove all topology data in the transform group
delete_bonds transform bond 1
delete_bonds transform angle 1 remove

# then generate different topologies for the two partitions. select by name.
if ""${name} == twowater"" then &
    ""create_bonds single/bond 2 1 2"" &
    ""create_bonds single/bond 2 1 3"" &
    ""create_bonds single/bond 2 4 5"" &
    ""create_bonds single/bond 2 4 6"" &
    ""create_bonds single/angle 2 2 1 3"" &
    ""create_bonds single/angle 2 5 4 6"" &
else &
    ""create_bonds single/bond 2 1 2"" &
    ""create_bonds single/bond 2 3 4"" &
    ""create_bonds single/bond 2 4 5"" &
    ""create_bonds single/bond 2 4 6"" &
    ""create_bonds single/angle 2 3 4 5"" &
    ""create_bonds single/angle 2 5 4 6"" &
    ""create_bonds single/angle 2 3 4 6"" &
    ""set atom 1 charge -1.1354"" &
    ""set atom 2 charge  0.1354"" &
    ""set atom 3 charge 0.56775"" &
    ""set atom 4 charge -0.70305"" &
    ""set atom 5*6 charge 0.56775""

velocity all create 300.0 5463576
timestep 0.2

# define ramp variable to combine the two different partitions
if ""${name} == twowater"" then             &
   ""variable ramp equal ramp(1.0,0.0)""    &
else                                      &
   ""variable ramp equal ramp(0.0,1.0)""

# since the trajectory and forces are kept identical through fix alchemy,
# we can do fix npt simulations, but we must use the ""mixed"" pressure

fix integrate all npt temp 300 300 1.0 iso 1.0 1.0 10.0
fix transform all alchemy v_ramp
compute pressure all pressure/alchemy transform
fix_modify integrate press pressure

# only need to output a dump file from one partition
# if ""${name} == twowater"" then &
#   ""dump 1 all atom 100 ${name}.lammpstrj"" &
#   ""dump_modify 1 sort id""

thermo_style custom step temp press etotal density pe ke f_transform f_transform[3]
thermo_modify colname f_transform lambda colname f_transform[3] EPot_mixed
thermo_modify press pressure

thermo 100
run 20000
"
"Generate a LAMMPS input script for a general simulation of an atomic system and f p p boundary conditions with a timestep of 5.0 running for 10000 steps.","# needs description
#AtC thermal Coupling
#
echo both

units    real
atom_style  atomic
lattice         fcc 5.405 origin 0.25 0.25 0.25
region     feRegion block -10 10 -1 1 -1 1
boundary  f p p
create_box  1 feRegion
mass    1 39.95 # need to keep this
atom_modify        sort 0 1
region		dummyRegion block -100 -99 -1 1 -1 1
group		dummy region dummyRegion

#               ID  group atc PhysicsType ParameterFile
fix             AtC dummy   atc thermal Ar_thermal.mat
timestep  5.0

#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 10 1  1  feRegion f p p

# fix end temperatures and an internal source 
fix_modify AtC  initial temperature all 20.0
fix_modify AtC  source temperature  all 0.0000000000632
fix_modify AtC mesh create_nodeset lbc -10.1   -9.9   -INF INF   -INF INF
fix_modify AtC mesh create_nodeset rbc   9.9   10.1   -INF INF   -INF INF
fix_modify AtC  fix temperature lbc 20.
fix_modify AtC  fix temperature rbc 20.

fix_modify AtC mesh create_elementset middle   -4.1 4.1  -INF INF   -INF INF
fix_modify AtC material middle Ar2

thermo_style custom step cpu f_AtC[1] f_AtC[2]
fix_modify      AtC  output        no_atomsFE 1000 text binary
thermo  100
run     10000


fix_modify AtC  remove_source temperature  all
fix_modify AtC  unfix temperature rbc 

fix_modify AtC  fix temperature all 20.
run 1
fix_modify AtC  unfix temperature all
reset_timestep 0

# fix one end temperature and the a source at the other
fix_modify AtC  fix temperature lbc 20.
fix_modify AtC mesh create_faceset rbcFace plane x 10.0  
fix_modify AtC  fix_flux temperature rbcFace 0.000000001

fix_modify      AtC  output        no_atoms_flux_FE 1000 text binary # NOTE not used
thermo  100
run     10000
"
"Generate a LAMMPS input script for a general simulation of an sphere system using gran/hooke/history 4e5 NULL 1e2 NULL 0.5 0 pair style with pair coefficients * * and p p f boundary conditions with a timestep of 0.0001 running for 100000 steps.","#Pour composite granular particles on flat wall

newton		on
atom_style	sphere
atom_modify	map array sort 0 0

thermo_modify	flush yes
units 		si  

variable	minrad equal 0.5
variable	maxrad equal 1.4

variable 	skin equal 0.3*${maxrad}

boundary	p p f
region		reg block 0 20 0 20 0 200 units box
create_box	1 reg

fix             prop all property/atom mol ghost yes

variable	dumpfreq equal 1000
variable	logfreq equal 1000

pair_style	gran/hooke/history 4e5 NULL 1e2 NULL 0.5 0
pair_coeff	* *

timestep 	0.0001

group		particles type 1
atom_modify     first particles

neighbor        ${skin} bin
group		rigid type 1
neigh_modify	every 1 delay 0 check yes exclude molecule/intra all 

thermo 		${logfreq}
thermo_style	custom step cpu atoms ke
thermo_modify	flush yes lost warn

comm_modify	vel yes cutoff 3

molecule	mymol molecule.data
region		pourreg block 5 15 5 15 80 100 side in units box

#Note: in versions prior to 1/2020, the 'disable' keyword to fix/gravity
# and the 'gravity' keyword to fix rigid/small were not available.
# These settings produce undesirable behavior, where gravity can induce
# torque on rigid bodies.
#fix		gravfix all gravity 9.8 vector 0 0 -1 #disable
#fix		rigidfix all rigid/small molecule mol mymol #gravity gravfix

#The correct behavior is recovered with the following settings:
fix		gravfix all gravity 9.8 vector 0 0 -1 disable
fix		rigidfix all rigid/small molecule mol mymol gravity gravfix

fix		pourfix all pour 5 0 1234 region pourreg mol mymol rigid rigidfix

fix		zwall all wall/gran hooke/history 4000.0 NULL 100.0 NULL 0.5 0 zplane 0.1 NULL

#dump		1 all custom 1000 molecule_pour.dump id type mass radius x y z fx fy fz

run		100000

"
"Generate a LAMMPS input script for a NVE simulation of an hybrid sphere dipole system using lj/cut/dipole/cut 2.5 pair style with pair coefficients * * 1.0 1.0 with a timestep of 0.005 running for 10000 steps.","# Point dipoles in a 2d box

units		lj
atom_style	hybrid sphere dipole
dimension	2

lattice		sq2 0.7
region		box block 0 10 0 10 -0.5 0.5
create_box	1 box
create_atoms	1 box

# need both mass settings due to hybrid atom style

mass		1 1.0
set		group all mass 1.0
set		group all dipole/random 98934 0.75

velocity	all create 0.0 87287 mom no

pair_style	lj/cut/dipole/cut 2.5
pair_coeff	* * 1.0 1.0

neighbor	0.3 bin
neigh_modify	delay 0

fix		1 all nve/sphere update dipole
fix		2 all enforce2d

timestep	0.005

compute		erot all erotate/sphere
thermo_style	custom step temp epair c_erot etotal press
thermo		500

#dump		1 all custom 500 dump.dipole id type x y z mux muy

#dump		1 all image 250 image.*.jpg mux type &
#		zoom 1.6 adiam 1.2
#dump_modify	1 pad 5

run		10000
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using hybrid/overlay lj/cut 4.5 atm 4.5 2.5 pair style with pair coefficients * * lj/cut 1.0 1.0 with a timestep of 0.002 running for 25 steps at temperature 1.033.","# Axilrod-Teller-Muto potential example

variable        x index 1
variable        y index 1
variable        z index 1

variable        xx equal 10*$x
variable        yy equal 10*$y
variable        zz equal 10*$z

units           lj
atom_style      atomic

lattice         fcc 0.65
region          box block 0 ${xx} 0 ${yy} 0 ${zz}
create_box      1 box
create_atoms    1 box

pair_style      hybrid/overlay lj/cut 4.5 atm 4.5 2.5
pair_coeff      * * lj/cut 1.0 1.0
pair_coeff      * * atm * 0.072

mass            * 1.0
velocity        all create 1.033 12345678 loop geom

fix             1 all nvt temp 1.033 1.033 0.05

timestep        0.002
thermo          5

run             25
"
"Generate a LAMMPS input script for a NVT simulation of an charge system using reaxff NULL safezone 3.0 mincap 150 pair style with pair coefficients * * acks2_ff.water O H and p p s boundary conditions with a timestep of 0.5 running for 20 steps at temperature 300.","# ACKS2 Water, CITE: Achtyl et al., Nat. Comm., 6 6539 (2015)

boundary        p p s
units           real
atom_style      charge

read_data       data.water

variable        x index 1
variable        y index 1
variable        z index 1

replicate       $x $y $z

pair_style      reaxff NULL safezone 3.0 mincap 150
pair_coeff      * * acks2_ff.water O H
neighbor        0.5 bin
neigh_modify    every 1 delay 0 check yes

velocity all create 300.0 4928459 rot yes dist gaussian

fix             1 all acks2/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 1000
fix             2 all nvt temp 300 300 50.0
fix             3 all efield 0.0 0.0 1.0
fix             4 all wall/reflect zlo EDGE zhi EDGE

timestep        0.5
thermo          10
thermo_style    custom step temp press density vol

run 20
"
"Generate a LAMMPS input script for a NVT simulation using agni pair style with pair coefficients * * Al_jpc.agni Al and p p f boundary conditions with a timestep of 0.0005 running for 1000 steps at temperature 250.","
processors * * 1
units metal
boundary p p f
read_data adatom.data

pair_style agni
pair_coeff * * Al_jpc.agni Al

neighbor 0.3 bin 
neigh_modify delay 2 check yes 

timestep 0.0005
velocity all create 500 12345
fix 1 all nvt temp 250 250 0.2 
fix 5 all momentum 1 linear 1 1 1

thermo 100
thermo_style custom step ke temp

# dump MyDump all custom 250 dump.atoms id type x y z vx vy vz fx fy fz

run 1000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 2.5 and p s p boundary conditions with a timestep of 0.0025 running for 20000 steps.","# 2d friction simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.9
region		box block 0 50 0 22 -0.25 0.25
create_box	4 box

mass		1 1.0
mass		2 1.0
mass		3 1.0
mass		4 1.0

# atom regions

region          lo-fixed block INF INF INF 1.1 INF INF
region          lo-slab block INF INF INF 7 INF INF
region          above-lo block INF INF INF 7 INF INF side out
region          hi-fixed block INF INF 20.9 INF INF INF
region          hi-slab block INF INF 15 INF INF INF
region          below-hi block INF INF 15 INF INF INF side out
region		lo-asperity sphere 32 7 0 8
region		hi-asperity sphere 18 15 0 8
region		lo-half-sphere intersect 2 lo-asperity above-lo
region		hi-half-sphere intersect 2 hi-asperity below-hi

# create 2 surfaces with asperities

create_atoms	1 region lo-slab
create_atoms	1 region hi-slab
create_atoms	2 region lo-half-sphere
create_atoms	3 region hi-half-sphere

# LJ potentials

pair_style	lj/cut 2.5
pair_coeff	* * 1.0 1.0 2.5

# define groups

group	        lo region lo-slab
group		lo type 2
group		hi region hi-slab
group		hi type 3
group		lo-fixed region lo-fixed
group		hi-fixed region hi-fixed
group		boundary union lo-fixed hi-fixed
group		mobile subtract all boundary

set		group lo-fixed type 4
set		group hi-fixed type 4

# initial velocities

compute         new mobile temp/partial 0 1 0
velocity	mobile create 0.1 482748 temp new
velocity	hi set 1.0 0.0 0.0 sum yes

# fixes

fix		1 all nve
fix		2 boundary setforce 0.0 0.0 0.0
fix		3 mobile temp/rescale 200 0.1 0.1 0.02 1.0
fix_modify	3 temp new
fix             4 all enforce2d

# Run

timestep	0.0025
thermo		1000
thermo_modify	temp new

#dump		1 all atom 500 dump.friction

#dump		2 all image 500 image.*.jpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	2 pad 5

#dump		3 all movie 500 movie.mpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	3 pad 5

run		20000
"
"Generate a LAMMPS input script for a NPT simulation of an body rounded/polygon 1 6 system using body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner} pair style with pair coefficients * * ${k_n} ${k_na} with a timestep of 0.001 running for ${steps} steps.","# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares

replicate   $r $r 1

velocity    all create $T ${seed} dist gaussian mom yes rot yes

change_box  all boundary p f p

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 0.1
variable c_t        equal 0.1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_coeff * * ${k_n} ${k_na}

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0

fix          2 all enforce2d
fix          3 all wall/body/polygon 2000 50 50 yplane 0.0 48.0

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 &
#             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
"
"Generate a LAMMPS input script for a general simulation of an full system using eam/fs pair style with pair coefficients * * Na_MendelevM_2014.eam.fs Na with a timestep of 0.002 running for 1000 steps.","echo both

units		metal
atom_style	full

read_data	data.interface
mass            1 22.98977

neigh_modify    delay 10 every 1
pair_style 	eam/fs
pair_coeff 	* * Na_MendelevM_2014.eam.fs Na
timestep	0.002
thermo          500

neighbor 	4. bin

# Define computes
# Global density, no average
compute         1 all entropy/atom 0.25 7.75
# Local density, no average
compute         2 all entropy/atom 0.25 7.75 local yes
# Global density, average over neighbors
compute         3 all entropy/atom 0.25 7.75 avg yes 5.
# Local density, average over neighbors
compute         4 all entropy/atom 0.25 7.75 avg yes 5. local yes

dump            myDump all custom 500 dump.interface id type x y z c_1 c_2 c_3 c_4


fix             1 all nph x 1. 1. 10.
fix             2 all temp/csvr 350. 350. 0.1 64582

run             1000

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using sw/mod maxdelcs 0.25 0.35 pair style with pair coefficients * * tmd.sw.mod Mo S S and p p f boundary conditions with a timestep of 0.001 running for 5000 steps.","# monolayer MoS2
units      	metal
boundary   	p p f
processors	* * 1

atom_style 	atomic
read_data       single_layer_MoS2.data

mass            * 32.065	# mass of sulphur atom , uint: a.u.=1.66X10^(-27)kg
mass            1 95.94		# mass of molebdenum atom , uint: a.u.=1.66X10^(-27)kg

########################## Define potentials ################################
pair_style      sw/mod maxdelcs 0.25 0.35
pair_coeff      * * tmd.sw.mod Mo S S
#########################################################################

### Simulation settings ####
timestep        0.001
velocity        all create 300.0 12345

############################

# Output
thermo          500
thermo_style    custom step etotal pe ke temp
thermo_modify   lost warn

###### Run molecular dynamics ######
fix             thermostat all nve
run             5000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/cut/coul/long  14 pair style with pair coefficients 1 1 0.15535 3.166 and p p p boundary conditions with a timestep of 1.0 running for 1000 steps.","# fix gcmc example with fix shake

# variables available on command line

variable        mu index -8.1
variable	disp index 0.5
variable        temp index 338.0
variable        lbox index 10.0
variable        spacing index 5.0

# global model settings

units           real
atom_style      full
boundary        p p p
pair_style      lj/cut/coul/long  14 
pair_modify     mix arithmetic tail yes
kspace_style    ewald 0.0001
bond_style      harmonic
angle_style     harmonic

# box, start molecules on simple cubic lattice

lattice 	sc ${spacing}
region          box block 0 ${lbox} 0 ${lbox} 0 ${lbox} units box
create_box      2 box                       &
                bond/types 1                &
                angle/types 1               &
                extra/bond/per/atom 2       &
                extra/angle/per/atom 1      &
                extra/special/per/atom 2

molecule        h2omol H2O.txt
create_atoms   	0 box mol h2omol 464563 units box
                        
# rigid SPC/E water model

pair_coeff      1 1 0.15535 3.166
pair_coeff      * 2 0.0000 0.0000       

bond_coeff      1     1000       1.0   
angle_coeff     1      100       109.47

# masses

mass 1 15.9994 
mass 2 1.0

# MD settings

group           h2o type 1 2
neighbor        2.0 bin
neigh_modify    every 1 delay 1 check yes
velocity       	all create ${temp} 54654
timestep        1.0

minimize 0.0 0.0 100 1000
reset_timestep 0

# rigid constraints with thermostat 

fix             mynvt h2o nvt temp ${temp} ${temp} 100
fix             wshake h2o shake 0.0001 50 0 b 1 a 1 mol h2omol

# important to make temperature dofs dynamic

compute_modify  thermo_temp dynamic/dof yes
compute_modify  mynvt_temp dynamic/dof yes

run 1000
reset_timestep 0

# gcmc

variable        tfac equal 5.0/3.0 # (3 trans + 2 rot)/(3 trans)
fix             mygcmc h2o gcmc 100 100 0 0 54341 ${temp} ${mu} ${disp} mol &
                h2omol tfac_insert ${tfac} group h2o shake wshake

# atom counts

variable 	oxygen atom ""type==1""
variable 	hydrogen atom ""type==2""
group 	        oxygen dynamic all var oxygen
group 		hydrogen dynamic all var hydrogen
variable        nO equal count(oxygen)
variable        nH equal count(hydrogen)

# output

variable	tacc equal f_mygcmc[2]/(f_mygcmc[1]+0.1)
variable	iacc equal f_mygcmc[4]/(f_mygcmc[3]+0.1)
variable	dacc equal f_mygcmc[6]/(f_mygcmc[5]+0.1)
variable	racc equal f_mygcmc[8]/(f_mygcmc[7]+0.1)
thermo_style    custom step temp press pe ke density atoms v_iacc v_dacc v_tacc v_racc v_nO v_nH
thermo          1000

# run

run             20000

"
"Generate a LAMMPS input script for a NVE simulation of an full system using zero 1.0 pair style with pair coefficients * * with a timestep of 0.00025.","# simple water model with LATTE

units           metal
atom_style      full

read_data       data.water

# replicate system if requested

variable        x index 1
variable        y index 1
variable        z index 1

variable        nrep equal v_x*v_y*v_z
if              ""${nrep} > 1"" then ""replicate $x $y $z""

# initialize system

velocity        all create 0.0 87287 loop geom

pair_style      zero 1.0
pair_coeff      * *

neighbor        1.0 bin
neigh_modify    every 1 delay 0 check yes

timestep        0.00025

fix             1 all nve

fix             2 all mdi/qm virial yes elements O H
fix_modify      2 energy yes

thermo_style    custom step temp pe etotal press

# dynamics

thermo          10

mdi             plugin latte_mdi mdi ""-role ENGINE -name LATTE -method LINK"" &
                extra latte.in.water command ""run 100""
"
"Generate a LAMMPS input script for a NVE simulation of an angle system using lj/cut 1.1224620483 pair style with pair coefficients * * 1.0 1.0 1.1224620483 with a timestep of 0.010 running for 50000 steps.","# test script for fix mol/swap
# initial system is 50/50 chains of type 1 and type 2
# b/c epsilon12 is set to 1.02 (weakly same as 1/1 or 1/2) the
#   system will stay in equilibrium as a mix of both chain types
# fix mol/swap helps this happen quickly
# see the last 2 columns of thermo output for counts of 2 chain types

units              lj
atom_style         angle
neighbor           0.36 bin
neigh_modify       delay 0

pair_style         lj/cut 1.1224620483
bond_style         fene
angle_style        cosine
special_bonds      lj 0.0 1.0 1.0

read_data          data.bead

pair_coeff         * * 1.0 1.0 1.1224620483
pair_coeff         1 2 1.02 1.0 1.1224620483
bond_coeff         1 30.0 1.5 1.0 1.0
angle_coeff        1 1.500
pair_modify        shift yes

variable           vt1 atom type==1
variable           vt2 atom type==2
group              g1 dynamic all var vt1 every 100
group              g2 dynamic all var vt2 every 100
variable           count1 equal count(g1)
variable           count2 equal count(g2)

timestep           0.010

fix                1 all langevin 1.0 1.0 100.0 702547
fix                2 all nve
fix                3 all mol/swap 100 1 1 2 482794 1.0

compute            p all pressure thermo_temp
thermo             1000
thermo_style       custom step temp etotal press f_3[1] f_3[2] v_count1 v_count2

run                50000

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 100 post no steps.","# 3d Lennard-Jones melt

variable        x index 1
variable        y index 1
variable        z index 1

variable        xx equal 20*$x
variable        yy equal 20*$y
variable        zz equal 20*$z

units           lj
atom_style      atomic

lattice         fcc 0.8442
region          box block 0 ${xx} 0 ${yy} 0 ${zz}
create_box      1 box
create_atoms    1 box
mass            1 1.0

velocity        all create 1.44 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    delay 0 every 20 check no

fix             1 all nve
thermo_style    yaml
thermo 10

#dump            1 all yaml 25 dump.yaml id type x y z ix iy iz vx vy vz
#dump_modify     1 sort id thermo yes units yes time yes format 1 %5d format float ""% 12.8e"" format int %2d

run             100 post no

run             100 post no
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 0 post no steps.","# 3d Lennard-Jones melt

variable	x index 1
variable	y index 1
variable	z index 1

variable	xx equal 20*$x
variable	yy equal 20*$y
variable	zz equal 20*$z

units		lj
atom_style	atomic

lattice		fcc 0.8442
region		box block 0 ${xx} 0 ${yy} 0 ${zz}
create_box	1 box
create_atoms	1 box
mass		1 1.0

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0 2.5

neighbor	0.3 bin

thermo          100

read_dump       lj_dump.bp 200 x y z vx vy vz format adios
run             0 post no

read_dump       lj_dump.bp 800 x y z vx vy vz format adios
run             0 post no

read_dump       lj_dump.bp 600 x y z vx vy vz format adios
run             0 post no

read_dump       lj_dump.bp 400 x y z vx vy vz format adios
run             0 post no
"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay eam/alloy spin/exchange/biquadratic 3.5 pair style with pair coefficients * * eam/alloy Fe_Mishin2006.eam.alloy Fe and p p p boundary conditions with a timestep of 0.0001 running for 1000 steps.","# bcc iron in a 3d periodic box

clear 
units 		metal
atom_style 	spin

dimension 	3
boundary 	p p p

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice 	bcc 2.8665
region 		box block 0.0 5.0 0.0 5.0 0.0 5.0
create_box 	1 box
create_atoms 	1 box

# setting mass, mag. moments, and interactions for bcc iron

mass		1 55.845
set 		group all spin 2.2 -1.0 0.0 0.0
velocity 	all create 100 4928459 rot yes dist gaussian

pair_style 	hybrid/overlay eam/alloy spin/exchange/biquadratic 3.5
pair_coeff 	* * eam/alloy Fe_Mishin2006.eam.alloy Fe
pair_coeff 	* * spin/exchange/biquadratic biquadratic 3.4 0.02726 0.2171 1.841 0.0 0.0 2.0 offset yes
neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin cubic 0.001 0.0005 1.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 1.0
fix_modify 	1 energy yes
fix 		2 all langevin/spin 0.0 0.0 21

fix 		3 all nve/spin lattice moving
timestep	0.0001

# compute and output options

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	magx      equal c_out_mag[1]
variable 	magy      equal c_out_mag[2]
variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo_style    custom step time v_magx v_magy v_magz v_magnorm v_tmag v_emag pe etotal
thermo          50

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
dump 		1 all custom 100 dump_iron.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3]

run 		1000
# min_style 	spin
# min_modify	alpha_damp 1.0 discrete_factor 10
# minimize 	1.0e-16 1.0e-16 10000 10000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 2.5 running for 250 post no steps.","# 3d Lennard-Jones melt

units           lj
atom_style      atomic
processors      * 1 1

variable        factor index 1.0

lattice         fcc 0.8442
region          box block 0 10 0 10 0 10
create_box      3 box
create_atoms    1 box
mass            * 1.0

region          long block 3 6 0 10 0 10
set             region long type 2

velocity        all create 1.0 87287

pair_style      lj/cut 2.5
pair_coeff      * * 1.0 1.0 2.5
pair_coeff      * 2 1.0 1.0 5.0

neighbor        0.3 bin
neigh_modify    every 2 delay 4 check yes

balance         1.0 shift x 10 1.0 weight neigh 0.8 # out weighted_var.txt

fix             1 all nve

#dump           id all atom 50 dump.melt

#dump           2 all image 25 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 25 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

thermo          50
run             250 post no
balance         1.0 shift x 10 1.0 weight neigh 0.8
run             250 post no
balance         1.0 shift x 10 1.0 weight neigh 0.8
run             250 post no
balance         1.0 shift x 10 1.0 weight neigh 0.8 weight time 0.6
run             250
balance         1.0 shift x 10 1.0 weight neigh 0.8 weight time 0.6
run             250

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using eam/alloy pair style with pair coefficients * * Cu_Mishin1.eam Cu Cu and p p p boundary conditions with a timestep of 0.004 running for 100 steps.","# Generation and relaxation of a partial dislocation in Cu perfect FCC crystal

# Initialization
units           metal
boundary        p p p
atom_style      atomic

# create simulation box and system
lattice         fcc 3.615  origin 0.01 0.01 0.01 orient x -1 -1 2 orient y 1 1 1 orient z -1 1 0 
region          mdbox  block 0 3 0.0 14.0 0 84 units lattice
region          system block 0 3 1.1 13.1 0 84 units lattice
create_box      2 mdbox
create_atoms    1 region system

# Define atoms mass and force field
mass            *  63.54                     
pair_style      eam/alloy
pair_coeff      * * Cu_Mishin1.eam Cu Cu

# Delete a plane of atoms along the z direction to generate a partial dislocation
region          dislocation_atoms block 0 3 7 14 41.9 42.1 units lattice
delete_atoms    region dislocation_atoms
region          quarter_up block 0 3 7 11 0 84 units lattice
group           middle region quarter_up

# specify simulation parameters
timestep        0.004

# Relax configuration using conjugate gradient
#min_style cg
#minimize 1.0e-4 1.0e-6 100 1000

# Setup calculations 
compute         1 all cnp/atom 3.086
compute         2 all cna/atom 3.086
compute         3 all centro/atom fcc
compute         4 all coord/atom cutoff 3.086
dump            1 all custom 100 dump.lammpstrj id type xu yu zu c_1 c_2 c_3 c_4 

### Set up thermo display
thermo          10
thermo_style    custom step atoms temp press pe ke etotal

# Relax the system performing a langevin dynamics (freeze motion along y 111 direction)
fix             1 all nve
fix             2 all langevin 50 1 0.1 699483
fix             3 all setforce NULL 0.0 NULL
fix             4 middle setforce 0.0  0.0 0.0
run             100
unfix           4
run             200
"
"Generate a LAMMPS input script for a general simulation of an full system using lj/cut/coul/long  14 pair style with pair coefficients 1   1  0.053649   2.8 and p p p boundary conditions with a timestep of 1.0 running for 20000 steps.","# GCMC for CO2 molecular fluid, rigid/small dynamics
# Rigid CO2 TraPPE model
# [Potoff and J.I. Siepmann, Vapor-liquid equilibria of
# mixtures containing alkanes, carbon dioxide and
# nitrogen AIChE J., 47,1676-1682 (2001)].

# variables available on command line

variable        mu index -8.1
variable        disp index 0.5
variable        temp index 338.0
variable        lbox index 10.0
variable        spacing index 5.0

# global model settings

units           real
atom_style      full
boundary        p p p
pair_style      lj/cut/coul/long  14
pair_modify     mix arithmetic tail yes
kspace_style    ewald 0.0001
bond_style      harmonic
angle_style     harmonic

# box, start molecules on simple cubic lattice

lattice         sc ${spacing}
region          box block 0 ${lbox} 0 ${lbox} 0 ${lbox} units box
create_box      2 box                       &
                bond/types 1                &
                angle/types 1               &
                extra/bond/per/atom 2       &
                extra/angle/per/atom 1      &
                extra/special/per/atom 2
molecule        co2mol CO2.txt
create_atoms    0 box mol co2mol 464563 units box

# rigid CO2 TraPPE model

pair_coeff      1   1  0.053649   2.8
pair_coeff      2   2  0.156973   3.05
bond_coeff      1       0       1.16
angle_coeff     1       0       180

# masses

mass 1 12.0107
mass 2 15.9994

# MD settings

group           co2 type 1 2
neighbor        2.0 bin
neigh_modify    every 1 delay 10 check yes
velocity        all create ${temp} 54654
timestep        1.0

# rigid constraints with thermostat

fix             myrigid co2 rigid/small molecule mol co2mol

# dynamically update  fix rigid/nvt/small temperature ndof
fix_modify      myrigid dynamic/dof yes

# gcmc

variable        tfac equal 5.0/3.0 # (3 trans + 2 rot)/(3 trans)
fix             mygcmc co2 gcmc 100 100 0 0 54341 ${temp} ${mu} ${disp} mol &
                co2mol tfac_insert ${tfac} group co2 rigid myrigid

# atom counts

variable        carbon atom ""type==1""
variable        oxygen atom ""type==2""
group           carbon dynamic co2 var carbon
group           oxygen dynamic co2 var oxygen
variable        nC equal count(carbon)
variable        nO equal count(oxygen)

# output

variable        tacc equal f_mygcmc[2]/(f_mygcmc[1]+0.1)
variable        iacc equal f_mygcmc[4]/(f_mygcmc[3]+0.1)
variable        dacc equal f_mygcmc[6]/(f_mygcmc[5]+0.1)
variable        racc equal f_mygcmc[8]/(f_mygcmc[7]+0.1)

# dynamically update default temperature ndof
compute_modify  thermo_temp dynamic/dof yes

thermo_style    custom step temp press pe ke density atoms v_iacc v_dacc v_tacc v_racc v_nC v_nO
thermo          1000

# run

run             20000

"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay buck 6.5 lj/cut 6.5 coul/cut 6.5 pair style with pair coefficients 1 1 buck 3150.462646 0.35032282 626.7519553 with a timestep of 0.0001 running for 3 steps.","# MM for SiO2 zeolite with one methane molecule

# CHIK potential
# EPL, Carre, Horbach, Ispas, Kob, 82, 17001 (2008)
# B = 1/rho

#q Si = 1.910418
#q O = -0.955209
#A OO = 659.595398 eV
#B OO = 2.590066 1/Ang
#C OO = 26.836679 eV-Ang^6
#A SiO = 27029.419922 eV
#B SiO = 5.158606 1/Ang
#C SiO = 148.099091 eV-Ang^6
#A SiSi = 3150.462646 eV
#B SiSi = 2.851451 1/Ang
#C SiSi = 626.7519553 eV-Ang^6

# LJ params for methane and O from Table 1
# Bhatia and Nicholson, J Phys Chem C, 2012, 116, 2344-2355.

#q C = -0.66
#Q H = 0.165
#sigma C = 0.34 nm
#sigma H = 0.265 nm
#sigma O = 0.28 nm
#eps/kB C = 55.082 K = 0.004745993 eV
#eps/kB H = 7.905 K = 0.000681113 eV
#eps/kB O = 492.7 K = 0.0424522 eV

# LJ params for silicon
#e-Journal of Surf Sci and Nanotech, Inui and Iwasaki, 15, 40-49 (2017)

#sigma Si = 3.826 Ang
#eps Si = 17.4 meV = 0.0174 eV

# C-H bond and methane angle params

#OPLS C-H bond k = 29.40 ev/Ang^2
#C-H bond r0 = 1.09 Angs
#methane angles = 109.5 degrees
#C-H angle k/kB = 2000 K/rad^2

# conversions

#1 eV = 11606 K
#1 eV = 23.0609 kcal/mole
#1 kcal/mole = 503.2761 K
#1 kcal = 4.814 kJoule

# -------------------------

units		metal
atom_style	full

bond_style      harmonic
angle_style     harmonic

read_data       data.zeolite

group           mm type 1 2
group           qm type 3 4

# pair style must define stand-alone short-range Coulombics
# arithmetic mixing

pair_style      hybrid/overlay buck 6.5 lj/cut 6.5 coul/cut 6.5

pair_coeff      1 1 buck 3150.462646 0.35032282 626.7519553
pair_coeff      2 2 buck 659.595398 0.38609055 26.836679
pair_coeff      1 2 buck 27029.419922 0.19385082 148.099091
pair_coeff      1 2 buck 27029.419922 0.19385082 148.099091
pair_coeff      1 3 lj/cut 0.009087 3.613
pair_coeff      1 4 lj/cut 0.00344258 3.238
pair_coeff      2 3 lj/cut 0.01419429 3.1
pair_coeff      2 4 lj/cut 0.00537724 2.725
pair_coeff      3 3 lj/cut 0.004746 3.4
pair_coeff      4 4 lj/cut 0.00068111 2.65
pair_coeff      * * coul/cut

bond_style      harmonic
bond_coeff      1 29.40 1.09

angle_style      harmonic
angle_coeff      1 0.172325 109.5

#velocity        all create 300.0 458732

neighbor	1.0 bin
neigh_modify	delay 0 every 1 check yes

# dynamic or frozen zeolite

fix		1 all nve
#fix		1 qm nve

timestep        0.0001

thermo_style    custom step cpu temp ke evdwl ecoul epair emol elong &
                pe etotal press

thermo          1

run		3
"
"Generate a LAMMPS input script for a general simulation of an atomic system using meam/sw/spline pair style with pair coefficients * * Si.b.meam.sw.spline Si and p p p boundary conditions running for 0 steps.","# Si bcc

units           metal
boundary        p p p

atom_style      atomic
lattice         bcc 3.2488516
region          box block 0 1 0 1 0 1
create_box              1 box
create_atoms    1 box

pair_style      meam/sw/spline
pair_coeff      * * Si.b.meam.sw.spline Si
mass            * 28.085

fix                     relax all box/relax aniso 0
thermo          1
minimize        0 0 10000 100000

variable        cohesive_energy equal pe/atoms
variable        atmVol equal vol/atoms
variable        aLatt equal (2*vol/atoms)^0.333333333333

run                     0

print           ""====================================================""
print           ""Calculated cohesive energy: ${cohesive_energy} eV/atom""
print           ""Reference cohesive energy:  -4.37 eV/atom""
print           ""Atomic volume               ${atmVol} A^3""
print           ""Lattice constant            ${aLatt} A""
print           ""Reference lattice constant  3.238 A""
print           ""====================================================""

#dump           1 all custom 1 bcc.dump id type x y z fx fy fz
#run            0


"
"Generate a LAMMPS input script for a general simulation of an atomic system with a timestep of 0.02 running for 5000 steps.","# 2d SRD only test

units		lj
atom_style	atomic
atom_modify	first empty
dimension	2

# create box with big lattice

lattice		sq 0.4
region		box block 0 10 0 10 -0.5 0.5
create_box	1 box

# add SRD particles as hi density lattice

lattice		sq 0.4
region		plane block 0 10 0 10 -0.001 0.001
lattice		sq 85.0
create_atoms	1 region plane

group		empty type 2

mass		1 0.01
velocity	all create 1.0 593849 loop geom

# settings - need dummy empty group to enable no communication

neighbor	0.3 bin
neigh_modify	delay 1 every 1 check no

comm_modify	group empty

# timestep is big and SRD frequency is 1

timestep	0.02

fix	        1 all srd 1 NULL 1.0 0.25 49894 collision slip
fix		2 all enforce2d

# diagnostics

thermo_style	custom step temp f_1[7] etotal press f_1[3] f_1[4] f_1[6]
thermo		100

#dump		1 all atom 250 dump.srd.pure

#dump		2 all image 250 image.*.jpg type type zoom 1.6 adiam 0.2
#dump_modify	2 pad 4

#dump		3 all movie 250 movie.mpg type type zoom 1.6 adiam 0.2
#dump_modify	3 pad 4

run		5000
"
"Generate a LAMMPS input script for a NVT simulation of an charge system using reaxff NULL safezone 3.0 mincap 150 pair style with pair coefficients * * qeq_ff.water O H and p p p boundary conditions with a timestep of 0.5 running for 20 steps at temperature 300.","# QEq Water, CITE: Achtyl et al., Nat. Comm., 6 6539 (2015)

boundary        p p p
units           real
atom_style      charge

read_data       data.water

variable        x index 1
variable        y index 1
variable        z index 1

replicate       $x $y $z

pair_style      reaxff NULL safezone 3.0 mincap 150
pair_coeff      * * qeq_ff.water O H
neighbor        0.5 bin
neigh_modify    every 1 delay 0 check yes

velocity all create 300.0 4928459 rot yes dist gaussian

fix             1 all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix             2 all nvt temp 300 300 50.0

timestep        0.5
thermo          10
thermo_style    custom step temp press density vol

run 20
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style with pair coefficients * * 0.010323166 3.405 13.5 and f p p boundary conditions with a timestep of 0.005 running for 0 steps.","# needs description
echo both

units		metal
atom_style	atomic

# create domain
#lattice	type reduced density rho* = 4*(sigma/a)^3, where N=4 for fcc, s = 3.405 A (Wagner) and a = 5.25 A (Ashcroft & Mermin, p. 70)
lattice         fcc 5.405 origin 0.25 0.25 0.25

# create atoms
region		simRegion block -12 12 -3 3 -3 3
region		atomRegion block -9 9 -3 3 -3 3
region		mdRegion block -8 8 -3 3 -3 3
boundary	f p p
create_box	2 simRegion 
create_atoms	1 region mdRegion
mass		* 39.95

# specify interal/ghost atoms
region		mdInternal block -6 6 -3 3 -3 3
region		leftghost block -8 -6 -3 3 -3 3
region		rightghost block 6 8 -3 3 -3 3
group		internal region mdInternal
group		Lghost region leftghost
group		Rghost region rightghost
group		ghosts union Lghost Rghost

# velocities have Vcm = 0
#velocity	internal create 40. 87287 mom yes loop geom

pair_style	lj/cut 13.5
#pair_coeff  	* * .238 3.405 13.5
pair_coeff      * * 0.010323166 3.405 13.5

neighbor	5. bin
neigh_modify	every 10 delay 0 check no

# define  layer
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc elastic     Ar_damped.mat

#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 12  1  1  simRegion f p p

# initial conditions 
fix_modify  AtC  initial displacement x all 0.0
fix_modify  AtC  initial displacement y all 0.0
fix_modify  AtC  initial displacement z all 0.0
fix_modify  AtC  initial velocity x all 0.0
fix_modify  AtC  initial velocity y all 0.0
fix_modify  AtC  initial velocity z all 0.0


variable v equal 0.00000004e3
variable n equal 1000
variable dt equal 0.005
variable u equal $v*$n*${dt}

# set node sets and bcs
#           ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
fix_modify  AtC mesh create_nodeset lbc -12.1  -11.9   -INF INF  -INF INF
fix_modify  AtC mesh create_nodeset rbc  11.9   12.1   -INF INF  -INF INF
fix_modify  AtC fix velocity     x rbc $v
fix_modify  AtC fix displacement x lbc 0.
fix_modify  AtC fix velocity     x lbc 0.

# specify atom types
fix_modify  AtC boundary ghosts

#fix_modify      AtC  output follow_ex.fe 50
fix_modify  AtC internal_quadrature off
fix_modify  AtC control localized_lambda on
fix_modify  AtC control  momentum glc_velocity
#fix_modify  AtC filter type exponential
#fix_modify  AtC filter scale 1.0
#fix_modify  AtC filter on

# run to extension
timestep	0.005
thermo		100
thermo_style custom step cpu ke pe 
run 		0
variable pe0 equal pe
variable pe equal pe-${pe0}
thermo_style custom step cpu ke pe v_pe f_AtC[1] f_AtC[2] f_AtC[4] f_AtC[5]

run 		$n

fix_modify      AtC  output bar1d_dampedFE 500 text 
dump CONFIG all custom 500 bar1d_damped.dmp id type x y z vx vy vz

# change nodes to fixed
fix_modify      AtC  fix velocity x rbc 0.
fix_modify	AtC  fix displacement x rbc $u

# run to equilibrium
thermo		100
log  bar1d_damped.log
run 		2000 
fix_modify AtC material all cubic  # M damping
run 		2000
fix_modify AtC material all damped # K damping
run 		2000
#  ATC: CB stiffness: 7.56717 Einstein freq: 0.355649 from Ar_CauchyBorn.mat 
#  real to metal 1 kcal/mol = 0.04336 eV
variable kCal2eV equal 0.04336
variable fconv equal 1./0.000103643 # NOTE old routine was doing calculations in lammps units, not atc units, so this conversion is necessary for bmark to pass
#variable k equal 1.e-3 # 7.56717*${kCal2eV}  NOTE <<<
#variable k equal 0.75*0.355649e3*${kCal2eV}
variable k equal 0.5*39.95*${fconv} # NOTE it was set to above, should have been 2 above, but there was a bug so this value is here for bmark
#variable g equal 0.75*0.355649e3*${kCal2eV}
variable g equal 1.e-3*${fconv} # NOTE it should be above, but there was a bug so this value is here for bmark
variable m equal 2. #0.5*39.95
fix_modify AtC boundary_dynamics damped_harmonic $k $g $m
run 		2000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut  10 pair style with pair coefficients 1 1 0.01032 3.405 and p p p boundary conditions with a timestep of 1e-03 running for 100 steps.","# LJ test of msst shock dynamics

# Energy in eV, time in ps, distance in angstroms.
units		metal
boundary        p p p

atom_style	atomic
timestep        1e-03

lattice		fcc 5.3589

## Specify the box as a given number of unit cells.
region		box1 block 0 18 0 18 0 18 units lattice

## Instantiate the system.
create_box	1 box1
create_atoms    1 region box1

mass		1 40.00

# Initial velocities correspond to around 300K.
velocity   all create 600.0 9999

pair_style	lj/cut  10 
pair_coeff	1 1 0.01032 3.405

timestep 2e-3

# Equilibrate the system
fix	      2 all nve
thermo		10

run		100
unfix		 2

# MSST fix
fix		msst all msst z 28.0 q 200 mu 3e2 tscale 0.01 

variable dhug equal f_msst[1]
variable dray equal f_msst[2]
variable lgr_vel equal f_msst[3]
variable lgr_pos equal f_msst[4]

thermo_style custom step temp ke pe lx ly lz pxx pyy pzz econserve &
	     v_dhug v_dray v_lgr_vel v_lgr_pos f_msst

#dump		id all atom 50 dump.msst

#dump		2 all image 25 image.*.jpg type type &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	2 pad 3

#dump		3 all movie 25 movie.mpg type type &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	3 pad 3

run	        100
"
"Generate a LAMMPS input script for a NVT simulation using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 running for 0 steps.","variable T equal 0.8
variable p_solid equal 0.05

read_data data.mop

pair_style lj/cut 2.5
pair_coeff * * 1.0 1.0
pair_coeff 1 2 0.5 1.0 
pair_coeff 2 2 0.0 0.0
neigh_modify delay 0

group liquid type 1
group solid type 2
region bottom block INF INF INF INF INF 7.0
group bottom region bottom
group solid_bottom intersect solid bottom
group solid_up subtract solid solid_bottom

variable faSolid equal ${p_solid}*lx*ly/count(solid_up)
fix piston_up solid_up aveforce NULL NULL -${faSolid} 
fix freeze_up solid_up setforce 0.0 0.0 NULL 
fix freeze_bottom solid_bottom setforce 0.0 0.0 0.0
fix nvesol solid nve
compute Tliq liquid temp
fix nvtliq liquid nvt temp $T $T 0.5
fix_modify nvtliq temp Tliq

thermo 1000
thermo_modify flush yes temp Tliq

fix fxbal all balance 1000 1.05 shift z 10 1.05

compute mopz0 all stress/mop z center kin conf
fix mopz0t all ave/time 1 1 1 c_mopz0[*] file mopz0.time

compute moppz liquid stress/mop/profile z 0.0 0.1 kin conf
fix moppzt all ave/time 1 1 1 c_moppz[*] ave running overwrite file moppz.time mode vector

run 0

"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using granular pair style with pair coefficients * * hooke 20.0 0.5 tangential linear_history 1.0 0.5 0.1 damping mass_velocity with a timestep of 0.005 running for 1000 steps.","# Shear power-law distributed granular particles

units           lj
atom_style      sphere
dimension       2
read_data       data.powerlaw
change_box      all triclinic

# multi neighbor and comm for efficiency

neighbor        1 multi
neigh_modify    delay 0 collection/interval 6 1.5 3 10 30 100 200
comm_modify     mode multi vel yes reduce/multi

# granular potential

pair_style      granular
pair_coeff      * * hooke 20.0 0.5 tangential linear_history 1.0 0.5 0.1 damping mass_velocity

# fixes

fix             1 all nve/sphere
fix             2 all enforce2d
fix             3 all deform 1 xy erate 1e-4

# dump          1 all custom 20000 dump.granular id x y z radius

thermo_style    custom step temp epair etotal press vol pxy
thermo          100

timestep        0.005

run             1000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using table spline 15000 pair style with pair coefficients 1 1 lammps_nb_MET-MET.table nb_METMET 12.0 and p p p boundary conditions with a timestep of 1.0 running for _style       verlet steps at temperature 300.0.","units		real
dimension	3
boundary	p p p
atom_style      atomic

newton		on
timestep	1.0

read_data	methanol.data

velocity	all create 300.0 16802 dist gaussian

pair_style	table spline 15000

pair_coeff	1 1 lammps_nb_MET-MET.table nb_METMET 12.0

neigh_modify	delay 0 every 1 check yes one 10000
neighbor	12.0 bin

thermo		500
thermo_style	custom step temp pe etotal press vol

variable STEP equal step
variable TEMP equal temp
## volume from cubic angstroms to cubic nm
variable VOL equal vol/1000.0
## pressure from atm to bar
variable PRESS equal press*1.01325
variable PXX equal pxx*1.01325
variable PYY equal pyy*1.01325
variable PZZ equal pzz*1.01325
variable PXY equal pxy*1.01325
variable PXZ equal pxz*1.01325
variable PYZ equal pyz*1.01325
## energy from kcal/mol to kJ/mol
variable KE equal ke*4.184
variable PE equal pe*4.184
variable UVDW equal evdwl*4.184


#####     SPECIAL COMMANDS FOR FIX_BOCS     #####
#       ID group-ID style_name thermostat T_init T_end T_couple barostat P_start P_end  P_couple pmatch_basis avg_vol     N_sites N_coeffs coeff1      coeff2
fix 	1  all      bocs       temp       300.0  300.0 100.0    cgiso    0.986   0.986  1000.0   analytic     66476.015   968     2        245030.10   8962.20 

# Report the modified pressure
thermo_modify 	press 1_press



## Uncomment to save some data from simulation to files
#fix             print_temp all print 500 ""${STEP} ${TEMP}"" file temp.dat screen no
#fix             print_vol all print 500 ""${STEP} ${VOL}"" file vol.dat screen no
#fix             print_press all print 500 ""${STEP} ${PRESS}"" file press.dat screen no
#fix             print_ke all print 500 ""${STEP} ${KE}"" file kinetic_E.dat screen no
#fix             print_pe all print 500 ""${STEP} ${PE}"" file potential_E.dat screen no
#fix             print_ve all print 500 ""${STEP} ${UVDW}"" file vdw_E.dat screen no
#fix             print_press_tens all print 500 ""${STEP} ${PXX} ${PYY} ${PZZ} ${PXY} ${PXZ} ${PYZ}"" file press_tens.dat screen no
#fix		print_PV_eos all print 500 ""${VOL} ${PRESS}"" file pv_eos.dat screen no

## Prints a configuration to dump.txt every 500 steps
#dump		1 all custom 500 dump.txt id type x y z fx fy fz

# Write restart files to continue simulations
#restart 10000 state1.restart state2.restart

## Run for this many steps
run_style       verlet
run 10000

"
"Generate a LAMMPS input script for a general simulation of an electron system using eff/cut 1000.0 ecp 1 Si pair style with pair coefficients * * and f f f boundary conditions.","
# Created 2011-01-07

# General parameters

variable        sname index Si2H6

units           electron
newton          on
boundary        f f f

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 1000.0 ecp 1 Si
pair_coeff      * *

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

comm_modify     vel yes

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo          2
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp press effPress

# Minimization

min_style       cg
#dump            1 all xyz 2 ${sname}.min.xyz
compute         1 all property/atom spin eradius erforce
#dump            2 all custom 2 ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
min_modify      line quadratic
minimize        0 1.0e-5 1000 10000

#undump          1
#undump          2

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using dpd/ext ${T} ${rc} 3854262 pair style with pair coefficients 1 1 25.0 4.5 4.53 0.5 0.53   1.2 #${rcD} and p p p boundary conditions with a timestep of 0.01 running for _style    verlet steps.","# DPD Fluid

variable T    equal 1.0
variable rc   equal 1.0
variable rcD  equal 1.2

units            lj
boundary     p p p
atom_style       atomic
dimension    3
newton       on
comm_modify  vel yes

### create box and configuration
variable     L equal 5.0
lattice      fcc 3.0
region       simBox block 0 ${L} 0 ${L} 0 ${L}
create_box   2 simBox
create_atoms 1 random 100 12456 simBox
create_atoms 2 random 100 13245 simBox
mass         1 1.0
mass         2 2.0
###

pair_style       dpd/ext ${T} ${rc} 3854262

pair_coeff   1 1 25.0 4.5 4.53 0.5 0.53   1.2 #${rcD}
pair_coeff   1 2 25.1 4.51 4.54 0.51 0.54 1.21 #${rcD}
pair_coeff   2 2 25.2 4.52 4.55 0.52 0.55 1.22 #${rcD}

timestep     0.01
run_style    verlet

velocity all create ${T} 68768932

thermo_style custom step time temp press
thermo       100

fix 1 all    nve

run          5000

"
"Generate a LAMMPS input script for a general simulation of an line system using lj/cut 1.5 pair style with pair coefficients 1 1 1.0 1.0 with a timestep of 0.001 running for 10000 steps.","# Aspherical shear demo - 2d line boxes, solvated by SRD particles

units           lj
atom_style      line
atom_modify     first big
dimension       2

read_data       data.line.srd

# add small particles as hi density lattice

lattice         sq 0.4
region          plane block INF INF INF INF -0.001 0.001
lattice         sq 10.0
create_atoms    2 region plane

group           big type 1
group           small type 2
set             group small mass 0.01

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style      lj/cut 1.5
pair_coeff      1 1 1.0 1.0
pair_coeff      2 2 0.0 1.0 0.0
pair_coeff      1 2 0.0 1.0

delete_atoms    overlap 1.5 small big

# SRD run

reset_timestep  0

velocity        small create 1.44 87287 loop geom

neighbor        0.3 multi
neigh_modify    delay 0 every 1 check yes
neigh_modify    exclude molecule/intra big include big

comm_modify     mode multi group big vel yes
neigh_modify    include big

# no pairwise interactions with small particles

pair_style      line/lj 2.5
pair_coeff      1 1 1.0 1.0 1.0 1.0 2.5
pair_coeff      2 2 0.0 0.0 0.0 1.0 0.0
pair_coeff      1 2 1.0 0.0 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones
# if comment out, big particles won't see SRD particles

timestep        0.001

fix             1 big rigid molecule
fix             2 small srd 20 big 1.0 0.25 49894 &
                search 0.2 cubic warn 0.0001 shift yes 49829 &
                overlap yes collision noslip

fix             3 all deform 1 x scale 0.35 y scale 0.35
fix             4 all enforce2d

# diagnostics

compute         tsmall small temp/deform
compute         tbig big temp
variable        pebig equal pe*atoms/count(big)
variable        ebig equal etotal*atoms/count(big)

compute_modify  tbig extra/dof -350

compute         1 big erotate/asphere
compute         2 all ke
compute         3 all pe
variable        toteng equal (c_1+c_2+c_3)/atoms

thermo          1000
thermo_style    custom step c_tsmall f_2[9] c_1 etotal &
                v_pebig v_ebig press
thermo_modify   temp tbig

compute         10 big property/atom end1x end1y end2x end2y

#dump           1 all custom 500 dump1.atom.srd id type x y z ix iy iz
#dump           2 all custom 500 dump1.line.srd id type &
#               c_10[1] c_10[2] c_10[3] c_10[4]

run             10000

#undump          1
#undump          2
unfix           3

change_box      all triclinic

fix             2 small srd 20 big 1.0 0.25 49894 &
                search 0.2 cubic warn 0.0001 shift yes 49829 &
                overlap yes collision noslip tstat yes

#dump           1 all custom 500 dump2.atom.srd id type x y z ix iy iz
#dump           2 all custom 500 dump2.line.srd id type &
#               c_10[1] c_10[2] c_10[3] c_10[4]

fix             3 all deform 1 xy erate 0.05 units box remap v

run             40000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using meam pair style with pair coefficients * * library.meam Ni4 Ni.meam Ni4 Ni4 Ni4 and s s p boundary conditions with a timestep of 0.001 running for 100 steps.","# 3d metal shear simulation

units		metal
boundary	s s p

atom_style	atomic
lattice		fcc 3.52
region		box block 0 16.0 0 10.0 0 2.828427
create_box	3 box

lattice		fcc 3.52 orient	x 1 0 0 orient y 0 1 1 orient z 0 -1 1 &
		origin 0.5 0 0 
create_atoms	1 box

pair_style	meam
pair_coeff	* * library.meam Ni4 Ni.meam Ni4 Ni4 Ni4

neighbor	0.3 bin
neigh_modify	delay 5

region		lower block INF INF INF 0.9 INF INF
region		upper block INF INF 6.1 INF INF INF
group		lower region lower
group		upper region upper
group		boundary union lower upper
group		mobile subtract all boundary

set		group lower type 2
set		group upper type 3

# void

#region		void cylinder z 8 5 2.5 INF INF
#delete_atoms	region void

# temp controllers

compute		new3d mobile temp
compute		new2d mobile temp/partial 0 1 1

# equilibrate

velocity	mobile create 300.0 5812775 temp new3d
fix		1 all nve
fix		2 boundary setforce 0.0 0.0 0.0

fix		3 mobile temp/rescale 10 300.0 300.0 10.0 1.0
fix_modify	3 temp new3d

thermo		25
thermo_modify	temp new3d

timestep	0.001
run		100

# shear

velocity	upper set 1.0 0 0
velocity	mobile ramp vx 0.0 1.0 y 1.4 8.6 sum yes

unfix		3
fix		3 mobile temp/rescale 10 300.0 300.0 10.0 1.0
fix_modify	3 temp new2d

#dump		1 all atom 500 dump.meam.shear

#dump		2 all image 100 image.*.jpg type type &
#		axes yes 0.8 0.02 view 0 0 zoom 1.5 up 0 1 0 adiam 2.0
#dump_modify	2 pad 4

#dump		3 all movie 100 movie.mpg type type &
#		axes yes 0.8 0.02 view 0 0 zoom 1.5 up 0 1 0 adiam 2.0
#dump_modify	3 pad 4

thermo		100
thermo_modify	temp new2d

reset_timestep	0
run		3000
"
"Generate a LAMMPS input script for a general simulation and p p p # finite field, fully periodic boundary conditions running for 10 steps.","boundary p p p # finite field, fully periodic
kspace_style ewald/electrode 1.0e-7

include ""settings.mod"" # styles, computes, groups and fixes

# constant potential electrodes with ramping potential difference
fix conp bot electrode/conp 0 1.979 couple top v_v symm on ffield yes

thermo 1
# thermo: step, imposed potential, bottom charge, top charge, theory charge, percent deviation
thermo_style custom step v_v c_qbot c_qtop v_qtheory v_percdev

run 10
"
"Generate a LAMMPS input script for a general simulation of an atomic system and p       p       p boundary conditions running for 1 steps.","# Test of MEAM potential for HGa

# ------------------------ INITIALIZATION ----------------------------
units           metal
dimension       3
boundary        p       p       p
atom_style      atomic
variable latparam equal 4.646
variable ncell equal 3

# ----------------------- ATOM DEFINITION ----------------------------
region          box block -4 4 -4 4 -4 4
create_box      2 box

#

include potential.mod
create_atoms    1 single 0 0 0  units box
create_atoms    2 single 2.2 0 0  units box
create_atoms    2 single 0.3 2.3 0  units box
# ---------- Define Settings ---------------------
variable        teng equal ""c_eatoms""
compute pot_energy all pe/atom
compute stress all stress/atom NULL
dump 1 all custom 1 dump.msmeam id x y z fx fy fz c_pot_energy c_stress[1] c_stress[2] c_stress[3] c_stress[4] c_stress[5] c_stress[6]
run     1
#write_data      data.msmeam

print ""All done!""
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 100 steps.","# 3d Lennard-Jones melt

units           lj
atom_style      atomic

lattice         fcc 0.8442
region          box block 0 2 0 2 0 2
create_box      1 box
create_atoms    1 box
mass            1 1.0

velocity        all create 3.0 87287

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.1 bin

neigh_modify    every 20 delay 0 check no

python         post_force_callback here """"""
from __future__ import print_function
from lammps import lammps

def post_force_callback(lmp, v):
  try:
    import os
    pid = os.getpid()
    pid_prefix = ""[{}] "".format(pid)

    L = lammps(ptr=lmp)
    t = L.extract_global(""ntimestep"", 0)
    print(pid_prefix, ""### POST_FORCE ###"", t)

    #mylist = L.numpy.get_neighlist(0)
    idx = L.find_pair_neighlist(""lj/cut"", reqid=0)
    mylist = L.numpy.get_neighlist(idx)
    print(pid_prefix, mylist)
    nlocal = L.extract_global(""nlocal"")
    nghost = L.extract_global(""nghost"")
    mass = L.numpy.extract_atom(""mass"")
    atype = L.numpy.extract_atom(""type"", nelem=nlocal+nghost)
    x = L.numpy.extract_atom(""x"", nelem=nlocal+nghost, dim=3)
    v = L.numpy.extract_atom(""v"", nelem=nlocal+nghost, dim=3)
    f = L.numpy.extract_atom(""f"", nelem=nlocal+nghost, dim=3)

    for iatom, neighs in mylist:
      print(pid_prefix, ""- {}"".format(iatom), x[iatom], v[iatom], f[iatom], "" : "",  len(neighs), ""Neighbors"")
      for jatom in neighs:
        if jatom < nlocal:
            print(pid_prefix, ""    *  "", jatom, x[jatom], v[jatom], f[jatom])
        else:
            print(pid_prefix, ""    * [GHOST]"", jatom, x[jatom], v[jatom], f[jatom])
  except Exception as e:
    print(e)
""""""

fix             1 all nve
fix     3 all python/invoke 50 post_force post_force_callback

#dump           id all atom 1 dump.melt

#dump           2 all image 1 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 1 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

thermo          1
run             100
"
"Generate a LAMMPS input script for a NVT simulation of an full system using hybrid/overlay coul/cut 12.0 python 12.0 pair style with pair coefficients * * coul/cut running for 100 steps at temperature 300.0.","units           real
atom_style      full

read_data       data.spce

pair_style      hybrid/overlay coul/cut 12.0 python 12.0

pair_coeff      * * coul/cut
pair_coeff      * * python py_pot.LJCutSPCE OW NULL

bond_style      harmonic
angle_style     harmonic
dihedral_style  none
improper_style  none

bond_coeff      1 1000.00 1.000
angle_coeff     1 100.0 109.47

special_bonds   lj/coul 0.0 0.0 1.0

neighbor        2.0 bin

fix             1 all shake 0.0001 20 0 b 1 a 1
fix             2 all nvt temp 300.0 300.0 100.0

# create combined lj/coul table for all atom types
# generate tabulated potential from python variant
pair_write      1 1 2000 rsq 0.1 12 spce.table OW-OW -0.8472 -0.8472
pair_write      1 2 2000 rsq 0.1 12 spce.table OW-HW -0.8472  0.4236
pair_write      2 2 2000 rsq 0.1 12 spce.table HW-HW  0.4236  0.4236

# switch to tabulated potential
pair_style      table linear 2000 pppm
pair_coeff      1 1 spce.table OW-OW
pair_coeff      1 2 spce.table OW-HW
pair_coeff      2 2 spce.table HW-HW

thermo 10
run 100

shell rm spce.table

"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/long 12 pair style with a timestep of 2.0.","# QMMM with PySCF

units           real
atom_style      full

pair_style      lj/cut/coul/long 12
pair_modify     mix arithmetic

bond_style      harmonic
angle_style     harmonic
dihedral_style  none
improper_style  none

kspace_style    pppm 1e-5

read_data       data.water

# QM atoms are 1st water
# MM atoms are 2nd water

group           qm molecule 1
group           mm molecule 2

# remove bonds/angles between QM atoms
# set charges to zero on QM atoms

delete_bonds    qm multi remove special
set             group qm charge 0.0

neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes

velocity        all create 300.0 87287 loop geom

# QMMM dynamics

timestep        2.0

fix		1 all nve

fix             2 qm mdi/qmmm direct elements O H
fix_modify      2 energy yes

thermo_style    custom step cpu temp ke evdwl ecoul epair emol elong &
                f_2 pe etotal press

thermo          1

mdi             plugin pyscf_mdi mdi ""-role ENGINE -name PySCF -method LINK"" &
                extra ""-pbc no"" command ""run 10""
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using hybrid/overlay table linear 1200 threebody/table pair style with pair coefficients * * table table_CG_CG.txt VOTCA with a timestep of 2.0 running for 1000 steps at temperature 300.0.","units           real
atom_style      atomic

# data file with two atom types
read_data       data.spce2

pair_style      hybrid/overlay table linear 1200 threebody/table

#pair coefficients
pair_coeff      * * table table_CG_CG.txt VOTCA
pair_coeff      * * threebody/table spce2.3b type1 type2

fix             1 all nvt temp 300.0 300.0 200.0

velocity        all create 300 432567 dist uniform loop geom mom yes
timestep        2.0

thermo          100
#dump            2 all custom 100 dump.spce2 id type x y z fx fy fz

run             1000

"
"Generate a LAMMPS input script for a general simulation of an atomic system and f f f boundary conditions with a timestep of 0.001 running for $r steps.","# needs description
# STEP THE GATE VOLTAGE UP
# NEED TO TURN OFF T EQNS FOR VACUUM
# HACK need to define well and open bcs
echo both
#variable iter equal 2 # need two for potential to affect density
variable iter1 equal 4  # NOTE <<<<
variable iter2 equal 25 # NOTE <<<<
variable r    equal 1
variable nx equal 12 # 30 40 10
variable mx equal 4  # 4  2
#variable ny equal ${nx}
variable ny equal 12 # 30 40
variable my equal 8 # 12 6
variable nz equal 1
variable hx  equal 1.0
variable hy  equal ${hx}*${nx}/${ny}
variable l  equal -${hx}*${nx}
variable u  equal  ${hx}*${nx}
variable w  equal  ${hy}*${my}
variable q  equal  ${hx}*${mx}
variable y equal ${nx}+1-${mx}
variable T  equal 300
variable S equal 1
variable n0 equal 0.00007
variable J0 equal 40.0 # 100.0  40.0
variable Vs equal 1.0
#variable Vg equal 1.0 # 10.0 0.0
variable tol equal 0.01
#################################################
atom_style      atomic
timestep  0.001
boundary      f f f
lattice       fcc 1.0
region        BOX block ${l} ${u} ${l} ${u} 0 1
create_box  1 BOX
mass          * 12.01
atom_modify     sort 0 1
#    ID  group atc PhysicsType ParameterFile
fix  AtC all   atc drift_diffusion-schrodinger-slice SiVacuum_ddm_schrodinger.mat
#            ID  part keywords    nx ny nz region
fix_modify   AtC mesh create ${nx} ${ny} ${nz}  BOX f f p
# surfaces & regions
variable a equal $l-${tol}
variable b equal $l+$q+${tol}
variable c equal -$w-${tol}
variable d equal  $w+${tol}
variable e equal $l+$q-${tol}
fix_modify AtC mesh create_nodeset bot -INF INF $a $b -INF INF
fix_modify AtC mesh create_nodeset lbc   $a $b -INF INF -INF INF
variable a equal $u-$q-${tol}
variable b equal $u+${tol}
variable e equal $u-$q+${tol}
fix_modify AtC mesh create_nodeset top -INF INF $a $b -INF INF 
fix_modify AtC mesh create_nodeset rbc   $a $b -INF INF -INF INF
variable a equal -$w-${tol}
variable b equal  $w+${tol}
variable c equal  $l+$q-${tol}
variable d equal  $u-$q+${tol}
fix_modify AtC mesh create_elementset wire $c $d $a $b  -INF INF
fix_modify AtC mesh create_nodeset    wire $c $d $a $b  -INF INF
variable e equal $c+2*${tol}
variable f equal $c+${tol}
fix_modify AtC mesh create_nodeset lwire   $c $e $a $b  -INF INF
fix_modify AtC mesh create_faceset lwire   $f INF $a $b  -INF INF
variable e equal $d-2*${tol}
variable f equal $d-${tol}
fix_modify AtC mesh create_nodeset rwire   $e $d $a $b  -INF INF
fix_modify AtC mesh create_faceset rwire   -INF $f $a $b  -INF INF
variable e equal $a+2*${tol}
fix_modify AtC mesh create_nodeset bwire   $c $d $a $e  -INF INF
variable e equal $b-2*${tol}
fix_modify AtC mesh create_nodeset twire   $c $d $e $b  -INF INF
# new material
fix_modify AtC material wire Si
# simplify
fix_modify  AtC extrinsic one_dimensional x wire $y
#fix_modify  AtC extrinsic poisson_solver iterative 
fix_modify AtC  internal_quadrature off 
fix_modify AtC control  thermal none
fix_modify AtC extrinsic electron_integration implicit 1
fix_modify AtC extrinsic schrodinger_poisson_solver self_consistency ${iter1}
#fix_modify AtC extrinsic conserve density 10
fix_modify AtC extrinsic schrodinger_poisson_solver conserve flux ${iter2}
fix_modify AtC extrinsic schrodinger_poisson_solver initial_fermi_level 0.1
fix_modify AtC extrinsic schrodinger_poisson_solver safe_fermi_increment 0.1
#fix_modify AtC extrinsic initial_fermi_level 0.5
# isolate system: 
# diffusion: dn/dx = 0
# drift    : n = 0
# fix temperature
fix_modify AtC  fix temperature          all $T
fix_modify AtC  initial electron_temperature all $T
fix_modify AtC  fix electron_temperature all $T # <<<
#fix_modify AtC  unfix electron_temperature wire
fix_modify AtC  fix electron_temperature lbc $T
fix_modify AtC  fix electron_temperature rbc $T
### NOTE there seems to be leakage into the vacuum
# electric potential ic
fix_modify AtC  initial electric_potential   all 0.0
fix_modify AtC  fix electric_potential lbc 0
fix_modify AtC  fix electric_potential rbc ${Vs}
#fix_modify AtC  fix electric_potential bot ${Vg} # remove this if Vg=0
# electron density ic
fix_modify AtC  initial electron_density all 0
fix_modify AtC  fix electron_density all 0 
fix_modify AtC  unfix electron_density wire
fix_modify AtC  initial electron_density wire ${n0}
fix_modify AtC  fix electron_density twire 0.0
fix_modify AtC  fix electron_density bwire 0.0
fix_modify AtC  fix electron_density lwire ${n0}
fix_modify AtC  fix electron_density rwire ${n0}
#fix_modify AtC  fix electron_density lbc ${n0}
#fix_modify AtC  fix electron_density rbc ${n0}
fix_modify AtC  unfix electron_density lwire 
fix_modify AtC  unfix electron_density rwire
fix_modify AtC  fix_flux electron_density lwire -${J0} # <<<<
fix_modify AtC  fix_flux electron_density rwire  ${J0} # <<<<
# HACK
#fix_modify AtC  fix electron_density all 0 
# electron wavefunction ic/bcs
fix_modify AtC  initial electron_wavefunction all 0.0
fix_modify AtC  fix electron_wavefunction top 0.0
fix_modify AtC  fix electron_wavefunction bot 0.0
fix_modify AtC  fix electron_wavefunction all 0 
fix_modify AtC  unfix electron_wavefunction wire
#fix_modify AtC  fix electron_wavefunction lwire 0.0 # <<<< bit of hack
#fix_modify AtC  fix electron_wavefunction rwire 0.0 # <<<< bit of hack
fix_modify AtC  fix electron_wavefunction twire 0.0
fix_modify AtC  fix electron_wavefunction bwire 0.0
thermo  1
# f_AtC:1 thermal energy, 2 avg T, 3 electron energy, 4 avg Te, 5 total n
thermo_style custom step cpu f_AtC[1] f_AtC[2] f_AtC[3] f_AtC[4] f_AtC[5]
thermo_modify  format 1 %5i format 2 %7.2g
fix_modify AtC  output schrodinger-poisson2d_JconstraintFE $r full_text binary tensor_components
fix_modify AtC mesh output schrodinger-poisson2dMESH
run     $r
# NOW BIAS
"
"Generate a LAMMPS input script for a NVT simulation of an charge system using reaxff NULL pair style with pair coefficients * * ../../sticking.coefficients/sticking/ffield.reax.combined.COFSi.v4 Si O C F and p p p boundary conditions with a timestep of 0.1 running for 25000000 steps at temperature 6000.0.","# test amorphous C system with ReaxFF

dimension   3
boundary    p p p
units		real
atom_style	charge
timestep    0.1

# Create cubic box and some C atoms at random postions
region        sim_region block 0 70.0 0 70.0 0 70.0 units box
create_box    4 sim_region

mass    1 28.0855  # Si
mass    2 15.9994  # O
mass    3 12.0107  # C
mass    4 18.9984  # F

# create_atoms  1 random 1000 1234 NULL mol SiF4 789
create_atoms  3 random 1372 1234 NULL overlap 5.0 maxtry 100

set type 3 charge 0

pair_style	    reaxff NULL
pair_coeff	    * * ../../sticking.coefficients/sticking/ffield.reax.combined.COFSi.v4 Si O C F
neighbor	    2. bin
neigh_modify	every 10 delay 0 check no
fix             2 all qeq/reaxff 1 0.0 10.0 1e-6 reaxff

thermo_style    custom step temp epair etotal press density
thermo          100
dump            1 all custom 100 dumpidtype.dat id type q x y z

# fix		        1 all npt temp 300.0 300.0 $(100.0*dt) iso 1.0 1.0 $(1000.0*dt)
fix		        1 all nvt temp 6000.0 2500.0 $(100.0*dt)

run		25000000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/class2 10 pair style and p p p boundary conditions running for 100 steps.","# three orthogonal periodic CNTs
# demo for replicating triply looped system
# infinite loops in x, y, z
# includes bonded interactions across box corners
# includes bonds, angles, dihedrals, impropers (class2)

units real

boundary p p p

atom_style full

pair_style lj/class2 10

angle_style class2

bond_style class2

dihedral_style class2

improper_style class2

read_data three_periodic_CNTs.data.gz

replicate 2 2 2 bond/periodic

fix 1 all nve

run 100

# write_restart replicate.restart
# write_data replicate.data
"
"Generate a LAMMPS input script for a NVE simulation of an amoeba system using hippo pair style with pair coefficients * * hippo_water.prm hippo_water.key and s s s boundary conditions running for 100 steps.","# water hexamer with AMOEBA or HIPPO

units           real
boundary        s s s

atom_style      amoeba
bond_style      class2
angle_style     amoeba
dihedral_style  none

# per-atom properties required by AMOEBA or HIPPO

fix             amtype all property/atom i_amtype ghost yes
fix             extra all property/atom i_amgroup d_redID d_pval ghost yes
fix             extra2 all property/atom i_polaxe d2_xyzaxis 3

# read data file

read_data       data.water_hexamer.hippo fix amtype NULL ""Tinker Types""

# force field

pair_style      hippo
pair_coeff      * * hippo_water.prm hippo_water.key

special_bonds   lj/coul 0.5 0.5 0.5 one/five yes

# thermo output

compute         virial all pressure NULL virial

thermo_style    custom step temp epair ebond eangle edihed eimp &
                emol etotal press c_virial[*]

#dump            1 all custom 10 dump.water_hexamer id type x y z fx fy fz
#dump_modify     1 sort id

# dynamics

fix             1 all nve

thermo          10
run             100
"
"Generate a LAMMPS input script for a NVE simulation of an wavepacket system using awpmd/cut -1. hartree ermscale 0.99 free flex_press pair style with pair coefficients * * and p p p boundary conditions with a timestep of 0.001 running for 10 steps.","variable	sname index h_molecule

units 		real
newton		on
boundary        p p p
processors      1 * *


atom_style	wavepacket

read_data  	data.${sname}

#neighbor        2.0 nsq

pair_style      awpmd/cut -1. hartree ermscale 0.99 free flex_press
pair_coeff 	    * *



timestep        0.001

fix             1 all nve/awpmd

comm_modify	vel yes

compute         energies all pair awpmd/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

thermo          1
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 

run 		10
"
"Generate a LAMMPS input script for a NVE simulation using hybrid/overlay snap snap pair style with pair coefficients * * snap 1 Ni_Zuo_JPCA2020.snapcoeff Ni_Zuo_JPCA2020.snapparam Ni and p p p boundary conditions with a timestep of 0.5e-3 running for ${nsteps} steps.","# Toy demonstration of SNAP ""scale"" parameter, using fix/adapt and hybrid/overlay
# Mixing linear and quadratic SNAP Ni potentials by Zuo et al. JCPA 2020

# mixing parameter

variable lambda equal 0.2


# Initialize simulation

variable nsteps index 100
variable nrep equal 3
variable a equal 3.52
units           metal

# generate the box and atom positions using a FCC lattice
variable nx equal ${nrep}
variable ny equal ${nrep}
variable nz equal ${nrep}

boundary        p p p

lattice         fcc $a
region          box block 0 ${nx} 0 ${ny} 0 ${nz}
create_box      1 box
create_atoms    1 box

mass 1 34.

# choose bundled SNAP Ni potential from Zuo et al. JCPA 2020
pair_style hybrid/overlay snap snap
pair_coeff * * snap 1 Ni_Zuo_JPCA2020.snapcoeff Ni_Zuo_JPCA2020.snapparam Ni
pair_coeff * * snap 2 Ni_Zuo_JPCA2020.quadratic.snapcoeff Ni_Zuo_JPCA2020.quadratic.snapparam Ni

# scale according to mixing parameter
variable l1 equal ${lambda}
variable l2 equal 1.0-${lambda}
fix scale1 all adapt 1 pair snap:1 scale * * v_l1
fix scale2 all adapt 1 pair snap:2 scale * * v_l2

# Setup output
thermo          1
thermo_modify norm yes

# Set up NVE run
timestep 0.5e-3
neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes

# Run MD
velocity all create 300.0 4928459 loop geom
fix 1 all nve
run             ${nsteps}
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 and p p m boundary conditions running for 2500 steps.","# 3d Lennard-Jones melt, thermostatted by fix controller

units           lj
atom_style      atomic
boundary        p p m
processors      * * 1
lattice         fcc 0.8442
region          box block 0 10 0 10 -4 14
region          slab block 0 10 0 10 0 10
create_box      1 box
create_atoms    1 region slab
mass            1 1.0

velocity        all create 1.44 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    delay 2 every 2 check yes

fix             1 all nve
fix             3 all langevin 1.5 1.5 0.5 412513

variable        zhi internal $(10.5*zlat)
variable        kwall equal 20.0
fix             2 all wall/harmonic zlo -0.5 ${kwall} 0.0 2.5 zhi v_zhi ${kwall} 0.0 2.5

variable        pzz equal pzz
fix             ave all ave/time 10 10 100 v_pzz
# equilibrate

thermo_style    custom  step temp pxx pyy pzz f_ave v_zhi
thermo           500
run             2500

# use time averaged pressure for control
#fix             10 all controller 100 -0.05 20.0 0.0 0.0 f_ave 1.5 zhi

# use instantaneous pressure for control
fix             10 all controller 100 -0.05 50.0 0.0 0.0 v_pzz 1.5 zhi

# run with controller

run             5000

"
"Generate a LAMMPS input script for a general simulation of an charge system using comb pair style with pair coefficients * * ffield.comb Si and p p p boundary conditions with a timestep of 0.00020 running for 1 steps.","# Pure Si crystal, qeq off, calculates stress-strain, no out.*.cfg

units		metal
atom_style	charge
dimension       3
boundary        p p p

lattice  	diamond 5.431
region		box block 0 4 0 4 0 4
create_box	1 box
create_atoms	1 box
mass		1 29.0
change_box  	all triclinic

velocity	all create 1.0 277387

pair_style	comb
pair_coeff	* * ffield.comb Si

neighbor	0.5 bin
neigh_modify	every 20 delay 0 check no

fix		1 all box/relax aniso 0.0 vmax 0.001
timestep        0.00020

thermo_style	custom step temp etotal pe evdwl ecoul &
		#lx ly lz vol pxx pyy pzz
thermo_modify	norm yes
thermo		1
minimize	1.0e-14  1.0e-20  1000  10000
min_modify	dmax 0.2 line quadratic

unfix		1
run		1

### copy lines after this to any input script for elastic calculations ###
## 		Elastic constants calculations: strain box, measure box stress
##		strain x, measure s_x, s_y, s_z, s_yz:
##                calculates C11, C12, C13 and C14

fix  		2 all deform 1 x scale 1.0001 remap x 
compute   	perfx all stress/atom NULL pair
compute   	fx all reduce sum &
		c_perfx[1] c_perfx[2] c_perfx[3] &
		c_perfx[4] c_perfx[5] c_perfx[6]
thermo_style	custom step lx ly lz xy xz yz &
		c_fx[1] c_fx[2] c_fx[3] c_fx[4] c_fx[5] c_fx[6]
run		10

##		strain z, measure s_z: calculates C33

fix  		2 all deform 1 z scale 1.0001 remap x 
compute   	perfz all stress/atom NULL pair
compute   	fz all reduce sum &
		c_perfz[1] c_perfz[2] c_perfz[3] &
		c_perfz[4] c_perfz[5] c_perfz[6]
thermo_style	custom  step lx ly lz xy xz yz &
		c_fz[1] c_fz[2] c_fz[3] c_fz[4] c_fz[5] c_fz[6]
run		10

##		strain yz, measure s_yz: calculates C44

fix  		2 all deform 1 yz erate 0.0001 remap x 
compute   	perfyz all stress/atom NULL pair
compute   	fyz all reduce sum &
		c_perfyz[1] c_perfyz[2] c_perfyz[3] &
		c_perfyz[4] c_perfyz[5] c_perfyz[6]
thermo_style	custom  step lx ly lz xy xz yz &
		c_fyz[1] c_fyz[2] c_fyz[3] c_fyz[4] c_fyz[5] c_fyz[6]
run		10

##		strain xy, measure s_xy: calculates C66

fix  		2 all deform 1 xy erate 0.0001 remap x 
compute   	perfxy all stress/atom NULL pair
compute   	fxy all reduce sum &
		c_perfxy[1] c_perfxy[2] c_perfxy[3] &
		c_perfxy[4] c_perfxy[5] c_perfxy[6]
thermo_style	custom  step lx ly lz xy xz yz &
		c_fxy[1] c_fxy[2] c_fxy[3] c_fxy[4] c_fxy[5] c_fxy[6]
run		10
"
"Generate a LAMMPS input script for a NVT simulation of an electron system using eff/cut 1000.0 pair style with pair coefficients * * and f f f boundary conditions running for 10000 steps at temperature 1.","
# Created 2010-12-13

# General parameters

variable	sname index C2H6fc.bohr

units		electron
newton		on
boundary	f f f

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 1000.0
pair_coeff      * *

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

comm_modify	vel yes

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp press effPress

# Minimization

min_style       cg
dump            1 all xyz 10 ${sname}.min.xyz
compute         1 all property/atom spin eradius erforce
dump            2 all custom 10 ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
dump            3 all custom 10 data.${sname}.restart id type q c_1[1] c_1[2] x y z
min_modify      line quadratic
minimize        0 1e-6 1000 2000

undump		1
undump		2
undump          3

fix		1 all nvt/eff temp 1 2000 1.0
dump            2 all custom 10 ${sname}.nvt.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]

run		10000
"
"Generate a LAMMPS input script for a general simulation of an atomic system and p p p boundary conditions running for 0 steps.","# kim property example
#
# For detailed information of this example please refer to:
# `https://openkim.org/doc/evaluation/tutorial-lammps/`
#
# Description:
#
# This example is designed to calculate the cohesive energy corresponding to
# the equilibrium FCC lattice constant for
# `LJ_Shifted_Bernardes_1958MedCutoff_Ar__MO_126566794224_004` model for
# argon. The material properties computed in LAMMPS are represented as a
# standard KIM property instance format. (See
# `https://openkim.org/doc/schema/properties-framework/` and
# `https://docs.lammps.org/kim_commands.html` for further details).
# Then the created property instance is written to a file named `results.edn`
# using the `kim property dump` command.
#
# Requirement:
#
# This example requires LAMMPS built with the Python 3.6 or later package
# installed. See the `https://docs.lammps.org/python.html` doc page for
# more info on building LAMMPS with the version of Python on your system.
# After successfully building LAMMPS with Python, you need to install the
# kim-property Python package, See the
# `https://docs.lammps.org/Build_extras.html#kim` doc page for
# further details.
#
# This example requires that the KIM Portable Model (PM)
# `LJ_Shifted_Bernardes_1958MedCutoff_Ar__MO_126566794224_004`
# is installed.  This can be done with the command
#   kim-api-collections-management install user LJ_Shifted_Bernardes_1958MedCutoff_Ar__MO_126566794224_004
# If this command does not work, you may need to setup your PATH to find the utility.
# If you installed the kim-api using the LAMMPS CMake build, you can do the following
# (where the current working directory is assumed to be the LAMMPS build directory)
#   source ./kim_build-prefix/bin/kim-api-activate
# If you installed the kim-api using the LAMMPS Make build, you can do the following
# (where the current working directory is assumed to be the LAMMPS src directory)
#   source ../lib/kim/installed-kim-api-X.Y.Z/bin/kim-api-activate
# (where you should relplace X.Y.Z with the appropriate kim-api version number).
#
# Or, see `https://openkim.org/doc/obtaining-models` for alternative options.
#

# Initialize interatomic potential (KIM model) and units
atom_style atomic

# Set the OpenKIM model that will be used
kim init LJ_Shifted_Bernardes_1958MedCutoff_Ar__MO_126566794224_004 metal

# the equilibrium lattice constant for the fcc structure
variable lattice_constant equal 5.248509056866169

# Periodic boundary conditions along all three dimensions
boundary p p p

# Create an FCC lattice with the lattice spacing
# using a single conventional (orthogonal) unit cell
lattice      fcc ${lattice_constant}
region box   block 0 1 0 1 0 1 units lattice
create_box   1 box
create_atoms 1 box
mass         1 39.948

# Specify the KIM interactions
kim interactions Ar

# Compute energy
run 0

# Get cohesive energy
variable natoms       equal ""count(all)""
variable ecohesive    equal ""-pe/v_natoms""

# Create a property instance
kim property create 1 cohesive-potential-energy-cubic-crystal

# Set all the key-value pairs for this property instance
kim property modify 1 key short-name source-value 1 fcc                          &
                      key species source-value 1 Ar                              &
                      key a source-value ${lattice_constant}                     &
                            source-unit angstrom                                 &
                      key basis-atom-coordinates source-value 1 1:3 0.0 0.0 0.0  &
                                                 source-value 2 1:3 0.0 0.5 0.5  &
                                                 source-value 3 1:3 0.5 0.0 0.5  &
                                                 source-value 4 1:3 0.5 0.5 0.0  &
                      key space-group source-value Fm-3m                         &
                      key cohesive-potential-energy source-value ${ecohesive}    &
                                                    source-unit eV

# Dump the results in a file
kim property dump ""results.edn""
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using vashishta/table ${ntable} 0.2 pair style with pair coefficients * *  SiO.1990.vashishta Si O and p p p boundary conditions with a timestep of 0.001 running for 100 steps.","# test Vashishta potential for quartz

units		metal
boundary	p p p

variable	ntable index 100000

atom_style	atomic

read_data	data.quartz

replicate       4 4 4
velocity	all create 2000.0 277387 mom yes
displace_atoms	all move 0.05 0.9 0.4 units box

pair_style 	vashishta/table ${ntable} 0.2
pair_coeff	* *  SiO.1990.vashishta Si O

neighbor	0.3 bin
neigh_modify	delay 10

fix		1 all nve
thermo		10
timestep	0.001

#dump		1 all cfg 10 *.cfg mass type xs ys zs vx vy vz fx fy fz
#dump_modify	1 element Si O

run		100

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 2.5 and p s p boundary conditions with a timestep of 0.003 running for 30000 steps.","# 2d indenter simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.9
region		box block 0 20 0 10 -0.25 0.25
create_box	2 box
create_atoms	1 box

mass		1 1.0
mass		2 1.0

# LJ potentials

pair_style	lj/cut 2.5
pair_coeff	* * 1.0 1.0 2.5

# define groups

region	        1 block INF INF INF 1.25 INF INF
group		lower region 1
group		mobile subtract all lower
set		group lower type 2

# initial velocities

compute	  	new mobile temp
velocity	mobile create 0.2 482748 temp new
fix		1 all nve
fix		2 lower setforce 0.0 0.0 0.0
fix		3 all temp/rescale 100 0.1 0.1 0.01 1.0

# run with indenter

timestep	0.003
variable	k equal 1000.0/xlat
variable        y equal ""13.0*ylat - step*dt*0.02*ylat""

fix		4 all indent $k sphere 10 v_y 0 5.0
fix		5 all enforce2d

thermo		1000
thermo_modify	temp new

#dump		1 all atom 250 dump.indent

#dump		2 all image 1000 image.*.jpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	2 pad 5

#dump		3 all movie 1000 movie.mpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	3 pad 5

run		30000

# run without indenter

unfix           4
run		30000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay rebo tersoff ilp/graphene/hbn 16.0 coul/shield 16.0 pair style with pair coefficients * * rebo               CH.rebo     NULL NULL C    # chemical and p p p boundary conditions with a timestep of 0.001 running for 1000 steps.","# Initialization
units           metal
boundary        p p p
atom_style      full
processors      * * 1     # domain decomposition over x and y

# System and atom definition
# we use different molecule ids for each layer
# so that inter- and intra-layer
# interactions can be specified separately
read_data       gr_hBN_Cstack_2L_noH.data
mass            1 10.8110   # boron    mass (g/mole) | membrane
mass            2 14.0067   # nitrogen mass (g/mole) | membrane
mass            3 12.0107   # carbon   mass (g/mole) | adsorbate
# Separate atom groups
group 		hBN molecule 1
group 		gr  molecule 2

######################## Potential defition ########################
pair_style  hybrid/overlay rebo tersoff ilp/graphene/hbn 16.0 coul/shield 16.0
####################################################################
pair_coeff  * * rebo               CH.rebo     NULL NULL C    # chemical
pair_coeff  * * tersoff            BNC.tersoff B    N    NULL # chemical
pair_coeff  * * ilp/graphene/hbn   BNCH.ILP    B    N    C    # long range
pair_coeff  1 1 coul/shield 0.70
pair_coeff  1 2 coul/shield 0.69498201415576216335
pair_coeff  2 2 coul/shield 0.69
####################################################################
# Neighbor update settings
neighbor        2.0 bin
neigh_modify    every 1
neigh_modify    delay 0
neigh_modify    check yes

#### Simulation settings ####
timestep  	0.001
velocity  	all create 300.0 12345 dist gaussian mom yes rot yes
fix       	thermostat all nve

compute   	0 all pair rebo
compute   	1 all pair tersoff
compute   	2 all pair ilp/graphene/hbn
compute   	3 all pair coul/shield
variable  	REBO     equal  c_0
variable  	Tersoff  equal  c_1
variable  	EILP     equal  c_2     # total interlayer energy
variable  	Evdw     equal  c_2[1]  # attractive energy
variable 	Erep     equal  c_2[2]  # repulsive  energy
variable  	Ecoul    equal  c_3

############# Output ##############
thermo          100
thermo_style    custom step etotal pe ke v_Evdw v_Tersoff v_REBO v_EILP v_Erep v_Evdw v_Ecoul temp

###### Run molecular dynamics ######
run 		1000
"
"Generate a LAMMPS input script for a general simulation of an bond system using zero 5.0 pair style with pair coefficients * * and f p p boundary conditions running for 5 post no steps.","units real
atom_style bond
boundary f p p
region box block -5.000000000000001 5.000000000000001 -5 5 -5 5
create_box 1 box bond/types 1 extra/bond/per/atom 1 extra/special/per/atom 1

pair_style zero 5.0
pair_coeff * *
mass * 1.0
bond_style zero
bond_coeff * 1.0

create_atoms 1 single -4.0 0.0 0.0
create_atoms 1 single  4.0 0.0 0.0
create_atoms 1 single -5.0 0.0 0.0
create_atoms 1 single  5.0 0.0 0.0
create_bonds single/bond 1 3 1
create_bonds single/bond 1 4 2

group move id 1:2
write_restart walltest.restart

variable name string wall-harmonic
include wall.inc

fix 1 move wall/harmonic xlo -5.0 100 0.0 4.0 xhi 5.0 100 1.0 4.0
fix_modify 1 energy yes
run 5 post no

variable name string lepton-harmonic
include wall.inc

fix 1 move wall/lepton xlo -5.0 ""k*(r-rc)^2;k=100.0"" 4.0 xhi 5.0 ""k*(r-rc)^2;k=100.0"" 4.0
fix_modify 1 energy yes
run 5 post no

variable name string bond-harmonic
include wall.inc

bond_style harmonic
bond_coeff 1 100 4.0
run 5 post no

variable name string pair-harmonic
include wall.inc

pair_style harmonic/cut
pair_coeff 1 1 100 4.0
run 5 post no

variable eps index 0.02
variable sig index 2.0
variable name string wall-lj126
include wall.inc

fix 1 move wall/lj126 xlo -5.0 ${eps} ${sig} 4.0 xhi 5.0 ${eps} ${sig} 4.0
fix_modify 1 energy yes
run 5 post no

variable name string lepton-lj126
include wall.inc

fix 1 move wall/lepton xlo -5.0 ""4.0*epsilon*((sigma/r)^12 - (sigma/r)^6);epsilon=v_eps;sigma=v_sig"" 4.0 &
                       xhi  5.0 ""4.0*epsilon*((sigma/r)^12 - (sigma/r)^6);epsilon=v_eps;sigma=v_sig"" 4.0
fix_modify 1 energy yes
run 5 post no

variable name string pair-lj126
include wall.inc

pair_style lj/cut 4.0
pair_coeff 1 1 ${eps} ${sig}
pair_modify shift yes
run 5 post no

variable d0 index 20.0
variable al index 2.0
variable r0 index 1.2

variable name string wall-morse
include wall.inc

fix 1 move wall/morse xlo -5.0 ${d0} ${al} ${r0} 4.0 xhi 5.0 ${d0} ${al} ${r0} 4.0
fix_modify 1 energy yes
run 5 post no

variable name string lepton-morse
include wall.inc

fix 1 move wall/lepton xlo -5.0 ""d0*(-1.0 + (1.0 - ralpha) * (1.0 - ralpha));ralpha=exp(-alpha*(r-r0));d0=v_d0;alpha=v_al;r0=v_r0"" 4.0 &
                       xhi  5.0 ""d0*(-1.0 + (1.0 - ralpha) * (1.0 - ralpha));ralpha=exp(-alpha*(r-r0));d0=v_d0;alpha=v_al;r0=v_r0"" 4.0 
fix_modify 1 energy yes
run 5 post no

variable name string bond-morse
include wall.inc

bond_style morse
bond_coeff 1 ${d0} ${al} ${r0}
run 5 post no

variable name string pair-morse
include wall.inc

pair_style morse 4.0
pair_coeff 1 1 ${d0} ${al} ${r0}
pair_modify shift yes
run 5 post no

shell rm -f walltest.restart
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using sw pair style with pair coefficients * * Si.sw Si and p p p boundary conditions with a timestep of 1.0e-3 running for 1000 steps.","# temperature accelerated dynamics model for a single vacancy in bulk Si
# events occur when a neighboring atom diffuses to the vacant site
# run this on multiple partitions as
#   mpirun -np 3 lmp_g++ -partition 3x1 -in in.tad

units           metal

atom_style      atomic
atom_modify     map array
boundary        p p p
atom_modify	sort 0 0.0

# temperatures
variable tlo equal 1800.0
variable thi equal 2400.0

# coordination number cutoff

variable r equal 2.835

# minimization parameters

variable etol equal 1.0e-5
variable ftol equal 1.0e-5
variable maxiter equal 100
variable maxeval equal 100
variable dmax equal 1.0e-1

# diamond unit cell

variable a equal 5.431
lattice         custom $a               &
                a1 1.0 0.0 0.0          &
                a2 0.0 1.0 0.0          &
                a3 0.0 0.0 1.0          &
                basis 0.0 0.0 0.0       &
                basis 0.0 0.5 0.5       &
                basis 0.5 0.0 0.5       &
                basis 0.5 0.5 0.0       &
                basis 0.25 0.25 0.25    &
                basis 0.25 0.75 0.75    &
                basis 0.75 0.25 0.75    &
                basis 0.75 0.75 0.25

region          myreg block     0 4 &
                                0 4 &
                                0 4
create_box      1 myreg
create_atoms    1 region myreg

mass            1       28.06

group Si type 1

velocity all create ${thi} 5287286 mom yes rot yes dist gaussian

# make a vacancy

group del id 300
delete_atoms group del

pair_style      sw
pair_coeff * * Si.sw Si

thermo          10

fix             1 all nve
fix 		2 all langevin ${thi} ${thi} 0.1 48278

timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes

# equilibrate

run             1000

# Eliminate COM motion
velocity all zero linear 

# only output atoms near vacancy

compute coord all coord/atom cutoff $r

#dump events all custom 1 dump.prd id type x y z
#dump_modify events thresh c_coord != 4

compute  patom all pe/atom
compute  pe all reduce sum c_patom
compute  satom all stress/atom NULL
compute  str all reduce sum c_satom[1] c_satom[2] c_satom[3]
variable press equal (c_str[1]+c_str[2]+c_str[3])/(3*vol)

thermo_style custom step temp pe c_pe press v_press

compute         event all event/displace 1.0

unfix 1
unfix 2
fix 		1 all nvt temp ${thi} ${thi} 0.1

# tad nsteps nevent tlo thi delta_conf tmax compute
#     [min etol ftol niter neval]
#     [neb etol_neb ftol_neb n1steps n2steps nevery]
#     [neb_style min_style]
#     [neb_log logfile]
 
tad 2000 50 ${tlo} ${thi} 0.05 1.0 event &
    min ${etol} ${ftol} ${maxiter} ${maxeval} &
    neb 0.0 0.01 200 200 20 neb_style fire neb_log log.neb
"
"Generate a LAMMPS input script for a NVE simulation of an atomic   # Can be either dpd or atomic system using dpd/fdt 300.0 10.0 234324 pair style with pair coefficients 1 1 0.075 0.022 10.0 and p p p boundary conditions with a timestep of 0.001 running for 100 steps.","# Input File for DPD fluid under isothermal conditions using the VV-SSA integration scheme

boundary        p p p

units           metal  
atom_style      atomic   # Can be either dpd or atomic 
read_data       data.dpd

comm_modify     mode single vel yes
mass            1 100.0

pair_style      dpd/fdt 300.0 10.0 234324
pair_coeff      1 1 0.075 0.022 10.0

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check no once no

timestep        0.001

thermo          1
thermo_style    custom step temp pe ke etotal
thermo_modify   format float %15.10f

fix             1 all shardlow
fix             2 all nve

run             100
"
"Generate a LAMMPS input script for a NVE simulation of an dielectric system using lj/cut/coul/long/dielectric 1.122 10.0 pair style with pair coefficients * * 1.0 1.0 and p p f boundary conditions running for 0 steps.","# Two ions, a cation and an anion, confined between two interfaces: epsilon1 | epsilon2  | epsilon1
# The interface normal vectors should be consistent with ed, pointing from region with epsilon1 to that with epsilon2
# bottom interface: n = (0, 0, 1)
# top interface:    n = (0, 0, -1)
# so that ed's are the same for both interfaces

# Dielectric constants can be set to be different from the input data file

variable epsilon1 index 20
variable epsilon2 index 10

variable    data index data.confined

newton off
units       lj
atom_style  dielectric
atom_modify map array
dimension   3
boundary    p p f

variable    method index gmres  # gmres = BEM/GMRES
                                # icc   = BEM/ICC*
                                # dof   = Direct optimization of the functional
                                # none

# compute the relevant values for the interface particles

variable ed      equal ""v_epsilon2 - v_epsilon1""
variable em      equal ""(v_epsilon2 + v_epsilon1)/2""
variable epsilon equal 1.0                             # epsilon at the patch, not used for now
variable area    equal 0.866                           # patch area, same as in the data file

read_data   ${data}

group interface type 1
group ions type 2 3

group cations type 2
group anions  type 3

# set the dielectric constant of the medium where the ions reside

set group cations epsilon ${epsilon2}
set group anions  epsilon ${epsilon2}

pair_style      lj/cut/coul/long/dielectric 1.122 10.0
pair_coeff      * * 1.0 1.0
pair_coeff      1 1 0.0 1.0

kspace_style    pppm/dielectric 0.0001
kspace_modify   slab 3.0

neigh_modify    every 1 delay 0 check yes one 5000

#compute         ef all efield/atom
#dump            1 all custom 100 all.dump id mol type q x y z #fx fy fz c_ef[1] c_ef[2] c_ef[3]
#dump            2 interface custom 100 interface.dump id mol type q x y z #fx fy fz c_ef[1] c_ef[2] c_ef[3]
#dump_modify     1 sort id

#dump            3 ions custom 100 ions.dump id mol type q x y z fx fy fz #c_ef[1] c_ef[2] c_ef[3]

fix             1 ions nve

# fix modify is used to set the properties of the interface particle group

if ""${method} == gmres"" then &
  ""fix             3 interface polarize/bem/gmres 1 1.0e-4"" &
  ""fix_modify      3 itr_max 50 dielectrics ${ed} ${em} ${epsilon} ${area} NULL"" &
elif ""${method} == icc""&
  ""fix             3 interface polarize/bem/icc 1 1.0e-4"" &
  ""fix_modify      3 itr_max 50 dielectrics ${ed} ${em} ${epsilon} ${area} NULL"" &
elif ""${method} == dof"" &
  ""fix             3 interface polarize/functional 1 0.0001"" &
  ""fix_modify      3 dielectrics ${ed} ${em} ${epsilon} ${area} NULL"" &
else &
  ""print 'Unsupported polarization solver' ""

thermo          1000
thermo_style    custom step evdwl ecoul elong epair #f_3
thermo_modify   flush yes

run             0





"
"Generate a LAMMPS input script for a general simulation of an molecular system using hybrid/overlay drip rebo pair style with pair coefficients * * drip  C.drip     C NULL  # only applies to species 1, i.e. C and p p s boundary conditions.","# Define unit set and class of atomic model
units metal
atom_style molecular

# BC
boundary p p s

# read config
read_data      data.CH


# potential
pair_style hybrid/overlay drip rebo
pair_coeff * * drip  C.drip     C NULL  # only applies to species 1, i.e. C
pair_coeff * * rebo  CH.rebo  C H     # species 1 is C and species 2 is H


compute        peratom all pe/atom

# set what thermodynamic information to print to log
thermo         10  # print every 1 timestep

# set what information to write to dump file
dump           id all custom 1 lammps.dump id type x y z fx fy fz c_peratom
dump_modify    id every 10 format line ""%d %d %13.5e %13.5e %13.5e %13.5e %13.5e %13.5e %13.5e""
dump_modify    id sort id

# minimize energy
minimize  1.0e-15 1.0e-15 100 100

"
"Generate a LAMMPS input script for a NPT simulation of an full system using lj/cut 5.0 pair style with a timestep of 1.0.","# LJ particles
variable        lambda world 900 910 920 930
variable        rep world 0 1 2 3 
#variable        walker world 0 1 3 2

variable        T0 equal 300.0
variable        press equal 0.0

units           real
atom_style      full
pair_style      lj/cut 5.0

# LJ particles
log             ${rep}/log.lammps.${rep}
print           ""This is replica: ${rep}""

read_data       ${rep}/lj.data

#dump            dump all xyz 1000 ${rep}/dump.xyz

fix             fxnpt all npt temp ${T0} ${T0} 1000.0 iso ${press} ${press} 10000.0 
fix             fxgREM all grem ${lambda} -.03 -30000 fxnpt

thermo          10
thermo_style    custom step temp f_fxgREM pe etotal press vol
thermo_modify   press fxgREM_press
timestep        1.0

temper/grem     10000 100 ${lambda} fxgREM fxnpt 10294 98392 #${walker}

#write_data      ${rep}/lj-out.data
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff NULL checkqeq no pair style with pair coefficients * * ffield.reax.cho H C O with a timestep of 0.25 running for 10 steps.","# This example demonstrates the use of various fix qeq variants with pair reaxff
# You can comment in/out various versions below
#
# 1) Fix qeq/shielded generates the same results compared to fix qeq/reax when
#    used with pair_style reaxff, provided that the QEq parameters are the same.
#
# 2) Fix qeq/point and fix qeq/dynamic generate comparable results provided that
#    the QEq parameters are the same.  These two styles can also be used with 
#    pair_style reaxff.

units		real
atom_style	charge

read_data	data.CHO

pair_style	reaxff NULL checkqeq no
pair_coeff	* * ffield.reax.cho H C O

neighbor	1 bin
neigh_modify	every 1 delay 0 check yes

group    	type1 type 1
compute   	charge1 type1 property/atom q
compute   	q1 type1 reduce ave c_charge1
group    	type2 type 2
compute   	charge2 type2 property/atom q
compute   	q2 type2 reduce ave c_charge2
group    	type3 type 3
compute   	charge3 type3 property/atom q
compute   	q3 type3 reduce ave c_charge3
variable   	qtot equal count(type1)*c_q1+count(type2)*c_q2+count(type3)*c_q3

thermo_style  	custom step pe c_q1 c_q2 c_q3 v_qtot
thermo     	1

velocity  	all create 300.0 1281937 
fix		1 all nve

fix             2 all qeq/reax 1 0.0 10.0 1e-6 param.qeq.reax
#fix             2 all qeq/shielded 1 10.0 1e-6 400 param.qeq1
#fix             2 all qeq/point 1 10.0 1e-6 400 param.qeq1
#fix             2 all qeq/dynamic 1 10.0 1e-3 100 param.qeq1

timestep	0.25

run		10
"
"Generate a LAMMPS input script for a NVE simulation of an ellipsoid system using resquared 1 pair style with pair coefficients 1 1 10.0 1.0 0.5 0.5 4 0.5 0.5 4 1 and p p p boundary conditions with a timestep of 0.0005 running for 50000 steps.","units lj
atom_style ellipsoid
boundary p p p
read_data Data_region
#------------------------------------#
region the_wall block 20. 40. 20. 40. 20. 40. side out
#------------------------------------#
pair_style resquared 1
pair_coeff 1 1 10.0 1.0 0.5 0.5 4 0.5 0.5 4 1
#------------------------------------#
timestep 0.0005
#------------------------------------#

fix EES_block all wall/region/ees the_wall 10. 1. 20
#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^#

thermo_style custom step temp press etotal f_EES_block[1] f_EES_block[3]

fix NVE all nve/asphere
#------------------------------------#
compute qw all  property/atom quatw
compute qi all  property/atom quati
compute qj all  property/atom quatj
compute qk all  property/atom quatk
#------------------------------------#
thermo 500
#dump 1 all custom 1000 dump_region id type x y z c_qw c_qi c_qj c_qk 
run 50000

"
"Generate a LAMMPS input script for a NVT simulation of an molecular system using lj/cut 12.0 pair style with pair coefficients 1 1  0.1180  3.905 and p p p boundary conditions running for 2500 steps at temperature 100.0.","# demo for atom style template simulating a cyclohexane methane mixture

units real
boundary p p p
molecule cychex cyclohexane.mol
atom_style molecular

pair_style lj/cut 12.0
pair_modify mix geometric tail yes
bond_style harmonic
angle_style harmonic
dihedral_style harmonic

lattice sc 6.0
variable boxlen index 4.0
region box block -${boxlen} ${boxlen} -${boxlen} ${boxlen} -${boxlen} ${boxlen} units lattice
create_box 2 box bond/types 1 angle/types 1 dihedral/types 1 extra/special/per/atom 6 &
                 extra/bond/per/atom 2 extra/angle/per/atom 2 extra/dihedral/per/atom 2

create_atoms 0 box mol cychex 734594
create_atoms 2 random 800 495437 box

mass 1 14.027
mass 2 16.043

pair_coeff 1 1  0.1180  3.905
pair_coeff 2 2  0.2940  3.730

bond_coeff      1  260.00 1.5260
angle_coeff     1  63.0   112.40
dihedral_coeff  1  2.0 1 3

thermo 100
minimize 0.001 0.001 500 1000
reset_timestep 0

velocity all create 100.0 6234235
fix 1 all nvt temp 100.0 300.0 1.0
# dump 1 all custom 100 cychex-methane.lammpstrj id xu yu zu
run 2500
#write_data molecular-mix.data
#write_restart molecular-mix.restart
"
"Generate a LAMMPS input script for a NVE simulation of an ellipsoid system using gayberne 1.0 3.0 1.0 4.0 pair style with pair coefficients 1 1 3.0 1.0 1 1 1 1 1 1 2.5 with a timestep of 0.002 running for 2000 steps at temperature 2.0.","# GayBerne ellipsoids in LJ background fluid

units        lj
atom_style   ellipsoid
dimension    2

lattice      sq 0.02
region       box block 0 20 0 20 -0.5 0.5
create_box   2 box
create_atoms 1 box

set          group all type/fraction 2 0.1 95392
set          type 1 mass 1.0
set          type 2 mass 1.5
set          type 1 shape 1 1 1
set          type 2 shape 3 1 1
set          group all quat/random 18238

compute      rot all temp/asphere
group        spheroid type 1
variable     dof equal count(spheroid)+2
compute_modify rot extra/dof ${dof}

velocity     all create 2.4 87287 loop geom

pair_style   gayberne 1.0 3.0 1.0 4.0
pair_coeff   1 1 3.0 1.0 1 1 1 1 1 1 2.5
pair_coeff   1 2 3.0 1.0 1 1 1 0 0 0
pair_coeff   2 2 1.0 1.0 1 1 0.2 0 0 0

neighbor     0.8 bin

thermo_style custom step c_rot epair etotal press vol
thermo       100

timestep     0.002

compute      0 all property/atom quatw quati quatj quatk shapex shapey shapez

dump        1 all custom 100 dump.ellipse.gayberne id type x y z c_0[*]
dump_modify 1 colname c_0[1] quatw colname c_0[2] quati colname c_0[3] quatj colname c_0[4] quatk &
              colname c_0[5] shapex colname c_0[6] shapey colname c_0[7] shapez

#dump        2 all image 100 image.*.jpg type type &
#            zoom 1.6 center d 0.5 0.5 0.5
#dump_modify  2 pad 4 adiam 1 1.0 adiam 2 2.0

#dump        3 all movie 100 movie.mpg type type &
#            zoom 1.6 center d 0.5 0.5 0.5
#dump_modify  3 pad 4 adiam 1 1.0 adiam 2 2.0

fix          1 all npt/asphere temp 2.0 2.0 0.1 iso 0.0 1.0 1.0 &
               mtk no pchain 0 tchain 1
fix          2 all enforce2d

compute_modify 1_temp extra/dof ${dof}

# equilibrate to shrink box around dilute system

run          2000

# run dynamics on dense system

unfix        1
fix          1 all nve/asphere

run          2000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using python 9.0 pair style with pair coefficients * * py_pot.Harmonic A B running for 250 post no steps.","# 3d soft repulsive particles

units           real
atom_style      atomic

lattice         fcc 5.0 origin 0.1 0.1 0.1
region          box block -5 5 -5 5 -5 5
create_box      2 box
create_atoms    1 box
set type 1 type/ratio 2 0.5 424662346
mass            * 1.0

velocity        all create 3.0 87287

pair_style      python 9.0
pair_coeff      * * py_pot.Harmonic A B

neighbor        1.0 bin
neigh_modify    every 2 delay 4 check yes

fix             1 all nve

thermo          50
run             250 post no

write_restart   repulsive.restart

clear

read_restart    repulsive.restart

pair_style      python 10.0
pair_coeff      * * py_pot.Harmonic A B

shell rm -f python.dat
pair_write 1 1 1000 rsq 0.1 10.0 python.dat PYTH_A_A
pair_write 2 2 1000 rsq 0.1 10.0 python.dat PYTH_B_B
pair_write 1 2 1000 rsq 0.1 10.0 python.dat PYTH_A_B

fix             1 all nve

thermo          50
run             250 post no

clear

read_restart    repulsive.restart

pair_style      harmonic/cut
pair_coeff      1 1 0.2 9.0
pair_coeff      2 2 0.4 9.0

shell rm -f harmonic.dat
pair_write 1 1 1000 rsq 0.1 10.0 harmonic.dat HARM_1_1
pair_write 2 2 1000 rsq 0.1 10.0 harmonic.dat HARM_2_2
pair_write 1 2 1000 rsq 0.1 10.0 harmonic.dat HARM_1_2

neighbor        1.0 bin
neigh_modify    every 2 delay 4 check yes

fix             1 all nve

thermo          50
run             250 post no

clear

read_restart    repulsive.restart

pair_style      table spline 1000
pair_coeff      1 1 python.dat PYTH_A_A
pair_coeff      1 2 python.dat PYTH_A_B
pair_coeff      2 2 python.dat PYTH_B_B

neighbor        1.0 bin
neigh_modify    every 2 delay 4 check yes

fix             1 all nve

thermo          50
run             250 post no

# remove temporary files
shell rm repulsive.restart harmonic.dat python.dat
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 100.0 pair style with pair coefficients * * 1.0 1.0 100.0 and s s s boundary conditions with a timestep of 0.003 running for 10 steps.","# Steinhardt-Nelson bond orientational order parameters for icosahedral cluster
# W_6_hat is sensitive to icosohedral order

variable        rcut equal 1.2 # a bit bigger than LJ Rmin 
variable        rcutred equal 0.75 # a bit bigger than 1/sqrt(2)

# create a perfect fcc crystallite

atom_style	atomic
boundary	s s s
lattice		fcc 1.0 # neighbors at LJ Rmin
region		box block 0 2 0 2 0 2
create_box	1 box
create_atoms	1 box
mass		1 1.0

region 		centralatom sphere 1 1 1 0.0 side in
group 		centralatom region centralatom

region 		mysphere sphere 1 1 1 ${rcutred} side out
delete_atoms 	region mysphere

# LJ potential

pair_style	lj/cut 100.0
pair_coeff	* * 1.0 1.0 100.0

# define output for central atom

compute 	qlwlhat all orientorder/atom wl/hat yes cutoff ${rcut} nnn NULL
compute 	avql centralatom reduce ave c_qlwlhat[1] c_qlwlhat[2] c_qlwlhat[3] c_qlwlhat[4] c_qlwlhat[5] 
compute 	avwlhat centralatom reduce ave c_qlwlhat[6] c_qlwlhat[7] c_qlwlhat[8] c_qlwlhat[9] c_qlwlhat[10] 
variable	q6 equal c_avql[2]
variable	w6hat equal c_avwlhat[2]

compute 	mype all pe/atom
compute 	centralatompe centralatom reduce ave c_mype

# gently equilibrate the crystallite

velocity     	all create 0.001 482748
fix	     	1 all nve
neighbor	0.3 bin
neigh_modify	every 1 check no delay 0
timestep	0.003
thermo_style    custom step temp epair etotal c_centralatompe v_q6 v_w6hat
thermo		10

run		10

# quench to icosehedral cluster

minimize      	1.0e-10 1.0e-6 100 1000

# check Q_l values

print "" ""
print ""*******************************************************************""
print "" ""
print ""Comparison with reference values of Q_l ""
print ""   [Table I in W. Mickel, S. C. Kapfer,"" 
print ""   G. E. Schroeder-Turkand, K. Mecke, ""
print ""   J. Chem. Phys. 138, 044501 (2013).]""
print "" ""

variable 	q4ref equal 0.0
variable 	q6ref equal 0.663
variable 	q8ref equal 0.0
variable 	q10ref equal 0.363
variable 	q12ref equal 0.585

variable 	q4 equal c_avql[1]
variable 	q6 equal c_avql[2]
variable 	q8 equal c_avql[3]
variable 	q10 equal c_avql[4]
variable 	q12 equal c_avql[5]

print ""q4     = $(v_q4:%10.6f) delta = $(v_q4-v_q4ref:%10.4f)""
print ""q6     = $(v_q6:%10.6f) delta = $(v_q6-v_q6ref:%10.4f)""
print ""q8     = $(v_q8:%10.6f) delta = $(v_q8-v_q8ref:%10.4f)""
print ""q10    = $(v_q10:%10.6f) delta = $(v_q10-v_q10ref:%10.4f)""
print ""q12    = $(v_q12:%10.6f) delta = $(v_q12-v_q12ref:%10.4f)""

# check W_l_hat values

print "" ""
print ""Comparison with reference values of W_l_hat""
print ""   [Table I in P. Steinhardt, D. Nelson, and M. Ronchetti, ""
print ""   Phys. Rev. B 28, 784 (1983).]""
print "" ""

variable 	w6hatref equal -0.169754
variable 	w10hatref equal -0.093967

variable 	w4hat equal c_avwlhat[1]
variable 	w6hat equal c_avwlhat[2]
variable 	w8hat equal c_avwlhat[3]
variable 	w10hat equal c_avwlhat[4]
variable 	w12hat equal c_avwlhat[5]

print ""w6hat  = $(v_w6hat:%10.6f) delta = $(v_w6hat-v_w6hatref:%10.6f)""
print ""w10hat = $(v_w10hat:%10.6f) delta = $(v_w10hat-v_w10hatref:%10.6f)""
print "" ""
print ""*******************************************************************""
print "" ""

"
"Generate a LAMMPS input script for a NVT simulation of an full system using hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0 pair style with pair coefficients 1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H and p p p boundary conditions with a timestep of 0.5 running for 2000 steps.","# 250 butane system for drude polarizability example (Langevin)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane

comm_modify vel yes

group gBUTANE molecule 1:250
group gCORES type 1 2 3
group gDRUDES type 4 5

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gDRUDES create ${vTEMP_D} 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4

fix fNVT all tgnvt/drude temp ${vTEMP} ${vTEMP} 100.0 ${vTEMP_D} 20.0

compute cTEMP all temp/drude

thermo_style custom step cpu etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2] f_fNVT[1] f_fNVT[2] f_fNVT[3]
thermo 50

timestep 0.5
run 2000
"
"Generate a LAMMPS input script for a general simulation of an molecular system using lj/cut 1.572 pair style with pair coefficients * * 0.0 0.0 1.572 and p p f boundary conditions with a timestep of 0.001 running for 100 steps.","#===========================================================================#
#  System of colloidal particles under shear.                               #
#                                                                           #
#  Run consists of 10x12x4 particles, each composed of 3613 particle nodes  #
#    (3612 particles forming a spherical shell, and 1 central particle).    #
#  280 x 280 x 101 lattice-Boltzmann grid sites.                            #
#                                                                           #
#  This simulation is used to illustrate the simulation time of a realistic #
#    implementation of the lb/fluid fix.                                    #
#  The data file ""confinedcolloids.dat"" is quite large and so is not        #
#  included here.  It can be obtained from:                                 #
#  http://publish.uwo.ca/~cdennist/confinedcolloids.dat.gz                  #
#                                                                           #
#  Sample output from this run can be found in the file:                    #
#    results64.out                                                          #
#===========================================================================#

units       micro
dimension   3
boundary    p p f
atom_style  molecular

# try to download
shell test -f confinedcolloids.dat.gz || curl -L -o confinedcolloids.dat.gz http://publish.uwo.ca/~cdennist/confinedcolloids.dat.gz
read_data   confinedcolloids.dat.gz

mass * 0.00010287

#----------------------------------------------------------------------------
# Need a neighbor bin size smaller than the lattice-Boltzmann grid spacing   
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid.   
# The arguments for neigh_modify have been set to ""delay 0 every 1"", again
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid.  However, these values can likely
#   be somewhat increased without issue.  If a problem does arise (a particle
#   is outside of its processors LB grid) an error message is printed and 
#   the simulation is terminated.                               
#---------------------------------------------------------------------------- 
neighbor 0.03 bin
neigh_modify delay 0 every 1
neigh_modify exclude type 2 2
neigh_modify exclude type 2 1

#----------------------------------------------------------------------------
# ForceAtoms are the particles at the center of each colloidal object which  
#   do not interact with the fluid, but are used to implement the hard-sphere
#   interactions.                                                              
#----------------------------------------------------------------------------
group ForceAtoms type 1  

#----------------------------------------------------------------------------
# FluidAtoms are the particles representing the surface of the colloidal
#   object which do interact with the fluid.
#----------------------------------------------------------------------------
group FluidAtoms type 2

#----------------------------------------------------------------------------
# Implement a hard-sphere interaction between the particles at the center of 
#   each colloidal object (use a truncated and shifted Lennard-Jones 
#   potential).
#----------------------------------------------------------------------------
pair_style lj/cut 1.572
pair_coeff * * 0.0 0.0 1.572
pair_coeff 1 1 10.0 1.400492785 1.572
pair_modify shift yes

timestep 0.001

#---------------------------------------------------------------------------
# Create a lattice-Boltzmann fluid covering the simulation domain.
# This fluid feels a force due to the particles specified through FluidAtoms 
#   (however, this fix does not explicitly apply a force back on to these 
#    particles...this is accomplished through the use of the lb/viscous fix).
# Use a fluid density = 1.0, fluid viscosity = 1.0, (water at STP) and a
# lattice spacing dx=0.06.
# Implement top/bottomw walls moving at speeds of 20.0 in opposite directions
#----------------------------------------------------------------------------
fix   1 FluidAtoms lb/fluid 1 1.0 1.0 dx 0.06 zwall_velocity -20.0 20.0 

#----------------------------------------------------------------------------
# Apply the force due to the fluid onto the FluidAtoms particles (again,
#   these atoms represent the surface of the colloidal object, which should
#   interact with the fluid).
#----------------------------------------------------------------------------
fix   2 FluidAtoms lb/viscous

#----------------------------------------------------------------------------
# Each colloidal object (spherical shell of particles and central particle)
#   is specified as a separate molecule in the confinedcolloids.dat data
#   file.  Integrate the motion of each of these sets of particles as rigid
#   objects which move and rotate together.
#----------------------------------------------------------------------------
fix   3 all rigid molecule 

#----------------------------------------------------------------------------
# Implement a repulsive interaction between the ForceAtoms particles, and the
#   upper and lower z-walls. (A truncated and shifted Lennard-Jones potential 
#   is used).
#----------------------------------------------------------------------------
fix   wallhi ForceAtoms wall/lj126 zhi 5.88 20.0 0.8071542386 0.906 units box
fix   walllo ForceAtoms wall/lj126 zlo 0.0  20.0 0.8071542386 0.906 units box

#dump  ParticleTracking ForceAtoms custom 50 test.track id mol x y z vx vy vz

thermo 50

#run   400
run 100
"
"Generate a LAMMPS input script for a NVE simulation using lj/long/coul/long long off 2.5 pair style with pair coefficients * * 1.0 1.0 2.5 running for 500 steps.","# 3d Lennard-Jones melt

units           lj
#atom_style     charge
processors      * 1 1

lattice         fcc 0.8442
region          box block 0 10 0 10 0 10
create_box      3 box
create_atoms    1 box
mass            * 1.0

region          long block 3 6 0 10 0 10
set             region long type 2
#set type 1:2    charge 0.0

velocity        all create 1.0 87287

pair_style      lj/long/coul/long long off 2.5
pair_coeff      * * 1.0 1.0 2.5
pair_coeff      * 2 1.0 1.0 5.0

kspace_style    pppm/disp 1.0e-4
kspace_modify   gewald/disp 0.1

neighbor        0.3 bin
neigh_modify    every 2 delay 4 check yes

group           fast type 1
group           slow type 2
fix             0 all balance 20 1.0 shift x 5 1.0 &
                weight group 2 fast 1.0 slow 2.0 weight time 0.66

fix             1 all nve

#dump           id all atom 50 dump.melt

#dump           2 all image 25 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 25 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

thermo          50
run             500
"
"Generate a LAMMPS input script for a general simulation of an hybrid rheo/thermal bond system using hybrid/overlay rheo ${cut} artificial/visc ${zeta} rheo/solid pair style with pair coefficients * * rheo and m m p boundary conditions with a timestep of 0.1 running for 30000 steps.","# ------ 2D Ice Cube Pour ------ #

dimension          2
units              lj
atom_style         hybrid rheo/thermal bond
boundary           m m p
comm_modify        vel yes
newton             off
special_bonds      lj 0.0 1.0 1.0 coul 1.0 1.0 1.0

region             box block -25 25 0 100 -0.01 0.01 units box
create_box         1 box bond/types 1 extra/bond/per/atom 15 extra/special/per/atom 50

region             fluid block $(xlo+1) $(xhi-1) $(ylo+1) $(ylo+30) EDGE EDGE units box
lattice            sq 1.0
create_atoms       1 region fluid

set                group all sph/e 8.0

# ------ Model parameters ------#

variable           cut equal 3.0
variable           n equal 1.0
variable           rho0 equal 1.0
variable           cs equal 1.0
variable           mp equal ${rho0}/${n}
variable           zeta equal 0.05
variable           kappa equal 0.01*${rho0}/${mp}
variable           dt_max equal 0.1*${cut}/${cs}/3
variable           eta equal 0.05
variable           Cv equal 1.0
variable           L equal 1.0
variable           Tf equal 1.0

mass               * ${mp}
timestep           0.1

pair_style         hybrid/overlay rheo ${cut} artificial/visc ${zeta} rheo/solid
pair_coeff         * * rheo
pair_coeff         * * rheo/solid 1.0 1.0 1.0

bond_style         bpm/spring
bond_coeff         1 1.0 1.0 1.0

# ------ Pour particles ------#

molecule        my_mol ""square.mol""

# Wall region extends far enough in z to avoid contact
region          wall block EDGE EDGE EDGE EDGE -5 5 side in open 4 units box
region          drop block -16 16 70 90 EDGE EDGE side in units box

fix             1 all rheo ${cut} quintic 0 &
                           thermal &
                           shift &
                           surface/detection coordination 22 8
fix             2 all rheo/viscosity * constant ${eta}
fix             3 all rheo/pressure * linear
fix             4 all rheo/thermal conductivity * constant ${kappa} &
                                   specific/heat * constant ${Cv} &
                                   Tfreeze * constant ${Tf} &
                                   latent/heat * constant ${L} &
                                   react 1.5 1
fix             5 all wall/region wall harmonic 1.0 1.0 1.0
fix             6 all gravity 5e-4 vector 0 -1 0
fix             7 all deposit 8 0 1000 37241459 mol my_mol region drop near 2.0 vy -0.02 -0.02
fix             8 all enforce2d

compute         rho all rheo/property/atom rho
compute         phase all rheo/property/atom phase
compute         temp all rheo/property/atom temperature
compute         eng all rheo/property/atom energy
compute         nbond all nbond/atom

# ------ Output & Run ------ #

thermo          200
thermo_style    custom step time ke press atoms

#dump            1 all custom 200 atomDump id type x y vx vy fx fy c_phase c_temp c_eng c_nbond c_rho

run             30000
"
"Generate a LAMMPS input script for a NVT simulation of an template cychex system using lj/cut 12.0 pair style and p p p boundary conditions running for 2000 steps at temperature 300.0.","# demo for atom style template simulating a cyclohexane methane mixture
# part 2: continuing from data file

units real
boundary p p p
molecule cychex cyclohexane.mol
atom_style template cychex

pair_style lj/cut 12.0
pair_modify mix geometric tail yes
bond_style harmonic
angle_style harmonic
dihedral_style harmonic

read_data template-mix.data

thermo 100

fix 1 all nvt temp 300.0 300.0 1.0
# dump 1 all custom 100 custom template-mix.lammpstrj id xu yu zu
run 2000
"
"Generate a LAMMPS input script for a general simulation of an full system and p p p boundary conditions.","###############################mm
# Atom style - charge/vdw/bonded#
#################################
atom_style full

##############################################
#Units Metal : eV       - ps - angstrom - bar#
#      Real  : kcal/mol - fs - angstrom - atm#
##############################################
units   	metal

############
#Run number#
############
variable run_no   equal   0             # is it a restart? 
variable res_no   equal   ${run_no}-1   # restart file number 

#######################################
#Random Seeds and Domain Decomposition#
#######################################
variable iseed0 equal 2357  
variable iseed1 equal 26488 
variable iseed2 equal 10669 
processors      * * *

###########
#Data File#
###########
variable inpfile   string   silicon_input_file.lmp
variable resfile   string   final_restart.${res_no}
variable ff_file   string   ff-silicon.lmp

##########
#Run Type#
##########
variable minimise equal    0   #Energy Minimization

###############################
#Molecular Dynamics Parameters#
###############################
neighbor 1 bin

################################
#Energy Minimization Parameters#
################################
variable mtraj    equal        1       # trajectory output frequency - all system
variable etol     equal     1e-5       # % change in energy
variable ftol     equal     1e-5       # max force threshold (force units)
variable maxiter  equal    10000       # max # of iterations

########################
#3D Periodic Simulation#
########################
boundary 	p p p

#############################
#Reading the input structure#
#############################
if ""${run_no} == 0"" then ""read_data ${inpfile}"" else ""read_restart ${resfile}""

#############
#Force Field#
#############
include ${ff_file}

######################
#Thermodynamic Output#
######################
variable str_basic string 'step time pe temp press'

#####################
#Energy Minimization#
#####################
if ""${minimise} <= 0 || ${run_no} > 0"" then ""jump SELF end_minimise""
  print ""Doing CG minimisation""
  dump mdcd all dcd ${mtraj} min.dcd
  dump_modify mdcd unwrap yes
  min_style cg
  min_modify line quadratic
  minimize ${etol} ${ftol} ${maxiter} ${maxiter}
  reset_timestep 0
  undump mdcd
label end_minimise

##################
#Dynamical Matrix#
##################
dynamical_matrix all eskm 0.000001 file dynmat.dat binary no

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 300 pre no post no every 100 & steps.","# 3d Lennard-Jones melt - MDI driver script

units           lj
atom_style      atomic
atom_modify     map array

read_data       data.snapshot

velocity        all create 1.44 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

fix             1 all nve

fix             2 all mdi/qm add no every 100 virial yes

compute         1 all pressure NULL virial
variable        evirial equal (f_2[1]+f_2[2]+f_2[3])/3

thermo_style    custom step temp pe c_1 c_1[1] c_1[2] c_1[3]

thermo          100

dump            1 all custom 100 dump.snapshot.driver &
                id type x y z f_2[1] f_2[2] f_2[3]
dump_modify     1 sort id

run             300 pre no post no every 100 &
                ""print 'QM eng = $(f_2/atoms)'"" & 
                ""print 'QM virial = $(v_evirial) $(f_2[1]) $(f_2[2]) $(f_2[3])'""
"
"Generate a LAMMPS input script for a general simulation of an full # charge system using lj/cut/coul/cut 13.0 pair style with pair coefficients * * 0.2381 3.405 and p p p boundary conditions with a timestep of ${dt} running for $n steps.","echo both
units           real
atom_style full # charge
### NOTE p p p is required for both lammps & atc since periodic images are employed in ExtrinsicModelElectrostatic::correct_electrostatic_forces
########### BEGIN PARAMETERS ####################################
variable T equal 300
variable a equal 1.0 # 5.719025032
variable i equal 10 # thermo
variable f equal 50 # neighbor & conc interval
variable s equal 100 # 10 # 100 # output
variable n equal 800 # 20 # 200 # 300 # duration
variable x equal 4 # 40 #  2 # 4 # exchanges
variable e equal 100. # 1. # 100. # 10. # energy
variable h equal 5 # nelems
variable dt equal 4. #1. # 0 # 4.0
##############  END PARAMETERS #################################
dimension       3
boundary        p p p
pair_style      lj/cut/coul/cut 13.0
lattice         sc  $a
read_data concentration_init.data
atom_modify sort 0 1
mass       * 39.948
pair_coeff * * 0.2381 3.405
pair_coeff 1 * 0.4    3.405
dielectric 80.0
variable xlo equal xlo
variable xhi equal xhi
variable xmid equal 0.5*(${xhi}+${xlo})
print ""reservior x ${xmid}:${xhi}""
variable ylo equal ylo
variable yhi equal yhi
variable zlo equal zlo
variable zhi equal zhi
region BOX   block ${xlo} ${xhi} ${ylo} ${yhi} ${zlo} ${zhi} units box
region FLUID block ${xlo} ${xhi} ${ylo} ${yhi} ${zlo} ${zhi} units box
region R     block ${xmid} ${xhi} ${ylo} ${yhi} ${zlo} ${zhi} units box
group SOLID type 1
variable xdof equal 3*count(SOLID)
compute_modify thermo_temp extra/dof ${xdof}
#set group SOLID charge 0
group NEUTRAL type 2
group FLUID type 2 3 4
group NION type 3
group PION type 4
#group tPION type 5 # not dynamic
#group tNION type 6 # not dynamic
#variable typeP atom type[]==5
set group PION charge  1
set group NION charge -1
variable O equal count(NEUTRAL)
variable S equal count(SOLID)
variable F equal count(FLUID)
variable P equal count(PION)
variable N equal count(NION)
variable Pr equal count(PION,R)
variable Nr equal count(NION,R)
#variable tP equal count(tPION)
#variable tN equal count(tNION)
variable V equal vol
variable cO equal v_O/v_V
variable cS equal v_S/v_V
variable cN equal v_N/v_V
variable cP equal v_P/v_V
compute q all property/atom q
compute m all property/atom mass
compute Q all reduce sum c_q
compute M all reduce sum c_m
compute Qf FLUID reduce sum c_q
compute Mf FLUID reduce sum c_m
compute PMIN PION reduce min x
compute PMAX PION reduce max x
compute NMIN NION reduce min x
compute NMAX NION reduce max x
timestep        ${dt}
#neighbor 13 bin
neigh_modify every $i check no
# coulombic interactions
fix         ATC FLUID   atc species_electrostatic  Ar_electrostatic.mat
#fix_modify  ATC parallel_consistency off
fix_modify  ATC extrinsic short_range off
#fix_modify  ATC boundary SOLID
fix_modify  ATC atom_element_map eulerian $i
fix_modify  ATC internal_quadrature off
fix_modify  ATC consistent_fe_initialization on
fix_modify  ATC filter type exponential
fix_modify  ATC filter scale $i
fix_modify  ATC filter equilibrate
# mesh
print ""x = ${xlo}:${xhi}""
fix_modify ATC mesh create $h 1 1 BOX p p p  # f p p  ExtrinsicModelElectrostatic::correct_electrostatic_forces iterates through ghosts
fix_modify ATC mesh create_nodeset LBC ${xlo} ${xlo}  -INF INF -INF INF
fix_modify ATC mesh create_elementset FLUID FLUID
fix_modify ATC mesh create_elementset R R
fix_modify ATC mesh create_elementset BOX BOX
## NOTE tag instead of type, what about transition tyme
fix_modify ATC mass_matrix fe
fix_modify ATC include atomic_charge
fix_modify ATC add_species N type 3
fix_modify ATC add_species P type 4
fix_modify ATC add_species Nt type 5
fix_modify ATC add_species Pt type 6
## CC
fix_modify ATC control concentration N R 0.001 Nt  # deletions R
fix_modify ATC control concentration N frequency $f
fix_modify ATC control concentration N max_energy $e
fix_modify ATC control concentration N max_attempts 100
fix_modify ATC control concentration N max_exchanges $x
#-
fix_modify ATC control concentration P R 0.002 Pt # addtions R
fix_modify ATC control concentration P frequency $f
fix_modify ATC control concentration P max_energy $e
fix_modify ATC control concentration P max_attempts 100
fix_modify ATC control concentration P max_exchanges $x
fix_modify ATC output volume_integral all mass_density
fix_modify ATC output volume_integral all charge_density
# data reduction
fix        PP all   atc field
#fix_modify PP add_species ions type 3 4
#fix_modify PP add_species IONS type 3 4 1 2
fix_modify PP add_species n type 3
fix_modify PP add_species p type 4
fix_modify PP add_species s type 1
fix_modify PP add_species o type 2
fix_modify PP fields add species_concentration mass_density charge_density temperature
fix_modify PP fields add charge_flux species_flux
fix_modify  PP output volume_integral all mass_density
fix_modify  PP output volume_integral all charge_density
fix_modify PP mesh  create $h 1 1 BOX f p p
fix_modify PP atom_element_map eulerian $i
# output
thermo    $i
variable dN equal f_ATC[1]
variable dP equal f_ATC[2]
variable Nc equal f_ATC[3]
variable Pc equal f_ATC[4]
variable Nt equal f_ATC[5]
variable Pt equal f_ATC[6]
#
variable Nu equal f_ATC[7]
variable Pu equal f_ATC[8]
variable Ng equal f_ATC[9]
variable Pg equal f_ATC[10]
thermo_style    custom step temp etotal &
atoms v_F v_P v_N v_dP v_dN v_Pc v_Nc v_Pr v_Nr v_Pt v_Nt &
c_PMIN c_NMIN c_PMAX c_NMAX c_Q c_M c_Qf c_Mf v_Pu v_Nu v_Pg v_Ng
# NOTE this doesn't seem to work
#thermo_modify format 4 %5d format 5 %5d format 6 %5d format 7 %5d format 8 %5d
#thermo_modify format 4 %5d
#thermo_modify format 5 %5d
#thermo_modify format 6 %5d
#thermo_modify format 7 %5d
#thermo_modify format 8 %5d
#thermo_modify format 9 %5d
#thermo_modify format 10 %5d
#thermo_modify format 11 %5d
log concentration.log
fix_modify  ATC output concentrationFE $s text binary
fix_modify   PP output concentrationPP $s text
dump D all custom $s concentration.dmp id type x y z q vx vy vz fx fy fz
#fix_modify ATC  fix     temperature all $T
fix_modify ATC  fix     electric_potential LBC 0.
thermo_modify lost ignore # HACK, look at fix_gcmc or ask Paul C.
run $n
#print ""average concentration S:${cS} O:${sO} N:${cN} P:${cP}""
print ""average_concentration_S: ${cS}""
print ""average_concentration_O: ${cO}""
print ""average_concentration_N: ${cN}""
print ""average_concentration_P: ${cP}""
print ""volume: $V""
#write_restart concentration.rst
#shell ""restart2data concentration.rst concentration.data""
"
"Generate a LAMMPS input script for a NVT simulation of an electron system using eff/cut 11.049221 limit/eradius pressure/evirials pair style with pair coefficients * * and p p p boundary conditions with a timestep of 0.005 running for 200 steps at temperature 3000.0.","variable        sname index Li.ang

units           real
newton          on
boundary        p p p
dielectric	1.0

atom_style      electron

read_data       data.${sname}
#read_restart	${sname}.min.restart

pair_style      eff/cut 11.049221 limit/eradius pressure/evirials
pair_coeff      * *

comm_modify	vel yes

neigh_modify	one 2000 page 20000

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        ecoul equal c_energies[3]
variable        erres equal c_energies[4]

thermo          100
thermo_style    custom step etotal pe ke v_eke v_epauli v_ecoul v_erres press v_press temp
thermo_modify	temp effTemp press effPress flush yes	

#min_style	cg
#minimize	0 1e-6 100 1000
#write_restart	${sname}.min.restart

timestep	0.005

velocity        all create 10.0 4928459 rot yes mom yes dist gaussian
fix 		0 all temp/rescale/eff 1 10.0 3000.0 0.05 1.0
#fix		0 all langevin/eff 3000.0 3000.0 10.0 699483
fix		1 all nve/eff

run		200
unfix		0
unfix		1

fix		1 all nvt/eff temp 3000.0 3000.0 100.0
compute         1 all property/atom spin eradius ervel
dump            1 all custom 500 ${sname}.nvt.lammpstrj id type q c_1[1] c_1[2] x y z vx vy vz c_1[3]

run 		500

"
"Generate a LAMMPS input script for a NVE simulation using eam/alloy pair style with pair coefficients * * AlCu.eam.alloy Al Cu and p p p boundary conditions running for 100 steps.","# ***
# Example input for including electronic stopping effects using fix electron/stopping/fit
# Al lattice with a single incident Cu atom - multiple species simulation
# ***

units            metal
boundary         p p p

lattice          fcc 4.0495

region           box block -10 10 -10 10 -10 10
create_box       2 box
create_atoms     1 box

pair_style       eam/alloy
pair_coeff       * * AlCu.eam.alloy Al Cu

mass             1 26.982
mass             2 63.546

velocity         all create 300 42534 mom yes rot yes

set              atom 1 type 2
group            pka id 1
velocity         pka set 1120 1620 400

fix              1 all nve
fix              2 all dt/reset 1 NULL 0.001 0.05 emax 10.0
fix              3 all electron/stopping/fit 3.49 1.8e-3 9.0e-8 7.57 4.2e-3 5.0e-8

thermo           5
thermo_style     custom step dt time temp pe ke f_3
thermo_modify    lost warn flush yes

#dump             0 all custom 10 dump.pka_* id type x y z vx vy vz fx fy fz
#dump_modify      0 first yes

run              100
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 1.122462 pair style with pair coefficients 1 1 1.0 1.0 and p p p boundary conditions with a timestep of 0.005 running for ${n} steps.","variable nrun equal 1000
variable dump_count equal 10

variable nwall equal 4
variable w1 equal 67
variable w2 equal 71
variable w3 equal 75
variable w4 equal 79

variable x_cylinder equal 20
variable y_cylinder equal 17
variable r_cylinder equal 4

variable MASS  equal 1
variable TEMP  equal 0.4
variable VFLOW equal 0.5

units         lj
atom_style    atomic

lattice       fcc 0.3
region        sim_box block 0 84 0 34 0 10

boundary      p p p

create_box    2 sim_box
region        reg_cylinder cylinder z ${x_cylinder} ${y_cylinder} ${r_cylinder} EDGE EDGE

create_atoms  1 box

## setup obstacle ##
group  g_obst region reg_cylinder
group  g_flow subtract all g_obst
set    group g_obst type 2 

mass          1 ${MASS}
mass          2 ${MASS}

velocity  g_flow create ${TEMP} 4928459 rot yes dist gaussian
velocity  g_obst set    0.0 0.0 0.0

pair_style  lj/cut 1.122462
pair_coeff  1 1 1.0 1.0
pair_coeff  1 2 1.0 1.0
pair_coeff  2 2 1.0 1.0
pair_modify shift yes

neighbor      0.3 bin
neigh_modify  delay 0 every 20 check no

fix    1     g_flow nve
fix    2     g_flow wall/flow  x ${VFLOW} ${TEMP} 123 ${nwall} ${w1} ${w2} ${w3} ${w4}

variable dump_every equal ${nrun}/${dump_count}
variable thermo_every equal ${dump_every}
variable restart_every equal ${nrun}/10

##### uncomment for grid aggregation #####
#variable gr_Nx equal 42
#variable gr_Ny equal 17
#variable gr_Nz equal 1
#variable gr_Nevery equal ${dump_every}
#variable gr_Nrepeat equal 1
#variable gr_Nfreq equal ${dump_every}
#fix    3     g_flow ave/grid ${gr_Nevery} ${gr_Nrepeat} ${gr_Nfreq} ${gr_Nx} ${gr_Ny} ${gr_Nz} vx vy vz density/mass norm all ave one
#compute ct_gridId g_flow property/grid ${gr_Nx} ${gr_Ny} ${gr_Nz} id
#dump   dmp_grid  g_flow grid ${dump_every} grid.lammpstrj c_ct_gridId:grid:data f_3:grid:data[*]
##########################################

#dump   dmp_coord all atom ${dump_every} dump.lammpstrj

#compute ct_Temp   g_flow temp/com
#thermo_style custom step temp epair emol etotal press c_ct_Temp

#restart  ${restart_every} flow.restart

timestep 0.005
thermo   ${thermo_every}
run      ${nrun}
"
"Generate a LAMMPS input script for a NVT simulation of an molecular system using lj/cut 12.0 pair style and p p p boundary conditions running for 2000 steps at temperature 300.0.","# demo for atom style template simulating a cyclohexane methane mixture
# part 2: continuing from data file

units real
boundary p p p
molecule cychex cyclohexane.mol
atom_style molecular

pair_style lj/cut 12.0
pair_modify mix geometric tail yes
bond_style harmonic
angle_style harmonic
dihedral_style harmonic

read_data molecular-mix.data

thermo 100

fix 1 all nvt temp 300.0 300.0 1.0
# dump 1 all custom 100 custom template-mix.lammpstrj id xu yu zu
run 2000
"
"Generate a LAMMPS input script for a NVT simulation of an molecular system using lj/relres 0.675e-9 .725e-9 1.2e-9 1.4e-9 pair style with pair coefficients 6    6  1.21585e-21  0.3905e-9  0.0           0.0         0.575e-9 0.625e-9 1.2e-9 1.4e-9 and p p p boundary conditions with a timestep of 1.0e-15 running for 1000 steps at temperature 290.","# Example: use of lj/relres for simulation of 2,2-dimethylhexane: C3H7-C5H11 
# with with mixed Rso: 0.625e-9 for C3H7 group and 0.725e-9 for C5H11 group (si units)

units           si
atom_style      molecular
boundary        p p p
dielectric      1
special_bonds   lj/coul 0.0 0.0 0.5

pair_style      lj/relres 0.675e-9 .725e-9 1.2e-9 1.4e-9
bond_style      harmonic
angle_style     harmonic
dihedral_style  fourier
read_data       Data.22DMH.in.relres
pair_coeff      6    6  1.21585e-21  0.3905e-9  0.0           0.0         0.575e-9 0.625e-9 1.2e-9 1.4e-9
pair_coeff      4    4  0.819828e-21 0.3905e-9  0.0           0.0          0.575e-9 0.625e-9 1.2e-9 1.4e-9
pair_coeff      2    2  0.819828e-21 0.3905e-9  8.48872E-21   0.3905E-9   0.575e-9 0.625e-9 1.2e-9 1.4e-9
pair_coeff      5    5  1.00742E-21  0.396E-9   0.0           0.0   
pair_coeff      3    3  0.819828e-21 0.3905e-9  0.0           0.0   
pair_coeff      1    1  0.347385E-21 0.38E-9    20.2372E-21   0.39309E-9
pair_modify     shift yes
neighbor        2.0e-10 bin
neigh_modify    every 2 delay 4 check yes

timestep 1.0e-15
thermo 100
thermo_style custom step temp press pe ke etotal epair emol vol
fix 2 all nvt temp 290 290 2.0e-13

run 1000
#write_data Data.22DMH.out.relres pair ij
#pair_write 1 1 1201 r 0.2e-9 1.4e-9  potential.relres LJ11
#pair_write 2 2 1201 r 0.2e-9 1.4e-9  potential.relres LJ22
#pair_write 1 2 1201 r 0.2e-9 1.4e-9  potential.relres LJ12
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff lmp_control pair style with pair coefficients * * ffield.reax.rdx H C O N with a timestep of 0.25 running for 3000 steps.","# REAX potential for high energy CHON systems
# .....

units           real

atom_style      charge
read_data       data.RDX

pair_style      reaxff lmp_control
pair_coeff      * * ffield.reax.rdx H C O N

neighbor        2 bin
neigh_modify    every 10 delay 0 check no

fix             1 all nve
fix             2 all qeq/reax 1 0.0 10.0 1e-6 param.qeq
fix             3 all temp/berendsen 500.0 500.0 100.0

timestep        0.25
thermo 100
#dump           1 all atom 30 dump.reax.rdx

run             3000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 300 steps.","# 3d Lennard-Jones melt - MDI driver script

units           lj
atom_style      atomic

read_data       data.snapshot

velocity        all create 1.44 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

fix             1 all nve

compute         1 all pressure NULL virial

thermo_style    custom step temp pe c_1 c_1[1] c_1[2] c_1[3]

thermo          100

dump            1 all custom 100 dump.snapshot.alone &
                id type x y z fx fy fz
dump_modify     1 sort id

run             300
"
"Generate a LAMMPS input script for a NVE simulation of an electron system using eff/cut 31.6125 pair style with pair coefficients * * and p p p boundary conditions running for 0 steps.","variable        sname index Be-solid

units           electron
newton          on
boundary        p p p

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 31.6125
pair_coeff      * *

comm_modify	vel yes

neigh_modify	one 10000 page 100000

compute		effTemp all temp/eff

thermo		10
thermo_style	custom step etotal pe ke temp press
thermo_modify	temp effTemp

compute         1 all property/atom spin eradius
dump            1 all custom 1 ${sname}.spe.lammpstrj id type x y z c_1[1] c_1[2]

fix		1 all nve/eff

run 		0

"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/charmmfsw/coul/long 10 12 pair style and p p p boundary conditions with a timestep of 2 running for 100 steps at temperature 303.15.","# charmmfsw example generated by https://charmm-gui.org/
# from PDB structure 1HVN (https://www.rcsb.org/structure/1HVN)
#
# Dependencies: packages MOLECULE / KSPACE / RIGID
# To test with KOKKOS: lmp -k on g 1 -sf kk -pk kokkos neigh half -in in.charmmfsw

units           real
boundary        p p p

newton          off
pair_style      lj/charmmfsw/coul/long 10 12
pair_modify     mix arithmetic
kspace_style    pppm 1e-6

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmmfsw
special_bonds   charmm
improper_style  harmonic
timestep        2

fix             cmap all cmap charmmff.cmap
fix_modify      cmap energy yes
read_data       data.charmmfsw.gz fix cmap crossterm CMAP

neighbor        2 bin
neigh_modify    delay 2 every 1

fix             1 all shake 1e-6 100 100 m 1.008 a 142
fix             2        all      nvt temp 303.15 303.15 100.0

# for visualization with LAMMPS-GUI
group           water type 18 60
group           nowater subtract all water
group           ions type 63 64
group           other subtract all water ions

# dump            viz      other    image 10 myimage-*.ppm element type size 800 800 zoom 2.82954 shiny 0.5 fsaa yes bond none none view 20 10 box no 0.0 axes no 0.0 0.0 center s 0.521318 0.489856 0.489856
# dump_modify viz pad 9 boxcolor darkblue backcolor darkgray element H H H H H H H H H H H H H H H H H H C C C C C C C C C C C C C C C C C C C N N N N N N N N N N N N N N O O O O O O O O O P S Cl K  adiam 1 1.92 adiam 2 1.92 adiam 3 1.92 adiam 4 1.92 adiam 5 1.92 adiam 6 1.92 adiam 7 1.92 adiam 8 1.92 adiam 9 1.92 adiam 10 1.92 adiam 11 1.92 adiam 12 1.92 adiam 13 1.92 adiam 14 1.92 adiam 15 1.92 adiam 16 1.92 adiam 17 1.92 adiam 18 1.92 adiam 19 2.72 adiam 20 2.72 adiam 21 2.72 adiam 22 2.72 adiam 23 2.72 adiam 24 2.72 adiam 25 2.72 adiam 26 2.72 adiam 27 2.72 adiam 28 2.72 adiam 29 2.72 adiam 30 2.72 adiam 31 2.72 adiam 32 2.72 adiam 33 2.72 adiam 34 2.72 adiam 35 2.72 adiam 36 2.72 adiam 37 2.72 adiam 38 2.48 adiam 39 2.48 adiam 40 2.48 adiam 41 2.48 adiam 42 2.48 adiam 43 2.48 adiam 44 2.48 adiam 45 2.48 adiam 46 2.48 adiam 47 2.48 adiam 48 2.48 adiam 49 2.48 adiam 50 2.48 adiam 51 2.48 adiam 52 2.432 adiam 53 2.432 adiam 54 2.432 adiam 55 2.432 adiam 56 2.432 adiam 57 2.432 adiam 58 2.432 adiam 59 2.432 adiam 60 2.432 adiam 61 2.88 adiam 62 2.88 adiam 63 3.632 adiam 64 2.816  

thermo          10
thermo_style    custom step etotal evdwl ecoul elong edihed pe ke temp press

run             100

"
"Generate a LAMMPS input script for a general simulation of an rheo system using rheo ${cut} artificial/visc ${zeta} rho/damp ${Dr} pair style with pair coefficients * * and p p p boundary conditions with a timestep of ${dt_max} running for 10000 steps.","# ------ 2D Taylor Green vortex ------ #

dimension          2
units              lj
atom_style         rheo
boundary           p p p
comm_modify        vel yes
newton off

# ------ Create simulation box ------ #

variable           n equal 1.0
variable           cut equal 3.0

region             box block 0 40 0 40 -0.01 0.01
create_box         1 box
lattice            sq ${n}

create_atoms       1 region box

displace_atoms     all random 0.1 0.1 0 135414 units box

# ------ Model parameters ------ #

variable           rho0 equal 1.0
variable           mp equal ${rho0}/${n}
variable           cs equal 1.0
variable           eta equal 0.05
variable           zeta equal 1
variable           dt_max equal 0.1*${cut}/${cs}/3
variable           Dr equal 0.1*${cut}*${cs}

mass               * ${mp}
set                group all rheo/rho ${rho0}
set                group all rheo/status 0

variable           u0 equal 0.05
variable           uy atom  ${u0}*sin(2*PI*x/lx)*cos(2*PI*y/ly)
variable           ux atom -${u0}*sin(2*PI*y/ly)*cos(2*PI*x/ly)
variable           d0 atom ${rho0}-${u0}*${u0}*${rho0}*0.25*(cos(4*PI*x/lx)+cos(4*PI*y/ly))/${cs}/${cs}

velocity           all set v_ux v_uy 0.0 units box

timestep           ${dt_max}

pair_style         rheo ${cut} artificial/visc ${zeta} rho/damp ${Dr}
pair_coeff         * *

# ------ Fixes & computes ------ #

fix                1 all rheo ${cut} RK1 8 shift
fix                2 all rheo/viscosity * constant ${eta}
fix                3 all rheo/pressure * linear
fix                4 all enforce2d

compute            rho all rheo/property/atom rho

# ------ Output & Run ------ #

thermo             200
thermo_style       custom step time ke press

#dump               1 all custom 200 atomDump id type x y vx vy fx fy c_rho

run 10000"
"Generate a LAMMPS input script for a NVE simulation of an amoeba system using amoeba pair style with pair coefficients * * amoeba_water.prm amoeba_water_box.key and p p p boundary conditions running for 100 steps.","# replicate water box with AMOEBA or HIPPO

units           real
boundary        p p p

atom_style      amoeba
bond_style      class2
angle_style     amoeba
dihedral_style  none

# per-atom properties required by AMOEBA or HIPPO

fix             amtype all property/atom i_amtype ghost yes
fix             extra all property/atom i_amgroup d_redID d_pval ghost yes
fix             extra2 all property/atom i_polaxe d2_xyzaxis 3

# read data file

read_data       data.water_box.amoeba fix amtype NULL ""Tinker Types""

# force field

pair_style      amoeba
pair_coeff      * * amoeba_water.prm amoeba_water_box.key

special_bonds   lj/coul 0.5 0.5 0.5 one/five yes

# thermo output

compute         virial all pressure NULL virial

thermo_style    custom step temp epair ebond eangle edihed eimp &
                emol etotal press c_virial[*]

#dump            1 all custom 10 dump.water_box id type x y z fx fy fz
#dump_modify     1 sort id

# dynamics

fix             1 all nve

thermo          10
run             100
"
"Generate a LAMMPS input script for a NVT simulation of an angle system using lj/sdk 15.0 # compatible with ""lj/spica"" pair style with a timestep of 5.0 running for 1000 steps at temperature 303.0.","# Solvated 5-mer peptide

units		real
dimension	3
atom_style	angle

# enforce that in z-direction there is only one 
# processor (could be two) for optimal performance
processors * * 1

# read topology and force field
pair_style	lj/sdk 15.0 # compatible with ""lj/spica""
bond_style	harmonic
angle_style	harmonic
special_bonds	lj/coul 0.0 0.0 1.0

read_data	data.pegc12e8.gz

neighbor	3.0 bin
neigh_modify	delay 5

timestep	5.0
#dump            1 all xtc 200 pegc12e8-1.xtc
#dump_modify  1 unwrap yes
#dump            2 all dcd 200 pegc12e8-1.dcd unwrap
#dump_modify  2 unwrap yes

velocity all create 303.0 46659 mom yes rot yes dist gaussian

fix		1 all nvt temp 303.0 303.0 100.0

thermo_style	multi
thermo		200
run		1000
#write_restart	pegc12e8-1.restart

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using mgpt pair style with pair coefficients * * Ta6.8x.mgpt.parmin Ta6.8x.mgpt.potin  ${atomic_vol} running for 0 steps.","# script for mgpt t=0 eos in bulk bcc structure

units           electron
atom_style      atomic

# Atomic volume for MGPT potential in a.u.
variable        atomic_vol equal 121.6

# Derive lattice constant from volume
variable        lattice_constant equal (${atomic_vol}*2.0)^(1.0/3.0)

# Create bcc lattice with 5x5x5 unit cells (250 atoms)
lattice         bcc ${lattice_constant}
region          box block 0 5 0 5 0 5
create_box      1 box
create_atoms    1 box

# Define potential for use in simulation
pair_style      mgpt

# Set parameters for potential:
#                  parameter files  atomic volume
#pair_coeff      * * parmin potin    ${atomic_vol}
pair_coeff      * * Ta6.8x.mgpt.parmin Ta6.8x.mgpt.potin  ${atomic_vol}

# Create velocities at 0 K
velocity        all create 0.0 87287

# Set neighbor list parameters
neighbor        0.1 bin
neigh_modify    every 1 delay 0 check yes

# Set up microcanonical integrator
fix             1 all nve

# Dump coordinates to file every 50 timesteps
#dump            id all atom 50 dump.bcc0

# Output thermodynamical data every 10 timesteps
thermo          10

# Set output quantities and output format
thermo_style custom step vol temp pe etotal press

## Example: Output floating point number with 5 digits exponential notation.
#thermo_modify format float %15.5e

# Run 0 timesteps
run             0
 
# Convert energy to rydbergs and pressure to gpa

variable natoms equal ""count(all)""
variable voltot equal ""vol""
variable atvol equal ""v_voltot/v_natoms""
variable etot equal ""2.0*pe""
variable etotry equal ""v_etot/v_natoms""
variable ptot equal ""press""
variable ptotgpa equal ""v_ptot/1.0e+09""

print ""number of atoms = ${natoms}""
print ""atomic volume (a.u.) = ${atvol}""
print ""total energy (ry/atom) = ${etotry}""
print ""pressure (gpa) = ${ptotgpa}""
print ""${natoms}   ${atvol}   ${etot}   ${ptotgpa}""
print ""${atvol}   ${etotry}   ${ptotgpa}""
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using hybrid/overlay coul/streitz 12.0 ewald eam/alloy pair style with pair coefficients * * coul/streitz AlO.streitz Al O and p p p boundary conditions with a timestep of 0.0004 running for 100 steps.","# Streitz-Mintmire potential with alpha-alumina
# option to use with Ewald or Wolf sum
# EAM (AlO.eam.alloy) includes 1994 SM and 2004 Zhou versions
# Streitz Mintmire (coul/streitz) does not include 2004 Zhou modifications
# Contributing authors: Ray Shan, Chris Weinberger (Sandia)

units		metal
atom_style	charge
dimension       3
boundary        p p p

read_data    	data.streitz

group    	type1 type 1
compute   	charge1 type1 property/atom q
compute   	q1 type1 reduce ave c_charge1
group    	type2 type 2
compute   	charge2 type2 property/atom q
compute   	q2 type2 reduce ave c_charge2

variable   	qcat equal 2.8
variable  	qani equal -${qcat}*count(type1)/count(type2)
set   		group type1 charge ${qcat}
set   		group type2 charge ${qani}
variable   	qsum equal count(type1)*c_q1+count(type2)*c_q2

# Ewald sum for coul/streitz
pair_style  	hybrid/overlay coul/streitz 12.0 ewald eam/alloy
kspace_style  	ewald 1e-6

# Wolf sum for coul/streitz
#pair_style  	hybrid/overlay coul/streitz 12.0 wolf 0.31 eam/alloy

pair_coeff   	* * coul/streitz AlO.streitz Al O
pair_coeff   	* * eam/alloy AlO.eam.alloy Al O

neighbor	1.0 bin
neigh_modify	every 10 delay 0 check yes
timestep        0.0004

thermo_style	custom step temp etotal pe evdwl ecoul elong &
                c_q1 c_q2 v_qsum press spcpu
thermo_modify  	norm yes
thermo   	10

velocity  	all create 300.0 42128
fix     	1 all qeq/slater 1 12.0 1.0e-6 100 coul/streitz
fix     	2 all nve

run    		100
"
"Generate a LAMMPS input script for a NVE simulation of an bond system using lj/cut 2.5 pair style with pair coefficients 1 1 10.0 1.0 2.5 and f f p boundary conditions with a timestep of 0.001 running for 10000 steps.","# 2d circle of particles inside a box with LJ walls

variable        b index 0

variable        x index 50
variable        y index 20
variable        d index 20
variable        v index 5
variable        w index 2

units           lj
dimension       2
atom_style      bond
boundary        f f p

lattice         hex 0.85
region          box block 0 $x 0 $y -0.5 0.5
create_box      1 box bond/types 1 extra/bond/per/atom 6
region          circle sphere $(v_d/2+1) $(v_d/2/sqrt(3.0)+1) 0.0 $(v_d/2)
create_atoms    1 region circle
mass            1 1.0

velocity        all create 0.5 87287 loop geom
velocity        all set $v $w 0 sum yes

pair_style      lj/cut 2.5
pair_coeff      1 1 10.0 1.0 2.5

bond_style      harmonic
bond_coeff      1 10.0 1.2

# need to preserve 1-3, 1-4 pairwise interactions during hard collisions

special_bonds   lj/coul 0 1 1
create_bonds    many all all 1 1.0 1.5

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

fix             1 all nve

fix             2 all wall/lj93 xlo 0.0 1 1 2.5 xhi $x 1 1 2.5
fix             3 all wall/lj93 ylo 0.0 1 1 2.5 yhi $y 1 1 2.5

comm_style      tiled
comm_modify     cutoff 10.0   # because bonds stretch a long ways
fix             10 all balance 50 0.9 rcb

#compute         1 all property/atom proc
#variable        p atom (c_1%10)+1
#dump            2 all custom 50 tmp.dump id v_p x y z

#dump            3 all image 50 image.*.jpg v_p type bond atom 0.25 &
#                adiam 1.0 view 0 0 zoom 1.8 subbox yes 0.02
#variable        colors string &
#                ""red green blue yellow white &
#                purple pink orange lime gray""
#dump_modify     3 pad 5 amap 0 10 sa 1 10 ${colors}

thermo_style    custom step temp epair press f_10[3] f_10
thermo          100
timestep        0.001

run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay  rebo  ilp/graphene/hbn 16.0 pair style with pair coefficients * * rebo               CH.rebo   C  C  # chemical and p p p boundary conditions with a timestep of 0.001 running for 1000 steps.","# Initialization
units           metal
boundary        p p p
atom_style      full
processors      * * 1     # domain decomposition over x and y

# System and atom definition
# we use different molecule ids for each layer of hBN
# so that inter- and intra-layer
# interactions can be specified separately

read_data       Bi_gr_AB_stack_2L_noH.data
mass            1 12.0107   # carbon mass (g/mole) | membrane
mass            2 12.0107   # carbon mass (g/mole) | adsorbate
# Separate atom groups
group		layer1 molecule 1
group		layer2 molecule 2

######################## Potential defition ########################
pair_style  hybrid/overlay  rebo  ilp/graphene/hbn 16.0
####################################################################
pair_coeff  * * rebo               CH.rebo   C  C  # chemical
pair_coeff  * * ilp/graphene/hbn   BNCH.ILP  C  C  # long range
####################################################################
# Neighbor update settings
neighbor        2.0 bin
neigh_modify    every 1
neigh_modify    delay 0
neigh_modify    check yes

#### Simulation settings ####
timestep	0.001
velocity	all create 300.0 12345

compute   	0 all pair rebo
compute  	1 all pair ilp/graphene/hbn
variable  	REBO  equal c_0     # REBO energy
variable  	ILP   equal c_1     # total interlayer energy
variable  	Evdw  equal c_1[1]  # attractive energy
variable 	Erep  equal c_1[2]  # repulsive  energy

############################

# Output
thermo          100
thermo_style    custom step etotal pe ke v_REBO v_ILP v_Erep v_Evdw temp
thermo_modify   lost warn

###### Run molecular dynamics ######
fix       	thermostat all nve
run 	  	1000
"
"Generate a LAMMPS input script for a NPT simulation of an full system using lj/cut 5.0 pair style with a timestep of 1.0 running for 1000 steps.","# LJ particles
variable        T0 equal 300.0
variable        press equal 0.0

units           real
atom_style      full
pair_style      lj/cut 5.0

read_data       ""lj.data""

thermo          10
thermo_style    custom step temp pe etotal press vol

timestep        1.0

fix             fxnpt all npt temp ${T0} ${T0} 1000.0 iso ${press} ${press} 10000.0 
fix             fxgREM all grem 400 -.01 -30000 fxnpt
thermo_modify   press fxgREM_press
run             1000

#write_data      lj-out.data
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using smtbq pair style with pair coefficients * * ffield.smtbq.TiO2 O Ti and p p p boundary conditions with a timestep of ${dt} running for 10 steps.","# Al2O3 crystal, qeq on, minimizes, then calculates elastic constants

variable T_depart equal 300

variable dt equal 0.0002

variable a equal 4.5937
variable c equal 2.9587
variable ca equal ${c}/${a}

variable nx equal 6
variable ny equal 6
variable nz equal 11

variable bx equal ${a}*${nx}
variable by equal ${a}*${ny}
variable bz equal ${c}*${nz}
# =======================================================================

units		metal
atom_style	charge
dimension       3
boundary        p p p


lattice		sc 1.0
region          box_vide prism 0 ${bx} 0 ${by} 0 ${bz} 0.0 0.0 0.0
create_box      2 box_vide

#lattice         sc 1.0
#region          box_TiO2 block 0 ${bx} 0 ${by} 0 ${bz}

# titanium atoms
lattice 	custom ${a} origin 0.0 0.0 0.0 &
                            orient x 1 0 0 orient y 0 1 0 orient z 0 0 1 &
                            a1 1.0  0.0  0.0  &
                            a2 0.0  1.0  0.0  &
                            a3 0.0  0.0 ${ca} &
                            basis 0.0    0.0     0.0 &
 			    basis 0.5    0.5     0.5

create_atoms 	2 region box_vide

# Oxygen atoms
lattice         custom ${a} origin 0.0 0.0 0.0 &
                            orient x 1 0 0 orient y 0 1 0 orient z 0 0 1 &
                            a1 1.0  0.0  0.0  &
                            a2 0.0  1.0  0.0  &
                            a3 0.0  0.0 ${ca} &
                            basis 0.30478    0.30478     0.0 &
                            basis 0.69522    0.69522     0.0 &
			    basis 0.19522    0.80478     0.5 &
			    basis 0.80478    0.19522     0.5 

create_atoms	1 region box_vide
 

mass            1 16.00
group           Oxy type 1
compute         chargeOxy Oxy property/atom q
compute         q_Oxy Oxy reduce ave c_chargeOxy

mass		2 47.867
group    	Ti type 2
compute   	chargeTi Ti property/atom q
compute   	q_Ti Ti reduce ave c_chargeTi

velocity	all create ${T_depart} 277387

pair_style	smtbq
pair_coeff	* * ffield.smtbq.TiO2 O Ti

neighbor	0.5 bin
neigh_modify	every 20 delay 0 check yes

timestep        ${dt}

thermo_style    custom step temp press pe ke etotal c_q_Ti c_q_Oxy lx ly lz vol 
thermo_modify	flush yes
thermo		1


#dump            5 all custom 500 boxAlpha_alumina.lammpstrj id type q x y z  

fix		3 all nve
run		10

unfix		3
#thermo		15
fix             1 all box/relax tri 0.0 vmax 0.001
minimize        1.0e-3 1.0e-5 1000 10000

unfix		1
thermo		1
fix             3 all nve
run             10

"
"Generate a LAMMPS input script for a general simulation of an sphere system using granular pair style with pair coefficients * * hooke 1.0 0.5 tangential linear_history 1.0 0.5 0.1 damping mass_velocity with a timestep of 0.005 running for 2000 steps.","# Big colloid particles and small LJ particles

units           lj
atom_style      sphere
dimension       2

lattice         sq 0.5
region          box block 0 60 0 60 -0.5 0.5
create_box      2 box
create_atoms    1 box
change_box      all triclinic

# remove two spheres of small particles and add large particles in the voids
region sphere1 sphere 20.0 20.0 0.0 10.0 units box
region sphere2 sphere 60.0 60.0 0.0 10.0 units box
delete_atoms  region sphere1
delete_atoms  region sphere2
create_atoms 2 single 20.0 20.0 0.0 units box
create_atoms 2 single 60.0 60.0 0.0 units box

set             type 2 mass 400
set             type 1 mass 1
set     type 2 diameter 20
set     type 1 diameter 1

velocity        all create 1.44 87287 loop geom

# multi neighbor and comm for efficiency

neighbor        1 multi #multi/old
neigh_modify    delay 0 collection/interval 2 1 20
comm_modify     mode multi vel yes reduce/multi #multi/old

# granular potential

pair_style      granular
pair_coeff      * * hooke 1.0 0.5 tangential linear_history 1.0 0.5 0.1 damping mass_velocity

fix             1 all nph/sphere iso 0.0 1.0 10.0 drag 1.0
fix             2 all enforce2d
fix             3 all deform 1 xy erate 1e-3

#dump           1 all custom 1000 dump.granular id x y z radius

thermo_style    custom step temp epair etotal press vol
thermo          100

timestep        0.005

run             2000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using vashishta pair style with pair coefficients * *  SiO.1990.vashishta Si O and p p p boundary conditions with a timestep of 0.001 running for 100 steps.","# test Vashishta potential for quartz

units		metal
boundary	p p p

atom_style	atomic

read_data	data.quartz

replicate       4 4 4
velocity	all create 2000.0 277387 mom yes
displace_atoms	all move 0.05 0.9 0.4 units box

pair_style 	vashishta
pair_coeff	* *  SiO.1990.vashishta Si O

neighbor	0.3 bin
neigh_modify	delay 10

fix		1 all nve
thermo		10
timestep	0.001

#dump		1 all cfg 10 *.cfg mass type xs ys zs vx vy vz fx fy fz
#dump_modify	1 element Si O

run		100

"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using edip pair style with pair coefficients * * Si.edip Si and p p p boundary conditions with a timestep of 1.0e-3 running for 500 steps.","
units           metal

atom_style      atomic
atom_modify     map array
boundary        p p p
atom_modify	sort 0 0.0

# temperature

variable t equal 1800.0

# coordination number cutoff

variable r equal 2.835

# minimization parameters

variable etol equal 1.0e-5
variable ftol equal 1.0e-5
variable maxiter equal 100
variable maxeval equal 100
variable dmax equal 1.0e-1

# diamond unit cell

variable a equal 5.431
lattice         custom $a               &
                a1 1.0 0.0 0.0          &
                a2 0.0 1.0 0.0          &
                a3 0.0 0.0 1.0          &
                basis 0.0 0.0 0.0       &
                basis 0.0 0.5 0.5       &
                basis 0.5 0.0 0.5       &
                basis 0.5 0.5 0.0       &
                basis 0.25 0.25 0.25    &
                basis 0.25 0.75 0.75    &
                basis 0.75 0.25 0.75    &
                basis 0.75 0.75 0.25

region          myreg block     0 4 &
                                0 4 &
                                0 4
create_box      1 myreg
create_atoms    1 region myreg

mass            1       28.06

group Si type 1

velocity all create $t 5287287 mom yes rot yes dist gaussian

# make a vacancy

group del id 300
delete_atoms group del

pair_style      edip
pair_coeff * * Si.edip Si

thermo          10

fix             1 all nvt temp $t $t 0.1

timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes

# equilibrate

run             500

"
"Generate a LAMMPS input script for a NVT simulation of an full system using hybrid lj/class2/coul/long 9.5 lj/class2/coul/long/soft 2 0.5 0.5 9.5 pair style with pair coefficients 1    6  lj/class2/coul/long/soft   0.054 4.01 1.0 with a timestep of 1.0 running for 100000 steps at temperature 300.","# LAMMPS atomistic input script

echo            screen
units           real
atom_style      full

pair_style      hybrid lj/class2/coul/long 9.5 lj/class2/coul/long/soft 2 0.5 0.5 9.5
bond_style      class2
angle_style     class2
dihedral_style  class2
improper_style  class2
pair_modify     mix sixthpower tail yes
special_bonds   lj/coul 0 0 1

read_data       data.init_conf_with_heptane

pair_coeff    1    6  lj/class2/coul/long/soft   0.054 4.01 1.0
pair_coeff    2    6  lj/class2/coul/long/soft   0.054 4.01 1.0
pair_coeff    3    6  lj/class2/coul/long/soft   0.10615754 3.80912744 1.0
pair_coeff    4    6  lj/class2/coul/long/soft   0.02333374 3.66909137 1.0
pair_coeff    5    6  lj/class2/coul/long/soft   0.00108740 3.57275476 1.0

pair_coeff    1    7  lj/class2/coul/long/soft   0.054 4.01 1.0
pair_coeff    2    7  lj/class2/coul/long/soft   0.054 4.01 1.0
pair_coeff    3    7  lj/class2/coul/long/soft   0.10615754 3.80912744 1.0
pair_coeff    4    7  lj/class2/coul/long/soft   0.02333374 3.66909137 1.0
pair_coeff    5    7  lj/class2/coul/long/soft   0.00108740 3.57275476 1.0

pair_coeff    1    8  lj/class2/coul/long/soft   0.02333374 3.66909137 1.0
pair_coeff    2    8  lj/class2/coul/long/soft   0.02333374 3.66909137 1.0
pair_coeff    3    8  lj/class2/coul/long/soft   0.06151694 3.31892497 1.0
pair_coeff    4    8  lj/class2/coul/long/soft   0.02 2.995 1.0
pair_coeff    5    8  lj/class2/coul/long/soft   0.00158519 2.66932028 1.0

timestep        1.0
kspace_style    pppm 1.0e-5

variable lambda equal ramp(1.0,0.0)
variable q1 equal -0.1590*v_lambda
variable q2 equal -0.1060*v_lambda
variable q3 equal  0.0530*v_lambda

fix ADAPT all adapt/fep 10 &
  pair lj/class2/coul/long/soft lambda 1*5 6*8 v_lambda &
  atom charge 6 v_q1 &
  atom charge 7 v_q2 &
  atom charge 8 v_q3 &
  after yes

thermo_style custom step temp press vol etotal pe v_lambda v_q1 v_q2 v_q3
thermo_modify line one
thermo          100

fix             1 all nvt temp 300 300 100
run             100000

write_data      data.after_heptane_deletion
"
"Generate a LAMMPS input script for a general simulation of an atomic system using mgpt pair style with pair coefficients * * Ta6.8x.mgpt.parmin Ta6.8x.mgpt.potin  ${atomic_vol}.","# script for mgpt t=0 eos with relaxed vacancy in bcc structure:
# input for relaxed vacancy formation energy at constant pressure

units           electron
atom_style      atomic

# Atomic volume for MGPT potential
variable        atomic_vol equal 121.863

# Derive effective lattice volume from atomic volume for 249-site cell
variable        lat_vol equal ${atomic_vol}*249/250

# Derive lattice constant from lattice volume
variable        lattice_constant equal (${lat_vol}*2.0)^(1.0/3.0)

# Create bcc lattice with 5x5x5 unit cells (250 atoms)
lattice         bcc ${lattice_constant}
region          box block 0 5 0 5 0 5
create_box      1 box
create_atoms    1 box

# Remove central atom from bcc lattice to create vacancy
region vacancy sphere 2.5 2.5 2.5 0.1 units lattice
delete_atoms region vacancy

# Define potential for use in simulation
pair_style      mgpt

# Set parameters for potential:
#                  parameter files  atomic volume 
#pair_coeff      * * parmin potin    ${atomic_vol}
pair_coeff      * * Ta6.8x.mgpt.parmin Ta6.8x.mgpt.potin  ${atomic_vol}

# Set neighbor list parameters
neighbor        0.1 bin
neigh_modify    every 1 delay 0 check yes

# Dump coordinates to file every 50 timesteps
# dump            id all atom 50 dump.vacmin-bcc

# Output thermodynamical data every 10 timesteps
thermo          10

# Set output quantities and output format
thermo_style custom step vol temp pe etotal press

## Example: Output floating point number with 5 digits exponential notation.
#thermo_modify format float %15.5e

# minimize total energy
min_style cg
minimize 1.0e-10 1.0e-10 5000 10000

# Convert energy to rydbergs and pressure to gpa

variable natoms equal ""count(all)""
variable voltot equal ""vol""
variable atvol equal ""v_voltot/v_natoms""
variable etot equal ""2.0*pe""
variable etotry equal ""v_etot/v_natoms""
variable ptot equal ""press""
variable ptotgpa equal ""v_ptot/1.0e+09""

print ""number of atoms = ${natoms}""
print ""atomic volume (a.u.) = ${atvol}""
print ""total energy (ry/atom) = ${etotry}""
print ""pressure (gpa) = ${ptotgpa}""
print ""${natoms}   ${atvol}   ${etot}   ${ptotgpa}""
print ""${atvol}   ${etotry}   ${ptotgpa}""
"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay eam/alloy spin/exchange 3.5 pair style with pair coefficients * * eam/alloy Fe_Mishin2006.eam.alloy Fe and p p p boundary conditions with a timestep of 0.0001 running for 1000 steps.","# bcc iron in a 3d periodic box

clear 
units 		metal
atom_style 	spin

dimension 	3
boundary 	p p p

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice 	bcc 2.8665
region 		box block 0.0 5.0 0.0 5.0 0.0 5.0
create_box 	1 box
create_atoms 	1 box

# setting mass, mag. moments, and interactions for bcc iron

mass		1 55.845

set 		group all spin/random 31 2.2
# set 		group all spin 2.2 0.0 0.0 1.0
velocity 	all create 100 4928459 rot yes dist gaussian

pair_style 	hybrid/overlay eam/alloy spin/exchange 3.5
pair_coeff 	* * eam/alloy Fe_Mishin2006.eam.alloy Fe
pair_coeff 	* * spin/exchange exchange 3.4 0.02726 0.2171 1.841 offset yes

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin zeeman 0.0 0.0 0.0 1.0
fix_modify 	1 energy yes
fix 		2 all langevin/spin 0.0 0.0 21

fix 		3 all nve/spin lattice moving
timestep	0.0001

# compute and output options

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo_style    custom step time v_magnorm v_tmag temp v_emag ke pe press etotal
thermo          50

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
dump 		1 all custom 100 dump_iron.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3]

run 		1000
"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using lj/cut 1.12 pair style with pair coefficients 1 1 1.0 1.0 1.12 with a timestep of 0.001 running for 1000 steps.","# SRD viscosity demo - poydisperse spheres

units           lj
atom_style      sphere
atom_modify     first big
dimension       2

# create big particles with 3 different types and diameters

lattice         sq 0.3
region          box block 0 10 0 10 -0.5 0.5
create_box      4 box
create_atoms    1 region box

group           big type 1
set             group big type/fraction 2 0.33 394895
set             group big type/fraction 3 0.5 989894
group           big type 2 3

set             type 1*3 mass 1.0
velocity        big create 1.44 87287 loop geom

# equilibrate big particles, repulsive only to prevent aggregation

pair_style      lj/cut 1.12
pair_coeff      1 1 1.0 1.0 1.12
pair_coeff      2 2 1.0 2.0 2.24
pair_coeff      3 3 1.0 1.5 1.68
pair_coeff      4 4 0.0 1.0 0.0

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

fix             1 big nve
fix             2 all enforce2d

#dump           1 all atom 10 dump.poly.equil

run             1000

#undump         1
unfix           1
unfix           2

# add small particles as hi density lattice

region          plane block INF INF INF INF -0.001 0.001 units box
lattice         sq 250.0
create_atoms    4 region plane

set             type 4 mass 0.1
group           small type 4
velocity        small create 1.0 593849 loop geom

# delete overlaps
# must set *-4 cutoffs to non-zero values

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0
pair_coeff      2 2 1.0 2.0
pair_coeff      3 3 1.0 1.5
pair_coeff      1 4 0.0 1.0 0.5
pair_coeff      2 4 0.0 1.0 1.0
pair_coeff      3 4 0.0 1.0 0.75
pair_coeff      4 4 0.0 1.0 0.0

delete_atoms    overlap 1.0 small big

# SRD run

reset_timestep  0

neighbor        0.3 multi
neigh_modify    delay 0 every 1 check yes

comm_modify     mode multi group big vel yes
neigh_modify    include big

# no pairwise interactions with small particles

pair_style      lj/cut 1.12
pair_coeff      1 1 1.0 1.0 1.12
pair_coeff      2 2 1.0 2.0 2.24
pair_coeff      3 3 1.0 1.5 1.68
pair_coeff      4 4 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones
# if comment out, big particles won't see SRD particles

timestep        0.001

fix             1 big nve
fix             2 small srd 20 big 1.0 0.25 49894 shift yes 54979 &
                  search 0.2 inside ignore
fix             3 small viscosity 10 x y 50
fix             4 all enforce2d

# diagnostics

compute         tbig big temp/sphere
variable        pebig equal pe*atoms/count(big)
variable        ebig equal etotal*atoms/count(big)
thermo_style    custom step temp f_2[8] etotal v_pebig v_ebig press &
                f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] &
                f_2[6] f_2[7] f_2[8] f_2[9] f_2[10] f_2[11]

thermo_modify   temp tbig
thermo          1000

#dump           1 all atom 500 dump.poly.mp

#dump           1 all image 500 image.*.jpg type type zoom 1.6
#dump_modify    1 pad 6 adiam 1 1 adiam 2 2.0 adiam 3 1.5 adiam 4 0.1

run             10000
"
"Generate a LAMMPS input script for a NVE simulation using eam/alloy pair style with pair coefficients * * ../../../../potentials/Cu_mishin1.eam.alloy Cu running for 1000 # Equilibrate system at lambda = 0. steps.","# Rodrigo Freitas - rodrigof@berkeley.edu
#
# Description: nonequilibrium thermodynamic integration. Further details in:
# R. Freitas, M. Asta, and M. de Koning, Computational Materials Science, (2016)
# https://doi.org/10.1016/j.commatsci.2015.10.050


#--------------------------- System setup -------------------------------------#
  units             metal
  lattice           fcc 3.621
  region            sim_box block 0 4 0 4 0 4
  create_box        1 sim_box
  create_atoms      1 box

  pair_style        eam/alloy
  pair_coeff        * * ../../../../potentials/Cu_mishin1.eam.alloy Cu
#------------------------------------------------------------------------------#


#---------------------- Simulation setup --------------------------------------#
  # The order of the fix commands is important: thermostat AFTER thermodynamic integration force interpolation.
  fix               f1 all nve
  fix               f2 all ti/spring 3.728 2000 1000 function 2
  fix               f3 all langevin 100.0 100.0 0.1 666 zero yes

  # Compute temperature using center-of-mass coordinates.
  compute           c1 all temp/com
  fix_modify        f3 temp c1

  # Output variables.
  variable          step    equal step
  variable          dU      equal pe-f_f2 # Used on the integration.
  variable          lambda  equal f_f2[1] # For reference or integration.
  variable          dlambda equal f_f2[2] # For reference or integration.

  # Thermo output.
  thermo_style      custom step pe
  thermo            100
#------------------------------------------------------------------------------#


#------------------------- Running the simulation -----------------------------#
  # Setup initial velocities to accelerate equilibration.
  velocity          all create 200.0 9999 mom yes rot yes dist gaussian

  # Forward nonequilibrium thermodynamic integration.
  run               1000 # Equilibrate system at lambda = 0.
  fix               f4 all print 1 ""${step} ${dU} ${lambda} ${dlambda}"" & 
                    screen no file forward.dat title '# step dU lambda dlambda'
  run               2000 # Lambda switching: 0 -> 1.
  unfix             f4

  # Backward nonequilibrium thermodynamic integration.
  run               1000 # Equilibrate system at lambda = 1.
  fix               f4 all print 1 ""${step} ${dU} ${lambda} ${dlambda}"" & 
                    screen no file backward.dat title '# step dU lambda dlambda'
  run               2000 # Lambda switching: 1 -> 0.
  unfix             f4
#------------------------------------------------------------------------------#
"
"Generate a LAMMPS input script for a NPT simulation of an molecular system using lj/cut	2.5 pair style with pair coefficients * * 1.0	1.0 1.122 with a timestep of 0.005 running for 5000 steps at temperature 1.4.","# Tethered nanorods

atom_style	molecular

read_data	data.rigid.tnr

# Specify bond parameters

bond_style	fene
bond_coeff	1 30.0 1.5 1.0 1.0

special_bonds	fene

# Specify initial velocities

velocity	all create 1.4 109345

# Specify rigid components

group		rods type 2	
group		tethers	subtract all rods

neigh_modify 	exclude	molecule/intra rods delay 0 every 1

# Specify the pair potentials

pair_style	lj/cut	2.5
pair_modify	shift	yes
pair_coeff	* * 1.0	1.0 1.122
pair_coeff	2 2 1.0 1.0 2.5

# Specify output

thermo	100
thermo_style custom step temp pe etotal press enthalpy lx ly lz pxx pyy pzz
thermo_modify flush yes lost warn

timestep	0.005

fix	1	rods	rigid molecule
fix	2	tethers	nve
fix	3	all	langevin 1.4 1.4 1.0 437624

run	5000

# Replace fix rigid and fix langevin with new ones

unfix	1
unfix	3

fix	3	tethers langevin 1.4 1.4 1.0 198450

# Test different integrators for rods

fix	1 rods	rigid/nve molecule
print 	""rigid/nve""
run	1000
unfix	1

fix	1 rods	rigid/nvt molecule temp 1.4 1.4 1.0
print 	""rigid/nvt""
run	1000
unfix	1

compute	myTemp all temp

fix	1 rods	rigid/npt molecule temp 1.4 1.4 1.0 iso 0.05 0.05 1.0 &
        dilate all
print 	""rigid/npt iso""
fix_modify 1 temp myTemp

run	1000
unfix	1

fix	1 rods	rigid/npt molecule temp 1.4 1.4 1.0 x 0.05 0.05 1.0 dilate all
print 	""rigid/npt x""
run	1000
unfix	1

fix	1 rods	rigid/nph molecule iso 0.05 0.05 1.0 dilate all
print 	""rigid/nph iso""
run	1000
unfix	1

fix	1 rods	rigid/nph molecule x 0.05 0.05 1.0 y 0.05 0.05 1.0 &
        couple xy dilate all
print 	""rigid/nph xy couple""
run	1000

"
"Generate a LAMMPS input script for a general simulation and p p f boundary conditions running for 0 steps.","boundary p p f
kspace_style ewald/electrode 1.0e-8
kspace_modify slab 8.0 # ew3dc

include ""settings.mod"" # styles, computes, groups and fixes

thermo_style custom step pe c_qbot c_qtop
fix feta all property/atom d_eta ghost on
set group bot d_eta 0.5
set group top d_eta 3.0
fix conp bot electrode/conp 0 NULL couple top 1 symm on eta d_eta write_inv inv.csv write_vec vec.csv

run 0

"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style with pair coefficients 1 1 .238 3.405 13.5 and f f f boundary conditions with a timestep of 1.0 running for 400 steps.","echo both
units    real
atom_style  atomic

variable L equal 12
variable l2 equal 6
variable l equal 4
variable w equal 2

lattice         fcc 5.405 origin 0.25 0.25 0.25
region     mdRegion   cylinder z 0. 0. ${l2} -$w $w
region     mdInternal cylinder z 0. 0. $l -$w $w

boundary  f f f
pair_style  lj/cut 13.5
read_data circle_temp.init
fix ZWALLS all wall/reflect zlo EDGE zhi EDGE
mass    1 39.95
pair_coeff    1 1 .238 3.405 13.5
group    internal region mdInternal
group	 ghost subtract all internal

fix             AtC internal   atc two_temperature  Ar_ttm.mat
# computational geometry
fix_modify      AtC mesh read  gaussianIC2d_hex.mesh
#fix_modify      AtC mesh read  gaussianIC2d_hex.exo
#fix_modify      AtC mesh read  gaussianIC2d_hex2.exo
#fix_modify      AtC mesh read  gaussianIC2d_hex2.mesh
fix_modify      AtC mesh write  parsed_gaussianIC2d_hex.mesh
fix_modify      AtC mesh output gaussianIC2d_hexMESH
fix_modify	AtC boundary ghost
# numerical parameters
fix_modify	AtC time_integration fractional_step
fix_modify	AtC internal_quadrature off

# initial conditions
fix_modify	AtC fix temperature      all 20.0
# NOTE this is only gaussian in x
fix_modify	AtC fix electron_temperature all gaussian 0 0 0 1 0 0 5 20 20

# thermostat
fix_modify	AtC control thermal rescale 10
fix_modify      AtC extrinsic exchange off

# run to equilibrate
thermo_style custom step temp pe f_AtC[2] f_AtC[4]
timestep  1.0
thermo    10
run	  400

# boundary conditions
fix_modify	AtC unfix temperature all
fix_modify	AtC unfix electron_temperature all
fix_modify AtC fix temperature   11 20.0
fix_modify AtC fix temperature   12 20.0

# numerical parameters
fix_modify AtC extrinsic electron_integration explicit 10

# thermostat
fix_modify AtC control thermal flux
fix_modify AtC extrinsic exchange on

# output
fix_modify      AtC output    gaussianIC2d_hexFE 10 full_text binary
dump            D1  all atom 10 gaussianIC2d_hex.dmp

# relax the system
run       1000
"
"Generate a LAMMPS input script for a NVE simulation of an ellipsoid system using ylz  2.6 pair style with pair coefficients *  *   1.0  1.0  4  3  0.0  2.6 and p p p boundary conditions with a timestep of 0.01 running for 3000 steps.","# flat membrane demo
variable     r0 equal  0.97
variable     d1 equal  ${r0}
variable     d2 equal  sqrt(3.0)*${r0}
variable     d3 equal  3.0*${r0}
variable     ro equal  2./${d1}/${d2}/${d3}

variable     T  equal  0.23
variable     LD equal  1.0

units        lj
atom_style   ellipsoid

boundary     p p p

lattice      custom ${ro} a1 ${d1}  0.0 0.0 a2 0.0 ${d2}  0.0 &
             a3 0.0 0.0 ${d3}  basis 0.0 0.0 0.0 basis 0.5  0.5  0.0


region       box block   0 40  0 24  -20  20
create_box   1 box
region       membrane block  0 40  0 24 -0.5 0.5
create_atoms 1 region membrane

group        membrane  region membrane

set type 1 mass  1.0

set type 1 shape  1 0.99 0.99

set          group all quat 0 -1 0  90

#compute      memb  all temp/com
#compute      rot all temp/asphere bias memb
velocity     all create ${T} 87287 loop geom

pair_style   ylz  2.6
pair_coeff   *  *   1.0  1.0  4  3  0.0  2.6
neighbor     1.0 bin


thermo_style custom step temp press pxx pyy
thermo       200

timestep     0.01

#dump         1 all atom 10 dump_onlymembrane.lammpstrj

fix          1 all langevin ${T} ${T}  ${LD}  48279


fix          2 all nve/asphere
run          3000


"
"Generate a LAMMPS input script for a general simulation of an electron system using eff/cut 1.0 pair style with pair coefficients * * and p p p boundary conditions running for 0 steps.","variable	sname index h_atom.bohr

units 		electron
newton		on
boundary        p p p

atom_style	electron

read_data  	data.${sname}

pair_style      eff/cut 1.0 
pair_coeff 	* *

comm_modify	vel yes

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo          1
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp press effPress

run 		0
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style and f p p boundary conditions with a timestep of 5.0 running for 1000 steps.","# in this example the electron temperature on the left is ramped up in time 
# and held fixed on the right. the phonon temperature is free on the left 
# and fixed and consistent with the electron temperature on the right. 
# ATC restarting is used to eliminate the need to redo the equilibration phase.
# This benchmark tests restarting and the fractional step method with the TTM.
#echo both
# units
units		real
atom_style	atomic
variable restart equal 0 # NOTE add support for ifs when we update to new lammps
# create domain
#lattice	type reduced density rho* = 4*(sigma/a)^3, 
#   where N = 4 for fcc, 
#         s = 3.405 A (Wagner) 
#         a = 5.25 A (Ashcroft & Mermin, p. 70)
boundary        f p p
pair_style      lj/cut 13.5
#if ""${restart}""
#read_data       atom_restart.data # NOTE reading in text atom data results in minor differences due to truncation
#else
read_data	temp.init
#endif
lattice         fcc 5.405 origin 0.25 0.25 0.25
region feRegion   block -14 14 -3 3 -3 3
region mdRegion   block -12 12 -3 3 -3 3
region mdInternal block -10 10 -3 3 -3 3
# NOTE: don't define ghosts if they are outside the feRegion
group		internal region mdInternal
group		ghost subtract all internal
# create atoms
#boundary	f p p
#create_box	1 mdRegion
#create_atoms	1 region mdRegion
#mass		1 39.95
#pair_style	lj/cut 13.5
#pair_coeff  	1 1 .238 3.405 13.5
#velocity  internal create 40 87287 mom yes loop geom
# timestep & neighboring
timestep	5.0
thermo		10
neighbor	5. bin
neigh_modify	every 10 delay 0 check no
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal atc two_temperature  Ar_ttm.mat
fix_modify      AtC boundary ghost
#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 14 1  1  feRegion f p p
fix_modify      AtC time_integration fractional_step
fix_modify      AtC internal_quadrature off
# fix initial temperatures
fix_modify 	AtC initial temperature      all 20
fix_modify 	AtC fix temperature          all 20
fix_modify 	AtC initial electron_temperature all 20
fix_modify 	AtC fix electron_temperature     all 20
# equilibrate MD field with rescale
fix_modify AtC extrinsic exchange off
fix_modify	AtC  control thermal rescale 10
thermo		100
run 		1000

# change thermostat 
fix_modify 	AtC extrinsic exchange on
fix_modify	AtC unfix          temperature all
fix_modify	AtC unfix electron_temperature all
fix_modify  	AtC mesh create_faceset bndy box -10 10 -10 10 -10 10
fix_modify  	AtC control thermal flux faceset bndy 
# add nodesets & boundary temperature controls
#               ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
# NOTE create_nodeset doesn't handle ""inf""
fix_modify      AtC mesh create_nodeset lbc -14.1 -13.9  -INF INF -INF INF
fix_modify      AtC mesh create_nodeset rbc  13.9  14.1  -INF INF -INF INF
fix_modify      AtC  fix electron_temperature lbc 40.
fix_modify      AtC  fix electron_temperature rbc 20.
fix_modify      AtC  fix          temperature rbc 20. 
fix_modify      AtC  source electron_temperature all 9.50445e-11
# run transient
thermo          100
reset_timestep  0
run             2000
write_restart   atom_restart.bin
fix_modify      AtC write_restart atc_restart.bin

unfix		AtC
fix             AtC internal atc two_temperature  Ar_ttm.mat
fix_modify      AtC boundary ghost
#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 14 1  1  feRegion f p p
fix_modify      AtC time_integration fractional_step
fix_modify      AtC internal_quadrature off
# fix initial temperatures
fix_modify      AtC initial temperature      all 20
fix_modify      AtC initial electron_temperature all 20
# change thermostat
fix_modify      AtC mesh create_faceset bndy box -10 10 -10 10 -10 10
fix_modify      AtC control thermal flux faceset bndy
# add nodesets & boundary temperature controls
#               ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
# NOTE create_nodeset doesn't handle ""inf""
fix_modify      AtC mesh create_nodeset lbc -14.1 -13.9  -INF INF -INF INF
fix_modify      AtC mesh create_nodeset rbc  13.9  14.1  -INF INF -INF INF
fix_modify      AtC  fix electron_temperature lbc 40.
fix_modify      AtC  fix electron_temperature rbc 20.
fix_modify      AtC  fix          temperature rbc 20.
fix_modify      AtC  source electron_temperature all 9.50445e-11
# read in reference positions
fix_modify      AtC reset_atomic_reference_positions temp.init
fix_modify      AtC consistent_fe_initialization on
# output                   filename    frequency [text output]
fix_modify      AtC output restartFE 100       text
# ATC restart command
fix_modify     AtC read_restart atc_restart.bin

# run to steady state
thermo		100
reset_timestep  0
fix_modify	AtC reset_time
run 		2000
"
"Generate a LAMMPS input script for a general simulation and p p f # slab calculation boundary conditions running for 500 steps.","# electrodes with constant potential
# for graphene-ionic liquid supercapacitor

boundary p p f # slab calculation
include settings.mod # styles, groups, computes and fixes
kspace_modify slab 3.0 # amat twostep

fix conp bot electrode/conp -1.0 1.979 couple top 1.0 symm on #algo mat_inv

thermo 50
thermo_style custom step temp c_ctemp epair etotal c_qbot c_qtop
run 500
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/class2/coul/cut 8.5 pair style and p p p boundary conditions running for 8000 steps.","# use bond/react 'create atoms' feature to add 30 new styrene monomers to chain

units real

boundary p p p

atom_style full

pair_style lj/class2/coul/cut 8.5

angle_style class2

bond_style class2

dihedral_style class2

improper_style class2

special_bonds lj/coul 0 0 1
pair_modify tail yes mix sixthpower

variable T equal 530

read_data trimer.data &
  extra/bond/per/atom 5 &
  extra/angle/per/atom 15 &
  extra/dihedral/per/atom 15 &
  extra/improper/per/atom 25 &
  extra/special/per/atom 25

molecule mol1 grow_styrene_pre.molecule_template
molecule mol2 grow_styrene_post.molecule_template

fix myrxns all bond/react stabilization yes statted_grp .03 &
    react rxn1 all 1 0 3.0 mol1 mol2 grow_styrene.map &
        modify_create fit create_fit overlap 2.0 &
        stabilize_steps 200 max_rxn 30

fix 1 statted_grp_REACT nvt temp $T $T 100

fix 4 bond_react_MASTER_group temp/rescale 1 $T $T 1 1

thermo_style custom step temp press density f_myrxns[*]

thermo 100

run 8000

# write_data final.data nofix
"
"Generate a LAMMPS input script for a NVE simulation of an dpd    # atomic atom style can also be used system using dpd/fdt 300.0 8.6 245455 pair style with pair coefficients 1 1 0.075 0.022 8.60 and p p p boundary conditions with a timestep of 0.001 running for 1000 steps.","# INPUT FILE FOR DPD_Fluid

boundary        p p p

units           metal  # ev, ps
atom_style      dpd    # atomic atom style can also be used
read_data       data.dpd

comm_modify     mode single vel yes
mass            1 125.9

pair_style      dpd/fdt 300.0 8.6 245455
pair_coeff      1 1 0.075 0.022 8.60

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check no once no

timestep        0.001

fix             2 all nve

variable        totEnergy equal pe+ke

thermo          10
thermo_style    custom step temp press pe ke v_totEnergy
thermo_modify   format float %24.16f

run             1000
"
"Generate a LAMMPS input script for a general simulation of an tri system using lj/cut 1.5 pair style with pair coefficients 1 1 1.0 1.0 with a timestep of 0.001 running for 1000 steps.","# Aspherical shear demo - 3d triangle boxes, solvated by SRD particles

units           lj
atom_style      tri
atom_modify     first big map yes

read_data       data.tri.srd

# add small particles as hi density lattice

lattice         sc 0.4
region          box block INF INF INF INF INF INF
lattice         sc 20.0
create_atoms    2 region box

group           big type 1
group           small type 2
set             group small mass 0.01

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style      lj/cut 1.5
pair_coeff      1 1 1.0 1.0
pair_coeff      2 2 0.0 1.0 0.0
pair_coeff      1 2 0.0 1.0

delete_atoms    overlap 1.5 small big

# SRD run

reset_timestep  0

velocity        small create 1.44 87287 loop geom

neighbor        0.3 multi
neigh_modify    delay 0 every 1 check yes
neigh_modify    exclude molecule/intra big include big

comm_modify     mode multi group big vel yes
neigh_modify    include big

# no pairwise interactions with small particles

pair_style      tri/lj 3.5
pair_coeff      1 1 0.1 1.0
pair_coeff      2 2 0.0 1.0 0.0
pair_coeff      1 2 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones
# if comment out, big particles won't see SRD particles

timestep        0.001

fix             1 big rigid/small molecule #langevin 1.0 1.0 0.1 12398 
fix             2 small srd 20 big 1.0 1.0 49894 &
                search 0.2 cubic warn 0.0001 shift yes 49829 &
                overlap yes collision noslip inside ignore

fix             3 all deform 1 x scale 0.8 y scale 0.8 z scale 0.8

# diagnostics

compute         tsmall small temp/deform
compute         tbig big temp
variable        pebig equal pe*atoms/count(big)
variable        ebig equal etotal*atoms/count(big)

compute_modify  tbig extra/dof -4500

compute         1 big erotate/asphere
compute         2 all ke
compute         3 all pe
variable        toteng equal (c_1+c_2+c_3)/atoms

thermo          100
thermo_style    custom step f_1 c_tsmall temp press f_2[9] f_2[4] 
thermo_modify   temp tbig

compute         10 all property/atom corner1x corner1y corner1z &
                corner2x corner2y corner2z corner3x corner3y corner3z

#dump           1 all custom 500 dump1.atom.srd id type x y z ix iy iz
#dump           2 all custom 500 dump1.tri.srd id type &
#               c_10[1] c_10[2] c_10[3] c_10[4] c_10[5] c_10[6] &
#               c_10[7] c_10[8] c_10[9]

run             1000

#undump          1
#undump          2
unfix           3

change_box      all triclinic

fix             2 small srd 20 big 1.0 1.0 49894 &
                search 0.2 cubic warn 0.0001 shift yes 49829 &
                overlap yes collision noslip tstat yes inside ignore

#dump           1 all custom 500 dump2.atom.srd id type x y z ix iy iz
#dump           2 all custom 500 dump2.tri.srd id type &
#               c_10[1] c_10[2] c_10[3] c_10[4] c_10[5] c_10[6] &
#               c_10[7] c_10[8] c_10[9]

fix             3 all deform 1 xy erate 0.05 units box remap v

run             2000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style with pair coefficients 1 1 .238 3.405 13.5 and f f p boundary conditions with a timestep of 0.0 running for 2 steps.","echo both
units    real
atom_style  atomic

# correct mass density = 1.0120
# NOTE the mesh is not currently periodic, so the density estimate is off by a factor of 2

variable L equal 6
variable w equal 2

lattice         fcc 5.405 origin 0.25 0.25 0.25
region     BOX   block -$L $L -$L $L -$w $w

boundary  f f p
create_box  1 BOX
create_atoms  1 region BOX
mass    1 39.95
pair_style  lj/cut 13.5
pair_coeff    1 1 .238 3.405 13.5
group    internal region BOX

fix            AtC internal atc hardy 
fix_modify     AtC kernel quartic_cylinder 5.0
fix_modify     AtC mesh read gaussianIC2d_hex.mesh
fix_modify     AtC fields add mass_density
fix_modify     AtC output kernel2d_hexFE 1 full_text binary
#dump  CONFIG all custom 1 kernel2d_hexMD.dmp id type x y z

thermo_style custom step cpu temp 
timestep  0.0
thermo    1
run     2
"
"Generate a LAMMPS input script for a general simulation.","LammpS RestartT"
"Generate a LAMMPS input script for a general simulation using lj/cut 1.1 pair style with pair coefficients * * 1.0 1.0 running for 0 steps.","# orthogonal box for 2d sq2 lattice unit cell

dimension     2

lattice       sq2 1.1

region        mybox block 0 1 0 1 -0.5 0.5
create_box    1 mybox
create_atoms  1 box

mass          * 1.0

write_data    tmp.data.sq2.orthog

pair_style    lj/cut 1.1
pair_coeff    * * 1.0 1.0

neighbor      0.0 bin

thermo_style  custom step pe avecx avecy bvecx bvecy pxx pyy vol

dump          1 all custom 100 tmp.dump.sq2.orthog id type x y z

run           0
"
"Generate a LAMMPS input script for a general simulation of an atomic system using eam pair style with pair coefficients * * ../../../../potentials/Cu_u3.eam and f p p boundary conditions with a timestep of 0.0 running for 1 steps.","# This test compares Hardy and Cauchy-Born metrics of energy density and stress
# for an EAM system subjected to uniaxial strain deformation.
# NOTE currently the convergence is distinctly exponential, the LJ version is quadratic
echo both
units		metal	
atom_style	atomic
# create domain
#lattice         fcc 3.615 origin 0.25 0.25 0.25
lattice         fcc 3.615 origin 0.01 0.01 0.01
region		BOX block -8 8 -2 2 -2 2
boundary	f p p
create_box	1 BOX
# create atoms
region		MD block -7 7 -2 2 -2 2
create_atoms	1 region MD
mass		1 63.55
# specify interal/ghost atoms
region    FREE block -6 6 -2 2 -2 2
group   internal region FREE
# specify inter-atomic potential
pair_style      eam
pair_coeff      * * ../../../../potentials/Cu_u3.eam
# specify neighbor/re-neighboring parameters
neighbor	0.3 bin
neigh_modify	every 10 delay 0 check no
# setup thermal output
thermo		10
thermo_style custom step pe ke press lx ly lz
#           ID  group atc PhysicsType ParameterFile
fix         AtC internal   atc field Cu_CauchyBorn.mat
fix_modify  AtC mesh create 8 1 1 BOX f p p
#fix_modify  AtC kernel quartic_cylinder 10.0
fix_modify  AtC  fields none 
fix_modify  AtC  fields add displacement 
fix_modify  AtC  fields add internal_energy stress 
fix_modify  AtC  fields add cauchy_born_energy 
fix_modify  AtC  fields add cauchy_born_stress
fix_modify  AtC  gradients add displacement 
#fix_modify  AtC  fields add elastic_deformation_gradient
timestep 0.0
fix_modify	AtC  output cb_unistrain_eamFE 1 text tensor_components binary
log       cb_unistrain_eam.log
variable step  equal 0
thermo_style  custom step v_step pe ke press lx ly lz
run 	1
variable step equal ${step}+1
displace_atoms	all ramp x -0.1 0.1 x -100 100
run		1
variable step equal ${step}+1
displace_atoms	all ramp x -0.1 0.1 x -100 100
run		1
"
"Generate a LAMMPS input script for a general simulation of an hybrid molecular system using lj/cut 1.68369 pair style with pair coefficients 1 1 4.14195 1.5 1.68369 and p p f boundary conditions with a timestep of 0.0001 running for 10000 steps.","#===========================================================================#
# polymer test                                                              #
#                                                                           #
# Run consists of a lone 32-bead coarse-grained polymer                     #
# undergoing Brownian motion in thermal lattice-Boltzmann fluid.            #
#                                                                           #
# To run this example, LAMMPS needs to be compiled with a the following     #
# packages: MOLECULE, RIGID, LATBOTLZ                                       #
#                                                                           #
# If uncommented, sample output from this run can be found in the file:     # 
#   'dump.polymer.lammpstrj'                                                #
# and viewed using, e.g., the VMD software.                                 #
#                                                                           #
#===========================================================================#

units	   	nano
dimension	3
boundary	p p f
atom_style	hybrid molecular
special_bonds	fene
read_data	data.polymer

#----------------------------------------------------------------------------
# Need a neighbor bin size smaller than the lattice-Boltzmann grid spacing   
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid. 
# The communcation cutoff is set to 2.5 dx to ensure that all particles in the
#   processor ghost fluid region (of width 2dx) are known to local processor.
#---------------------------------------------------------------------------- 
neighbor 0.5 bin
neigh_modify delay 0 every 1 check yes
neigh_modify exclude type 2 2
neigh_modify exclude type 2 1
comm_modify cutoff 2.5        

#----------------------------------------------------------------------------
# Implement a hard-sphere interaction between the particles at the center of 
#   each monomer (use a truncated and shifted Lennard-Jones potential).
#----------------------------------------------------------------------------
bond_style	fene
bond_coeff	1 60.0 2.25 4.14195 1.5
pair_style	lj/cut 1.68369
pair_coeff	1 1 4.14195 1.5 1.68369
pair_coeff	1 2 4.14195 1.5 1.68369
pair_coeff	2 2 0 1.0

# The mass is set 4/3 PI r^3 fluid_density/31 , where r=0.617, 31 is number of
# nodes in a single monomer 
mass * 0.00000318
timestep 0.0001

#----------------------------------------------------------------------------
# ForceAtoms are the particles at the center of each monomer which  
#   do not interact with the fluid, but are used to implement the hard-sphere
#   interactions.       
# FluidAtoms are the particles representing the surface of the monomer
# which do interact with the fluid.                               
#----------------------------------------------------------------------------
group ForceAtoms type 1
group FluidAtoms type 2

#----------------------------------------------------------------------------
# Placement of a trap (similar to an 1D optical trap) for the polymer
# Note that the addforce fix needs to go before the lb/fluid and lb/viscous
# fix as these fixes rescale the forces to account for the added mass of the
# fluid that gets dragged around with the particle so need prior knowledge of
# all forces applied to the particles involved in these fixes before they are
# called.
#----------------------------------------------------------------------------
variable fx atom -(x-20.0)*20.0/31.0
fix trap all addforce v_fx 0.0 0.0  # call before fix lb/fluid and lb/viscous

#---------------------------------------------------------------------------
# Create a lattice-Boltzmann fluid covering the simulation domain.
# This fluid feels a force due to the particles specified through FluidAtoms 
#   (however, this fix does not explicity apply a force back on to these 
#    particles. This is accomplished through the use of the lb/viscous fix).
# We set fluid viscosity = 0.1 and fluid density = 0.00009982071 which 
#   means the kinematic viscosity is idential to that of water but the 
#   dynamic viscosity is a factor of 10 less than that of water which 
#   increases the diffusive dynamics by a corresponding factor of 10.
#   lattice spacing dx=1.0.
# Use a thermal lattice-Boltzmann fluid (temperature 300K, random number 
#   seed=15003).  This enables the particles to undergo Brownian motion in 
#   the fluid.
#----------------------------------------------------------------------------
fix 1 all lb/fluid 1 0.1 0.00009982071 dx 1.0 noise 300.0 15003

#----------------------------------------------------------------------------
# Apply the force from the fluid to the particles, and integrate their 
#   motion, constraining each monomerto move and rotate as a single rigid 
#   spherical object.  
# Since both the ForceAtoms (central atoms), and the FluidAtoms (spherical
#   shell) should move and rotate together, this fix is applied to all of 
#   the atoms in the system.  
#----------------------------------------------------------------------------
fix 2 all lb/viscous
fix 3 all rigid/small molecule

#----------------------------------------------------------------------------
# To ensure that numerical errors do not lead to a buildup of momentum in the
#   system, the momentum_lb fix is used every 100000 timesteps to zero out the
#   total (particle plus fluid) momentum in the system.
#----------------------------------------------------------------------------
fix   4 all lb/momentum 100000 linear 1 1 1


#dump  1 ForceAtoms custom 10 trapped_polymer.lammpstrj id x y z vx vy vz

#run		2000001
run 10000  "
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/charmm/coul/long 8.0 10.0 10.0 pair style with a timestep of 2.0 running for 300 steps at temperature 275.0.","# Solvated 5-mer peptide

units           real
atom_style      full

pair_style      lj/charmm/coul/long 8.0 10.0 10.0
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic
kspace_style    pppm 0.0001

read_data       data.peptide

neighbor        2.0 bin
neigh_modify    delay 5

timestep        2.0

thermo_style    multi
thermo          50

group tmd id 1:6

fix             1 all nvt temp 275.0 275.0 100.0 tchain 1
fix             0 tmd tmd 0.1 tmd.target  100 tmd.log
fix             2 all shake 0.0001 10 100 b 4 6 8 10 12 14 18 a 31

group           peptide type <= 12

#dump           1 peptide atom 10 dump.peptide

#dump           2 peptide image 25 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30 bond atom 0.5
#dump_modify    2 pad 3

#dump           3 peptide movie 25 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30 bond atom 0.5
#dump_modify    3 pad 3

#compute                bnd all property/local btype batom1 batom2
#dump           2 peptide local 300 dump.bond index c_bnd[1] c_bnd[2] c_bnd[3]

run             300

"
"Generate a LAMMPS input script for a general simulation of an electron system using eff/cut 1000.0 limit/eradius pressure/evirials pair style with pair coefficients * * and p p p boundary conditions with a timestep of 0.0001 running for 0 steps.","# Created 2010-11-28

# General parameters

variable	sname index CH4fc.ang

units		real
newton		on
boundary	p p p

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 1000.0 limit/eradius pressure/evirials
pair_coeff      * *

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

comm_modify	vel yes
timestep 0.0001

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo          10
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp press effPress

run	0


"
"Generate a LAMMPS input script for a NVE simulation of an charge system using smtbq pair style with pair coefficients * * ffield.smtbq.Al2O3 O Al and p p p boundary conditions with a timestep of ${dt} running for 10 steps.","# Al2O3 crystal, qeq on, minimizes, then calculates elastic constants

variable T_depart equal 300

variable dt equal 0.0002

# =======================================================================

units		metal
atom_style	charge
dimension       3
boundary        p p p

read_data	data.Alpha
# ^ Orthorombic box of corundum strcture 

mass            1 16.00
group           Oxy type 1
compute         chargeOxy Oxy property/atom q
compute         q_Oxy Oxy reduce ave c_chargeOxy

mass		2 26.98
group    	Al type 2
compute   	chargeAl Al property/atom q
compute   	q_Al Al reduce ave c_chargeAl

velocity	all create ${T_depart} 277387

pair_style	smtbq
pair_coeff	* * ffield.smtbq.Al2O3 O Al

neighbor	0.5 bin
neigh_modify	every 20 delay 0 check yes

timestep        ${dt}

thermo_style    custom step temp press pe ke etotal c_q_Al c_q_Oxy lx ly lz vol 
thermo_modify	flush yes
thermo		1

#dump            5 all custom 500 boxAlpha_alumina.lammpstrj id type q x y z  

fix		3 all nve
run		10

unfix		3
thermo		1
fix             1 all box/relax tri 0.0 vmax 0.001
minimize        1.0e-3 1.0e-5 1000 10000

unfix		1
thermo		1
fix             3 all nve
run             10

"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style and f p p boundary conditions with a timestep of 2 running for 2000 steps.","#AtC Thermal Coupling
# This benchmark tests heat conducting into and out of the MD region.  The
# temperature is initially 20 everywhere and the left boundary BC is fixed at
# 40.# The result should show heat diffusing through the FEM to the MD and back
# out # to the FEM on the right.  Insufficient time is captured to reach the
# linear # steady state, but heat crossing both boundaries should be observed.
log bar1d_fluids.log
units           real
atom_style      atomic
# create domain
#lattice        type reduced density rho* = 4*(sigma/a)^3, where N=4 for fcc, s = 3.405 A (Wagner) and a = 5.25 A (Ashcroft & Mermin, p. 70)
# NOTE following 3 lines added for restart
boundary        f p p
pair_style      lj/cut 13.5
read_data       temp.init
#read_restart   post_eq.dat
lattice         fcc 5.405 origin 0.25 0.25 0.25
# create atoms, NOTE commented out for restart
#region         mdRegion block -7 7 -3 3 -3 3
#boundary       f p p
#create_box     2 mdRegion
#create_atoms   1 region mdRegion
#mass           * 39.95
# specify interal/ghost atoms
#region         mdInternal block -6 6 -3 3 -3 3
#region         mdGhost block -6 6 -3 3 -3 3 side out
#create_atoms    1 region mdGhost
#lattice         fcc 6.5 origin 0.25 0.25 0.25
#create_atoms   2 region mdInternal
group           internal type 2
group           ghost type 1
# velocities have Vcm = 0, NOTE next four lines commented out for restart
#velocity       internal create 100. 87287 mom yes loop geom
#pair_style     lj/cut 13.5
##pair_coeff    1 1 0.010323166 3.405 13.5
#pair_coeff     * * .238 3.405 13.5
neighbor        5. bin
neigh_modify    every 10 delay 0 check no
#write_restart  tinit.dat
#               ID  group atc PhysicsType ParameterFile
lattice         fcc 5.405 origin 0.25 0.25 0.25
region          atcRegion block -6.25 6.25 -3 3 -3 3
fix             AtC internal   atc thermal     Ar_thermal.mat
#               ID  part keywords    nx ny nz region    periodicity
fix_modify      AtC mesh create 6 1  1   atcRegion f p p
fix_modify      AtC time_integration fractional_step
fix_modify      AtC atom_element_map eulerian 10 # NOTE this introduces a minor amount of time integration error tracking the atomic temperature
fix_modify      AtC  internal_quadrature off
#fix_modify     AtC  mass_matrix fe
# fix a temperature
fix_modify      AtC  fix temperature all 100.
# add nodesets
#               ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
fix_modify      AtC mesh create_nodeset lbc -6.3 -6.2   -INF  INF   -INF  INF
fix_modify      AtC mesh create_nodeset rbc  6.2  6.3   -INF  INF   -INF  INF
#fix_modify      AtC  fix temperature lbc 120.
#fix_modify      AtC  fix temperature rbc 100.
#used for restarting
#fix_modify     AtC  consistent_fe_initialization on
#fix_modify     AtC  initial temperature all 100.
# turn on thermostat
fix_modify      AtC control  thermal rescale 10
# equilibrate MD field
variable xdof equal 3*count(ghost)
compute_modify thermo_temp extra/dof ${xdof}
thermo_style custom step cpu etotal pe f_AtC[1] temp f_AtC[2]
thermo_modify  format 1 %6i format 2 %7.2g
#fix_modify      AtC  output bar1d_fluids_eqFE 200 text binary
#dump            D1 all atom 200 dump_eq.bar1d
timestep        2
thermo          200
run             2000
#write_restart  post_eq.dat
# change thermostat to hoover
reset_timestep 0
fix_modify      AtC  reset_time
fix_modify      AtC  unfix temperature all
variable deltaT equal 2.*2000.
fix_modify      AtC  fix temperature lbc temporal_ramp 100. 120. ${deltaT}
#fix_modify     AtC  fix temperature lbc 100.
fix_modify      AtC  fix temperature rbc 100.
fix_modify      AtC control thermal flux no_boundary
fix_modify      AtC control tolerance 1.e-14
fix_modify      AtC control localized_lambda on
fix_modify      AtC  filter type exponential
fix_modify      AtC  filter scale 1000.0
fix_modify      AtC  filter on
# output commands
fix_modify      AtC  output bar1d_fluidsFE 100 text
#undump          D1
#dump           D2 all atom 200 dump.bar1d
#dump           D2 all custom 200 dump.bar1d id type xs ys zs vx vy vz
# set-up non-equilibrium IC
thermo          100
run             2000
# run non-equilibrium condition
fix_modify      AtC  fix temperature lbc 120.
run             4000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using zero 5.7 pair style with pair coefficients * * and p p p boundary conditions running for 0 steps.","#info all out log
units  metal
atom_style  atomic
boundary    p p p
atom_modify    map hash
read_data  ace_compute_struct.data
mass  1 1.00
mass  2 14.00
mass  3 15.999

pair_style     zero 5.7
pair_coeff     * *


compute     ace all mliap descriptor ace H_N_O_ccs.yace model linear gradgradflag 1
fix         ace all ave/time 1 1 1 c_ace[*] file desc_out.dat  mode vector

thermo 1
thermo_style    custom &
        pe            pxy     c_ace[1][1] c_ace[1][2]
thermo_modify   norm no
run 0

uncompute   ace
unfix       ace
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using mliap model nn Si.nn.mliap.model descriptor so3 Si.nn.mliap.descriptor pair style with pair coefficients * * Si Si and p p p boundary conditions with a timestep of 0.5e-3 running for ${nsteps} steps.","# Run NPT MD simulation for Si at 500 K.
variable nsteps index 100 #0

# NOTE: These are not intended to represent real materials

units           metal

atom_style      atomic
atom_modify     map array
boundary        p p p
atom_modify     sort 0 0.0

#read_data Si.data
lattice         diamond 5.43
region          box block 0 2 0 2 0 2
create_box      1 box
create_atoms    1 box
mass            1 29.0

# temperature
variable t equal 500.


# Potential
#pair_style mliap model nn Si-snap/NN_weights.txt descriptor sna Si-snap/DescriptorParam.txt
pair_style mliap model nn Si.nn.mliap.model descriptor so3 Si.nn.mliap.descriptor
pair_coeff * * Si Si

# Set-up output

compute  eatom all pe/atom
compute  energy all reduce sum c_eatom

compute  satom all stress/atom NULL
compute  str all reduce sum c_satom[1] c_satom[2] c_satom[3]
variable press equal (c_str[1]+c_str[2]+c_str[3])/(3*vol)

thermo_style    custom step temp epair c_energy etotal press v_press
thermo          10
thermo_modify norm yes

# Set up NVE run

timestep 0.5e-3
neighbor 1.0 bin
neigh_modify once no every 1 delay 0 check yes

# Run MD

velocity all create $t 5287287 loop geom
fix 1 all npt temp ${t} ${t} 0.2 iso 0.0 0.0 2
run ${nsteps}
"
"Generate a LAMMPS input script for a general simulation of an sph system using hybrid/overlay sph/rhosum 1 sph/taitwater pair style with pair coefficients * * sph/taitwater 1000.0 ${c} 1.0 ${h} and s s p boundary conditions running for 6000 steps.","# SPH water over dam

atom_style         sph
dimension          2
newton             on
boundary           s s p
units              lj

read_data          data.sph

# upper limit of timestep based on CFL-like criterion
# roughly estimate number of timesteps needed for 7.5 seconds

variable           h equal 0.03
variable           c equal 10.0 # soundspeed for Tait's EOS
variable           dt equal 0.1*${h}/${c} 
variable           nrun equal 15.0/${dt} 

# assign group name ""bc"" to boundary particles (type 2)
# assign group name ""water"" to water particles (type 1)

group              bc    type 2 
group              water type 1 

# use hybrid pairstyle which does density summation 
# with cutoff ${h} every timestep (1)
# use target density of 1000, soundspeed ${c} for Tait's EOS

pair_style         hybrid/overlay sph/rhosum 1 sph/taitwater
pair_coeff         * * sph/taitwater 1000.0 ${c} 1.0 ${h} 
pair_coeff         1 1 sph/rhosum ${h}

# add gravity. This fix also computes potential energy of mass in gravity field

fix                gfix water gravity -9.81 vector 0 1 0 
fix                2d_fix all enforce2d

compute            rho_peratom all sph/rho/atom
compute            e_peratom all sph/e/atom
compute            esph all reduce sum c_e_peratom
compute            ke all ke
variable           etot equal c_esph+c_ke+f_gfix
compute            ke_peratom all ke/atom

# adjust nevery | min. allowed dt | max. allowed dt | 
# max. travel distance per dt 
# ${dt} ~= CFL criterion 0.1*h/c

# remove top atoms

region            cut block INF INF 2.5 INF INF INF
delete_atoms      region cut

# use a variable timestep

fix                dtfix all dt/reset 1 NULL ${dt} 0.0005 units box 

# time-integrate position, velocities, 
# internal energy and density of water particles

fix                integrate_water_fix water sph

# time-integrate only internal energy and density of boundary particles

fix                integrate_bc_fix bc sph/stationary

thermo             500
thermo_style       custom step ke c_esph v_etot f_gfix press time f_dtfix
thermo_modify      norm no

# load balancing

comm_style      tiled
fix             100 all balance 100 0.9 rcb

# fix ave/grid

fix             ave all ave/grid 50 5 250 10 10 1 vx vy

# dump particles

#dump               dump_id all custom 100 tmp.dump &
#                   id type x y z c_ke_peratom
#dump_modify        dump_id first yes

# dump grid

#compute         ave all property/grid 10 10 1 id ix iy
#dump            ave all grid 250 tmp.grid c_ave:grid:data[*] f_ave:grid:data[*]
#dump_modify     ave sort 1

# dump image

#compute         1 all property/atom proc
#variable        p atom c_1%10

#dump            3 all image 500 tmp.*.png c_ke_peratom type &
#                adiam 0.015 view 0 0 zoom 2.5 subbox yes 0.01 &
#                center d 0.5 0.5 0.5 size 1024 768 box no 0.0 &
#                grid f_ave:grid:count
#variable        colors string &
#                ""min blue 0.25 green 0.5 orange 0.75 yellow max red""
#dump_modify     3 pad 5 amap 0 1.5 cf 1 5 ${colors}

# run

neigh_modify       every 5 delay 0 check no
variable           skin equal 0.3*${h}
neighbor           ${skin} bin

run                6000

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with a timestep of 0.0001 running for 10000 steps.","# Simple rigid body system

units		lj
atom_style	atomic

pair_style	lj/cut 2.5

read_data	data.rigid

velocity 	all create 100.0 4928459

# unconnected bodies

group		clump1 id <> 1 9
group		clump2 id <> 10 18
group		clump3 id <> 19 27
group		clump4 id <> 28 36
group		clump5 id <> 37 45
group		clump6 id <> 46 54
group		clump7 id <> 55 63
group		clump8 id <> 64 72
group		clump9 id <> 73 81

fix 1 all rigid/nve group 9 clump1 clump2 clump3 clump4 clump5 &
	  	      clump6 clump7 clump8 clump9

fix_modify 1 bodyforces early

# 1 chain of connected bodies

#group		clump1 id <> 1 9
#group		clump2 id <> 9 18
#group		clump3 id <> 18 27
#group		clump4 id <> 27 36
#group		clump5 id <> 36 45
#group		clump6 id <> 45 54
#group		clump7 id <> 54 63
#group		clump8 id <> 63 72
#group		clump9 id <> 72 81

#fix 1 all poems group clump1 clump2 clump3 clump4 clump5 &
#	  	      clump6 clump7 clump8 clump9

# 2 chains of connected bodies

#group		clump1 id <> 1 9
#group		clump2 id <> 9 18
#group		clump3 id <> 18 27
#group		clump4 id <> 27 36
#group		clump5 id <> 37 45
#group		clump6 id <> 45 54
#group		clump7 id <> 54 63
#group		clump8 id <> 63 72
#group		clump9 id <> 72 81

#fix 1 all poems group clump1 clump2 clump3 clump4
#fix 2 all poems group clump5 clump6 clump7 clump8 clump9

neigh_modify	exclude group clump1 clump1
neigh_modify	exclude group clump2 clump2
neigh_modify	exclude group clump3 clump3
neigh_modify	exclude group clump4 clump4
neigh_modify	exclude group clump5 clump5
neigh_modify	exclude group clump6 clump6
neigh_modify	exclude group clump7 clump7
neigh_modify	exclude group clump8 clump8
neigh_modify	exclude group clump9 clump9

thermo		100

#dump		1 all atom 50 dump.rigid

#dump		2 all image 100 image.*.jpg type type &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	2 pad 5

#dump		3 all movie 100 movie.mpg type type &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	3 pad 5

timestep 	0.0001
thermo		50
run		10000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/long 12 pair style with a timestep of 0.01 running for 20 steps.","# mixture example

units           real
atom_style      full

pair_style      lj/cut/coul/long 12
pair_modify     mix arithmetic

bond_style      harmonic
angle_style     harmonic
dihedral_style  none
improper_style  none

kspace_style    pppm 1e-5

read_data       data.mixture

neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes

# MM dynamics

timestep        0.01

fix		1 all nve

thermo_style    custom step cpu temp ke evdwl ecoul epair emol elong &
                pe etotal press

thermo          10
run		20
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/long/soft 2 0.5 10.0  1.122462 20 pair style with pair coefficients * *  1.0 1.0 1.122462 # charges with a timestep of 0.005 running for 2000 steps at temperature 1.0.","# Charge regulation lammps for a polymer chain
units           lj
atom_style      full
neighbor        3.0 bin
read_data       data.chreg-polymer

bond_style      harmonic
bond_coeff      1 100 1.122462 # K R0
velocity        all create 1.0 8008 loop geom

pair_style      lj/cut/coul/long/soft 2 0.5 10.0  1.122462 20
pair_coeff      * *  1.0 1.0 1.122462 # charges
kspace_style    pppm 1.0e-3
pair_modify     shift yes
dielectric      1.0

#########  VERLET INTEGRATION WITH LANGEVIN THERMOSTAT  ###########
fix             fnve all nve
compute         dtemp all temp
compute_modify  dtemp dynamic/dof yes
fix             fT all langevin 1.0 1.0 1.0 123
fix_modify      fT temp dtemp

fix chareg1 all charge/regulation 2 3 acid_type 1 pH 7.0 pKa 6.5 pIp 3.0 pIm 3.0 temp 1.0 nmc 40 seed 2345
fix chareg2 all charge/regulation 4 5 acid_type 1 pH 7.0 pKa 6.5 pIp 7.0 pIm 7.0 temp 1.0 nmc 40 seed 2345
fix chareg3 all charge/regulation 4 3 pIp 7.0 pIm 3.0 temp 1.0 nmc 20 seed 2345

thermo          100
#               print: step, potential energy, temperature, neutral acids, charged acids, salt cations, salt anions, H+ ions, OH- ions
thermo_style    custom step pe c_dtemp f_chareg1[3] f_chareg1[4] f_chareg1[7] f_chareg1[8] f_chareg2[7] f_chareg2[8]

timestep        0.005
run             2000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using python 2.5 pair style with pair coefficients * * py_pot.LJCutMelt lj running for 250 steps.","# 3d Lennard-Jones melt

units           lj
atom_style      atomic

lattice         fcc 0.8442
region          box block 0 10 0 10 0 10
create_box      1 box
create_atoms    1 box
mass            * 1.0

velocity        all create 3.0 87287

pair_style      python 2.5
pair_coeff      * * py_pot.LJCutMelt lj

# generate tabulated potential from python variant
pair_write      1 1 2000 rsq 0.01 2.5 lj_1_1.table LJ

pair_style      table linear 2000
pair_coeff      1 1 lj_1_1.table LJ

neighbor        0.3 bin
neigh_modify    every 20 delay 0 check no

fix             1 all nve

thermo          50
run             250

shell rm lj_1_1.table

"
"Generate a LAMMPS input script for a NVT simulation of an full system using hybrid/overlay coul/long 12.0 python 12.0 pair style with pair coefficients * * coul/long running for 100 steps at temperature 300.0.","units           real
atom_style      full

read_data       data.spce

pair_style      hybrid/overlay coul/long 12.0 python 12.0
kspace_style    pppm 1.0e-6

pair_coeff      * * coul/long
pair_coeff      * * python py_pot.LJCutSPCE OW NULL

bond_style      harmonic
angle_style     harmonic
dihedral_style  none
improper_style  none

bond_coeff      1 1000.00 1.000
angle_coeff     1 100.0 109.47

special_bonds   lj/coul 0.0 0.0 1.0

neighbor        2.0 bin

fix             1 all shake 0.0001 20 0 b 1 a 1
fix             2 all nvt temp 300.0 300.0 100.0

thermo 10
run 100
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using lj/cut/coul/long ${cut_lj} ${cut_long} pair style with pair coefficients * *  1.0 1.0 with a timestep of 0.005 running for 2000 steps.","# Charge regulation lammps for simple weak electrolyte

units           lj
atom_style      charge
neighbor        3.0 bin
read_data       data.chreg-acid

variable        cut_long equal 12.5
variable        nevery equal 100
variable        nmc equal 100
variable        pH equal 7.0
variable        pKa equal 6.0
variable        pIm equal 3.0
variable        pIp equal 3.0

variable        cut_lj equal 2^(1.0/6.0)
variable        lunit_nm equal 0.72 # in the units of nm
velocity        all create 1.0 8008 loop geom

pair_style      lj/cut/coul/long ${cut_lj} ${cut_long}
pair_coeff      * *  1.0 1.0
kspace_style    ewald 1.0e-3
pair_modify     shift yes

#########  VERLET INTEGRATION WITH LANGEVIN THERMOSTAT  ###########
fix             fnve all nve
compute         dtemp all temp
compute_modify  dtemp dynamic/dof yes
fix             fT all langevin 1.0 1.0 1.0 123
fix_modify      fT temp dtemp

fix chareg      all charge/regulation 2 3 acid_type 1 pH ${pH} pKa ${pKa} pIp ${pIp} pIm ${pIm} lunit_nm ${lunit_nm} nevery ${nevery} nmc ${nmc} seed 2345 tempfixid fT
thermo          100
thermo_style custom step pe c_dtemp f_chareg[1] f_chareg[2] f_chareg[3] f_chareg[4] f_chareg[5] f_chareg[6] f_chareg[7] f_chareg[8]
timestep        0.005
run             2000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5.","# MDI engine script to process a series of evaulate, run, minimize commands

units           lj
atom_style      atomic

lattice         fcc 0.8442
region          box block 0 1 0 1 0 1
create_box      1 box
mass            1 1.0

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

fix             1 all nve

thermo          10

mdi             engine

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 2.5 running for 500 steps.","# 3d Lennard-Jones melt

units           lj
atom_style      atomic
processors      * 1 1

lattice         fcc 0.8442
region          box block 0 10 0 10 0 10
create_box      3 box
create_atoms    1 box
mass            * 1.0

region          long block 3 6 0 10 0 10
set             region long type 2

velocity        all create 1.0 87287

pair_style      lj/cut 2.5
pair_coeff      * * 1.0 1.0 2.5
pair_coeff      * 2 1.0 1.0 5.0

neighbor        0.3 bin
neigh_modify    every 2 delay 4 check yes
fix             p all property/atom d_WEIGHT
compute         p all property/atom d_WEIGHT
fix             0 all balance 50 1.0 shift x 10 1.0 &
                weight time 1.0 weight store WEIGHT
variable        maximb equal f_0[1]
variable        iter   equal f_0[2]
variable        prev   equal f_0[3]
variable        final  equal f_0

#fix            3 all print 50 ""${iter} ${prev} ${final} ${maximb}""

fix             1 all nve

#dump           id all atom 50 dump.melt
#dump           id all custom 50 dump.lammpstrj id type x y z c_p

#dump           2 all image 25 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 25 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

thermo          50
run             500
run             500
fix             0 all balance 50 1.0 shift x 5 1.0 &
                weight neigh 0.5 weight time 0.66 weight store WEIGHT
run             500
run             500
"
"Generate a LAMMPS input script for a general simulation using zero ${rcutfac} pair style with pair coefficients * * and p p p boundary conditions running for ${nsteps} steps.","# Demonstrate bispectrum computes

# initialize simulation

variable 	nsteps index 0
variable 	nrep equal 1
variable 	a equal 2.0
units		metal

# generate the box and atom positions using a BCC lattice

variable 	nx equal ${nrep}
variable 	ny equal ${nrep}
variable 	nz equal ${nrep}

boundary	p p p

atom_modify	map hash
lattice         bcc $a
region		box block 0 ${nx} 0 ${ny} 0 ${nz}
create_box	2 box
create_atoms	2 box

mass 		* 180.88

displace_atoms 	all random 0.1 0.1 0.1 123456

# choose SNA parameters

variable 	twojmax equal 2
variable 	rcutfac equal 1.0
variable 	rfac0 equal 0.99363
variable 	rmin0 equal 0
variable 	radelem1 equal 2.3
variable 	radelem2 equal 2.0
variable	wj1 equal 1.0
variable	wj2 equal 0.96
variable	quadratic equal 1
variable	bzero equal 0
variable	switch equal 0
variable 	snap_options string &
""${rcutfac} ${rfac0} ${twojmax} ${radelem1} ${radelem2} ${wj1} ${wj2} rmin0 ${rmin0} quadraticflag ${quadratic} bzeroflag ${bzero} switchflag ${switch}""

# set up dummy potential to satisfy cutoff

pair_style 	zero ${rcutfac}
pair_coeff 	* *

# set up reference potential

variable 	zblcutinner equal 4
variable 	zblcutouter equal 4.8
variable 	zblz equal 73
pair_style 	zbl ${zblcutinner} ${zblcutouter}
pair_coeff 	* * ${zblz} ${zblz}

# set up per-atom computes

compute 	b all sna/atom ${snap_options}
compute 	vb all snav/atom ${snap_options}
compute 	db all snad/atom ${snap_options}

# perform sums over atoms

group 		snapgroup1 type 1
group 		snapgroup2 type 2
compute         bsum1 snapgroup1 reduce sum c_b[*]
compute         bsum2 snapgroup2 reduce sum c_b[*]
# fix 		bsum1 all ave/time 1 1 1 c_bsum1 file bsum1.dat mode vector
# fix 		bsum2 all ave/time 1 1 1 c_bsum2 file bsum2.dat mode vector
compute		vbsum all reduce sum c_vb[*]
# fix 		vbsum all ave/time 1 1 1 c_vbsum file vbsum.dat mode vector
variable	db_2_100 equal C_db[2][100]

# set up compute snap generating global array

compute 	snap all snap ${snap_options}
fix 		snap all ave/time 1 1 1 c_snap[*] file compute.snap.dat mode vector

thermo 		100

# test output:   1: total potential energy
#                2: xy component of stress tensor
#                3: Sum(0.5*(B_{222}^i)^2, all i of type 2) 
#                4: xz component of Sum(Sum(r_j*(0.5*(dB_{222}^i)^2/dR[j]), all i of type 2), all j) 
#                5: y component of -Sum(d(0.5*(B_{222}^i)^2/dR[2]), all i of type 2)
#
#                followed by 5 counterparts from compute snap

thermo_style	custom &
		pe            pxy            c_bsum2[20]   c_vbsum[220]   v_db_2_100 & 
		c_snap[1][41] c_snap[13][41] c_snap[1][40] c_snap[12][40] c_snap[6][40]
thermo_modify 	norm no

# dump 		mydump_db all custom 1000 dump_db id c_db[*]
# dump_modify 	mydump_db sort id

# Run MD

run             ${nsteps}
"
"Generate a LAMMPS input script for a general simulation of an atomic system and f f f boundary conditions with a timestep of 0.0 running for 1 steps.","# needs description
# note the units
units metal
variable nx equal 40 
variable h  equal 0.25
variable L  equal $h*${nx}
variable T  equal 300
variable n0 equal 0.000025
variable V equal 5.
variable E equal -0.0001
variable s equal  0.0001
atom_style      atomic
timestep  0.0
boundary      f f f
lattice       fcc 1.0
region        BOX block 0 $L 0 1 0 1
create_box  1 BOX
mass          * 1.0
atom_modify     sort 0 1
fix             AtC all   atc drift_diffusion Si_ddm.mat
fix_modify      AtC mesh create ${nx} 1 1  BOX f p p
# boundary conditions
fix_modify AtC mesh create_nodeset lbc -0.1 0.1 -INF INF -INF INF
fix_modify AtC mesh create_faceset rbc -INF $L -INF INF -INF INF
fix_modify AtC internal_quadrature off
fix_modify AtC control thermal none
fix_modify AtC extrinsic electron_integration explicit 1
# fix temperature
fix_modify AtC fix temperature          all $T
fix_modify AtC fix electron_temperature all $T
# fix electron density
fix_modify AtC fix electron_density all ${n0}
# bcs for electric potential
fix_modify AtC initial electric_potential all 0
fix_modify AtC fix electric_potential  lbc $V
fix_modify AtC fix_flux electric_potential  rbc $E
fix_modify AtC source electric_potential all $s
thermo  1
thermo_style custom step cpu 
fix_modify AtC  output   poisson1d_noatomsFE 1 text
run     1
"
"Generate a LAMMPS input script for a NVE simulation of an dpd system using dpd/fdt/energy 8.6 245455 pair style with pair coefficients 1 1 0.075 0.022 3.2E-05 8.60 and p p p boundary conditions with a timestep of 0.001 running for 1000 steps.","# INPUT FILE FOR DPD_Fluid

boundary        p p p

units           metal  # ev, ps
atom_style      dpd
read_data       data.dpd

comm_modify     mode single vel yes
mass            1 125.9

pair_style      dpd/fdt/energy 8.6 245455
pair_coeff      1 1 0.075 0.022 3.2E-05 8.60

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check no once no

timestep        0.001

fix             1 all dpd/energy
fix             2 all nve
fix             3 all eos/cv 0.00517041

compute         dpdU all dpd

variable        totEnergy equal pe+ke+c_dpdU[1]+c_dpdU[2]

thermo          10
thermo_style    custom step temp press pe ke c_dpdU[1] c_dpdU[2] v_totEnergy c_dpdU[4]
thermo_modify   format float %24.16f

run             1000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5.","# 3d Lennard-Jones melt - MDI engine script

units           lj
atom_style      atomic

lattice         fcc 1.0
region          box block 0 1 0 1 0 1
create_box      1 box
mass            1 1.0

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

mdi             engine
"
"Generate a LAMMPS input script for a NVE simulation of an molecular system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.5 running for 5000 steps.","# test of replicating system with periodic bonds in xy diagonal direction

dimension       2
atom_style      molecular

read_data       data.bond.xy

#replicate       3 3 1
replicate       3 3 1 bond/periodic

mass            1 1.0
velocity        all create 0.02 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.5

bond_style      harmonic
bond_coeff      1 50.0 1.414

special_bonds   fene

fix             1 all nve

write_data      tmp.data.xy

dump		1 all image 100 tmp.image.xy.*.ppm type type &
                adiam 0.2 bond type 0.1 zoom 1.6
dump_modify	1 pad 5

#dump		2 all movie 100 tmp.movie.xy.mpg type type &
#                adiam 0.2 bond type 0.1 zoom 1.6
#dump_modify	2 pad 5

run             5000
"
"Generate a LAMMPS input script for a general simulation of an full system using lj/cut 13. pair style with pair coefficients * * 0.2381 3.405 and f p p boundary conditions with a timestep of 0.0 running for 1 steps.","# test poisson solver
# * seems to have error in fix_flux
echo both
units 		metal
variable E equal 20.0
variable nx equal 32
# allow charges
atom_style full
dielectric      1.
dimension	3
boundary	f p p
lattice 	fcc   4.08 origin 0.25 0.25 0.25
region BOX block 0 16 0 3 0 3
create_box   1 BOX
create_atoms 1 region BOX
pair_style      lj/cut 13. 
pair_coeff * * 0.2381 3.405
mass 		* 39.948
group  real region BOX
set group   real charge 1
###########################################################################
#fix EFIELD all efield $E 0.0 0.0
###########################################################################
fix         ATC real atc species_electrostatic Ar_species.mat
fix_modify  ATC add_species ion type 1  ### <<<<<
#fix_modify  ATC add_species REAL group real
fix_modify  ATC include atomic_charge
fix_modify  ATC internal_quadrature off
fix_modify  ATC extrinsic short_range off
fix_modify  ATC mesh create ${nx} 1 1 BOX f p p
fix_modify  ATC atom_element_map eulerian 1
fix_modify  ATC atom_weight multiscale
fix_modify  ATC initial mass_density all 0.
#fix_modify  ATC initial charge_density all 0.
###########################################################################
variable n equal count(real)
print ""number of atoms: $n""
timestep 	0.0
thermo		1
compute   Fx real reduce sum fx
compute   Fy real reduce sum fy
thermo_style 	custom step etotal temp press pe c_Fx c_Fy
fix_modify  ATC output poissonFE 1 text binary
# (1) all fixed
fix_modify  ATC fix electric_potential all linear 0 0 0 $E 0 0 0 0 
run 1
# (2) Dirichlet
# NOTE with correct density solution is very close
#fix_modify  ATC  fix charge_density all 0.0588951459091903
fix_modify  ATC unfix electric_potential all 
fix_modify  ATC mesh create_nodeset lbc 0.0 0.0    -INF INF -INF INF
fix_modify  ATC mesh create_faceset lbc 0.0 INF    -INF INF -INF INF
fix_modify  ATC mesh create_faceset rbc -INF 16.0  -INF INF -INF INF
fix_modify  ATC fix electric_potential      lbc 100.0
run 1
# (3) Neumann
fix_modify  ATC fix_flux electric_potential rbc 0.5
run 1
# (4) Robin eps_1 phi'_1 = eps_2/L_2 (phi_{L_2} - phi)
fix_modify  ATC unfix_flux electric_potential rbc 
fix_modify  ATC fix_robin electric_potential rbc 0.5 -0.00001
run 1
# (5) Robins on the left and Robins on the right
fix_modify  ATC unfix electric_potential lbc 
fix_modify  ATC fix_robin electric_potential rbc 0.01 -0.0001
fix_modify  ATC fix_robin electric_potential lbc 0.01 -0.0001
run 1
#fix_modify  ATC fix charge_density all 0.0
#run 1
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using reaxff lmp_control pair style with pair coefficients * * ffield.reax.cho H C O with a timestep of 0.25 running for 3000 steps.","# REAX potential for CHO system
# .....

units           real

atom_style      charge
read_data       data.CHO

pair_style      reaxff lmp_control
pair_coeff      * * ffield.reax.cho H C O

neighbor        2 bin
neigh_modify    every 10 delay 0 check no

fix             1 all nve
fix             2 all qeq/reax 1 0.0 10.0 1e-6 param.qeq
fix             3 all temp/berendsen 500.0 500.0 100.0

timestep        0.25

thermo 100
#dump           1 all atom 30 dump.reax.cho

run             3000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay buck 6.5 lj/cut 6.5 coul/cut 6.5 pair style with pair coefficients 1 1 buck 3150.462646 0.35032282 626.7519553 with a timestep of 0.0001.","# QMMM for SiO2 zeolite with one methane molecule

units		metal
atom_style	full

bond_style      harmonic
angle_style     harmonic

read_data       data.zeolite

# MM atoms are Si,O
# QM atoms are C,H

group           mm type 1 2
group           qm type 3 4

# pair style must define stand-alone short-range Coulombics
# must specify mixing explicitly b/c hybrid/overlay
# MM Si,O = types 1,2
# QM C,H = types 3,4
# MM Si,O atoms do not LJ interact with each other (just via Buckingham)
# QM C,H atoms do not LJ interact with each other
# MM Si,O and QM C,H do LJ interact with each other

pair_style      hybrid/overlay buck 6.5 lj/cut 6.5 coul/cut 6.5

pair_coeff      1 1 buck 3150.462646 0.35032282 626.7519553
pair_coeff      2 2 buck 659.595398 0.38609055 26.836679
pair_coeff      1 2 buck 27029.419922 0.19385082 148.099091

pair_coeff      1 3 lj/cut 0.09087 3.613
pair_coeff      1 4 lj/cut 0.0344258 3.238
pair_coeff      2 3 lj/cut 0.1419429 3.1
pair_coeff      2 4 lj/cut 0.035857762359063315 1.932779  # same as water

pair_coeff      3 3 lj/cut 0.0 3.4
pair_coeff      4 4 lj/cut 0.0 2.65
pair_coeff      * * coul/cut

bond_style      harmonic
bond_coeff      1 29.40 1.09

angle_style     harmonic
angle_coeff     1 0.172325 109.5

# remove bonds/angles in QM methane molecule

delete_bonds    qm multi remove special

neighbor	1.0 bin
neigh_modify	delay 0 every 1 check yes

velocity        all create 300.0 458732

# QMMM dynamics with small timestep
# dynamic or frozen zeolite

#fix		1 all nve
fix		1 qm nve

fix             2 qm mdi/qmmm potential elements Si O C H
fix_modify      2 energy yes

timestep        0.0001

thermo_style    custom step cpu temp ke evdwl ecoul epair emol elong &
                f_2 pe etotal press
thermo          1

variable        p equal extract_setting(world_size)

mdi             plugin nwchem_mdi mdi ""-role ENGINE -name NWChem -method LINK"" &
                extra ""template.methane.nw methane.nw log.zeolite.pwdft.qmmm.plugin.$p"" &
                command ""run 2""
"
"Generate a LAMMPS input script for a NVT simulation of an charge system using hybrid/overlay pedone 15.0 coul/long 15.0 pair style with pair coefficients * * coul/long with a timestep of 0.002 running for 1000 steps at temperature 3000.0.","# Ca-O melt with Pedone potential

units metal
atom_style charge

lattice fcc 4.8105  # experimental lattice parameter for fcc-lattice Ca cations

region box block 0 4 0 4 0 4
create_box 2 box
create_atoms 1 box

lattice fcc 4.8105 origin 0.5 0.5 0.5 # O anion lattice shifted by half a unit cell
create_atoms 2 box

mass 1 40.078
mass 2 15.999

set type 1 charge 1.2
set type 2 charge -1.2

timestep 0.002
neigh_modify delay 5 every 1 check yes

pair_style hybrid/overlay pedone 15.0 coul/long 15.0
kspace_style pppm 1.0e-6

pair_coeff * * coul/long
pair_coeff 1 2 pedone 0.030211 2.241334 2.923245 5.0
pair_coeff 2 2 pedone 0.042395 1.379316 3.618701 22.0

velocity all create 6000.0 98347

fix 1 all nvt temp 3000.0 3000.0 0.1

# dump 1 all atom 500 Ca-O-melt.lammpstrj

thermo 100
run 1000
"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay eam/alloy spin/exchange 4.0 pair style with pair coefficients * * eam/alloy Co_PurjaPun_2012.eam.alloy Co and p p p boundary conditions with a timestep of 0.0001 running for 100 steps.","units 		metal
dimension 	3
boundary 	p p p 

atom_style 	spin

# necessary for the serial algorithm (sametag)
atom_modify 	map array
read_data 	Norm_randXY_8x8x32.data

mass		1 58.93

pair_style 	hybrid/overlay eam/alloy spin/exchange 4.0
pair_coeff 	* * eam/alloy Co_PurjaPun_2012.eam.alloy Co
pair_coeff 	* * spin/exchange exchange 4.0 0.0446928 0.003496 1.4885 

neighbor 	1.0 bin
neigh_modify 	every 1 check no delay 0

fix 		1 all precession/spin zeeman 0.0 0.0 0.0 1.0
fix 		2 all langevin/spin 0.0 0.0 21

fix 		3 all nve/spin lattice moving
timestep	0.0001

# define outputs and computes

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo          20
thermo_style    custom step time v_magnorm pe v_emag v_tmag temp etotal
thermo_modify   format float %20.15g

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
dump 		1 all custom 1 dump.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3] c_outsp[4] c_outsp[5] c_outsp[6] c_outsp[7]

run 		100
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 0.0 1.0 and f f p boundary conditions running for 0 steps.","# Exercise different output data options

variable        len equal 4.0
variable        lenz equal 10.0

dimension       2
units           metal
boundary        f f p

lattice         hex 1.0 origin 0.25 0.25 0.0

atom_style      atomic

region          box block 0 ${len}  0 ${len} -0.5 0.5
region          atoms block 0 ${len}  0 ${len} 0.0 0.0
create_box      1 box
create_atoms    1 region atoms

mass            1 1.0

pair_style      lj/cut 2.5
pair_coeff      1 1 0.0 1.0 

neighbor        1.0 nsq

#
# TEST 1: 
#

# This compute voronoi generates all three 
# types of quantity: per-atom, local, and global

compute         v1 all voronoi/atom neighbors yes edge_histo 6

# write voronoi per-atom quantities to a file

dump            dperatom all custom 1 dump.voro id type x y z c_v1[1] c_v1[2]

# writing voronoi local quantities to a file

dump            dlocal all local  1 dump.neighbors index c_v1[1] c_v1[2] c_v1[3]

# sum up a voronoi per-atom quantity

compute         volvor all reduce sum c_v1[1]

variable        volsys equal lz*lx*ly
variable        err equal c_volvor-v_volsys

# output voronoi global quantities

thermo_style    custom c_volvor v_volsys vol v_err c_v1[3] c_v1[4] c_v1[5] c_v1[6] c_v1[7]
thermo          1

run             0

uncompute       v1
uncompute       volvor
undump          dperatom
undump          dlocal

#
# TEST 2: 
#

# This compute voronoi generates peratom and local and global quantities

compute         v2 all voronoi/atom neighbors yes edge_histo 6

# write voronoi local quantities to a file

dump            d2 all local  1 dump.neighbors2 index c_v2[1] c_v2[2] c_v2[3]

# sum up a voronoi local quantity

compute         sumarea all reduce sum c_v2[3] inputs local

# output voronoi global quantities

thermo_style    custom c_sumarea c_v2[3] c_v2[4] c_v2[5] c_v2[6] c_v2[7]
thermo          1

run             0
"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay eam/alloy spin/exchange 3.5 spin/dipole/long 8.0 pair style with pair coefficients * * eam/alloy Fe_Mishin2006.eam.alloy Fe and p p p boundary conditions with a timestep of 0.0001 running for 100 steps.","# bcc iron in a 3d periodic box

clear 
units 		metal
atom_style 	spin

dimension 	3
boundary 	p p p

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice 	bcc 2.8665
region 		box block 0.0 12.0 0.0 12.0 0.0 12.0
create_box 	1 box
create_atoms 	1 box

# setting mass, mag. moments, and interactions for bcc iron

mass		1 55.845
set 		group all spin 2.2 -1.0 0.0 0.0
velocity 	all create 100 4928459 rot yes dist gaussian

pair_style 	hybrid/overlay eam/alloy spin/exchange 3.5 spin/dipole/long 8.0
pair_coeff 	* * eam/alloy Fe_Mishin2006.eam.alloy Fe
pair_coeff 	* * spin/exchange exchange 3.4 0.02726 0.2171 1.841
pair_coeff	* * spin/dipole/long 8.0

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

kspace_style 	ewald/dipole/spin 1.0e-4

fix 		1 all precession/spin cubic 0.001 0.0005 1.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 1.0
fix_modify 	1 energy yes
fix 		2 all langevin/spin 0.0 0.0 21

fix 		3 all nve/spin lattice moving
timestep	0.0001

# compute and output options

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	magx      equal c_out_mag[1]
variable 	magy      equal c_out_mag[2]
variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo_style    custom step time v_magx v_magy v_magz v_magnorm v_tmag v_emag pe etotal
thermo          50

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
dump 		1 all custom 100 dump_iron.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3]

run 		100
"
"Generate a LAMMPS input script for a NVE simulation of an electron system using eff/cut 50.112 pair style with pair coefficients * * and p p p boundary conditions running for 100 steps.","variable        sname index Li-dendritic

units 		electron
newton		on
boundary        p p p

atom_style	electron

read_data  	data.${sname}
#read_restart	${sname}.min.restart2

pair_style      eff/cut 50.112 
pair_coeff	* * 

comm_modify	vel yes

compute		effTemp all temp/eff

thermo          10
thermo_style    custom step etotal pe ke temp press
thermo_modify	temp effTemp

compute         1 all property/atom spin eradius
dump            1 all custom 10 ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z
dump            2 all xyz 10 ${sname}.min.xyz

restart		10 ${sname}.nve.restart1 ${sname}.nve.restart2

#min_style       cg
#min_modify      line quadratic dmax 2.0
#minimize        0.0 1.0e-5 10000 100000

velocity all create 300.0 4928459 rot yes dist gaussian

fix		1 all nve/eff

run		100
"
"Generate a LAMMPS input script for a general simulation of an full system using buck6d/coul/gauss/long  0.9  0.9  12.0000 pair style with pair coefficients 1     1           10304       3.0612245       457.17971       4.5218516      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW and p p p boundary conditions running for 0 steps.","clear
units real
boundary p p p
atom_style full
read_data hkust1.data

neighbor 2.0 bin


# ------------------------ MOF-FF FORCE FIELD ------------------------------
kspace_style ewald 1.0e-6

pair_style buck6d/coul/gauss/long  0.9  0.9  12.0000

pair_coeff     1     1           10304       3.0612245       457.17971       4.5218516      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW
pair_coeff     1     2           10304       3.0612245       457.17971       4.5218516      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene
pair_coeff     1     3       6157.8178       3.4682081       129.19572      0.78772886      0.73006542    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene
pair_coeff     1     4       23689.598       2.8436019        1636.052       12.696549      0.42066711    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW
pair_coeff     1     5       10576.399       3.1746032       377.27092       2.7176691      0.61999948    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW
pair_coeff     1     6           10304       3.0769231       443.36171       4.2093581      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c3@ph)|CuPW <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW
pair_coeff     2     2           10304       3.0612245       457.17971       4.5218516      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene <--> buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene
pair_coeff     2     3       6157.8178       3.4682081       129.19572      0.78772886      0.73006542    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene <--> buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene
pair_coeff     2     4       23689.598       2.8436019        1636.052       12.696549      0.42066711    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene <--> buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW
pair_coeff     2     5       10576.399       3.1746032       377.27092       2.7176691      0.61999948    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene <--> buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW
pair_coeff     2     6           10304       3.0769231       443.36171       4.2093581      0.60800971    # buck6d->(c3_c2h1@ph)|benzene/gaussian->(c3_c2h1@ph)|benzene <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW
pair_coeff     3     3            3680               4          32.805      0.10690769       0.9771554    # buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene <--> buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene
pair_coeff     3     4       14157.243       3.1914894       489.18197       2.5231391      0.45538909    # buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene <--> buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW
pair_coeff     3     5       6320.6076       3.6144578       103.50278      0.44181916      0.75109952    # buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene <--> buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW
pair_coeff     3     6       6157.8178       3.4883721        124.7792      0.72632262      0.73006542    # buck6d->(h1_c1@ph)|benzene/gaussian->(h1_c1@ph)|benzene <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW
pair_coeff     4     4           54464       2.6548673       5679.4311       33.208515      0.34105936    # buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW <--> buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW
pair_coeff     4     5       24315.863       2.9411765       1371.5617       7.9168726      0.42457748    # buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW <--> buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW
pair_coeff     4     6       23689.598       2.8571429       1590.0769        11.87959      0.42066711    # buck6d->(cu5_cu1o4@cu2)|CuPW/gaussian->(cu5_cu1o4@cu2)|CuPW <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW
pair_coeff     5     5           10856       3.2967033        308.7755       1.6022517      0.63272774    # buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW <--> buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW
pair_coeff     5     6       10576.399       3.1914894       365.45138       2.5231391      0.61999948    # buck6d->(o2_c1cu1@co2)|CuPW/gaussian->(o2_c1cu1@co2)|CuPW <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW
pair_coeff     6     6           10304       3.0927835       429.89352       3.9170177      0.60800971    # buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW <--> buck6d->(c3_c1o2@co2)|CuPW/gaussian->(c3_c1o2@co2)|CuPW

bond_style hybrid class2 morse

bond_coeff     5 morse    50.000000    1.451345     1.914000    # morse->(cu5_cu1o4@cu2,o2_c1cu1@co2)|CuPW
bond_coeff     4 class2     2.536000    75.465060  -192.435903   286.248406    # mm3->(cu5_cu1o4@cu2,cu5_cu1o4@cu2)|CuPW
bond_coeff     3 class2     1.094000   390.634200  -996.117210  1481.724350    # mm3->(c3_c2h1@ph,h1_c1@ph)|benzene
bond_coeff     6 class2     1.278000   585.591600 -1493.258580  2221.222138    # mm3->(c3_c1o2@co2,o2_c1cu1@co2)|CuPW
bond_coeff     1 class2     1.394000   509.335200 -1298.804760  1931.972080    # mm3->(c3_c2h1@ph,c3_c2h1@ph)|benzene
bond_coeff     2 class2     1.485000   360.635220  -919.619811  1367.934469    # mm3->(c3_c1o2@co2,c3_c3@ph)|CuPW

angle_style hybrid class2/p6 cosine/buck6d

angle_coeff     2 class2/p6      117.711000    57.408120   -46.049402    10.553745    -7.558563    13.610890    # mm3->(c3_c1o2@co2,c3_c3@ph,c3_c2h1@ph)|CuPW
angle_coeff     2 class2/p6 bb 0.0 1.0 1.0
angle_coeff     2 class2/p6 ba 0.0 0.0 1.0 1.0
angle_coeff     6 class2/p6      126.814000    13.740540   -11.021849     2.526022    -1.809130     3.257744    # mm3->(c3_c1o2@co2,o2_c1cu1@co2,cu5_cu1o4@cu2)|CuPW
angle_coeff     6 class2/p6 bb 0.0 1.0 1.0
angle_coeff     6 class2/p6 ba 0.0 0.0 1.0 1.0
angle_coeff     7 class2/p6      123.490000   111.075360   -89.098091    20.419778   -14.624589    26.334856    # mm3->(o2_c1cu1@co2,c3_c1o2@co2,o2_c1cu1@co2)|CuPW
angle_coeff     7 class2/p6 bb    14.244120     1.278000     1.278000
angle_coeff     7 class2/p6 ba     3.309240     3.309240     1.278000     1.278000
angle_coeff     1 class2/p6      127.050000    53.307540   -42.760159     9.799907    -7.018666    12.638684    # mm3->(c3_c2h1@ph,c3_c2h1@ph,c3_c2h1@ph)|benzene
angle_coeff     1 class2/p6 bb    71.796120     1.394000     1.394000
angle_coeff     1 class2/p6 ba     6.762360     6.762360     1.394000     1.394000
angle_coeff     4 class2/p6       84.336000    29.351520   -23.544055     5.395900    -3.864529     6.958951    # mm3->(cu5_cu1o4@cu2,cu5_cu1o4@cu2,o2_c1cu1@co2)|CuPW
angle_coeff     4 class2/p6 bb 0.0 1.0 1.0
angle_coeff     4 class2/p6 ba 0.0 0.0 1.0 1.0
angle_coeff     3 class2/p6      120.350000    36.185820   -29.026127     6.652298    -4.764358     8.579296    # mm3->(c3_c2h1@ph,c3_c2h1@ph,h1_c1@ph)|benzene
angle_coeff     3 class2/p6 bb    93.378120     1.394000     1.094000
angle_coeff     3 class2/p6 ba   -25.179000    53.523360     1.394000     1.094000
angle_coeff     8 class2/p6      115.098000    79.493700   -63.765149    14.613896   -10.466432    18.847160    # mm3->(c3_c3@ph,c3_c1o2@co2,o2_c1cu1@co2)|CuPW
angle_coeff     8 class2/p6 bb 0.0 1.0 1.0
angle_coeff     8 class2/p6 ba 0.0 0.0 1.0 1.0
angle_coeff     5 cosine/buck6d       1.978350     4   180.000000 #1.0   # fourier->(o2_c1cu1@co2,cu5_cu1o4@cu2,o2_c1cu1@co2)|CuPW

dihedral_style opls

dihedral_coeff     3     0.000000     0.000000     0.000000     0.000000    # cos3->(c3_c3@ph,c3_c2h1@ph,c3_c3@ph,c3_c1o2@co2)|CuPW
dihedral_coeff     9     0.000000     4.528000     0.000000     0.000000    # cos3->(o2_c1cu1@co2,c3_c1o2@co2,o2_c1cu1@co2,cu5_cu1o4@cu2)|CuPW
dihedral_coeff     8     0.000000     0.000000     0.000000     0.000000    # cos3->(o2_c1cu1@co2,cu5_cu1o4@cu2,o2_c1cu1@co2,c3_c1o2@co2)|CuPW
dihedral_coeff     5     0.000000     1.741000     0.000000     0.000000    # cos3->(o2_c1cu1@co2,c3_c1o2@co2,c3_c3@ph,c3_c2h1@ph)|CuPW
dihedral_coeff     2     0.000000     6.316000     0.000000     0.000000    # cos3->(c3_c2h1@ph,c3_c2h1@ph,c3_c2h1@ph,h1_c1@ph)|benzene
dihedral_coeff     1     0.000000     4.379000     0.000000     0.000000    # cos3->(c3_c2h1@ph,c3_c2h1@ph,c3_c2h1@ph,c3_c2h1@ph)|benzene
dihedral_coeff     6     0.000000     0.000000     0.000000     0.609000    # cos4->(o2_c1cu1@co2,cu5_cu1o4@cu2,cu5_cu1o4@cu2,o2_c1cu1@co2)|CuPW
dihedral_coeff     4     0.000000     0.000000     0.000000     0.000000    # cos3->(h1_c1@ph,c3_c2h1@ph,c3_c3@ph,c3_c1o2@co2)|CuPW
dihedral_coeff    10     0.000000     0.000000     0.000000     0.000000    # cos3->(c3_c3@ph,c3_c1o2@co2,o2_c1cu1@co2,cu5_cu1o4@cu2)|CuPW
dihedral_coeff     7     0.000000     0.000000     0.000000     0.000000    # cos3->(cu5_cu1o4@cu2,cu5_cu1o4@cu2,o2_c1cu1@co2,c3_c1o2@co2)|CuPW

improper_style inversion/harmonic

improper_coeff     1    18.776340     0.000000    # harm->(c3_c3@ph,c3_c2h1@ph,c3_c2h1@ph,c3_c1o2@co2)|CuPW
improper_coeff     3    41.005800     0.000000    # harm->(c3_c1o2@co2,c3_c3@ph,o2_c1cu1@co2,o2_c1cu1@co2)|CuPW
improper_coeff     2     4.100580     0.000000    # harm->(c3_c2h1@ph,c3_c2h1@ph,c3_c2h1@ph,h1_c1@ph)|benzene

special_bonds lj 0.0 0.0 1.0 coul 1.0 1.0 1.0

# ------------------------ MOF-FF FORCE FIELD END --------------------------

run 0
"
"Generate a LAMMPS input script for a general simulation of an full system using lj/cut 13.0 pair style with pair coefficients * * 0.2381 3.405 and f p p boundary conditions with a timestep of ${dt} running for $n steps.","# simulation of negatively charge liquid argon-positively charged solid/frozen argon
# MAKE this dielectric_interface then interface (major difference: non-uniform grid)
# START with extrinsic charges on both and then use an intrinsic charge density for frozen
echo both
units     	real
atom_style full
########### BEGIN PARAMETERS ####################################
variable a equal 5.719025032  
variable i equal 1
variable s equal 100
variable n equal 1000 # 500 2000
variable dt equal 4.0 
variable W equal 4
variable L equal 20
variable Ls equal 4 # surface
variable h equal 10 
variable phiInf equal -1. # 0. 10 -10.0
variable perm2 equal 2.
variable depth equal 17.1571
#  1 1 0.1 0.1 1 1
variable w1  equal 4/$L # relative wall width
variable w2  equal ${w1}+2/$L # relative wall width
variable w3  equal ${w2}+2/$L 
variable w4  equal ${w3}+2/$L 
##############  END PARAMETERS #################################
dimension 	3
boundary  	f p p
pair_style  	lj/cut 13.0
lattice   	fcc  $a 
read_data interface_init.data
atom_modify sort 0 1
mass       * 39.948
pair_coeff * * 0.2381 3.405
dielectric 1.0 
region BOX block 0 $L 0 $W 0 $W
group SOLID type 1
group FLUID type 2 3 4
group P type 3
group N type 4
set group SOLID charge 0 # use ATC to provide charge to the surface
timestep  	${dt}
neigh_modify every $i check no
fix WALLS all wall/reflect xlo EDGE xhi EDGE 
fix         PP  all   atc field
fix_modify  PP  add_species IONS type 1 2 3 4
fix_modify  PP  fields add species_concentration mass_density charge_density
fix_modify  PP  atom_element_map eulerian $s
fix_modify  PP  mesh create $h 1 1 BOX f p p
fix_modify  PP output volume_integral all mass_density
fix_modify  PP output volume_integral all charge_density
fix         ATC FLUID   atc species_electrostatic  Ar_electrostatic.mat 
fix_modify  ATC add_species P type 3
fix_modify  ATC add_species N type 4
fix_modify  ATC boundary SOLID
fix_modify  ATC atom_element_map eulerian $i
fix_modify  ATC internal_quadrature off # on creates a nasty error (NOTE trap error)
fix_modify  ATC mass_matrix fe
fix_modify  ATC include atomic_charge
# mesh
fix_modify ATC mesh create $h 2 2 BOX f p p dx piecewise_linear 0 0 0 1 0 0 0.0 1.0 1.0 1.0
fix_modify ATC output volume_integral all mass_density
fix_modify ATC output volume_integral all charge_density
fix_modify ATC mesh create_nodeset lbc 0  0  -INF INF -INF INF
fix_modify ATC mesh create_nodeset rbc $L $L -INF INF -INF INF
fix_modify ATC mesh create_nodeset    wall 0 ${Ls} 0 4 0 4
fix_modify ATC mesh create_elementset wall 0 ${Ls} 0 4 0 4
#fix_modify ATC mesh create_faceset lbc plane x 0  
fix_modify ATC mesh create_faceset surface -INF ${Ls}  -INF INF -INF INF
fix_modify ATC mesh output dielectric_interfaceMESH text binary
# ic/bcs
#fix_modify ATC initial charge_density     all 0.
fix_modify ATC initial mass_density       all 0.
fix_modify ATC initial electric_potential all 0.
# output
thermo    	$s
variable cFLUID   equal count(FLUID)
compute PAVE P reduce ave x 
compute PMIN P reduce min x
compute PMAX P reduce max x
compute NAVE N reduce ave x 
compute NMIN N reduce min x
compute NMAX N reduce max x
compute q all property/atom q
compute Q all reduce sum c_q
compute m all property/atom mass
compute M all reduce sum c_m
compute Qf FLUID reduce sum c_q
compute Mf FLUID reduce sum c_m
compute F FLUID reduce sum fx fy fz
thermo_style 	custom step temp press etotal pe c_Q c_M c_Qf c_Mf c_PMIN c_PAVE c_PMAX c_NMIN c_NAVE c_NMAX c_F[1] c_F[2] c_F[3]
compute T FLUID temp
thermo_modify  temp T
thermo_modify  flush yes
log dielectric_interface.log
fix_modify ATC output dielectric_interfaceFE $s full_text binary
fix_modify  PP output dielectric_interfacePP $s full_text binary
dump   X all custom $s dielectric_interface.dmp id type x y z q vx vy vz fx fy fz
fix_modify ATC  fix     electric_potential rbc 0.
# stage 1 : active source controlling far-field shielding
fix_modify ATC  control charge FLUID dielectric ${phiInf} ${perm2} ${depth}
fix_modify ATC  control charge FLUID image_charge surface
run $n
# stage 2 : static source - i.e. above the mean like JCTC / ""effective_charge""
fix_modify ATC  source electric_potential wall 0.001 
fix_modify ATC  fix     electric_potential lbc ${phiInf}
#run $n
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using airebo/morse 3.0 1 1 pair style with pair coefficients * * CH.airebo-m C H with a timestep of 0.0005 running for 100 steps.","# AIREBO polyethelene benchmark

units               metal
atom_style          atomic

read_data           data.airebo

replicate           17 16 2

neighbor            0.5 bin
neigh_modify        delay 5 every 1

pair_style          airebo/morse 3.0 1 1
pair_coeff          * * CH.airebo-m C H

velocity            all create 300.0 761341

fix                 1 all nve
timestep            0.0005

thermo              10
run                 100
"
"Generate a LAMMPS input script for a general simulation using vashishta pair style with pair coefficients * * InP.vashishta In P and p p p boundary conditions running for 0 steps.","# calculate the energy volume curve for InP zincblende

# define volume range and filename

variable	ndelta equal 100
variable	volatom_min equal 20.0
variable	volatom_max equal 29.0
variable	evsvolfile string evsvol.dat

# set up cell 

units		metal
 
boundary	p p p

# setup loop variables for box volume

variable	amin equal ${volatom_min}^(1/3)*2
variable 	delta equal (${volatom_max}-${volatom_min})/${ndelta} 
variable	scale equal (${delta}/v_volatom+1)^(1/3)

# set up 8 atom InP zincblende unit cell

lattice diamond ${amin}

region		box prism &
	 	0 1 &
		0 1 &
		0 1 &
		0 0 0

create_box	2 box

create_atoms	1	box       &
			basis 5 2 &
			basis 6 2 &
			basis 7 2 &
			basis 8 2

mass 		1 114.76
mass 		2 30.98

# choose potential

pair_style	vashishta
pair_coeff 	* * InP.vashishta In P

# setup neighbor style

neighbor 	1.0 nsq
neigh_modify 	once no every 1 delay 0 check yes

# setup output

thermo_style 	custom step temp pe press vol
thermo_modify 	norm no
variable 	volatom equal vol/atoms
variable 	eatom equal pe/atoms
print 		""# Volume [A^3/atom] Energy [eV/atom]"" file ${evsvolfile}

# loop over range of volumes

label 		loop
variable 	i loop ${ndelta}

change_box 	all x scale ${scale} y scale ${scale} z scale ${scale} remap

# calculate energy
# no energy minimization needed for zincblende
 
run 		0
print 		""${volatom} ${eatom}"" append ${evsvolfile}

next 		i
jump 		SELF loop
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut ${rc} pair style with pair coefficients 1 1 1.0 1.0 running for 1000 steps.","# sample LAMMPS input script for thermal conductivity of liquid LJ
# Green-Kubo method via compute heat/flux and fix ave/correlate

# settings

variable        x equal 10
variable        y equal 10
variable        z equal 10

variable        rho equal 0.6
variable        t equal 1.35
variable        rc equal 2.5

#variable       rho equal 0.85
#variable        t equal 0.7
#variable       rc equal 3.0

variable    p equal 200     # correlation length
variable    s equal 10      # sample interval
variable    d equal $p*$s   # dump interval

# setup problem

units           lj
atom_style      atomic

lattice         fcc ${rho}
region          box block 0 $x 0 $y 0 $z
create_box      1 box
create_atoms    1 box
mass            1 1.0

velocity        all create $t 87287

pair_style      lj/cut ${rc}
pair_coeff      1 1 1.0 1.0

neighbor        0.3 bin
neigh_modify    delay 0 every 1

# 1st equilibration run

fix             1 all nvt temp $t $t 0.5
thermo          100
run             1000

velocity        all scale $t

unfix           1

# thermal conductivity calculation

reset_timestep  0

compute         myKE all ke/atom
compute         myPE all pe/atom
compute         myStress all stress/atom NULL virial
compute         flux all heat/flux myKE myPE myStress
variable        Jx equal c_flux[1]/vol
variable        Jy equal c_flux[2]/vol
variable        Jz equal c_flux[3]/vol

fix             1 all nve
fix             JJ all ave/correlate $s $p $d &
                c_flux[1] c_flux[2] c_flux[3] type auto &
                file profile.heatflux ave running

variable        scale equal $s*dt/$t/$t/vol
variable        k11 equal trap(f_JJ[3])*${scale}
variable        k22 equal trap(f_JJ[4])*${scale}
variable        k33 equal trap(f_JJ[5])*${scale}
variable        kappa equal (v_k11+v_k22+v_k33)/3.0

thermo          $d
thermo_style    custom step temp v_Jx v_Jy v_Jz v_k11 v_k22 v_k33 v_kappa
thermo_modify   colname v_Jx Jx colname v_Jy Jy colname v_Jz Jz &
                colname v_k11 kappa_11 colname v_k22 kappa_22 &
                colname v_k33 kappa_33 colname v_kappa kappa

run             100000

print           ""Running average thermal conductivity: $(v_kappa:%.2f)""
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using rebomos pair style with pair coefficients * * MoS.rebomos Mo S S and p p f boundary conditions with a timestep of 0.001 running for 5000 steps.","# monolayer MoS2
units           metal
boundary        p p f
processors      * * 1
atom_modify map array

atom_style      atomic
read_data       single_layer_MoS2.data

mass            * 32.065        # mass of sulphur atom , uint: a.u.=1.66X10^(-27)kg
mass            1 95.94         # mass of molebdenum atom , uint: a.u.=1.66X10^(-27)kg

########################## Define potentials ################################
pair_style      rebomos
pair_coeff      * * MoS.rebomos Mo S S
#########################################################################

### Simulation settings ####
timestep        0.001
velocity        all create 300.0 12345 loop geom

############################

# Output
thermo          500
thermo_style    custom step etotal pe ke temp
thermo_modify   lost warn

###### Run molecular dynamics ######
fix             thermostat all nve
run             5000
"
"Generate a LAMMPS input script for a NPT simulation of an charge system using hybrid/overlay coul/dsf 0.2 12.0 table spline 20000 buck 7.0 nb3b/screened pair style with pair coefficients * *  coul/dsf and p p p boundary conditions with a timestep of 0.002 running for 1000 steps.","### LAMMPS input file

units            metal
dimension        3
boundary         p p p
atom_style       charge

read_data  data.NaPO3

pair_style hybrid/overlay coul/dsf 0.2 12.0 table spline 20000 buck 7.0 nb3b/screened

pair_coeff  * *  coul/dsf
pair_coeff 1  3 table Table_NP.dat  Pair_P-O 7.0
pair_coeff 2  3 table Table_NP.dat  Pair_Na-O 7.0
pair_coeff 3  3 table Table_NP.dat  Pair_O-O 7.0

# pair Buckingham
pair_coeff  1  1  buck  5.093669  0.905598  0.0

# shrm
pair_coeff * * nb3b/screened PSiO.nb3b.screened  P NULL O

neighbor         1.0  bin
neigh_modify     every 10 delay 10 check no
timestep         0.002

thermo 100
thermo_style custom step density lx press pe evdwl ecoul temp

#dump 2 all custom 10000 NaPO3-melt.lammpstrj  id type element x y z
#dump_modify 2 element P  Na  O
variable temp equal 2500

fix 1 all npt temp ${temp} ${temp} $(100*dt) iso 1 1 $(1000*dt)
run 1000
"
"Generate a LAMMPS input script for a NVE simulation of an amoeba system using hippo pair style with pair coefficients * * hippo_water.prm hippo_water_box.key and p p p boundary conditions running for 100 steps.","# water box with AMOEBA or HIPPO

units           real
boundary        p p p

atom_style      amoeba
bond_style      class2
angle_style     amoeba
dihedral_style  none

# per-atom properties required by AMOEBA or HIPPO

fix             amtype all property/atom i_amtype ghost yes
fix             extra all property/atom i_amgroup d_redID d_pval ghost yes
fix             extra2 all property/atom i_polaxe d2_xyzaxis 3

# read data file

read_data       data.water_box.hippo fix amtype NULL ""Tinker Types""

# force field

pair_style      hippo
pair_coeff      * * hippo_water.prm hippo_water_box.key

special_bonds   lj/coul 0.5 0.5 0.5 one/five yes

# thermo output

compute         virial all pressure NULL virial

thermo_style    custom step temp epair ebond eangle edihed eimp &
                emol etotal press c_virial[*]

#dump            1 all custom 10 dump.water_box id type x y z fx fy fz
#dump_modify     1 sort id

# dynamics

fix             1 all nve

thermo          10
run             100
"
"Generate a LAMMPS input script for a NVT simulation of an full system using hybrid lj/class2/coul/long 9.5 lj/class2/coul/long/soft 2 0.5 0.5 9.5 pair style with pair coefficients 1    6  lj/class2/coul/long/soft   0.054 4.01 0.0 with a timestep of 1.0 running for 100000 steps at temperature 300.","# LAMMPS atomistic input script

echo            screen
units           real
atom_style      full

pair_style      hybrid lj/class2/coul/long 9.5 lj/class2/coul/long/soft 2 0.5 0.5 9.5
bond_style      class2
angle_style     class2
dihedral_style  class2
improper_style  class2
pair_modify     mix sixthpower tail yes
special_bonds   lj/coul 0 0 1

read_data       data.init_conf_with_heptane

pair_coeff    1    6  lj/class2/coul/long/soft   0.054 4.01 0.0
pair_coeff    2    6  lj/class2/coul/long/soft   0.054 4.01 0.0
pair_coeff    3    6  lj/class2/coul/long/soft   0.10615754 3.80912744 0.0
pair_coeff    4    6  lj/class2/coul/long/soft   0.02333374 3.66909137 0.0
pair_coeff    5    6  lj/class2/coul/long/soft   0.00108740 3.57275476 0.0

pair_coeff    1    7  lj/class2/coul/long/soft   0.054 4.01 0.0
pair_coeff    2    7  lj/class2/coul/long/soft   0.054 4.01 0.0
pair_coeff    3    7  lj/class2/coul/long/soft   0.10615754 3.80912744 0.0
pair_coeff    4    7  lj/class2/coul/long/soft   0.02333374 3.66909137 0.0
pair_coeff    5    7  lj/class2/coul/long/soft   0.00108740 3.57275476 0.0

pair_coeff    1    8  lj/class2/coul/long/soft   0.02333374 3.66909137 0.0
pair_coeff    2    8  lj/class2/coul/long/soft   0.02333374 3.66909137 0.0
pair_coeff    3    8  lj/class2/coul/long/soft   0.06151694 3.31892497 0.0
pair_coeff    4    8  lj/class2/coul/long/soft   0.02 2.995 0.0
pair_coeff    5    8  lj/class2/coul/long/soft   0.00158519 2.66932028 0.0

timestep        1.0
kspace_style    pppm 1.0e-5

variable lambda equal ramp(0.0,1.0)
variable q1 equal -0.1590*v_lambda
variable q2 equal -0.1060*v_lambda
variable q3 equal  0.0530*v_lambda

fix ADAPT all adapt/fep 10 &
  pair lj/class2/coul/long/soft lambda 1*5 6*8 v_lambda &
  atom charge 6 v_q1 &
  atom charge 7 v_q2 &
  atom charge 8 v_q3 &
  after yes

thermo_style custom step temp press vol etotal pe v_lambda v_q1 v_q2 v_q3
thermo_modify line one
thermo          100

fix             1 all nvt temp 300 300 100
run             100000

write_data      data.after_heptane_insertion
"
"Generate a LAMMPS input script for a NPT simulation of an full system using hybrid & pair style with pair coefficients 1    1  lj/cut/coul/long    0.0660   3.5000  # C4H C4H and p p p boundary conditions with a timestep of 1.0 running for 100000 steps.","# created by fftool

print ""Methane in TIP4P water""

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
special_bonds lj/coul 0.0 0.0 0.5

read_data data.lmp

pair_style hybrid &
  lj/cut/coul/long 10.0 10.0 &
  lj/cut/tip4p/long/soft 3 4 2 2 0.125 1 0.5 10.0 10.0 10.0
pair_modify tail no
kspace_style pppm/tip4p 1.0e-4

pair_coeff    1    1  lj/cut/coul/long    0.0660   3.5000  # C4H C4H
pair_coeff    1    2  lj/cut/coul/long    0.0445   2.9580  # C4H H
pair_coeff    2    2  lj/cut/coul/long    0.0300   2.5000  # H H
pair_coeff    3    3  lj/cut/tip4p/long/soft   0.1628   3.1644  1.0  # Ow Ow
pair_coeff    3    4  lj/cut/tip4p/long/soft   0.0000   1.0000  1.0  # Ow Hw
pair_coeff    4    4  lj/cut/tip4p/long/soft   0.0000   1.0000  1.0  # Hw Hw

pair_coeff    1    3  lj/cut/tip4p/long/soft   0.1036   3.3279  0.0  # C4H Ow
pair_coeff    1    4  lj/cut/tip4p/long/soft   0.0000   1.0000  0.0  # C4H Hw
pair_coeff    2    3  lj/cut/tip4p/long/soft   0.0699   2.8126  0.0  # H Ow
pair_coeff    2    4  lj/cut/tip4p/long/soft   0.0000   1.0000  0.0  # H Hw

variable TK equal 300.0
variable PBAR equal 1.0

fix SHAKE all shake 0.0001 20 0 b 2 a 2

neighbor 2.0 bin

timestep 1.0

velocity all create ${TK} 12345

thermo_style custom step etotal ke pe evdwl ecoul elong temp press density
thermo 5000

fix TPSTAT all npt temp ${TK} ${TK} 100 iso ${PBAR} ${PBAR} 1000

set type 1*2 charge 0.0

run 100000

reset_timestep 0

variable lambda equal ramp(0.0,1.0)
variable q1 equal -0.24*v_lambda
variable q2 equal  0.06*v_lambda

fix ADAPT all adapt/fep 100000 &
  pair lj/cut/tip4p/long/soft lambda 1*2 3*4 v_lambda &
  atom charge 1 v_q1 &
  atom charge 2 v_q2 &
  after yes

thermo_style custom step etotal ke pe evdwl ecoul elong temp press density v_lambda v_q1 v_q2

variable dlambda equal 0.05
variable dq1 equal -0.24*v_dlambda
variable dq2 equal  0.06*v_dlambda

compute FEP all fep ${TK} &
  pair lj/cut/tip4p/long/soft lambda 1*2 3*4 v_dlambda &
  atom charge 1 v_dq1 &
  atom charge 2 v_dq2 &
  volume yes

fix FEP all ave/time 20 4000 100000 c_FEP[*] file fep01.fep

dump TRAJ all custom 20000 dump.lammpstrj id mol type element xu yu zu
dump_modify TRAJ element C H O H

run 2000000

# write_restart restart.*.lmp
write_data data.*.lmp
"
"Generate a LAMMPS input script for a general simulation of an full system using lj/cut/tip4p/long 1 2 1 1 0.14714951 8 pair style with pair coefficients * 2  0.0     0.0 with a timestep of 0.5 running for 10000 steps.","units           real
atom_style      full 

pair_style      lj/cut/tip4p/long 1 2 1 1 0.14714951 8
bond_style      class2
angle_style     harmonic
kspace_style    pppm/tip4p 0.0001

read_data       data.h2o-smart

pair_coeff  * 2  0.0     0.0
pair_coeff  1 1  0.1852  3.1589022

#q-tip4pf bond parameters
bond_coeff      1 0.9419 607.19354  -1388.6516 1852.577
angle_coeff     1 43.93  107.4

timestep        0.5

velocity        all create 300.0 1112 dist gaussian mom yes

thermo          100
thermo_style    custom step temp pe ke etotal

# smart sampling with GLE: best efficiency on slow diffusive modes, 
# and as good as possible on higher-frequency modes
fix             1 all gle 6 300.0 300.0 31415 smart.A

#dump           1 all atom 100 h2o-smart.lammpstrj

#dump           2 all image 1000 h2o-smart.*.jpg element element &
#               zoom 1.4
#dump_modify    2 pad 5 element O H

#dump           3 all movie 100 movie.mp4 element element &
#               zoom 1.4
#dump_modify    3 pad 5 element O H

run             10000

"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/cut/coul/long 12.0 12.0 pair style with pair coefficients 1 1 0.15535 3.166 with a timestep of 2.0 running for 0 post no steps at temperature 300.0.","
units		real	
atom_style	full

read_data	data.spce

pair_style	lj/cut/coul/long 12.0 12.0
kspace_style	pppm 1.0e-4

pair_coeff	1 1 0.15535 3.166
pair_coeff	* 2 0.0000 0.0000	

bond_style	harmonic
angle_style	harmonic
dihedral_style	none
improper_style	none

bond_coeff	1 1000.00 1.000
angle_coeff	1 100.0 109.47

special_bonds   lj/coul 0.0 0.0 1.0

neighbor        2.0 bin

fix		1 all shake 0.0001 20 0 b 1 a 1
fix		2 all nvt temp 300.0 300.0 100.0

# make certain that shake constraints are satisfied
run 0 post no

group		oxy type 1
group		hyd type 2

# the following section shows equivalences between using the pe/tally compute and other computes and thermo keywords

# compute pairwise energy between all oxygen and all hydrogen
compute		epa oxy group/group hyd pair yes kspace no boundary no
# tally pairwise energy between all oygen and all hydrogen
compute		c1 oxy pe/tally hyd
# tally pairwise energy between all atoms to compare with globals
compute		c2 all pe/tally all
# collect per atom energies
compute		c3 all pe/atom pair
# reduce over the first group only the per-atom data is storing VDW and Coulomb separately...
compute		oxy oxy reduce sum c_c1[1] c_c1[2]
compute		red all reduce sum c_c2[1] c_c2[2] c_c3
# ... thus to get the same as compute group/group, we need to add the two
# ... and multiply by 2.0 since compute group/group sums the pair energy, while we collect only for the first group.
variable	epa equal 2.0*(c_oxy[1]+c_oxy[2])
# compute equivalent values to globals
variable	vdwl equal c_red[1]
variable	coul equal c_red[2]
variable	pe   equal c_red[3]
variable	pair equal v_vdwl+v_coul
variable	eref equal epair-elong

velocity	all create 300 432567 dist uniform

timestep	2.0

# c_epa and v_epa, evdwl and v_vdwl, ecoul and v_coul, and the last 4 columns each should have identical value
thermo_style    custom step c_epa v_epa evdwl v_vdwl ecoul v_coul v_eref v_pe c_c2 v_pair
thermo		10

run 50

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut $(v_cutoff*v_sigma) pair style with pair coefficients 1 1 ${epsilon} ${sigma} with a timestep of $(v_dt*v_tscale) running for ${nsteps} steps.","# Ar in real units

# simulation params in reduced units
# settable from command line
# epsilon, sigma, mass set below

variable	x index 5
variable	y index 5
variable	z index 5
variable        rhostar index 0.8842
variable        dt index 0.005
variable        cutoff index 2.5
variable        skin index 0.3
variable        tinitial index 1.0
variable        nthermo index 10
variable        nsteps index 100

# physical constants from update.cpp

variable        kb index 0.0019872067         # kB in Kcal/mole/K
variable        avogadro index 6.02214129e23  # Avogadro's number

# Ar properties in real units

variable        epskb index 117.7             # LJ epsilon/kB in degrees K
variable        sigma index 3.504             # LJ sigma in Angstroms
variable        epsilon equal ${epskb}*${kb}  # LJ epsilon in Kcal/mole
variable        mass index 39.95              # mass in g/mole

# scale factors

# sigma = scale factor on distance, converts reduced distance to Angs
# epsilon = scale factor on energy, converts reduced energy to Kcal/mole
# tmpscale = scale factor on temperature, converts reduced temp to degrees K
# tscale = scale factor on time, converts reduced time to fs
#   formula is t = t* / sqrt(epsilon/mass/sigma^2), but need t in fs
#   use epsilon (Joule/mole), mass (kg/mole), sigma (meter) to get t in seconds
# pscale = scale factor on pressure, converts reduced pressure to atmospheres
#   formula is P = P* / (sigma^3/epsilon), but need P in atmospheres
#   use sigma (meter), epsilon (Joule) to get P in nt/meter^2, convert to atms

variable        KcaltoJoule index 4.1868e3    # convert Kcals to Joules
variable        NtMtoAtm equal 1.0/1.0135e5   # convert Nt/meter^2 to Atmospheres

variable        tmpscale equal ${epskb}
variable        epsJmole equal ${epsilon}*${KcaltoJoule}
variable        massKgmole equal ${mass}/1000.0
variable        sigmaM equal ${sigma}/1.0e10
variable        sigmaMsq equal ${sigmaM}*${sigmaM}
variable        tscale equal 1.0e15/sqrt(${epsJmole}/${massKgmole}/${sigmaMsq})
variable        sigmaM3 equal ${sigmaM}*${sigmaM}*${sigmaM}
variable        pscale equal ${NtMtoAtm}/(${sigmaM3}/(${epsJmole}/${avogadro}))

# variables
# alat = lattice constant in Angs (at reduced density rhostar)
# temp = reduced temperature for output
# epair,emol,etotal = reduced epair,emol,etotal energies for output
# press = reduced pressure for output

variable        alat equal (4.0*${sigma}*${sigma}*${sigma}/${rhostar})^(1.0/3.0)
variable        temp equal temp/${tmpscale}
variable        epair equal epair/${epsilon}
variable        emol equal emol/${epsilon}
variable        etotal equal etotal/${epsilon}
variable        press equal press/${pscale}

# same script as in.ar.lj

units		real
atom_style	atomic

lattice		fcc ${alat}
region		box block 0 $x 0 $y 0 $z
create_box	1 box
create_atoms	1 box
mass		1 ${mass}

velocity	all create $(v_tinitial*v_epskb) 12345

pair_style	lj/cut $(v_cutoff*v_sigma)
pair_coeff	1 1 ${epsilon} ${sigma}

neighbor	$(v_skin*v_sigma) bin
neigh_modify	delay 0 every 20 check no

fix		1 all nve

timestep	$(v_dt*v_tscale)

# columns 2,3,4 = temp,pe,press in real units
# columns 5-9 = temp,energy.press in reduced units, compare to in.ar.lj
# need to include real unit output to enable use of reduced variables

thermo_style    custom step temp pe press v_temp v_epair v_emol v_etotal v_press
thermo_modify	norm yes
thermo		${nthermo}

run		${nsteps}
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 12.0 pair style with pair coefficients 1 1 0.238067 3.405 running for 20000 steps.","# Numerical difference calculation
# of Born matrix

# Note that because of cubic symmetry and central forces, we have:
# C11, pure axial == positive mean value: 1,2,3
# C44==C23, pure shear == positive mean value, exactly match in pairs: (4,12),(5,8),(6,7)
# C14==C56, shear/axial(normal) == zero mean, exactly match in pairs: (9,21),(14,20),(18,19)
# C15, shear/axial(in-plane) == zero mean: 10,11,13,15,16,17

# adjustable parameters

units           real
variable        nsteps index 100000    # length of run
variable        nthermo index  1000    # thermo output interval 
variable        nlat equal 5           # size of box
variable        T    equal 60.         # Temperature in K
variable        rho  equal 5.405       # Lattice spacing in A

atom_style      atomic

lattice         fcc ${rho}
region          box block 0 ${nlat} 0 ${nlat} 0 ${nlat}
create_box      1 box
create_atoms    1 box

mass            * 39.948

velocity        all create ${T} 87287 loop geom
velocity        all zero linear

pair_style      lj/cut 12.0
pair_coeff      1 1 0.238067 3.405

neighbor        0.0 bin
neigh_modify    every 1 delay 0 check no

variable vol equal vol
thermo 100
fix aL all ave/time 1 1 1 v_vol ave running
fix NPT all npt temp $T $T 100 aniso 1. 1. 1000 fixedpoint 0. 0. 0.

run 20000

unfix NPT

variable newL equal ""f_aL^(1./3.)""
change_box all x final 0 ${newL} y final 0. ${newL} z final 0. ${newL} remap units box

unfix aL

reset_timestep 0

# Conversion variables
variable kb        equal 1.38065e-23    # J/K
variable Myvol     equal ""vol*10^-30"" # Volume in m^3
variable kbt       equal ""v_kb*v_T""
variable Nat       equal atoms
variable Rhokbt    equal ""v_kbt*v_Nat/v_Myvol""
variable at2Pa     equal 101325
variable kcalmol2J equal ""4183.9954/(6.022e23)""
variable C1        equal ""v_kcalmol2J/v_Myvol"" # Convert Cb from energy to pressure units
variable C2        equal ""v_Myvol/v_kbt""       # Factor for Cfl terms
variable Pa2GPa    equal 1e-9

# Born compute giving <C^b> terms
# The six virial stress component to compute <C^fl>
compute     VIR all pressure NULL virial
compute     born all born/matrix numdiff 1e-6 VIR
variable s1 equal ""-c_VIR[1]*v_at2Pa""
variable s2 equal ""-c_VIR[2]*v_at2Pa""
variable s3 equal ""-c_VIR[3]*v_at2Pa""
variable s6 equal ""-c_VIR[4]*v_at2Pa""
variable s5 equal ""-c_VIR[5]*v_at2Pa""
variable s4 equal ""-c_VIR[6]*v_at2Pa""
variable press equal press


# Average of Born term and vector to store stress
# for post processing
fix CB all ave/time 1 ${nthermo} ${nthermo} c_born[*] ave running file born.out overwrite
fix CPR all ave/time 1 1 1 c_VIR[*] file vir.out
fix APR all ave/time 1 1 1 v_press ave running
fix VEC all vector 1 v_s1 v_s2 v_s3 v_s4 v_s5 v_s6

thermo      ${nthermo}
thermo_style    custom step temp press f_APR c_born[1] f_CB[1] c_born[12] f_CB[12] c_born[4] f_CB[4]
thermo_modify line multi

fix     1 all nvt temp $T $T 100

run         ${nsteps}

# Compute vector averages
# Note the indice switch.
# LAMMPS convention is NOT the Voigt notation.
variable aves1 equal ""ave(f_VEC[1])""
variable aves2 equal ""ave(f_VEC[2])""
variable aves3 equal ""ave(f_VEC[3])""
variable aves4 equal ""ave(f_VEC[6])""
variable aves5 equal ""ave(f_VEC[5])""
variable aves6 equal ""ave(f_VEC[4])""

# Computing the covariance through the <s_{i}s_{j}>-<s_i><s_j>
# is numerically instable. Here we go through the <(s-<s>)^2>
# definition.

# Computing difference relative to average values
variable ds1 vector ""f_VEC[1]-v_aves1""
variable ds2 vector ""f_VEC[2]-v_aves2""
variable ds3 vector ""f_VEC[3]-v_aves3""
variable ds4 vector ""f_VEC[4]-v_aves4""
variable ds5 vector ""f_VEC[5]-v_aves5""
variable ds6 vector ""f_VEC[6]-v_aves6""

# Squaring and averaging
variable dds1 vector ""v_ds1*v_ds1""
variable dds2 vector ""v_ds2*v_ds2""
variable dds3 vector ""v_ds3*v_ds3""
variable vars1 equal ""ave(v_dds1)""
variable vars2 equal ""ave(v_dds2)""
variable vars3 equal ""ave(v_dds3)""
variable C11 equal ""v_Pa2GPa*(v_C1*f_CB[1] - v_C2*v_vars1 + 2*v_Rhokbt)""
variable C22 equal ""v_Pa2GPa*(v_C1*f_CB[2] - v_C2*v_vars2 + 2*v_Rhokbt)""
variable C33 equal ""v_Pa2GPa*(v_C1*f_CB[3] - v_C2*v_vars3 + 2*v_Rhokbt)""

variable dds12 vector ""v_ds1*v_ds2""
variable dds13 vector ""v_ds1*v_ds3""
variable dds23 vector ""v_ds2*v_ds3""
variable vars12 equal ""ave(v_dds12)""
variable vars13 equal ""ave(v_dds13)""
variable vars23 equal ""ave(v_dds23)""
variable C12 equal ""v_Pa2GPa*(v_C1*f_CB[7] - v_C2*v_vars12)""
variable C13 equal ""v_Pa2GPa*(v_C1*f_CB[8] - v_C2*v_vars13)""
variable C23 equal ""v_Pa2GPa*(v_C1*f_CB[12] - v_C2*v_vars23)""

variable dds4 vector ""v_ds4*v_ds4""
variable dds5 vector ""v_ds5*v_ds5""
variable dds6 vector ""v_ds6*v_ds6""
variable vars4 equal ""ave(v_dds4)""
variable vars5 equal ""ave(v_dds5)""
variable vars6 equal ""ave(v_dds6)""
variable C44 equal ""v_Pa2GPa*(v_C1*f_CB[4] - v_C2*v_vars4 + v_Rhokbt)""
variable C55 equal ""v_Pa2GPa*(v_C1*f_CB[5] - v_C2*v_vars5 + v_Rhokbt)""
variable C66 equal ""v_Pa2GPa*(v_C1*f_CB[6] - v_C2*v_vars6 + v_Rhokbt)""

variable aC11 equal ""(v_C11 + v_C22 + v_C33)/3.""
variable aC12 equal ""(v_C12 + v_C13 + v_C23)/3.""
variable aC44 equal ""(v_C44 + v_C55 + v_C66)/3.""

print """"""
C11 = ${aC11}
C12 = ${aC12}
C44 = ${aC44}
""""""
"
"Generate a LAMMPS input script for a NVE simulation of an bond system using lj/cut 2.5 pair style with pair coefficients 1 1 10.0 1.0 2.5 and f f p boundary conditions with a timestep of 0.001 running for 40000 steps.","# 2d circle of particles inside a box with LJ walls

variable        b index 0

variable        x index 50
variable        y index 20
variable        d index 20

# careful not to slam into wall too hard

variable        v index 0.3
variable        w index 0.08

units           lj
dimension       2
atom_style      bond
boundary        f f p

lattice         hex 0.85
region          box block 0 $x 0 $y -0.5 0.5
create_box      1 box bond/types 1 extra/bond/per/atom 6
region          circle sphere $(v_d/2+1) $(v_d/2/sqrt(3.0)+1) 0.0 $(v_d/2)
create_atoms    1 region circle
mass            1 1.0

velocity        all create 0.5 87287 loop geom
velocity        all set $v $w 0 sum yes

pair_style      lj/cut 2.5
pair_coeff      1 1 10.0 1.0 2.5

bond_style      harmonic
bond_coeff      1 10.0 1.2

create_bonds    many all all 1 1.0 1.5

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

fix             1 all nve

fix             2 all wall/lj93 xlo 0.0 1 1 2.5 xhi $x 1 1 2.5
fix             3 all wall/lj93 ylo 0.0 1 1 2.5 yhi $y 1 1 2.5

comm_style      tiled
fix             10 all balance 50 0.9 rcb

#compute         1 all property/atom proc
#variable        p atom (c_1%10)+1
#dump            2 all custom 50 tmp.dump id v_p x y z

#dump            3 all image 200 image.*.jpg v_p type bond atom 0.25 &
#                adiam 1.0 view 0 0 zoom 1.8 subbox yes 0.02
#variable        colors string &
#                ""red green blue yellow white &
#                purple pink orange lime gray""
#dump_modify     3 pad 5 amap 0 10 sa 1 10 ${colors}

thermo_style    custom step temp epair press f_10[3] f_10
thermo          100
timestep        0.001

run             40000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using meam pair style with pair coefficients * * FeTiClibrary.meam   Fe Ti C FeTiC.meam  C Fe and p p p boundary conditions.","
units           metal
atom_style      atomic
boundary        p p p

read_data data.fe

pair_style       meam
pair_coeff       * * FeTiClibrary.meam   Fe Ti C FeTiC.meam  C Fe

thermo 10

thermo_style custom step pe etotal fmax fnorm temp press
thermo_modify format 4*6 %14.10f

#dump equilibration all custom 1 dump.equilibration id type xu yu zu #v_Adam_m

min_style fire
minimize 0 1e-8 2000 2000

"
"Generate a LAMMPS input script for a NVE simulation of an charge system using smtbq pair style with pair coefficients * * ffield.smtbq.Al Al and p p p boundary conditions with a timestep of ${dt} running for 10 steps.","# Al2O3 crystal, qeq on, minimizes, then calculates elastic constants

variable T_depart equal 300
variable dt equal 0.0002

#Constante
variable rac3 equal sqrt(3.0)
variable rac1_2 equal sqrt(0.5)
variable rac3_2 equal sqrt(1.5)

#Structure
variable a equal 4.05

variable nx equal 10 
variable ny equal 7
variable nz equal 4

variable bx equal ${a}*${nx}*${rac1_2}
variable by equal ${a}*${ny}*${rac3_2}
variable bz equal ${a}*${nz}*${rac3}
# =======================================================================

units		metal
atom_style	charge
dimension       3
boundary        p p p


lattice		sc 1.0
region          box_vide prism 0 ${bx} 0 ${by} 0 ${bz} 0.0 0.0 0.0
create_box      1 box_vide

# Aluminium atoms z = [111]
lattice custom ${a} a1 ${rac1_2}  0.0      0.0 &
                    a2   0.0   ${rac3_2}   0.0 &
                    a3   0.0      0.0    ${rac3} &
                        basis 0.0 0.0 0.0 &
                        basis 0.5 0.5 0.0 &
                        basis 0.5 0.166666667 0.33333 &
                        basis 0.0 0.666666667 0.33333 &
                        basis 0.0 0.333333333 0.66667 &
                        basis 0.5 0.833333333 0.66667

create_atoms 	1 region box_vide

mass		1 26.98

velocity	all create ${T_depart} 277387

pair_style	smtbq
pair_coeff	* * ffield.smtbq.Al Al

neighbor	0.5 bin
neigh_modify	every 20 delay 0 check yes

timestep        ${dt}

thermo_style    custom step temp press pe ke etotal lx ly lz vol 
thermo_modify	flush yes
thermo		1


#dump            5 all custom 1 box_Al.lammpstrj id type q x y z  

fix		3 all nve
run		10

unfix		3
#thermo		15
fix             1 all box/relax tri 0.0 vmax 0.001
minimize        1.0e-8 1.0e-10 1000 10000

unfix		1
thermo		1
fix             3 all nve
run             10

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using mliap unified mliap_unified_lj_Ar.pkl 0 pair style with pair coefficients * * Ar running for 250 steps.","
# create pickle of unified model

python create_pickle here """"""
import lammps
import lammps.mliap

from lammps.mliap.mliap_unified_lj import MLIAPUnifiedLJ

def create_pickle():
    unified = MLIAPUnifiedLJ([""Ar""])
    unified.pickle('mliap_unified_lj_Ar.pkl')
""""""
python create_pickle invoke

# 3d Lennard-Jones melt

units           lj
atom_style      atomic

lattice         fcc 0.8442
region          box block 0 10 0 10 0 10
create_box      1 box
create_atoms    1 box
mass            1 1.0

velocity        all create 3.0 87287 loop geom

pair_style      mliap unified mliap_unified_lj_Ar.pkl 0
pair_coeff      * * Ar

neighbor        0.3 bin
neigh_modify    every 20 delay 0 check no

fix             1 all nve

#dump           id all atom 50 dump.melt

#dump           2 all image 25 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 1 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

#dump 4 all custom 1 forces.xyz fx fy fz

thermo          50
run             250

# clean up
shell rm -f mliap_unified_lj_Ar.pkl
"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using gran/hertz/history & pair style with pair coefficients * * and p p f boundary conditions with a timestep of ${dt} running for 20000 steps.","# pour particles into cone-shaped funnel, settle them, let them run out bottom

variable	name string funnel_pour

thermo_modify	flush yes
units 		si  
variable	PI equal 3.141592653589
variable	seed equal 14314

###############################################
# Geometry-related parameters
###############################################

variable	xlo equal 10
variable	xhi equal 40
variable	ylo equal 10
variable	yhi equal 40
variable	zlo equal -20
variable	zhi equal 50

variable	xc equal 25
variable	yc equal 25

variable	zconehi equal 50
variable	zconelo equal 10
variable	zcyllo equal 0
variable	radconelo equal 2
variable	radconehi equal 20

################################################
# Particle sizes
################################################

variable	rlo equal 0.25 
variable	rhi equal 0.5
variable	dlo equal 2.0*${rlo}
variable	dhi equal 2.0*${rhi}

variable 	skin equal ${rhi}

###############################################
# Granular contact parameters
###############################################

variable	coeffRes equal 0.1
variable	coeffFric equal 0.5

variable	density equal 1.0
variable	EYoung equal 10^5
variable 	Poisson equal 2.0/7.0
variable	GShear equal ${EYoung}/(2*(1+${Poisson})) 

variable	gravity equal 1.0

variable	reff equal 0.5*(${rhi}+${rlo})
variable	meff equal ${density}*4.0/3.0*${PI}*${reff}^3
variable	min_mass equal ${density}*4.0/3.0*${PI}*${rlo}*${rlo}*${rlo}
variable	max_mass equal ${density}*4.0/3.0*${PI}*${rhi}*${rhi}*${rhi}

## Typical way to set kn, kt, etc.:
variable        kn equal 4.0*${GShear}/(3*(1-${Poisson}))
variable        kt equal 4.0*${GShear}/(2-${Poisson})

variable	a equal (-2.0*log(${coeffRes})/${PI})^2
variable        gamma_n equal sqrt($a*2*${kn}/${min_mass}/(1+0.25*$a))
variable        gamma_t equal ${gamma_n}*0.5

variable	tcol equal ${PI}/sqrt(2*${kn}/${min_mass}-${gamma_n}/4.0)

variable	dt equal ${tcol}*0.05
timestep	${dt}

###############################################
variable	dumpfreq equal 1000
variable	logfreq equal 1000

newton 		off
atom_style	sphere

boundary	p p f

region		boxreg block ${xlo} ${xhi} ${ylo} ${yhi} ${zlo} ${zhi}
create_box	1 boxreg

pair_style	gran/hertz/history &
		${kn} ${kt} ${gamma_n} ${gamma_t} ${coeffFric} 1
pair_coeff	* *

neighbor        ${skin} multi
thermo 		${logfreq}

comm_style	brick
comm_modify 	mode multi group all vel yes
balance		1.1 shift xyz 20 1.1
fix		bal all balance 10000 1.1 shift xyz 20 1.01

####################### Options specific to pouring #########################

# insertion region for fix/pour

region	     	insreg cylinder z ${xc} ${yc} 10 30 50 side in units box

# define cone and cylinder regions - see lammps doc on region command
# note new open options

region	    	cylreg cylinder z ${xc} ${yc} ${radconelo} &
		${zcyllo} ${zconelo} side in units box &
		open 2 #Top is open
		
region		conereg cone z ${xc} ${yc} ${radconelo} ${radconehi} &
		${zconelo} ${zconehi} side in units box & 
		open 1 open 2 #Bottom and top are open

region		hopreg union 2 conereg cylreg

fix		grav all gravity ${gravity} vector 0 0 -1
fix		1 all nve/sphere


fix		hopper3 all wall/gran/region hertz/history &
                ${kn} ${kt} ${gamma_n} ${gamma_t} ${coeffFric} 1 region hopreg

fix		ins all pour 2000 1 42424 region insreg &
		diam range ${dlo} ${dhi} dens ${density} ${density}

#dump		1 all custom ${dumpfreq} ${name}.dump &
#		id type mass diameter x y z

#dump		2 all image 4000 image.*.jpg type type &
#		axes yes 0.8 0.02 view 60 -30 zoom 3.0 &
#                box no 0.0 axes no 0.0 0.0
#dump_modify	2 pad 6

thermo_style	custom step cpu atoms ke
thermo_modify	flush yes lost warn

# Initial run to fill up the cone

run		20000 
unfix 		ins
run		150000

# remove ""plug"" - need to redefine cylinder region & union

region	  	cylreg delete
region		hopreg delete
region	    	cylreg cylinder z ${xc} ${yc} ${radconelo} &
		${zcyllo} ${zconelo} side in units box &
		open 1 open 2 #Bottom & top are open

region		hopreg union 2 cylreg conereg

unfix		hopper3
fix		hopper3 all wall/gran/region hertz/history &
		${kn} ${kt} ${gamma_n} ${gamma_t} ${coeffFric} 1 region hopreg

run		100000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style with pair coefficients 1 1 .238 3.405 13.5 and f p p boundary conditions with a timestep of 5.0 running for 100 # 400 steps.","echo both
units    real
atom_style  atomic

lattice         fcc 5.405 origin 0.25 0.25 0.25
region     mdRegion   block -12 12 -3 3 -3 3
region     mdInternal block -10 10 -3 3 -3 3

# create atoms
boundary  f p p
create_box  1 mdRegion
create_atoms  1 region mdRegion
mass    1 39.95
pair_style  lj/cut 13.5
pair_coeff    1 1 .238 3.405 13.5

# specify interal/ghost atoms
group    internal region mdInternal
velocity  internal create 40 87287 mom yes loop geom # <<< NOTE

neighbor  5. bin
neigh_modify  every 10 delay 0 check no

#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc two_temperature  Ar_ttm.mat

fix_modify      AtC mesh read gaussianIC1d_hex.mesh

# fix a temperature
fix_modify AtC  fix temperature          all 20.0
fix_modify AtC  initial temperature      all 20.0
fix_modify AtC  initial electron_temperature all gaussian 0 0 0 1 0 0 5 20 20
fix_modify AtC  fix electron_temperature     all gaussian 0 0 0 1 0 0 5 20 20

# turn on thermostat
fix_modify AtC extrinsic exchange off
fix_modify AtC  control thermal rescale 10

# equilibrate MD field
timestep  5.0
thermo    10

#output
fix_modify      AtC  output        gaussianIC1d_hexFE 10 text

# change thermostat
fix_modify AtC  unfix          temperature all
fix_modify AtC  unfix electron_temperature all
fix_modify AtC  control thermal flux
fix_modify AtC extrinsic exchange on
fix_modify AtC extrinsic electron_integration explicit 10

# run with FE
thermo_style custom step temp pe f_AtC[2] f_AtC[4]
reset_timestep 0
run     100 # 400
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.45 pair style with pair coefficients * * 0.0 0.0 2.45 and p p f boundary conditions with a timestep of 4.0 running for 7500 steps.","#===========================================================================#
# Rigid sphere freely moving near a stationary plane wall in a system       #
#   undergoing shear flow.                                                  # 
# Every 10 time steps the center of mass velocity and angular velocity of   #
#   the sphere are printed to the screen.                                   #
# To run this example, LAMMPS needs to be compiled with a the following     #
# packages: RIGID, LATBOLTZ                                                 #
#                                                                           #
#===========================================================================# 

units          micro
dimension      3
boundary       p p f
atom_style     atomic

#----------------------------------------------------------------------------
# Need a neighbor bin size smaller than the lattice-Boltzmann grid spacing
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid.
# The arguments for neigh_modify have been set to ""delay 0 every 1"", again
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid.  However, these values can likely
#   be somewhat increased without issue.  If a problem does arise (a particle
#   is outside of its processors LB grid) an error message is printed and 
#   the simulation is terminated.   
# The communcation cutoff is set to 2.5 dx to ensure that all particles in the
#   processor ghost fluid region (of width 2dx) are known to local processor.
#----------------------------------------------------------------------------
neighbor       1.0 bin
neigh_modify   delay 0 every 1 
comm_modify cutoff 10.0

read_data      data.one_radius16d2

#----------------------------------------------------------------------------
# None of the particles interact with one another.
#----------------------------------------------------------------------------
pair_style     lj/cut 2.45
pair_coeff     * * 0.0 0.0 2.45
neigh_modify   exclude type 1 1 

mass           * 1.0

timestep       4.0

group          sphere1 id <> 1 320

#----------------------------------------------------------------------------
# Colloidal particle is initially stationary.
#----------------------------------------------------------------------------
velocity       all set 0.0 0.0 0.0 units box

#----------------------------------------------------------------------------
# Create a lattice-Boltzmann fluid covering the simulation domain.
# All of the particles in the simulation apply a force to the fluid.
#   (however, this fix does not explicitly apply a force back on to these 
#    particles...this is accomplished through the use of the lb/viscous fix.
# Use a fluid density = 1.0, fluid viscosity = 1.0 (water), and a lattice
#   spacing dx=4.0.
# Use the trilinear interpolation stencil (default) to distribute the force
#   from a given particle onto the fluid mesh.
# Create shear in the system, by giving the upper z-wall a velocity of 0.0001
#   along the y-direction, while keeping the lower z-wall stationary.
#-----------------------------------------------------------------------------
fix   1 all lb/fluid 1 1.0 1.0 dx 4.0 zwall_velocity 0.0 0.0001

#----------------------------------------------------------------------------
# Apply the force due to the fluid onto the particles.
#----------------------------------------------------------------------------
fix   2 all lb/viscous

#----------------------------------------------------------------------------
# Integrate the motion of the particles, constraining them to move and 
#   rotate together as a single rigid spherical object.  Use the first
#   version to allow the sphere to freely rotate and move with the fluid 
#   and the 2nd version to measure the force and torque on a fixed sphere
#   in the shear flow which will allow you to measure the Stokes drag and
#   torque on the sphere.
#----------------------------------------------------------------------------
fix   3 all rigid group 1 sphere1
#fix   3 all rigid group 1 sphere1 force * off off off torque * off off off

#----------------------------------------------------------------------------
# Create variables for the center-of-mass velocities, angular velocities, and 
#   force and torque on the CM.  Then output these quantities to the screen.
#----------------------------------------------------------------------------
variable vx equal vcm(all,x)
variable vy equal vcm(all,y)
variable vz equal vcm(all,z)
variable omegax equal omega(all,x)
variable omegay equal omega(all,y)
variable omegaz equal omega(all,z)
variable fx equal fcm(all,x)
variable fy equal fcm(all,y)
variable fz equal fcm(all,z)
variable tx equal torque(all,x)
variable ty equal torque(all,y)
variable tz equal torque(all,z)

thermo_style   custom v_vx v_vy v_vz v_omegax v_omegay v_omegaz v_fx v_fy v_fz v_tx v_ty v_tz
thermo         100

run   7500"
"Generate a LAMMPS input script for a general simulation of an spin system using spin/exchange 3.5 pair style with pair coefficients * * exchange 3.4 0.02726 0.2171 1.841 and p p f boundary conditions with a timestep of 0.0001.","
units 		metal
dimension 	3
boundary 	p p f
atom_style 	spin

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

# setting mass, mag. moments, and interactions for bcc iron
# (mass not necessary for fixed lattice calculation)

read_data       initial.iron_spin
mass		1 55.845

pair_style 	spin/exchange 3.5
pair_coeff 	* * exchange 3.4 0.02726 0.2171 1.841

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin zeeman 0.1 0.0 0.0 1.0 anisotropy 0.0001 1.0 0.0 0.0 
fix_modify	1 energy yes
fix		3 all neb/spin 1.0  

timestep	0.0001
thermo		100

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	magx      equal c_out_mag[1]
variable 	magy      equal c_out_mag[2]
variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]

thermo          100
thermo_style    custom step time v_magx v_magz v_magnorm etotal
thermo_modify   format float %20.15g

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
variable	u universe 1 2 3 4
dump 		1 all custom 200 dump.$u type x y z c_outsp[1] c_outsp[2] c_outsp[3]

min_style	spin
min_modify 	alpha_damp 1.0 discrete_factor 10.0
neb/spin	1.0e-12 1.0e-12 200000 100000 1000 final final.iron_spin verbose
"
"Generate a LAMMPS input script for a general simulation of an smd system using hybrid/overlay smd/tri_surface 1.0 & pair style with pair coefficients 1 1 smd/ulsph *COMMON ${rho} ${c0} ${q1} ${cp} ${hg} & and f f f # simulation box boundaries boundary conditions running for 0 # This is important! Always  for 0 timesteps directly after loading STL file! steps.","####################################################################################################
#
# ULSPH example: water flow through a complex geometry read from a .STL file
#
# The boundary dump file (see below) can be converted into VTK format using the conversion
# tool dump2vtk_tris from the tools/smd directory.
#
# unit system: GPa / mm / ms
#
####################################################################################################

####################################################################################################
# MATERIAL PARAMETERS
####################################################################################################
variable        c0 equal 10.0 # speed of sound for fluid
variable        rho equal 1.0e-6 # initial mass density
variable        q1 equal 0.06 # standard artificial viscosity linear coefficient
variable        q2 equal 0.0  # standard artificial viscosity quadratic coefficient
variable        hg equal 0.0 # hourglass control coefficient
variable        cp equal 1.0 # heat capacity of material -- not used here
variable        K equal ${c0}*${rho}^2
variable        contact_stiffness equal 0.1*${K}

####################################################################################################
# INITIALIZE LAMMPS
####################################################################################################
dimension       3
units           si
boundary        f f f # simulation box boundaries
atom_style      smd
atom_modify	map array
comm_modify     vel yes
comm_style      tiled
neigh_modify    every 10 delay 0 check yes exclude type 2 2 one 10000
newton          off

####################################################################################################
# CREATE INITIAL GEOMETRY
####################################################################################################
variable        l0 equal 5.0 # lattice spacing for creating particles
lattice         sc ${l0}
region          box block -110 60 -30 220 -90 130 units box
create_box      2 box
region          particles cylinder y 0 -30 47 135 200 units box
create_atoms    1 region particles
group           water type 1

####################################################################################################
# DISCRETIZATION PARAMETERS
####################################################################################################
variable        h equal 2.01*${l0} # SPH smoothing kernel radius
variable        vol_one equal ${l0}^3 # volume of one particle -- assuming unit thickness
variable        skin equal 0.1*${h} # Verlet list range
neighbor        ${skin} bin
variable        cr equal ${l0}/2
set             group all smd/contact/radius ${cr}
set             group all volume ${vol_one}
set             group all smd/mass/density ${rho}
set             group all diameter ${h} # set SPH kernel radius

####################################################################################################
# DEFINE GRAVITY BOUNDARY CONDITION
####################################################################################################
fix             gfix all gravity 0.01 vector 0.0 -1. 0.0

####################################################################################################
# INTERACTION PHYSICS / MATERIAL MODEL
# We use polynomial EOS for the pressure and the Johnson Cook strength model
# An integration point fails (cannot support tension anymore) if the plastic strain exceeds 0.5.
####################################################################################################
pair_style      hybrid/overlay smd/tri_surface 1.0 &
                smd/ulsph *DENSITY_CONTINUITY *VELOCITY_GRADIENT *NO_GRADIENT_CORRECTION
pair_coeff      1 1 smd/ulsph *COMMON ${rho} ${c0} ${q1} ${cp} ${hg} &
                *EOS_TAIT 2 &
                *END
pair_coeff      2 2 none
pair_coeff      1 2 smd/tri_surface ${contact_stiffness}

####################################################################################################
# LOAD STL SURFACE
####################################################################################################
fix             stl_surface_fix all smd/wall_surface boundary.stl 2 65535
run             0 # This is important! Always run for 0 timesteps directly after loading STL file!
group           surface type 2

####################################################################################################
# TIME INTEGRATION
####################################################################################################
fix             force_fix surface setforce 0 0 0
fix             dtfix all smd/adjust_dt 0.1 # dynamically adjust time increment every step
fix             integration_fix all smd/integrate_ulsph adjust_radius 1.01 10 15

####################################################################################################
# SPECIFY TRAJECTORY OUTPUT
####################################################################################################
variable        dumpFreq equal 100
compute         rho all smd/rho
compute         nn all smd/ulsph/num/neighs # number of neighbors for each particle
compute         contact_radius all smd/contact/radius
compute         surface_coords surface smd/triangle/vertices


dump            dump_id water custom ${dumpFreq} dump.LAMMPS id type x y z vx vy vz &
                c_rho c_nn c_contact_radius proc
dump_modify     dump_id first yes

dump            surf_dump surface custom 999999999 surface.LAMMPS id type mol x y z  &
                  c_surface_coords[1] c_surface_coords[2] c_surface_coords[3]          &
                  c_surface_coords[4] c_surface_coords[5] c_surface_coords[6]          &
                  c_surface_coords[7] c_surface_coords[8] c_surface_coords[9]
dump_modify 	surf_dump first yes

####################################################################################################
# STATUS OUTPUT
####################################################################################################
compute         eint all smd/internal/energy
compute         alleint all reduce sum c_eint
variable        etot equal pe+ke+c_alleint+f_gfix # total energy of the system
thermo          100
thermo_style    custom step dt f_dtfix pe ke v_etot

####################################################################################################
# RUN SIMULATION
####################################################################################################
balance          1.1 rcb
fix              balance_fix all balance 200 1.1 rcb
run              5000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/class2 8 pair style and p p p boundary conditions running for 2000 steps at temperature 300.","# two molecules DGEBA (diepoxy) and one DETA (linker)
# two crosslinking reactions

units real

boundary p p p

atom_style full

pair_style lj/class2 8

angle_style class2

bond_style class2

dihedral_style class2

improper_style class2

special_bonds lj/coul 0 0 1
pair_modify tail yes mix sixthpower

read_data tiny_epoxy.data &
  extra/special/per/atom 25

velocity all create 300.0 4928459 dist gaussian

molecule mol1 rxn1_stp1_pre.molecule_template
molecule mol2 rxn1_stp1_post.molecule_template
molecule mol3 rxn1_stp2_post.molecule_template
molecule mol4 rxn2_stp1_pre.molecule_template
molecule mol5 rxn2_stp1_post.molecule_template
molecule mol6 rxn2_stp2_post.molecule_template

thermo 50

# dump 1 all xyz 1 test_vis.xyz
# dump_modify 1 types labels

fix rxns all bond/react stabilization yes statted_grp .03 &
  react rxn1_stp1 all 1 0.0 5 mol1 mol2 rxn1_stp1.map &
  react rxn1_stp2 all 1 0.0 5 mol2 mol3 rxn1_stp2.map &
  react rxn2_stp1 all 1 0.0 5 mol4 mol5 rxn2_stp1.map &
  react rxn2_stp2 all 1 0.0 5 mol5 mol6 rxn2_stp2.map


fix 1 statted_grp_REACT nvt temp 300 300 100

thermo_style custom step temp f_rxns[*]

run 2000

# write_restart restart_longrun
# write_data restart_longrun.data nofix
"
"Generate a LAMMPS input script for a general simulation of an atomic system and f p p boundary conditions with a timestep of ${dt} running for 40 steps.","# needs description
# DESCRIPTION: haynes-schockley
# continuity eqn: n,t = J,x + (G-R) = D n,xx + mu (n E),x + G - 1/tau (n - n_0)
# w/ J = D n,x + mu n phi,x
# poisson eqn for E-field: epsilon phi,xx = -e (n - p + N_D - N_A)
# w/ E = phi,x
# NOTE: does not conserve electrons even with fixed E field and zero mobility
# if J=0 --> n,x = mu/D n phi,x

echo both
units    metal

variable E equal  10.0
variable n0 equal 0.0001
variable dn equal 2.0*${n0}
variable dt equal 0.0000001

timestep  ${dt}

atom_style  atomic
lattice         fcc 1.0 
region    simRegion block -50 50  0 1 0 1
boundary  f p p
create_box  1 simRegion
mass    1 1.0 # need to keep this
atom_modify     sort 0 1

#          ID  group atc PhysicsType ParameterFile
fix        AtC all   atc drift_diffusion  Si_ddm.mat

#          ID  part keywords    nx ny nz region
fix_modify AtC mesh  create 100 1  1  simRegion f p p

fix_modify AtC mesh create_nodeset lbc -50.1 -49.9 -INF  INF -INF  INF
fix_modify AtC mesh create_nodeset rbc  49.9  50.1 -INF  INF -INF  INF

# fix a temperature
fix_modify AtC  initial temperature          all 300.0
fix_modify AtC  initial electron_temperature all 300.0
fix_modify AtC  initial electron_density all gaussian 0 0 0 1 0 0 5.0 ${dn} ${n0}
# isolate system: 
# diffusion: dn/dx = 0
# drift    : n = 0
fix_modify AtC  fix electron_density lbc ${n0}
fix_modify AtC  fix electron_density rbc ${n0}
fix_modify AtC  fix electric_potential all linear 0 0 0 $E 0 0 1
variable perm equal 0.06 
variable nD equal  1.0e-4 
fix_modify AtC  source electric_potential all ${nD}

variable s equal 10
thermo  $s
# f_AtC:1 thermal energy, 2 avg T, 3 electron energy, 4 avg Te, 5 total n
thermo_style custom step cpu f_AtC[1] f_AtC[2] f_AtC[3] f_AtC[4] f_AtC[5]
thermo_modify  format 1 %5i format 2 %7.2g
fix_modify      AtC  output   no_atoms_ddmFE $s text
fix_modify AtC extrinsic electron_integration implicit
run     40

# free electric field and allow shielding
fix_modify AtC  unfix electric_potential all
fix_modify AtC  fix electric_potential  lbc linear 0 0 0 $E 0 0 1
fix_modify AtC  fix electric_potential  rbc linear 0 0 0 $E 0 0 1
fix_modify AtC extrinsic electron_integration implicit 10
run     40
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using mliap unified mliap_unified_jax_Ar.pkl 0 pair style with pair coefficients * * Ar running for 250 steps.","# 3d Lennard-Jones melt

units           lj
atom_style      atomic

lattice         fcc 0.8442
region          box block 0 10 0 10 0 10
create_box      1 box
create_atoms    1 box
mass            1 1.0

velocity        all create 3.0 87287 loop geom

pair_style      mliap unified mliap_unified_jax_Ar.pkl 0
pair_coeff      * * Ar

neighbor        0.3 bin
neigh_modify    every 20 delay 0 check no

fix             1 all nve

#dump           id all atom 50 dump.melt

#dump           2 all image 25 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 1 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

#dump 4 all custom 1 forces.xyz fx fy fz

dump 1 all xyz 10 dump.xyz

thermo          1
run             250
"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using hybrid gran/hooke 4000.0 NULL 100.0 NULL 0.5 1 pair style with pair coefficients * * gran/hooke and f f f boundary conditions with a timestep of 0.005 running for 5000 steps.","# pouring spheres into container box

units		lj
atom_style      sphere
boundary        f f f
dimension	3
comm_modify     vel yes

region          box block -10 10 -10 10 -10 10 units box
create_box      2 box

pair_style	hybrid gran/hooke 4000.0 NULL 100.0 NULL 0.5 1
pair_coeff	* * gran/hooke

region          container block -6 6 -6 6 -6 6 units box
fix		container all wall/gran/region hooke/history &
		4000.0 NULL 100.0 NULL 0.5 1 region container

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix             2 all nve/sphere
fix		3 all gravity 1.0 vector 0 0 -1

region          slab block -2 2 -2 2 -2 2 units box
fix             ins all pour 100 2 4767548 vol 0.4 10 &
	        diam one 1.0 region slab ignore

timestep	0.005

compute         1 all temp
compute_modify  1 dynamic/dof yes

compute         2 all temp/sphere
compute_modify  2 dynamic/dof yes

thermo		100
thermo_style	custom step atoms temp c_1 c_2 press
thermo_modify   lost ignore
compute_modify  thermo_temp dynamic/dof yes

#dump		2 all image 100 image.*.jpg type type &
#		zoom 1.4 adiam 1.0 box no 0.0 axes yes 0.9 0.03
#dump_modify	2 pad 5

run	        5000

region          container delete
variable        theta equal (step-5000)*(4.0*PI/5000)
region          container block -6 6 -6 6 -6 6 units box &
                rotate v_theta 0 0 0 0 0 1
run	        5000

region          container delete
region          container block -6 6 -6 6 -6 6 units box
run             5000

region          container delete
variable        theta equal (step-15000)*(4.0*PI/5000)
region          container block -6 6 -6 6 -6 6 units box &
                rotate v_theta 0 0 0 1 1 1
run	        5000

region          container delete
region          container block -6 6 -6 6 -6 6 units box
run             5000
"
"Generate a LAMMPS input script for a general simulation of an smd system using smd/tlsph pair style with pair coefficients 1 1 *COMMON ${rho} ${E} ${nu} ${q1} ${q2} ${hg} ${cp} & and sm sm p # simulation box boundaries boundary conditions running for 2000 steps.","####################################################################################################
#
# TLSPH example:  elongate a 2d strip of aluminum py pulling its ends apart
#
# unit system: GPa / mm / ms
#
####################################################################################################

####################################################################################################
# MATERIAL PARAMETERS
####################################################################################################
variable        E equal 70.0  # Young's modulus
variable        nu equal 0.3  # Poisson ratio
variable        rho equal 1   # initial mass density
variable        q1 equal 0.56 # standard artificial viscosity linear coefficient
variable        q2 equal 0.0  # standard artificial viscosity quadratic coefficient
variable        hg equal 10.0 # hourglass control coefficient
variable        cp equal 1.0  # heat capacity of material -- not used here

variable        JC_A equal 0.3241 # Johnson Cook parameters
variable        JC_B equal 0.1138
variable        JC_N equal 0.42
variable        JC_C equal 0 #0.002
variable        JC_M equal 1.34
variable        JC_epsdot0 equal 1.0e-3 # 1/s = 1/(1000 ms)
variable        Troom equal 298.15
variable        Tmelt equal 500.15

variable        eosC0 equal 0.0 # Polynomial EOS parameters
variable        eosC1 equal 74.2
variable        eosC2 equal 60.5
variable        eosC3 equal 36.5
variable        eosC4 equal 1.96
variable        eosC5 equal 0.0
variable        eosC6 equal 0.0

####################################################################################################
# INITIALIZE LAMMPS
####################################################################################################
dimension       2
units           si
boundary        sm sm p # simulation box boundaries
atom_style      smd
atom_modify     map array
comm_modify     vel yes
neigh_modify    every 10 delay 0 check yes # re-build neighbor list every 10 steps
newton          off

####################################################################################################
# CREATE INITIAL GEOMETRY
####################################################################################################
variable        l0 equal 1.0 # lattice spacing for creating particles
lattice         sq ${l0}
region          box block -10 10 -10 10 -0.1 0.1 units box
create_box      1 box
create_atoms    1 box
group           tlsph type 1

####################################################################################################
# DISCRETIZATION PARAMETERS
####################################################################################################
variable        h equal 2.01*${l0} # SPH smoothing kernel radius
variable        vol_one equal ${l0}^2 # volume of one particle -- assuming unit thickness
variable        skin equal ${h} # Verlet list range
neighbor        ${skin} bin
set             group all volume ${vol_one}
set             group all smd/mass/density ${rho}
set             group all diameter ${h} # set SPH kernel radius

####################################################################################################
# DEFINE VELOCITY BOUNDARY CONDITIONS
####################################################################################################
variable        vel0 equal 0.02 # pull velocity
region          top block EDGE EDGE 9.0 EDGE EDGE EDGE units box
region          bot block EDGE EDGE EDGE -9.1 EDGE EDGE units box
group           top region top
group           bot region bot
variable        vel_up equal ${vel0}*(1.0-exp(-0.01*time))
variable        vel_down equal -v_vel_up
fix             veltop_fix top smd/setvel 0 v_vel_up 0
fix             velbot_fix bot smd/setvel 0 v_vel_down 0

####################################################################################################
# INTERACTION PHYSICS / MATERIAL MODEL
# We use polynomial EOS for the pressure and the Johnson Cook strength model
# An integration point fails (cannot support tension anymore) if the plastic strain exceeds 0.5.
####################################################################################################
pair_style      smd/tlsph
pair_coeff      1 1 *COMMON ${rho} ${E} ${nu} ${q1} ${q2} ${hg} ${cp} &
                *EOS_POLYNOMIAL ${eosC0} ${eosC1} ${eosC2} ${eosC3} ${eosC4} ${eosC5} ${eosC6} &
                *JOHNSON_COOK ${JC_A} ${JC_B}  ${JC_N} ${JC_C} ${JC_epsdot0} ${Troom} ${Tmelt} ${JC_M} &
                *FAILURE_MAX_PLASTIC_STRAIN 1.2 &
                *END

####################################################################################################
# TIME INTEGRATION
####################################################################################################
fix             dtfix tlsph smd/adjust_dt 0.1 # dynamically adjust time increment every step
fix             integration_fix tlsph smd/integrate_tlsph

####################################################################################################
# SPECIFY TRAJECTORY OUTPUT
####################################################################################################
compute         dt_atom all smd/tlsph/dt
compute         p all smd/plastic/strain
compute         epsdot all smd/plastic/strain/rate
compute         S all smd/tlsph/stress # Cauchy stress tensor
compute         D all smd/tlsph/strain/rate
compute         E all smd/tlsph/strain
compute         nn all smd/tlsph/num/neighs # number of neighbors for each particle
compute         shape all smd/tlsph/shape
compute         damage all smd/damage
dump            dump_id all custom 100 dump.LAMMPS id type x y z &
                c_S[1] c_S[2] c_S[3] c_S[4] c_S[5] c_S[6] c_S[7] c_nn c_p &
                c_E[1] c_E[2] c_E[3] c_E[4] c_E[5] c_E[6] &
                c_shape[1] c_shape[2] c_shape[3] c_shape[4] c_shape[5] c_shape[6] c_shape[7] &
                c_D[1] c_D[2] c_D[4] c_damage radius c_epsdot &
                vx vy vz c_dt_atom
dump_modify     dump_id first yes

####################################################################################################
# STATUS OUTPUT
####################################################################################################
variable        stress equal 0.5*(f_velbot_fix[2]-f_veltop_fix[2])/20
variable        length equal xcm(top,y)-xcm(bot,y)
variable        strain equal (v_length-${length})/${length} # engineering strain
variable        time equal f_dtfix
fix             stress_curve all print 10 ""${time} ${strain} ${stress}"" file stress_strain.dat screen no

thermo          100
thermo_style    custom step dt f_dtfix time v_strain

####################################################################################################
# RUN SIMULATION
####################################################################################################
#fix            2 all enforce2d
run             2000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 300 pre no post no every 100 steps.","# 3d Lennard-Jones melt - MDI driver script

variable        x index 5
variable        y index 5
variable        z index 5

units           lj
atom_style      atomic
atom_modify     map array

read_data       data.snapshot

velocity        all create 1.44 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

fix             1 all nve

fix             2 all mdi/qm add no every 100 virial yes

compute         1 all pressure NULL virial
variable        evirial equal (f_2[1]+f_2[2]+f_2[3])/3

thermo_style    custom step temp pe c_1 c_1[1] c_1[2] c_1[3]

thermo          100

dump            1 all custom 100 dump.snapshot.driver.plugin &
                id type x y z f_2[1] f_2[2] f_2[3]
dump_modify     1 sort id

mdi             plugin lammps mdi ""-role ENGINE -name LMP2 -method LINK"" &
                infile in.snapshot.engine &
                extra ""-log log.snapshot.engine.plugin"" &
                command """"""
                run 300 pre no post no every 100
                ""print 'QM eng = $(f_2/atoms)'""
                ""print 'QM virial = $(v_evirial) $(f_2[1]) $(f_2[2]) $(f_2[3])'""
                """"""
"
"Generate a LAMMPS input script for a NVE simulation running for 100 steps.","# 3d Lennard-Jones melt
#
# This example requires that the example models provided with
# the kim-api package are installed.  see the `./lib/kim/README` or
# `./lib/kim/Install.py` files for details on how to install these
# example models.
#

variable     x index 1
variable     y index 1
variable     z index 1

variable     xx equal 20*$x
variable     yy equal 20*$y
variable     zz equal 20*$z

kim          init LennardJones_Ar real

lattice      fcc 4.4300
region       box block 0 ${xx} 0 ${yy} 0 ${zz}
create_box   1 box
create_atoms 1 box

kim          interactions Ar

mass         1 39.95
velocity     all create 200.0 232345 loop geom

neighbor     0.3 bin
neigh_modify delay 0 every 1 check yes

fix          1 all nve
#fix         1 all npt temp 1.0 1.0 1.0 iso 1.0 1.0 3.0

run          100
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 1000 steps at temperature 0.7.","# compute stress/cartesian for a flat liquid-vapor interface

units           lj
atom_style      atomic
processors      * * 1

lattice         fcc 0.8442
region          box block 0 10 0 10 0 30
region    liquid block 0 10 0 10 10 20
create_box      1 box
create_atoms    1 region liquid
mass            1 1.0

velocity        all create 0.65 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    every 20 delay 0 check no

fix             1 all nvt temp 0.7 0.7 0.2

#dump           id all atom 50 dump.flat

#dump           2 all image 25 image.*.jpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    2 pad 3

#dump           3 all movie 25 movie.mpg type type &
#               axes yes 0.8 0.02 view 60 -30
#dump_modify    3 pad 3

fix 2 all recenter NULL NULL 15 units lattice
compute p1 all stress/cartesian z 0.5
fix 3 all ave/time 100 1 100 c_p1[*] file flat.out mode vector

thermo          50
thermo_style custom step temp epair emol etotal press c_p1[50][3] c_p1[50][4] c_p1[50][5] c_p1[50][6] c_p1[50][7] c_p1[50][8]

run             1000
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using extep pair style with pair coefficients * * BN.extep B N and p p p boundary conditions with a timestep of 0.0001 # ps running for 1000 steps at temperature 300.","# Initialization
units           metal
boundary        p p p
atom_style      atomic
processors      * * 1

# System and atom definition
read_data       BN.data     # read lammps data file

# Neighbor update settings 
neighbor        2.0 bin
neigh_modify    every 1
neigh_modify    delay 0
neigh_modify    check yes

# Potential
pair_style      extep
pair_coeff      * * BN.extep B N

# Output 
thermo          10
thermo_style    custom step time etotal pe temp lx ly lz pxx pyy pzz

# Setup NPT MD run
timestep        0.0001 # ps
velocity        all create 300.0 12345
fix             thermos all npt temp 300 300 1.0 x 0 0 1.0 y 0 0 1.0
run 1000
"
"Generate a LAMMPS input script for a NVT simulation of an charge system using reaxff NULL safezone 3.0 mincap 150 pair style with pair coefficients * * qeq_ff.water O H and p p s boundary conditions with a timestep of 0.5 running for 20 steps at temperature 300.","# QEq Water, CITE: Achtyl et al., Nat. Comm., 6 6539 (2015)

boundary        p p s
units           real
atom_style      charge

read_data       data.water

variable        x index 1
variable        y index 1
variable        z index 1

replicate       $x $y $z

pair_style      reaxff NULL safezone 3.0 mincap 150
pair_coeff      * * qeq_ff.water O H
neighbor        0.5 bin
neigh_modify    every 1 delay 0 check yes

velocity all create 300.0 4928459 rot yes dist gaussian

fix             1 all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix             2 all nvt temp 300 300 50.0
fix             3 all efield 0.0 0.0 1.0
fix             4 all wall/reflect zlo EDGE zhi EDGE

timestep        0.5
thermo          10
thermo_style    custom step temp press density vol

run 20
"
"Generate a LAMMPS input script for a general simulation of an molecular system using lj/cut 5.88 pair style with pair coefficients * * 0.0 0.0 5.88 and p p f boundary conditions with a timestep of ${tstep} running for 10000 steps.","#===========================================================================#
# single particle drag tests                                                #
#                                                                           #
# Run consists of a colloidal particle being dragged with a constant force  #
# through an LB-fluid.  The colloidal particle could be single atom or      #
# be a composite particle.  Composite particles could be bonded or just     #
# rigidly constrained to stay together. You can set flags in the script to  #
# change these.                                                             #
#                                                                           #
# Sample output from this run can be found in the files with ""log.""         #
# located in the same directory.     	      	                            # 
#===========================================================================#

units          nano
dimension      3
boundary       p p f
atom_style     molecular

region mydomain block -24.0 24.0 -24.0 24.0 -24.0 24.0

#----------------------------------------------------------------------------
# Set up particles with n_nodes and decide if bonded or rigid
#----------------------------------------------------------------------------
variable n_nodes equal 4     # 1, 4, 6 are options with definitions below
variable is_bonded equal 0   # 0 or 1 (1 only if n_nodes > 1,
                             #    bond parameters set for n_node = 4 case)
variable stpts equal 3       # 2, 3, 4 number of stencil points in any direction.

variable tstep equal 0.00025

if ""${is_bonded} == 1"" then &
   ""create_box 1 mydomain bond/types 1 extra/bond/per/atom 6"" &
else &
   ""create_box 1 mydomain""

if ""${n_nodes} == 1"" then &
      ""create_atoms 1 single 0.0 0.0 0.0"" &
elif ""${n_nodes} == 4"" &
      ""create_atoms 1 single 0.0 0.0 0.204124"" &
      ""create_atoms 1 single -0.096225 -0.166667 -0.0680414"" &
      ""create_atoms 1 single -0.096225 0.166667 -0.0680414"" &
      ""create_atoms 1 single 0.19245 0. -0.0680414"" &
elif ""${n_nodes} == 6"" &
      ""create_atoms 1 single 0.204124  0.0000000  0.0000000""  &
      ""create_atoms 1 single -0.204124  0.0000000  0.0000000"" &
      ""create_atoms 1 single 0.0000000  0.204124  0.0000000""  &
      ""create_atoms 1 single 0.0000000  -0.204124  0.0000000"" &
      ""create_atoms 1 single 0.0000000  0.0000000  0.204124""  &
      ""create_atoms 1 single 0.0000000  0.0000000  -0.204124""

#----------------------------------------------------------------------------
# Need a neighbor bin size smaller than the lattice-Boltzmann grid spacing   
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid. 
# The arguments for neigh_modify have been set to ""delay 0 every 1"", again
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid.  However, these values can likely
#   be somewhat increased without issue.  If a problem does arise (a particle
#   is outside of its processors LB grid) an error message is printed and 
#   the simulation is terminated.                                 
#---------------------------------------------------------------------------- 
neighbor 0.3 bin
neigh_modify delay 0 every 1 check yes

comm_modify cutoff 2.5       # cutoff for communcation shoud be at least 2 dx

#----------------------------------------------------------------------------
# Implement a hard-sphere interactions between particles & create bonds
#----------------------------------------------------------------------------
pair_style	lj/cut 5.88
pair_coeff	* * 0.0 0.0 5.88

variable total_mass equal 0.002398       # particle mass
variable node_mass equal ""v_total_mass / v_n_nodes""
mass * ${node_mass}

if ""${is_bonded} == 1"" then &
   ""bond_style harmonic"" &
   ""bond_coeff 1 1.0 0.333333333"" &
   ""create_bonds many all all 1 0.3 0.35""

#velocity all set 0.02 0.0 0.0       

#----------------------------------------------------------------------------
# Define external forces (SHOULD COME BEFORE lb/fluid and lb/viscous FIXes) 
# to drag particles through the fluid.
#----------------------------------------------------------------------------
variable total_force equal 1.0        # total external force on the particle
variable node_force equal ""v_total_force / v_n_nodes""
variable oscillateY equal cos(step*0.0005)/(-0.03+400*v_tstep)/v_n_nodes
variable oscillateZ equal cos(step*0.0003)/(-0.03+400*v_tstep)/v_n_nodes
fix drag all addforce ${node_force} v_oscillateY v_oscillateZ

#---------------------------------------------------------------------------
# Create a lattice-Boltzmann fluid covering the simulation domain.
# This fluid feels a force due to the particle (group all here)
#   (however, this fix does not explicity apply a force back on to these 
#    particles...this is accomplished through the use of the lb/viscous fix).
# Use a fluid viscosity = 1.0, fluid density= 0.0009982071,(i.e. water) and
# lattice spacing dx=1.2.
# Different "".log"" files in this directory show the output with the stencil
# option being stencil 2, stencil 3, and stencil 4 (triliner, IBM, Key's).
#----------------------------------------------------------------------------
timestep ${tstep}
fix   FL all lb/fluid 1 1.0 0.0009982071 stencil ${stpts} dx 1.2
#dumpxdmf 1000 fflow

#----------------------------------------------------------------------------
# Apply the force from the fluid to the particles, and integrate their 
#   motion, constraining them to move and rotate together as a single rigid 
#   spherical object or an elastically bonded object 
#----------------------------------------------------------------------------
fix   2 all lb/viscous

if ""${n_nodes} == 1 || ${is_bonded} == 1"" then &
   ""fix   3 all nve"" &
else & 
   ""fix   3 all rigid group 1 all"" 

#----------------------------------------------------------------------------
# Create variables containing the positions/velocity of the colloids center 
#   of mass.
#----------------------------------------------------------------------------
variable cmx equal xcm(all,x)
variable cmy equal xcm(all,y)
variable cmz equal xcm(all,z)

variable vcmx equal vcm(all,x)
variable vcmy equal vcm(all,y)
variable vcmz equal vcm(all,z)

if ""${is_bonded} == 1"" then &
   ""variable comdatafile string drag_nb${n_nodes}_st${stpts}_dt${tstep}.out"" &
else &
   ""variable comdatafile string drag_n${n_nodes}_st${stpts}_dt${tstep}.out"" 

#fix printCM all print 100 ""$(step) ${cmx} ${cmy} ${cmz} ${vcmx} ${vcmy} ${vcmz}"" file ${comdatafile} screen no

run    10000
#run   100000

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using sw pair style with pair coefficients * * Si.sw Si and p p p boundary conditions with a timestep of 0.0001 running for 1000 steps.","units           metal
atom_style      atomic
boundary        p p p

lattice diamond 5.4309
region box block 0 10 0 10 0 10
create_box 1 box
mass 1 28.0855
create_atoms 1 box basis 1 1 basis 2 1 basis 3 1 basis 4 1 basis 5 1 basis 6 1 basis 7 1 basis 8 1

pair_style      sw
pair_coeff      * * Si.sw Si

neighbor        2.0 bin
neigh_modify    every 5 delay 0 check yes

fix             1 all nve
fix             twotemp all ttm/mod 1354684 Si.ttm_mod 10 10 10 set 1000.0 # outfile 100 T_out.txt

compute         pe all pe/atom
compute         ke all ke/atom

timestep        0.0001
thermo          100

thermo_style    custom step temp etotal f_twotemp[1] f_twotemp[2]
                thermo_modify format float ""%20.16g""

run             1000
"
"Generate a LAMMPS input script for a general simulation of an edpd system using edpd 1.58 9872598 pair style with pair coefficients 1 1 18.75 4.5 0.41 1.58 1.41E-5 2.0 1.58 & and p p p boundary conditions with a timestep of 0.01 running for 500 steps.","########################################################################
### Heat conduction analog of periodic Poiseuille flow problem       ###
### using energy-conserving DPD (eDPD) simulation                    ###
###                                                                  ### 
### Created  : Zhen Li (zhen_li@brown.edu)                           ### 
###            Division of Applied Mathematics, Brown University.    ###
###                                                                  ###
### mDPD system setup follows Fig.12 in the publication:             ###
### Z. Li, Y.-H. Tang, H. Lei, B. Caswell and G.E. Karniadakis.      ###
### ""Energy-conserving dissipative particle dynamics with            ###
### temperature-dependent properties"". J. Comput. Phys.,             ###
### 2014, 265: 113-127. DOI: 10.1016/j.jcp.2014.02.003               ###
########################################################################
units                   lj
dimension               3
boundary                p p p
neighbor                0.2 bin
neigh_modify        every 1 delay 0 check yes

atom_style              edpd
comm_modify vel yes

region     edpd     block -10 10 -10 10 -5 5 units box
create_box          1 edpd
create_atoms        1 random 16000 276438 NULL
mass                1 1.0
set                 atom * edpd/temp 1.0
set                 atom * edpd/cv 1.0E5

pair_style          edpd 1.58 9872598 
#pair_coeff          1 1 18.75 4.5 0.41 1.58 1.45E-5 2.0 1.58
pair_coeff          1 1 18.75 4.5 0.41 1.58 1.41E-5 2.0 1.58 &
                        power 10.54 -3.66 3.44 -4.10 &
                        kappa -0.44 -3.21 5.04  0.00

compute             mythermo all temp
thermo              100
thermo_modify       temp mythermo
thermo_modify       flush yes

velocity            all create 1.0 432982 loop local dist gaussian

region upper block -10.0  10.0   0.0 10.0 -5.0 5.0
region lower block -10.0  10.0 -10.0  0.0 -5.0 5.0

fix         mvv     all mvv/edpd 0.5
fix         upper   all edpd/source region upper  0.011
fix         lower   all edpd/source region lower -0.011

timestep            0.01
run                 500
reset_timestep      0

compute     temp    all edpd/temp/atom
compute     ccT     all chunk/atom bin/1d y 0.0 1.0 
fix         stat    all ave/chunk 1 500 500 ccT c_temp density/number norm sample file temp.profile

run                 500
"
"Generate a LAMMPS input script for a NVE simulation of an full system using zero 1.0 pair style with pair coefficients * *.","# minimize water model with LATTE and FIRE

units           metal
atom_style      full

read_data       data.water

# replicate system if requested

variable        x index 1
variable        y index 1
variable        z index 1

variable        nrep equal v_x*v_y*v_z
if              ""${nrep} > 1"" then ""replicate $x $y $z""

# initialize system

velocity        all create 0.0 87287 loop geom

pair_style      zero 1.0
pair_coeff      * *

neighbor        1.0 bin
neigh_modify    every 1 delay 0 check yes

fix             1 all nve

fix             2 all mdi/qm virial yes elements O H
fix_modify      2 energy yes

thermo_style    custom step temp pe etotal press

# minimization

thermo          10

min_style       fire
minimize        1.0e-4 1.0e-4 500 500
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using eim pair style with pair coefficients * * Na Cl ffield.eim Na Cl and p p p boundary conditions with a timestep of 0.001 running for 500 steps at temperature 1400.0.","# NaCl test problem for embedded atom method (EIM) potential

units		metal
atom_style      atomic

boundary	p p p

lattice         diamond 5.0
read_data       data.eim

pair_style      eim
pair_coeff      * * Na Cl ffield.eim Na Cl 

neighbor	0.3 bin
neigh_modify	delay 0

timestep        0.001
thermo_style    custom step pe pxx pyy pzz temp
thermo          50

velocity        all create 1400.0 43454 dist gaussian mom yes
fix             int all npt temp 1400.0 300.0 0.1 aniso 0.0 0.0 0.1

#dump		id all atom 100 dump.eim

#dump		2 all image 25 image.*.jpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	2 pad 3 element Na Cl

#dump		3 all movie 25 movie.mpg element element &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	3 pad 3 element Na Cl

run             500
"
"Generate a LAMMPS input script for a NPT simulation of an sphere system using colloid 12.5 pair style with pair coefficients 1 1  1.0 1.0 5.0 5.0 12.5 with a timestep of 0.005 running for 50000 steps at temperature 2.0.","# Big colloid particles and small LJ particles

units		lj
atom_style	sphere
dimension	2

lattice		sq 0.01
region		box block 0 30 0 30 -0.5 0.5
create_box	2 box
create_atoms	1 box

set		group all type/fraction 2 0.96 23984

set		type 1 mass 9
set		type 2 mass 1

velocity	all create 1.44 87287 loop geom

# multi neighbor and comm for efficiency

neighbor	1 multi
neigh_modify	delay 0
comm_modify     mode multi

# colloid potential

pair_style	colloid 12.5
pair_coeff	1 1  1.0 1.0 5.0 5.0 12.5
pair_coeff	1 2  5.0 1.0 5.0 0.0 7.0
pair_coeff	2 2 10.0 1.0 0.0 0.0 2.5

fix		1 all npt temp 2.0 2.0 1.0 iso 0.0 1.0 10.0 drag 1.0 &
	        mtk no pchain 0 tchain 1
fix		2 all enforce2d

#dump		1 all atom 1000 dump.colloid

#dump		2 all image 1000 image.*.jpg type type &
#		zoom 1.5 center d 0.5 0.5 0.5
#dump_modify	2 pad 5 adiam 1 5.0 adiam 2 1.5

#dump		3 all movie 1000 movie.mpg type type &
#		zoom 1.5 center d 0.5 0.5 0.5
#dump_modify	3 pad 5 adiam 1 5.0 adiam 2 1.5

thermo_style	custom step temp epair etotal press vol
thermo		1000

timestep	0.005

run		50000
"
"Generate a LAMMPS input script for a general simulation using zbl ${zblcutinner} ${zblcutouter} pair style with pair coefficients * * ${zblz} ${zblz} and p p p boundary conditions running for ${nsteps} steps.","# Demonstrate bispectrum computes

# initialize simulation

variable 	nsteps index 0
variable 	nrep equal 1
variable 	a equal 2.0
units		metal

# generate the box and atom positions using a BCC lattice

variable 	nx equal ${nrep}
variable 	ny equal ${nrep}
variable 	nz equal ${nrep}

boundary	p p p

atom_modify	map hash
lattice         bcc $a
region		box block 0 ${nx} 0 ${ny} 0 ${nz}
create_box	2 box
create_atoms	2 box

mass 		* 180.88

displace_atoms 	all random 0.1 0.1 0.1 123456

# set up reference potential

variable 	zblcutinner equal 4
variable 	zblcutouter equal 4.8
variable 	zblz equal 73
pair_style 	zbl ${zblcutinner} ${zblcutouter}
pair_coeff 	* * ${zblz} ${zblz}

# choose SNA parameters

variable 	twojmax equal 2
variable 	rcutfac equal 1.0
variable 	rfac0 equal 0.99363
variable 	rmin0 equal 0
variable 	radelem1 equal 2.3
variable 	radelem2 equal 2.0
variable	wj1 equal 1.0
variable	wj2 equal 0.96
variable	quadratic equal 0
variable	bzero equal 0
variable	switch equal 0
variable 	snap_options string &
""${rcutfac} ${rfac0} ${twojmax} ${radelem1} ${radelem2} ${wj1} ${wj2} rmin0 ${rmin0} quadraticflag ${quadratic} bzeroflag ${bzero} switchflag ${switch}""

# set up per-atom computes

compute 	b all sna/atom ${snap_options}
compute 	vb all snav/atom ${snap_options}
compute 	db all snad/atom ${snap_options}

# perform sums over atoms

group 		snapgroup1 type 1
group 		snapgroup2 type 2
compute         bsum1 snapgroup1 reduce sum c_b[*]
compute         bsum2 snapgroup2 reduce sum c_b[*]
# fix 		bsum1 all ave/time 1 1 1 c_bsum1 file bsum1.dat mode vector
# fix 		bsum2 all ave/time 1 1 1 c_bsum2 file bsum2.dat mode vector
compute		vbsum all reduce sum c_vb[*]
# fix 		vbsum all ave/time 1 1 1 c_vbsum file vbsum.dat mode vector
variable	db_2_25 equal C_db[2][25]

thermo 		100

# test output:   1: total potential energy
#                2: xy component of stress tensor
#                3: Sum(B_{000}^i, all i of type 2) 
#                4: xz component of Sum(Sum(r_j*dB_{222}^i/dR[j]), all i of type 2), all j)
#                5: y component of -Sum(d(B_{222}^i)/dR[2]), all i of type 2)
#
#                followed by 5 counterparts from compute snap

# run compute mliap with gradgradflag = 1

compute   	snap all mliap descriptor sna compute.mliap.descriptor model linear gradgradflag 1
fix 		snap all ave/time 1 1 1 c_snap[*] file compute.snap.gg1.dat mode vector

thermo_style	custom &
		pe            pxy            c_bsum2[1]   c_vbsum[55]    v_db_2_25 &
		c_snap[1][13] c_snap[13][13] c_snap[1][8] c_snap[12][12] c_snap[6][12] 
thermo_modify 	norm no

run             ${nsteps}

uncompute	snap
unfix		snap

# run compute mliap with gradgradflag = 0

compute   	snap all mliap descriptor sna compute.mliap.descriptor model linear gradgradflag 0
fix 		snap all ave/time 1 1 1 c_snap[*] file compute.snap.gg0.dat mode vector

thermo_style	custom &
		pe            pxy            c_bsum2[1]   c_vbsum[55]    v_db_2_25 &
		c_snap[1][13] c_snap[13][13] c_snap[1][8] c_snap[12][12] c_snap[6][12] 
thermo_modify 	norm no

run             ${nsteps}
"
"Generate a LAMMPS input script for a NVE simulation of an charge system using lj/cut/coul/long ${cut_lj} ${cut_long} pair style with pair coefficients * *  ${epsilon} ${sigma} with a timestep of ${} running for 2000 steps.","# Charge regulation lammps for simple weak electrolyte

units           real
atom_style      charge
neighbor        10.0 bin
read_data       data.chreg-acid-real

#real units
variable        sigma equal 7.2               # particle diameter 0.72 nm
variable        temperature equal 298         # temperature 298 K
variable        kb index 0.0019872067         # kB in Kcal/mol/K
variable        epsilon equal ${kb}*${temperature}
variable        tunit   equal   2000          # time unit is 2000 fs
variable        timestep equal 0.005*${tunit}

variable        cut_long equal 12.5*${sigma}
variable        nevery equal 100
variable        nmc equal 100
variable        pH equal 7.0
variable        pKa equal 6.0
variable        pIm equal 3.0
variable        pIp equal 3.0

variable        cut_lj equal 2^(1.0/6.0)*${sigma}
velocity        all create ${temperature} 8008 loop geom

pair_style      lj/cut/coul/long ${cut_lj} ${cut_long}
pair_coeff      * *  ${epsilon} ${sigma}
kspace_style    pppm 1.0e-3
dielectric      78
pair_modify     shift yes

#########  VERLET INTEGRATION WITH LANGEVIN THERMOSTAT  ###########
fix             fnve all nve
compute         dtemp all temp
compute_modify  dtemp dynamic/dof yes
fix             fT all langevin $(v_temperature) $(v_temperature) $(v_tunit) 123
fix_modify      fT temp dtemp

fix chareg      all charge/regulation 2 3 acid_type 1 pH ${pH} pKa ${pKa} pIp ${pIp} pIm ${pIm} lunit_nm 0.1 nevery ${nevery} nmc ${nmc} seed 2345 tempfixid fT
thermo          100
thermo_style custom step pe c_dtemp f_chareg[1] f_chareg[2] f_chareg[3] f_chareg[4] f_chareg[5] f_chareg[6] f_chareg[7] f_chareg[8]
timestep        ${timestep}
run             2000
"
"Generate a LAMMPS input script for a NVE simulation of an molecular system using hybrid/overlay table spline 500 local/density pair style with pair coefficients 1     1    table          benzene_water.pair.table      PairBB and p p p boundary conditions with a timestep of 2.0 running for 5000 steps.","# LAMMPS input file for 26.5% benzene mole fraction solution
# with 380 benzene and 1000 water molecules,
# using all possible local density potentials
# between benzene and water
#
# Author: Tanmoy Sanyal, Shell Group, UC Santa Barbara
#
# Refer: Sanyal and Shell, JPC-B, 2018, 122 (21), 5678-5693



# Initialize simulation box
dimension       3
boundary        p p p
units           real
atom_style      molecular

# Set potential styles
pair_style      hybrid/overlay table spline 500 local/density

# Read molecule data and set initial velocities
read_data       benzene_water.data
velocity        all create  3.0000e+02 16611 rot yes dist gaussian

# Assign potentials
pair_coeff          1     1    table          benzene_water.pair.table      PairBB
pair_coeff          1     2    table          benzene_water.pair.table      PairWW
pair_coeff          2     2    table          benzene_water.pair.table      PairBW
pair_coeff          *     *    local/density  benzene_water.localdensity.table

# Recentering during minimization and equilibration
fix recentering all recenter 0.0 0.0 0.0 units box

# Thermostat & time integration
timestep        2.0
thermo          100
thermo_style    custom temp ke pe etotal ebond eangle edihed evdwl

# Minimization
minimize        1.e-4 0.0 10000 10000

# Set up integration parameters
fix             timeintegration all nve
fix             thermostat all langevin  3.0000e+02  3.0000e+02  1.0000e+02 81890

# Equilibration (for realistic results, run for 5000000 steps)
reset_timestep  0
run             5000

# Turn off recentering during production phase
unfix recentering
reset_timestep  0

# Setup trajectory output
#dump            myDump all custom 100 benzene_water.lammpstrj.gz id type x y z element
#dump_modify     myDump element B W
#dump_modify     myDump sort id

# Production (for realistic results, run for 10000000 steps)
run             1000


"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 2.5 and p s p boundary conditions with a timestep of 0.05.","# 2d NEB surface simulation, hop from surface to become adatom

dimension       2
boundary        p s p

atom_style      atomic
neighbor        0.3 bin
neigh_modify    delay 5
atom_modify     map array sort 0 0.0

variable        u uloop 20

# create geometry with flat surface

lattice         hex 0.9
region          box block 0 20 0 10 -0.25 0.25

#create_box     3 box
#create_atoms   1 box
#mass           * 1.0
#write_data      initial.hop1

read_data        initial.hop1

# LJ potentials

pair_style      lj/cut 2.5
pair_coeff      * * 1.0 1.0 2.5
pair_modify     shift yes

# initial minimization to relax surface

minimize        1.0e-6 1.0e-4 1000 10000
reset_timestep  0

# define groups

region          1 block INF INF INF 1.25 INF INF
group           lower region 1
group           mobile subtract all lower
set             group lower type 2

timestep        0.05

# group of NEB atoms - either block or single atom ID 412

region          surround block 10 18 17 20 0 0 units box
group           nebatoms region surround
#group          nebatoms id 412
set             group nebatoms type 3
group           nonneb subtract all nebatoms

fix             1 lower setforce 0.0 0.0 0.0
fix             2 nebatoms neb 1.0 parallel ideal
fix             3 all enforce2d

thermo          100

#dump            1 nebatoms atom 10 dump.neb.$u
#dump            2 nonneb atom 10 dump.nonneb.$u

# run NEB for 2000 steps or to force tolerance

min_style       quickmin

neb             0.0 0.1 1000 1000 100 final final.hop1
"
"Generate a LAMMPS input script for a NVE simulation of an full system and p p p boundary conditions with a timestep of 0.1 running for 5000 steps.","# GJF-2GJ thermostat

units   	metal
atom_style      full

boundary 	p p p
read_data argon.lmp

include ff-argon.lmp

velocity all create 10 2357 mom yes dist gaussian

neighbor 1 bin

timestep 0.1

fix lang all langevin 10 10 1 26488 gjf vfull
fix nve all nve

thermo 200
run 5000


"
"Generate a LAMMPS input script for a NVE simulation of an charge system using tersoff shift 0.05 pair style with pair coefficients * * BNC.tersoff B N and p p p boundary conditions with a timestep of 0.001 running for 1000 steps.","# Initialization
units           metal
boundary        p p p
atom_style      charge
processors      * * 1     # domain decomposition over x and y

# System and atom definition
# we use different molecule ids for each layer of hBN
# so that inter- and intra-layer
# interactions can be specified separately
read_data       hBN-monolayer-5nm.data
mass            1 10.8110   # boron mass (g/mole) | membrane
mass            2 14.0067   # nitrogen mass (g/mole) | adsorbate

######################## Potential defition ########################
pair_style  tersoff shift 0.05
pair_coeff  * * BNC.tersoff B N
####################################################################
# Neighbor update settings
neighbor        2.0 bin
neigh_modify    every 1
neigh_modify    delay 0
neigh_modify    check yes

#### Simulation settings ####
timestep        0.001
velocity        all create 300.0 4928459 loop geom
fix             thermostat all nve

############# Output ###############
thermo          100
thermo_style    custom step etotal pe ke temp
#thermo_modify   lost warn
thermo_modify   line one format float %20.16g lost warn

###### Run molecular dynamics ######
run             1000
"
"Generate a LAMMPS input script for a NVE simulation of an peri system using peri/pmb pair style with pair coefficients * * 1.6863e22 0.0015001 0.0005 0.25 and s s s boundary conditions with a timestep of 1.0e-7 running for 1000 steps.","# small Peridynamic cylinder hit by projectile

units           si
boundary        s s s
atom_style      peri
atom_modify     map array
neighbor        0.0010 bin

# small target

lattice         sc 0.0005
region          target cylinder y 0.0 0.0 0.0050 -0.0050 0.0 units box
create_box      1 target
create_atoms    1 region target

pair_style      peri/pmb
pair_coeff      * * 1.6863e22 0.0015001 0.0005 0.25
set             group all density 2200
set             group all volume 1.25e-10
velocity        all set 0.0 0.0 0.0 sum no units box
fix             1 all nve

# spherical indenter to shatter target

variable        y0 equal 0.00155
variable        vy equal -100
variable        y equal ""v_y0 + step*dt*v_vy""

fix             2 all indent 1e17 sphere 0.0000 v_y 0.0000 0.0015 units box

compute         1 all damage/atom
timestep        1.0e-7
thermo          100

#dump            1 all custom 100 dump.peri id type x y z c_1

#dump           2 all image 50 image.*.jpg type type &
#               axes yes 0.8 0.02 view 80 -30 adiam 0.0006
#dump_modify    2 pad 4

#dump           3 all movie 50 movie.mpg type type &
#               axes yes 0.8 0.02 view 80 -30 adiam 0.0006
#dump_modify    3 pad 4

run             1000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using airebo 3.0 1 1 pair style with pair coefficients * * CH.airebo C H with a timestep of 0.0005 running for 100 steps.","# AIREBO polyethelene benchmark

units               metal
atom_style          atomic

read_data           data.airebo

replicate           17 16 2

neighbor            0.5 bin
neigh_modify        delay 5 every 1

pair_style          airebo 3.0 1 1
pair_coeff          * * CH.airebo C H

velocity            all create 300.0 761341

fix                 1 all nve
timestep            0.0005

thermo              10
run                 100
"
"Generate a LAMMPS input script for a general simulation of an electron system using eff/cut 20.0 limit/eradius pressure/evirials ecp 1 Si 2 C pair style with pair coefficients * * and p p p boundary conditions.","variable	sname index SiC
variable        nstep equal 100

units		electron
newton		on
boundary	p p p

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 20.0 limit/eradius pressure/evirials ecp 1 Si 2 C
pair_coeff	* *
pair_coeff	1 s 0.320852 2.283269 0.814857 
pair_coeff	2 p 22.721015 0.728733 1.103199 17.695345 6.693621

comm_modify	vel yes

neigh_modify    one 4000 page 40000

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        ecoul equal c_energies[3]
variable        erres equal c_energies[4]
variable        etotalnew equal c_energies[1]+c_energies[2]+c_energies[3]+c_energies[4]

thermo          ${nstep}
thermo_style    custom step etotal pe ke v_etotalnew v_eke v_epauli v_ecoul v_erres
thermo_modify   format float %16.8f
thermo_modify   lost warn norm yes flush yes

# Minimization

min_style       cg
dump            1 all xyz ${nstep} ${sname}.min.xyz 
compute         1 all property/atom spin eradius erforce
dump            2 all custom ${nstep} ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
dump            3 all custom ${nstep} ${sname}.data.restart id type q c_1[1] c_1[2] x y z
min_modify      line quadratic
minimize        0 1e-8 100000 1000000

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using hybrid lj/cut 2.5 python 2.5 pair style with pair coefficients * * python py_pot.LJCutMelt lj NULL running for 250 steps.","# 3d Lennard-Jones hybrid

units           lj
atom_style      atomic

lattice         fcc 0.8442
region          box block 0 10 0 10 0 10
create_box      2 box
create_atoms    1 box
mass            * 1.0
region          half block -0.1 4.9 0 10 0 10
set region half type 2

velocity        all create 3.0 87287

pair_style      hybrid lj/cut 2.5 python 2.5
pair_coeff      * * python py_pot.LJCutMelt lj NULL
pair_coeff      * 2 lj/cut 1.0 1.0

neighbor        0.3 bin
neigh_modify    every 20 delay 0 check no

fix             1 all nve

thermo          50
run             250

write_data      hybrid.data
write_restart   hybrid.restart

clear

read_restart    hybrid.restart

pair_style      hybrid lj/cut 2.5 python 2.5
pair_coeff      * * python py_pot.LJCutMelt lj NULL
pair_coeff      * 2 lj/cut 1.0 1.0

fix             1 all nve

thermo          50
run             250

clear

units           lj
atom_style      atomic

read_data       hybrid.data

pair_style      hybrid lj/cut 2.5 python 2.5
pair_coeff      * * python py_pot.LJCutMelt lj NULL
pair_coeff      * 2 lj/cut 1.0 1.0

neighbor        0.3 bin
neigh_modify    every 20 delay 0 check no

fix             1 all nve

thermo          50
run             250

shell rm hybrid.data hybrid.restart
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 13.5 pair style and f f p boundary conditions with a timestep of 0.002 running for 200 steps.","# needs description
#AtC Two temperature Coupling
# DESCRIPTION:
# delete elements from the mesh
# heating and then relaxation

echo both
units    metal
variable INF equal 1000

variable T equal 20

atom_style  atomic

lattice   fcc 5.405 origin 0.25 0.25 0.25
region    FE block -8 8 -6 6 0 3
region    MD block -7 7 -6 0 0 3
region    FREE block -4 4 -6 0 0 3

boundary  f f p

# create atoms
#create_box  1 FE
#create_atoms 1 region MD
#group   internal region FREE
#mass    1 39.95 
#read_data cutout.data
#pair_coeff * * .238 3.405 13.5
#velocity  internal create 40 87287 mom yes loop geom
#fix NVE internal nve
#thermo 100
#dump CONFIG all atom 100 cutout.dump
##run 1000
#unfix NVE 
#write_restart cutout.rst

pair_style lj/cut 13.5
read_data cutout.init
group   internal region FREE
group   ghost subtract all internal

timestep  0.002
thermo  20

# allow initial state to relax
fix NVT internal nvt temp $T $T 10 drag 0.2
fix RESCALE internal temp/rescale 25 $T $T 0.05 1.0
run 200
unfix RESCALE
run 800
unfix NVT

#          ID  group atc PhysicsType ParameterFile
fix        AtC internal  atc two_temperature  Ar_ttm.mat

#          ID  part keywords    nx ny nz region
fix_modify AtC mesh  create 8 6  1  FE f f p

fix_modify AtC mesh create_elementset wire  -4 4 -INF  0 -INF INF
fix_modify AtC mesh create_nodeset    gap   -4 4 -0  INF -INF INF
fix_modify AtC mesh create_elementset gap   -4 4 -0  INF -INF INF
fix_modify AtC mesh delete_elements gap

fix_modify  AtC mesh create_faceset bndy box -4 4 -INF 0 -INF INF
fix_modify  AtC  control thermal flux faceset bndy

# fix a temperature
fix_modify AtC  initial temperature          all 20.0
fix_modify AtC  initial electron_temperature all 30.0
fix_modify AtC  initial temperature          gap  0.0

# relaxation
thermo_style custom step cpu f_AtC[1] f_AtC[2] f_AtC[3] f_AtC[4]
fix_modify AtC  output   cutoutFE 10 text
fix_modify AtC extrinsic electron_integration implicit

# heating
fix_modify AtC mesh create_nodeset lbc -8  -8 -INF INF -INF INF
fix_modify AtC mesh create_nodeset rbc  8   8 -INF INF -INF INF
fix_modify AtC  fix electron_temperature lbc 20. 
fix_modify AtC  fix electron_temperature rbc 20.
fix_modify AtC  source electron_temperature wire 0.001
run    200

# relaxation
fix_modify AtC  remove_source electron_temperature wire
run    200
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut ${rcut} pair style with pair coefficients 1 1 0.0 1.0 and p p p boundary conditions running for 0 steps.","# Test volume definitions for 2d and finite systems

variable        rcut equal 10.0
variable        rskin equal 2.0
variable        rcomm equal 20.0
variable        len equal 4.0
variable        lenz equal 10.0

dimension       2
units           metal
boundary        p p p

#lattice         sq 1.0 origin 0.5 0.5 0.0
lattice         hex 1.0 origin 0.5 0.5 0.0

atom_style      atomic

region          box block 0 ${len}  0 ${len} -0.5 0.5
region          atoms block 0 ${len}  0 ${len} 0.0 0.0
create_box      1 box
create_atoms    1 region atoms

mass            1 1.0

pair_style      lj/cut ${rcut}
pair_coeff      1 1 0.0 1.0 

neighbor        ${rskin} nsq

# set the minimum communication cut-off 
comm_modify     cutoff ${rcomm}

compute         v1 all voronoi/atom neighbors yes
compute         volvor all reduce sum c_v1[1]
variable        volsys equal lz*lx*ly
variable        err equal c_volvor-v_volsys
thermo_style    custom c_volvor v_volsys vol v_err
thermo          1

#
# TEST 1: Volume check for 2d bulk system
#

run             0

#
# TEST 2: Volume check for 2d finite system
#         add margins in x and y directions
#

change_box      all boundary f f p
run             0
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style and p p p boundary conditions with a timestep of 5.0 running for 500 steps.","#AtC Two temperature Coupling
# DESCRIPTION:
# full overlap of MD and FE regions with full periodic boundary conditions.
# initial electron and phonon temperatures are different and then allowed to 
# relax.
#

units    real
atom_style  atomic
boundary  p p p

# create domain
#lattice  type reduced density rho* = 4*(sigma/a)^3, 
#   where N = 4 for fcc, 
#         s = 3.405 A (Wagner) 
#         a = 5.25 A (Ashcroft & Mermin, p. 70)
lattice         fcc 5.405 origin 0.25 0.25 0.25

pair_style  lj/cut 13.5

read_data   uniform_exchange.init

region    simRegion block -12 12 -3 3 -3 3
region     feRegion block -12 12 -3 3 -3 3

# create atoms
region    mdRegion block -12 12  -3 3 -3 3

# specify interal/ghost atoms
region    mdInternal block -12 12 -3 3 -3 3
group    internal region mdInternal

neighbor  5. bin
neigh_modify  every 10 delay 0 check no

#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc two_temperature  Ar_ttm.mat

#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 4 1  1  feRegion p p p

# fix a temperature
fix_modify AtC  fix temperature          all 20.0
fix_modify AtC  fix electron_temperature all 30.0

timestep  5.0

# output
thermo_style custom step pe temp f_AtC[2] f_AtC[4]
thermo    10

# equilibrate MD field
fix_modify  AtC  control thermal rescale 13
run     500

# relax
fix_modify      AtC  output        uniform_exchangeFE 100 text
fix_modify	AtC  filter type exponential
fix_modify	AtC  filter scale 5.0e2
fix_modify	AtC  filter on
fix_modify	AtC  unfix          temperature all
fix_modify	AtC  unfix electron_temperature all
fix_modify	AtC  control thermal flux

# run with FE
run     5000
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using eam/fs pair style with pair coefficients * * FeCu.pasianot.eamfs Fe Cu and p p p boundary conditions with a timestep of 0.0025 running for 2000 steps.","# general variables
variable        temperature equal 700
variable        size equal 20

# variables for 'fix sgcmc'
variable        nsteps_mc     equal 100
variable        swap_fraction equal 0.2
variable        temperature_mc equal ${temperature}
variable        deltamu equal -0.70
variable        target_concentration equal 0.02
variable        kappa equal 1e3

# general settings
units           metal
atom_style      atomic

# set up structure
boundary        p p p
lattice         bcc 2.88
region          box block 0 ${size}  0 ${size}  0 ${size}
create_box      2 box
create_atoms    1 box
reset_timestep  0
timestep        0.0025

# set up interaction
pair_style      eam/fs
pair_coeff      * * FeCu.pasianot.eamfs Fe Cu

# initialize velocities
variable        double_temp equal ${temperature}*2
velocity        all create ${double_temp} 428459 dist gaussian

# what and how to run
fix             integrate all npt &
                temp ${temperature} ${temperature} 1.7 &
                aniso 0.0 0.0 1.5
fix             mc all sgcmc ${nsteps_mc} ${swap_fraction} ${temperature_mc} ${deltamu} &
                randseed 324234 &
                variance ${kappa} ${target_concentration}

# set up output
thermo          100
thermo_style    custom step temp atoms pe press &
                lx ly lz f_mc[1] f_mc[2] f_mc[3] f_mc[4]
#dump            1 all custom 200 mc.*.dump id type x y z

run             2000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/cut 13.0 pair style with pair coefficients * * 0.2381 3.405 and f p p boundary conditions with a timestep of ${dt} running for 800 steps.","# simulation of liquid argon with an electrostatic potential
#
# p | free | free |  fixed | p
# real units:
# distance = Angstroms
# time = femtoseconds
# mass = grams/mole
# energy = Kcal/mole
# 1 kilocalorie = 4184 Joules
# mvv2e = 2390.057361533490 [g/mol A^2/fs^2] -> [kcal/mol]
echo both
units     	real
atom_style full
########### BEGIN PARAMETERS ####################################
variable 	T equal 115.607
print 	""reference temperature $T [K]""
variable  a equal 5.719025032  
variable  i equal 1
variable  s equal 100
variable dt equal 4.0 
##############  END PARAMETERS #################################
dimension 	3
boundary  	f p p
pair_style  	lj/cut 13.0
lattice   	sc  $a 
region    	BOX     block  0 12 0 4 0 4
read_data	velocities.init
mass    	* 39.948
pair_coeff * * 0.2381 3.405
set group all charge 0.1
dielectric 80.0
timestep  	${dt}
neigh_modify every $i check no
thermo    	$s
# ------------- Equilibration and thermalisation ----------------
fix WALL all wall/reflect xlo EDGE xhi EDGE 
fix 		NVT all nvt temp $T $T 10 drag 0.2  
thermo_style 	custom step temp press etotal pe
#run 		400
unfix 		NVT
# ------------- Post processing ---------------------------------
fix        PP  all atc field
fix_modify PP  fields add mass_density charge_density electric_potential velocity
#fix_modify PP  mesh create 50 1 1 BOX f p p
fix_modify PP  mesh create 25 1 1 BOX f p p
#fix_modify PP  mesh create 6 1 1 BOX f p p
fix_modify PP  atom_element_map eulerian $i
# ------------- Coupling ----------------------------------------
fix        AtC all atc species_electrostatic     Ar_species.mat
fix_modify AtC add_species ALL group all 
fix_modify AtC internal_quadrature off
fix_modify AtC mesh create 6 1 1 BOX f p p
fix_modify AtC atom_element_map eulerian $i
fix_modify AtC extrinsic short_range off
fix_modify AtC mesh create_nodeset rbc 12. 12. -INF INF -INF INF
fix_modify AtC mesh create_nodeset lbc  0.  0. -INF INF -INF INF
# ------------- run ---------------------------------------------
thermo_style    custom step cpu etotal ke
fix_modify AtC output liquid_electrostaticFE $s full_text # binary
fix_modify PP  output liquid_electrostaticPP $s full_text
log liquid_electrostatic.log
fix_modify AtC  fix electric_potential lbc linear 0 0 0 0 0 0 0 
run 800
"
"Generate a LAMMPS input script for a NVE simulation of an bond system using lj/cut 1.12 pair style with pair coefficients 1 1 1.0 1.0 1.12 with a timestep of 0.012 running for 500 steps.","# FENE beadspring benchmark

units		lj
atom_style	bond
special_bonds   fene

read_data	data.chain

neighbor	0.4 bin
neigh_modify	every 1 delay 1

bond_style      fene
bond_coeff	1 30.0 1.5 1.0 1.0

pair_style	lj/cut 1.12
pair_modify	shift yes
pair_coeff	1 1 1.0 1.0 1.12

fix		1 all nve
fix		2 all langevin $t $t 1.0 904297

thermo          100
timestep	0.012

run		500
"
"Generate a LAMMPS input script for a NVE simulation using soft 1.0 pair style with pair coefficients * * 0.0 and p p p boundary conditions with a timestep of 0.002 running for 20000 steps.","#===========================================================================#
# Large colloidal sphere difusing around.                                   #
#                                                                           #
# In the first stage, the sphere is constructed by condensing atoms onto    #
# the surface of a spherical region. There are a flag you can change to     #
# either bond atoms into a spherical shell or integrate them as a rigid body#
#                                                                           #
# To run this example, LAMMPS needs to be compiled with a the following     #
# packages: RIGID, LATBOTLZ                                                 #
#                                                                           #
# If you uncomment the ""dump..."" line, sample output from this run          #
# can be found in the file:                                                 # 
#   'dump.trapnewsphere.lammpstrj'                                          #
# and viewed using, e.g., the VMD software.                                 #
#                                                                           #
#===========================================================================#

units nano
dimension 3
boundary p p p

region mybox block -24 24 -24 24 -24 24

# flag indicating whether sphere will be bonded or rigid, 0 or 1
variable is_bonded equal 0  
# timestep for the LB run (setup uses different timesteps)
variable tstep equal 0.00025
# number of stencil points in any direction.  could be 2, 3, or 4
variable stpts equal 2

if ""${is_bonded} == 1"" then &
   ""create_box 1 mybox bond/types 10 extra/bond/per/atom 12"" &
else &
   ""create_box 1 mybox""

#----------------------------------------------------------------------------
# Create a spherical region and then fill it with atoms
#----------------------------------------------------------------------------
region mysphereinside sphere 0 0 0 4.0

#variable n_nodes equal 216
variable n_nodes equal 284
create_atoms 1 random ${n_nodes} 1234 mysphereinside units box

pair_style soft 1.0
pair_coeff * * 0.0
variable prefactor equal ramp(0,30)
fix 1 all adapt 1 pair soft a * * v_prefactor

mass * 1.0

#----------------------------------------------------------------------------
# Set up and do an initial run to push the atoms apart as the random creation
#   could have them overlapping too much for stability.
#----------------------------------------------------------------------------
timestep 0.002

# Define sphere where minimum of wall potential is at r=4 so
# regions is 4 + (2/5)^(1/6) sigma
region mysphere sphere 0 0 0 5.28756
fix wall all wall/region mysphere lj93 15.0 1.5 5.28

fix 2 all nve

#dump mydump all atom 10000 dump.trapnewsphere.lammpstrj

run 20000

unfix wall
fix wall all wall/region mysphere lj93 50.0 1.5 5.68

unfix 1

#----------------------------------------------------------------------------
# Do a run to condense the atoms onto the spherical surface and anneal them 
#   so they will be orderly aranged onto a semi-triangular mesh on the sphere
#----------------------------------------------------------------------------
pair_style lj/cut 1.68359
#pair_coeff * * 0.002 1.5 1.68369
pair_coeff * * 0.0005 1.5 1.68369

fix 3 all langevin 1.5 0.01 100.0 5678

neighbor 0.3 bin
neigh_modify delay 0 every 1 check yes
comm_modify cutoff 2.5

run 500000

minimize 0.0 1.0e-8 1000 100000

unfix wall
unfix 2
unfix 3

#----------------------------------------------------------------------------
# If bonded, bond the atoms together at something close to their current  
#   configuration
#----------------------------------------------------------------------------

variable total_mass equal 0.002398
variable node_mass equal ""v_total_mass / v_n_nodes""
mass * ${node_mass}

if ""${is_bonded} == 1"" then &
""bond_style harmonic"" &
""bond_coeff 1 25.0 0.869333"" &
""bond_coeff 2 25.0 0.948"" &
""bond_coeff 3 25.0 1.026666"" &
""bond_coeff 4 25.0 1.105333"" &
""bond_coeff 5 25.0 1.184"" &
""bond_coeff 6 25.0 1.262666"" &
""bond_coeff 7 25.0 1.341333"" &
""bond_coeff 8 25.0 1.42"" &
""bond_coeff 9 25.0 1.498666"" &
""bond_coeff 10 25.0 1.577333"" &
""create_bonds many all all 1 0.83 0.908666"" &
""create_bonds many all all 2 0.908667 0.987333"" &
""create_bonds many all all 3 0.987334 1.066"" &
""create_bonds many all all 4 1.066001 1.144666"" &
""create_bonds many all all 5 1.144667 1.223333"" &
""create_bonds many all all 6 1.223334 1.302"" &
""create_bonds many all all 7 1.302001 1.380666"" &
""create_bonds many all all 8 1.380667 1.459333"" &
""create_bonds many all all 9 1.459334 1.538"" &
""create_bonds many all all 10 1.538001 1.61667""

if ""${is_bonded} == 1"" then &
 ""pair_style lj/cut 5.05108"" &
 ""pair_coeff * * 0.5 4.5"" &
else &
 ""pair_style lj/cut 1.2"" &
 ""pair_coeff * * 0.0 0.0""

timestep ${tstep}

#----------------------------------------------------------------------------
# You could uncomment the following lines and then turn off the noise and
#   comment out the trap (following) to instead do a run that drags the
#   sphere through the fluid to measure the drag force.
#----------------------------------------------------------------------------
#variable total_force equal 8.0
#variable node_force equal ""v_total_force / v_n_nodes""
#variable oscillateY equal cos(step*0.0005)/(-0.004+50*v_tstep)/v_n_nodes
#variable oscillateZ equal cos(step*0.0003)/(-0.004+50*v_tstep)/v_n_nodes
#fix drag all addforce ${node_force} v_oscillateY v_oscillateZ

#----------------------------------------------------------------------------
# Trap the sphere along x (could be done experimentally using optical
#    tweezers.
#----------------------------------------------------------------------------
variable fx atom -x*4.14195/284.0
fix trap all addforce v_fx 0.0 0.0  # needs to go before fix lb/fluid and lb/viscous

#----------------------------------------------------------------------------
# Set up the lb/fluid parameters for water and at a temperature of 300 K.  If
#   the colloid is integrated with the rigid fix, the dof are not
#   automatically calculated correctly but as this would then be a rigid
#   sphere it is clear it should have 6 degrees of freedom.
#----------------------------------------------------------------------------
if ""${is_bonded} == 1"" then &
""fix   FL all lb/fluid 1 1.0 0.0009982071 stencil ${stpts} dx 1.2 noise 300.0 181920"" &
else &
""fix   FL all lb/fluid 1 1.0 0.0009982071 stencil ${stpts} dx 1.2 noise 300.0 181920 dof 6""

fix   2 all lb/viscous

if ""${is_bonded} == 1"" then &
   ""fix   3 all nve"" &
else & 
   ""fix   3 all rigid group 1 all"" 

#equilibration run
run 10000

unfix 2
unfix FL
# data gathering run
reset_timestep 0

if ""${is_bonded} == 1"" then &
""fix   FL all lb/fluid 1 1.0 0.0009982071 stencil ${stpts} dx 1.2 noise 300.0 181920"" &
else &
""fix   FL all lb/fluid 1 1.0 0.0009982071 stencil ${stpts} dx 1.2 noise 300.0 181920 dof 6""

fix   2 all lb/viscous
#----------------------------------------------------------------------------
# Create variables containing the positions/velocity of the colloids center 
#   of mass.
#----------------------------------------------------------------------------
variable cmx equal xcm(all,x)
variable cmy equal xcm(all,y)
variable cmz equal xcm(all,z)

variable vcmx equal vcm(all,x)
variable vcmy equal vcm(all,y)
variable vcmz equal vcm(all,z)

if ""${is_bonded} == 1"" then &
   ""variable comdatafile string trap_nb${n_nodes}_st${stpts}_dt${tstep}.out"" &
else &
   ""variable comdatafile string trap_n${n_nodes}_st${stpts}_dt${tstep}.out"" 

#fix printCM all print 10 ""$(step) $(f_FL) ${cmx} ${cmy} ${cmz} ${vcmx} ${vcmy} ${vcmz}"" file ${comdatafile} screen no

run 10000
#run 25000000"
"Generate a LAMMPS input script for a NPT simulation of an full system using lj/charmm/coul/long/gpu 8 10 pair style with a timestep of 2.0 running for 5000000 steps at temperature 300.0.","# 
units           real
neighbor        2.5 bin
neigh_modify    delay 1 every 1 
newton          off

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic

pair_style      lj/charmm/coul/long/gpu 8 10
pair_modify     mix arithmetic
special_bonds   charmm
read_data       data.deca-ala-solv

fix             0 all gpu force/neigh 0 0 1.0    

group peptide   id <= 103
fix             rigidh all shake 1e-6 100 1000 t 1 2 3 4 5 a 23

thermo          100
thermo_style    multi
timestep        2.0
kspace_style    pppm/gpu 1e-5

fix             ensemble all npt temp 300.0 300.0 100.0 iso 1.0 1.0 1000.0 drag 0.2

# IMD setup.
fix  comm       peptide imd 5678 unwrap on trate 10

run 5000000


"
"Generate a LAMMPS input script for a NVE simulation of an sphere system using gran/hertz/history 4000.0 NULL 100.0 NULL 0.5 0 pair style with pair coefficients * * and f fm p boundary conditions with a timestep of 0.001 running for 25000 steps.","# Pour 2d granular particles into container

dimension	2
atom_style	sphere
boundary	f fm p
newton		off
comm_modify	vel yes

region		reg block 0 100 0 50 -0.5 0.5 units box
create_box	1 reg

neighbor	0.2 bin
neigh_modify	delay 0

# IMPORTANT NOTE: these values of stiffness (4000) and timestep (0.001)
# are used in this example file to produce a quick simulation and movie.
# More appropriate values for realistic simulations would be
# k = 4.0e5 and dt = 0.0001, as in bench/in.chute (if it were Hertzian).

pair_style      gran/hertz/history 4000.0 NULL 100.0 NULL 0.5 0
pair_coeff	* *

timestep	0.001

fix             1 all nve/sphere
fix		2 all gravity 1.0 spherical 0.0 -180.0
fix		xwalls all wall/gran hertz/history 4000.0 NULL 100.0 NULL 0 1 &
		xplane 0 100
fix		ywalls all wall/gran hertz/history 4000.0 NULL 100.0 NULL 0 1 &
		yplane 0 NULL
 
region          slab block 1.0 99.0 30 34.5 -0.5 0.5 units box
fix             ins all pour 1000 1 4767548 vol 0.4 10 &
	        diam range 0.5 1.0 region slab

fix             3 all enforce2d

compute		1 all erotate/sphere
thermo_style	custom step atoms ke c_1 vol
thermo		1000
thermo_modify	lost ignore norm no
compute_modify	thermo_temp dynamic/dof yes

#dump		id all atom 250 dump.pour

#dump		2 all image 500 image.*.jpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	2 pad 5

#dump		3 all movie 500 movie.mpg type type &
#		zoom 1.6 adiam 1.5
#dump_modify	3 pad 5

run		25000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay  tersoff  ilp/graphene/hbn 16.0 coul/shield 16.0 1 pair style with pair coefficients * * tersoff          BNC.tersoff B N B N  # chemical and p p p boundary conditions with a timestep of 0.001 running for 1000 steps.","# Initialization
units           metal
boundary        p p p
atom_style      full
processors      * * 1     # domain decomposition over x and y

# System and atom definition
# we use different molecule ids for each layer of hBN
# so that inter- and intra-layer
# interactions can be specified separately
read_data       hBN_AA_prime_stack_2L_noH.data
mass            1 10.8110   # boron mass (g/mole) | membrane
mass            2 14.0067   # nitrogen mass (g/mole) | adsorbate
mass            3 10.8110   # boron mass (g/mole) | membrane
mass            4 14.0067   # nitrogen mass (g/mole) | adsorbate
# Separate atom groups
group 		layer1 molecule 1
group 		layer2 molecule 2

######################## Potential defition ########################
pair_style  hybrid/overlay  tersoff  ilp/graphene/hbn 16.0 coul/shield 16.0 1
####################################################################
pair_coeff  * * tersoff          BNC.tersoff B N B N  # chemical
pair_coeff  * * ilp/graphene/hbn BNCH.ILP    B N B N  # long range
pair_coeff  1 3 coul/shield 0.70
pair_coeff  1 4 coul/shield 0.69498201415576216335
pair_coeff  2 3 coul/shield 0.69498201415576216335
pair_coeff  2 4 coul/shield 0.69
####################################################################
# Neighbor update settings
neighbor        2.0 bin
neigh_modify    every 1
neigh_modify    delay 0
neigh_modify    check yes

#### Simulation settings ####
timestep  	0.001
velocity  	all create 300.0 12345 dist gaussian mom yes rot yes
fix       	thermostat all nve

compute   	0 all pair tersoff
compute   	1 all pair coul/shield ecoul
compute   	2 all pair ilp/graphene/hbn
variable  	Tersoff  equal c_0     # Tersoff energy
variable  	Ecoul    equal c_1     # Coulomb energy
variable  	EILP     equal c_2     # total interlayer energy
variable  	Evdw     equal c_2[1]  # attractive energy
variable 	Erep     equal c_2[2]  # repulsive  energy

############# Output ###############
thermo          100
thermo_style    custom step etotal pe ke v_Evdw v_Tersoff v_EILP v_Erep v_Evdw v_Ecoul temp
thermo_modify   lost warn

###### Run molecular dynamics ######
run 		1000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/charmm/coul/long 8.0 10.0 10.0 pair style with a timestep of 8 running for _style respa 3 2 8 bond 1 dihedral 2 pair 2 kspace 3 steps at temperature 250.0.","# Solvated 5-mer peptide, run for 8ps in NVT

units           real
atom_style      full

pair_style      lj/charmm/coul/long 8.0 10.0 10.0
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic
kspace_style    pppm 0.0001

read_data       data.peptide

neighbor        2.0 bin
neigh_modify    delay 5

thermo          50
#dump            dump1 all atom 100 peptide.dump

timestep        8

run_style respa 3 2 8 bond 1 dihedral 2 pair 2 kspace 3

fix             1 all nvt temp 250.0 250.0 100.0 tchain 1
fix             cor all filter/corotate m 1.0
run             1000
unfix           cor
unfix           1



"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 and p p p boundary conditions with a timestep of 0.004 running for _style 	verlet steps at temperature 0.8.","units		lj
dimension	3
boundary	p p p
atom_style  atomic

# truncated and shifted LJ potential
pair_style	lj/cut 2.5
pair_modify	shift yes
lattice	fcc 0.9731
region	my_box block 0 8.0   0 8.0   0 20.0
create_box 1 my_box
region particles block 0 8.0 0 8.0 0 20.0
create_atoms 1 region particles
pair_coeff 1 1 1.0 1.0 2.5
pair_modify tail no
pair_modify shift yes
mass 1 1.0
velocity all create 1.6 1 mom yes rot yes

# simulation parameters
neighbor	0.6 bin
timestep	0.004
run_style 	verlet
fix ensemble all npt temp 0.8 0.8 4.0 aniso 2.185 2.185 8.0 pchain 32

# computing long-range order (no bias is added since k=0)
fix bias all rhok 16 0 0 0.0 0.0

# output
thermo 50
thermo_style custom step temp press density f_bias[3]
# dump dumpXYZ all xyz 2000 traj.xyz

# NOTE: this is cut short to 5000 steps for demonstration purposes
# run 100000
run 5000
"
"Generate a LAMMPS input script for a NVE simulation of an dielectric system using lj/cut/coul/cut/dielectric 1.122 20.0 pair style with pair coefficients * * 1.0 1.0 and f f f boundary conditions running for 0 steps.","# Interface
newton off
units       lj
atom_style  dielectric
atom_modify map array
dimension   3
boundary    f f f

variable    method index gmres  # gmres = BEM/GMRES
                                # icc   = BEM/ICC*
                                # dof   = Direct optimization of the functional
                                # none
 
variable    data index data.sphere

read_data   ${data}

group interface type 1
group ions type 2 3

pair_style      lj/cut/coul/cut/dielectric 1.122 20.0
pair_coeff      * * 1.0 1.0
pair_coeff      1 1 0.0 1.0

neigh_modify    one 5000

#compute         ef all efield/atom
#dump            1 all custom 100 all.dump id mol type q x y z #c_ef[1] c_ef[2] c_ef[3]
#
#dump            2 interface custom 100 interface.dump id mol type q x y z #c_ef[1] c_ef[2] c_ef[3]
#dump_modify     1 sort id

fix             1 ions nve

if ""${method} == gmres"" then &
  ""fix             3 interface polarize/bem/gmres 1 1.0e-4"" &
elif ""${method} == icc""&
  ""fix             3 interface polarize/bem/icc 1 1.0e-4"" &
elif ""${method} == dof"" &
  ""fix             3 interface polarize/functional 1 1.0e-4"" &
else &
  ""print 'Unsupported method for polarization' ""

thermo          1000
thermo_style    custom step evdwl ecoul elong epair
thermo_modify   flush yes

run             0



"
"Generate a LAMMPS input script for a NVE simulation of an charge system using hybrid reax/c NULL zbl 8.0 10.0 pair style with pair coefficients * * reax/c ../../ffield.reax.combined.COFSi.v4 Si O C F NULL and p p f boundary conditions with a timestep of ${dt} running for ${_step} steps at temperature 300.0.","variable a loop 400
log data/log.$a
variable randomSeedForDeposit equal floor(random(1,9999,${a}))

# deposit molecules on materials and measure sticking coefficients

dimension      3
boundary       p p f
units		   real
atom_style	   charge

variable       dt equal 0.25 # units=fs
timestep       ${dt}
read_data	   ../../get.equilibrated.SiO2.300K/SiO2.300K.equilibrated.dat

variable       box_zh equal 50

# freeze the bottom layer
variable       material_height equal 35.2
variable       freeze_below_z equal 0.2*v_material_height
region         freeze_block block INF INF INF INF INF ${freeze_below_z} units box
region         mobile_block block INF INF INF INF ${freeze_below_z} INF units box
group		   freeze_group region freeze_block
group          mobile_group region mobile_block
fix        1   freeze_group setforce 0.0 0.0 0.0

# NVT for middle region and NVE for top region
variable       between_nvt_and_nve equal 0.8*v_material_height
region         middle_nvt_block block INF INF INF INF ${freeze_below_z} ${between_nvt_and_nve} units box
region         top_nve_block    block INF INF INF INF ${between_nvt_and_nve} INF units box
group          middle_nvt_group region middle_nvt_block
group          top_nve_group    region top_nve_block

pair_style	   hybrid reax/c NULL zbl 8.0 10.0
pair_coeff	   * * reax/c ../../ffield.reax.combined.COFSi.v4 Si O C F NULL
# pair_coeff	   * * reax/c ../../ffield_Kapton Si O C F NULL
# pair_coeff	   * * ffield.reax.CHOSi Si O
pair_coeff     1 5 zbl 14.0 18.0
pair_coeff     2 5 zbl  8.0 18.0
pair_coeff     3 5 zbl  6.0 18.0
pair_coeff     4 5 zbl  9.0 18.0
pair_coeff     5 5 zbl 18.0 18.0

neighbor	   2. bin
neigh_modify   every 10 delay 0 check no
fix        2   all qeq/reax 1 0.0 10.0 1e-6 reax/c

# # initial minimisation
# thermo_style   custom step temp epair etotal press
# thermo         10
# minimize       1.0e-6 1.0e-6 100000 100000
# reset_timestep 0

compute        mobile_temp mobile_group temp
compute_modify mobile_temp dynamic/dof yes

if ""$a <= 20"" then ""dump           1 all custom 100 data/dumpidtype.$a.dat id type x y z""
thermo_style   custom step temp pe ke etotal press vol density
thermo         100
thermo_modify  lost warn temp mobile_temp

# fix		   3   mobile_group nvt temp 300.0 300.0 $(100.0*dt)
fix		   3   middle_nvt_group nvt temp 300.0 300.0 $(100.0*dt)
fix		   4   top_nve_group nve

# read molecule data file
molecule       mol_deposit  XXX1

# deposit molecules on top of materials
variable       num_of_insert   equal 5
variable       delta_step_insert   equal 200

# variable       randomSeedForDeposit equal 1234
variable       offset_for_atom_types equal XXX2 # 0
variable       deposit_slab_zl equal v_box_zh-5
variable       deposit_slab_zh equal v_box_zh-5

variable       in_mass_amu equal XXX3
variable       in_mass_kg equal 1.66054E-27*v_in_mass_amu # (12.0107+4*18.9984)
variable       in_angle_degree equal 0 # random(0,60,${randomSeedForDeposit}) # degree
variable       in_energy equal 0.0259 # eV
variable       in_angle equal v_in_angle_degree/180*3.1415926 # rad
variable       in_angle_phi equal random(0,6.2831852,${randomSeedForDeposit}) # rad
variable       in_velocity equal sqrt(2*v_in_energy*1.602E-19/(v_in_mass_kg))/100/1000 # Angstrom/fs
variable       in_vz equal -v_in_velocity*cos(v_in_angle)
variable       in_vy equal v_in_velocity*sin(v_in_angle)*cos(v_in_angle_phi)
variable       in_vx equal v_in_velocity*sin(v_in_angle)*sin(v_in_angle_phi)

group	       addatoms type 3 4 5
region         deposit_slab block EDGE EDGE EDGE EDGE ${deposit_slab_zl} ${deposit_slab_zh} units box
fix		   5   addatoms deposit ${num_of_insert} ${offset_for_atom_types} ${delta_step_insert} ${randomSeedForDeposit} &
               region deposit_slab near 8.0 id next mol mol_deposit vx ${in_vx} ${in_vx} vy ${in_vy} ${in_vy} vz ${in_vz} ${in_vz} units box

fix        6   addatoms nve

# remove atoms using ""oneway"" to fix the issues of partially removing molecules
variable       evaporate_slab_zl equal v_box_zh-2
region         evaporate_slab block EDGE EDGE EDGE EDGE ${evaporate_slab_zl} EDGE units box
fix        7   all oneway 100 evaporate_slab z

variable       run_step equal XXX4
run		       ${run_step}

write_data     data/SiO2.300K.sticked.$a.dat

clear
next a
jump in.stick.lammps
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 2.5 running for 0 steps.","# 3d Lennard-Jones melt - MDI driver script

variable        x index 5
variable        y index 5
variable        z index 5

variable        rho index 0.7 0.8 0.9

label LOOP

  units         lj
  atom_style    atomic

  read_data     data.series.${rho}

  displace_atoms all random 0.1 0.1 0.1 48294

  pair_style    lj/cut 2.5
  pair_coeff    1 1 1.0 1.0 2.5

  neighbor      0.3 bin
  neigh_modify  delay 0 every 1 check yes

  compute       1 all pressure NULL virial

  thermo_style  custom step temp pe c_1 c_1[1] c_1[2] c_1[3]

  run           0

  write_dump    all custom dump.series.alone &
                id type x y z fx fy fz modify sort id append yes

  clear

next rho

jump SELF LOOP
"
"Generate a LAMMPS input script for a NVE simulation of an molecular system using lj/cut  10.0 pair style with pair coefficients 1  1    0.07    3.55 and f f f boundary conditions with a timestep of 2.0 running for 100000000 steps.","# stick a buckyball into a nanotube
units           real
dimension       3
boundary       f f f
atom_style      molecular
newton          on off

processors * * 1

# read topology 
read_data       data.bucky-plus-cnt

pair_style  lj/cut  10.0
bond_style  harmonic
angle_style charmm
dihedral_style charmm

special_bonds lj/coul 0.0 0.0 0.0

pair_coeff  1  1    0.07    3.55
pair_coeff  1  2    0.07    3.55
pair_coeff  2  2    0.07    3.55
bond_coeff     1  305.0     1.4
angle_coeff    1   40.000 120.00   35.00   2.41620
dihedral_coeff 1    3.100   2     180   0.0

neighbor        4.0 bin
neigh_modify    delay 0 every 1 check yes

timestep        2.0

# we only move some atoms.
group mobile type 1

# have balls bounce off the walls
fix     walls       mobile wall/reflect xlo EDGE ylo EDGE zlo EDGE xhi EDGE yhi EDGE zhi EDGE

velocity mobile create 303.0 46659 mom yes rot yes dist gaussian

# take some potential energy out of the system
minimize 1.0e-4 1.0e-6 100 1000

reset_timestep 0

fix     integrate   mobile nve
fix     thermostat  mobile langevin 300.0 300.0 2000.0 234624

# IMD setup.
fix  comm       all imd 6789 unwrap on trate 10
#fix  comm       all imd 6789 unwrap on trate 10 nowait on

# temperature is based on mobile atoms only
compute mobtemp mobile temp
thermo_style    custom step pe ke evdwl emol c_mobtemp spcpu
thermo          1000
thermo_modify   norm yes
thermo_modify   temp mobtemp

run             100000000
"
"Generate a LAMMPS input script for a NVE simulation of an ellipsoid system using ylz  2.6 pair style with pair coefficients *  *   1.0  1.0  4  3  0.0  2.6 and p p p boundary conditions with a timestep of 0.001 running for 3000 steps.","# Vesicle demo

variable     T  equal  0.2
variable     LD equal  1.0

units        lj
atom_style   ellipsoid

boundary     p p p

read_data    read_data.vesicle1026

compute      ali  all temp/com
compute      rott all temp/asphere bias ali

velocity     all create ${T} 87287 loop geom

pair_style   ylz  2.6
pair_coeff   *  *   1.0  1.0  4  3  0.0  2.6
neighbor     1.0 bin

thermo_style custom step temp press pxx pyy
thermo       200

timestep     0.001

#dump         1 all atom 10 onlymembrane2.lammpstrj

fix          1 all langevin ${T} ${T}  ${LD}  48279
fix          2 all nve/asphere

run          3000

"
"Generate a LAMMPS input script for a NVE simulation of an charge system using comb3 polar_off pair style with pair coefficients * * ffield.comb3 O Cu H C C and p p p boundary conditions with a timestep of 0.00020 running for 100 steps.","# Graphene-OH on Cu2O (110) surface

units		metal
atom_style	charge
dimension       3
boundary        p p p

read_data   	data.comb3-OHCCu

mass            1 16.0
mass            2 63.5
mass            3 1.00
mass            4 12.0
mass            5 12.0

pair_style	comb3 polar_off
pair_coeff	* * ffield.comb3 O Cu H C C

neighbor	2.0 bin
neigh_modify	every 1 delay 0 check yes 

#dump            1 all cfg 10 *.cfg mass type xs ys zs id type q
#dump_modify   	1 element O Cu H C C

fix             1 all nve
fix             2 all qeq/comb 10 1e-3 file fq.out

timestep        0.00020

thermo_style	custom step temp etotal pe evdwl ecoul press vol lx ly lz
thermo_modify	norm yes
velocity	all create 300.0 2398378
thermo	  	10
run  		100
"
"Generate a LAMMPS input script for a general simulation of an atomic system using smatb/single pair style with pair coefficients 1 1 2.88 10.35	4.178	0.210	1.818	4.07293506	4.9883063257983666 and p p p boundary conditions.","# -*- lammps -*-

units           metal
atom_style      atomic
boundary	p p p

lattice fcc 4.0782

region myreg block 0 8 0 8 0 8

create_box      1 myreg

create_atoms    1 box

mass 1 196.96655  # Au

pair_style	smatb/single
pair_coeff	1 1 2.88 10.35	4.178	0.210	1.818	4.07293506	4.9883063257983666

neighbor	8.0 bin
neigh_modify	every 1 delay 0 check yes

thermo          1
fix            boxmin all box/relax iso 1.0
minimize       1.0e-8 1.0e-10 10000 100000
unfix boxmin
minimize       1.0e-8 1.0e-10 10000 100000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system.","# LAMMPS input for coupling LAMMPS with Python via fix external

units		metal
dimension	3
atom_style	atomic
atom_modify	sort 0 0.0

lattice		diamond 5.43
region		box block 0 1 0 1 0 1
create_box	1 box
create_atoms	1 box
mass		1 28.08

velocity	all create 300.0 87293 loop geom

fix		1 all nve
fix		2 all external pf/callback 1 1

#dump		2 all image 25 image.*.jpg type type &
#		axes yes 0.8 0.02 view 60 -30
#dump_modify	2 pad 3

thermo		1
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using hybrid/overlay table spline 1000 dpd/ext/tstat ${T} ${T} ${rc} 385262 pair style with pair coefficients 1 1 table cg_spce_table.pot VOTCA ${rc} and p p p boundary conditions with a timestep of 1.0 running for _style   verlet steps.","# Coarse-Grained SPC/E Water

variable T   equal 300.0
variable rc  equal   9.0
variable rcD equal  10.0

units            real
boundary     p p p
atom_style   atomic
dimension    3
newton       on
comm_modify  vel yes

read_data    cg_spce.data

pair_style       hybrid/overlay table spline 1000 dpd/ext/tstat ${T} ${T} ${rc} 385262

pair_coeff   1 1 table cg_spce_table.pot VOTCA ${rc}
pair_coeff   1 1 dpd/ext/tstat 20.0 10.0 0.5 0.5 ${rcD}

timestep    1.0
run_style   verlet

velocity all create ${T} 68768932

thermo_style custom step time temp press
thermo       100

fix 1 all    nve

run          1000
"
"Generate a LAMMPS input script for a general simulation of an atomic   # Can be either dpd or atomic system using dpd/fdt 300.0 10.0 234324 pair style with pair coefficients 1 1 0.075 0.022 10.0 and p p p boundary conditions with a timestep of 0.001 running for 100 steps.","# Input File for DPD fluid under isobaric conditions using the VV-SSA integration scheme

boundary        p p p

units           metal
atom_style      atomic   # Can be either dpd or atomic
read_data       data.dpd

comm_modify     mode single vel yes
mass            1 100.0

pair_style      dpd/fdt 300.0 10.0 234324 
pair_coeff      1 1 0.075 0.022 10.0

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check no once no

timestep        0.001

thermo          1
thermo_style    custom step temp press vol pe ke etotal enthalpy cella cellb cellc
thermo_modify   format float %15.10f

fix             1 all shardlow
fix             0 all nph iso 0.0 0.0 1000.0

run             100
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut ${rc} pair style with pair coefficients * * 1 1 running for 20000 steps.","# sample LAMMPS input script for viscosity of 2d LJ liquid
# use shearing wall, thermostat via fix langevin

# settings

variable	x equal 20
variable	y equal 20
variable	ylo equal -2.5
variable	yhi equal 23

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

variable	srate equal 2.7

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

lattice         sq2 ${rho}
region          simbox block 0 $x ${ylo} ${yhi} -0.1 0.1
create_box      3 simbox
create_atoms    1 box

mass            * 1.0

pair_style      lj/cut ${rc}
pair_coeff      * * 1 1

region		lower block INF INF INF 0.0 INF INF
region		upper block INF INF $y INF INF INF
group		lower region lower
group		upper region upper
set		group lower type 2
set		group upper type 3
group		wall union lower upper
group		flow subtract all wall

velocity        flow create $t 97287
velocity	upper set ${srate} 0.0 0.0 units box

compute		thermal flow temp/partial 0 1 0
compute		flow flow temp

fix             1 all nve
fix	        2 flow langevin $t $t 0.1 498094 
fix_modify      2 temp thermal

fix		3 wall setforce 0.0 0.0 0.0

compute         layers all chunk/atom bin/1d y center 0.05 units reduced
fix		4 all ave/chunk 20 500 10000 layers vx file profile.wall.2d

fix	        5 all enforce2d

# equilibration run

variable        ybox equal $y*ylat
compute		tilt flow temp/ramp vx 0 ${srate} y 0 ${ybox} units box

thermo          1000
thermo_style	custom step temp c_tilt epair etotal press pxy

run	        20000

# data gathering run

variable	visc equal -pxy/(v_srate/ly)
fix		vave all ave/time 1000 1 1000 v_visc ave running

thermo_style	custom step temp pxy v_visc f_vave
thermo_modify	temp tilt

# only need to run for 5000 steps to make a good 100-frame movie

#dump	        1 all custom 50 dump.wall.2d id type x y z vx

#dump		2 all image 50 image.*.jpg vx type zoom 1.6 adiam 1.2
#dump_modify	2 pad 5 amap 0.0 ${srate} ca 0.0 2 min blue max red

run		50000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay eam rebo saip/metal 16.0 pair style with pair coefficients 1 1 eam  ./Au_u3.eam and p p f boundary conditions with a timestep of 1e-3 running for 1000 steps.","units           metal
atom_style      full
processors      * * 1
boundary        p p f
read_data       ./3Lgold_1Lgr_atop_sliding.data

# global group definition
group          gold type 1
group          gra  type 2

# Define mass
mass            * 12.0107  # mass of carbon atom , uint: a.u.=1.66X10^(-27)kg
mass            1 196.96657  # mass of gold atom , uint: a.u.=1.66X10^(-27)kg

# Define potentials
pair_style 	hybrid/overlay eam rebo saip/metal 16.0
pair_coeff      1 1 eam  ./Au_u3.eam
pair_coeff      * * rebo ./CH.rebo NULL C
pair_coeff      * * saip/metal ./CHAu.ILP Au C

# compute energy
compute         0 all pair rebo
compute         1 all pair eam
compute         2 all pair saip/metal
variable        REBO equal c_0
variable        EAM  equal c_1
variable        ILP  equal c_2

thermo_style    custom step etotal pe ke v_REBO v_ILP temp

thermo          100
thermo_modify   lost error

# Creat initial velocity
velocity        all set 0.0 0.0 0.0
velocity 	gra create 300.0 4928459 mom yes rot yes dist gaussian
velocity 	gold create 300.0 4928459 mom yes rot yes dist gaussian

# Integration
fix             intsub gold nve
fix             intrib gra nve

timestep        1e-3
run		1000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using eam/alloy pair style with pair coefficients * * ptvoterlammps.eam Pt Pt Pt and p p p boundary conditions with a timestep of 0.005 running for 1000 steps.","# 3d EAM surface for global HD

# nearest neighbor distance = a * sqrt(2)/2 = 2.77 Angs for Pt with a = 3.92
# hop event on (100) surface is same distance
# exchange event is 2 atoms moving same distance

variable        Tequil index 500.0
variable        Vmax index 0.5
variable        qfactor index 0.3
variable        cutbond index 3.2
variable        cutevent index 1.1
variable        steps index 100000
variable        nevent index 1000
variable        zoom index 1.8
variable        seed index 826626413
variable        tol index 1.0e-15

units           metal
atom_style	atomic
atom_modify     map array
boundary        p p p

lattice		fcc 3.92
region		box block 0 6 0 6 0 4
create_box	3 box
create_atoms	1 box

mass            * 1.0

change_box      all z final -0.1 5.0 boundary p p f 
create_atoms    2 single 3.5 3.5 4

# define frozen substrate and mobile atoms

group           adatom type 2
region          base block INF INF INF INF 0 1.8
set             region base type 3
group           base type 3
group           mobile type 1 2

# pair style

pair_style	eam/alloy
pair_coeff	* * ptvoterlammps.eam Pt Pt Pt

neighbor	0.5 bin
neigh_modify    every 1 delay 5 check yes

fix		1 mobile nve
fix		2 mobile langevin ${Tequil} ${Tequil} 1.0 ${seed} zero yes

timestep	0.005

compute         tmobile mobile temp

thermo		100
thermo_modify   temp tmobile

# thermal equilibration

run             1000
reset_timestep  0

# pin base so will not move during quenches

fix             freeze base setforce 0.0 0.0 0.0

# event detection

compute         event all event/displace ${cutevent}

# hyper/global

fix             HG mobile hyper/global ${cutbond} ${qfactor} ${Vmax} ${Tequil}

# thermo output

thermo_style    custom step temp pe f_HG f_HG[*]

thermo_modify   lost ignore
thermo_modify   temp tmobile

thermo          ${nevent}

# dump output options

region          substrate block INF INF INF INF 1.8 3.8
region          adatoms block INF INF INF INF 3.8 INF
variable        acolor atom rmask(base)+2*rmask(substrate)+3*rmask(adatoms)

dump		1 all image 1000000 global.*.jpg v_acolor type &
		zoom ${zoom} adiam 2.5 view 0.0 0.0 up 0 1 0 axes yes 0.9 0.01
dump_modify	1 pad 6 amap 1 3 sa 1 3 blue red green

# run

hyper           ${steps} ${nevent} HG event min ${tol} ${tol} 1000 1000 dump 1
"
"Generate a LAMMPS input script for a general simulation of an full system using lj/cut 10. pair style with pair coefficients * * 0.2381 3.405 and p p p boundary conditions with a timestep of 0.0005 running for 1000 steps.","# Tests Poisson solver, charge density restriction
# and electric field force prolongation
# Two groups of charged particles interact electrically
# using the long range electric field only, so they will 
# move towards each other
echo both
units 		metal
variable E equal 20.0
variable nx equal 16
# allow charges
atom_style full
dielectric      1.
dimension	3
boundary	p p p
lattice 	fcc   4.08 origin 0.25 0.25 0.25
region BOX block -8 8 0 3 0 3
create_box   3 BOX
create_atoms 1 region BOX
pair_style     lj/cut 10.
#pair_style	lj/cut/coul/long 10.
#kspace_style	pppm 1.e-4
#kspace_style	ewald 1.e-4
pair_coeff * * 0.2381 3.405
mass 		* 39.948
group  real region BOX
region LEFT block -5 -2 INF INF INF INF
region RIGHT block 2 5 INF INF INF INF
set             region LEFT type 2
set             region RIGHT type 3
set             region LEFT charge -1.
set             region RIGHT charge 1.
group		NION region LEFT
group		PION region RIGHT
neighbor        2. bin
###########################################################################
#fix EFIELD all efield $E 0.0 0.0
###########################################################################
fix         ATC real atc species_electrostatic Ar_species.mat
fix_modify  ATC add_species N group NION
fix_modify  ATC add_species P group PION
fix_modify  ATC  include atomic_charge
fix_modify  ATC  internal_quadrature off
fix_modify  ATC extrinsic short_range off
fix_modify  ATC mesh create ${nx} 1 1 BOX p p p
fix_modify  ATC atom_element_map eulerian 1
fix_modify  ATC  atom_weight multiscale
fix_modify  ATC  initial mass_density all 0.
#fix_modify  ATC  initial charge_density all 0.
fix_modify  ATC  initial electric_potential all 0. 
fix_modify  ATC mesh create_nodeset left_end -8.01 -7.99 -.1 .1 -.1 .1
fix_modify  ATC  fix electric_potential left_end 0.
#fix_modify  ATC mesh create_nodeset right_end 7.99 8.01 -.1 .1 -.1 .1
#fix_modify  ATC  fix electric_potential right_end 0.
# quick test for charged surfaces
#fix_modify  ATC mesh create_faceset left_end box -8 10 -10 10 -10 10 outward
#fix_modify  ATC extrinsic fix_charge left_end 0.
fix_modify  ATC  add_species NION type 2
fix_modify  ATC  add_species PION type 3
###########################################################################
variable n equal count(real)
print ""number of atoms: $n""
timestep 	0.0005
thermo		100
compute   Fn NION reduce sum fx
compute   Fp PION reduce sum fx
thermo_style 	custom step etotal temp press pe c_Fn c_Fp
# initial thermo line should be:
#0    13699.992            0     12453927    13699.992    880.49388   -880.49388
fix_modify  ATC  output opp_forceFE 100 text binary
run 1000
"
"Generate a LAMMPS input script for a NPT simulation of an full system using born/coul/long/cs 20.0 20.0    # A, rho, sigma=0, C, D pair style with pair coefficients * *      0.0 1.000   0.00  0.00   0.00 and p	p	p boundary conditions with a timestep of 0.002 running for 500 steps.","# Testsystem for core-shell model compared to Mitchell and Fincham
# Hendrik Heenen, June 2014

# ------------------------ INITIALIZATION ----------------------------

units 		metal
dimension	3
boundary	p	p	p
atom_style	full

# ----------------------- ATOM DEFINITION ----------------------------

fix csinfo all property/atom i_CSID
read_data data.coreshell fix csinfo NULL CS-Info

group cores type 1 2
group shells type 3 4

neighbor 2.0 bin
comm_modify vel yes

# ------------------------ FORCE FIELDS ------------------------------

kspace_style ewald 1.0e-6
pair_style   born/coul/long/cs 20.0 20.0    # A, rho, sigma=0, C, D 
pair_coeff   * *      0.0 1.000   0.00  0.00   0.00
pair_coeff   3 3    487.0 0.23768 0.00  1.05   0.50 #Na-Na
pair_coeff   3 4 145134.0 0.23768 0.00  6.99   8.70 #Na-Cl
pair_coeff   4 4 405774.0 0.23768 0.00 72.40 145.40 #Cl-Cl

bond_style harmonic
bond_coeff 1 63.014 0.0
bond_coeff 2 25.724 0.0

# ------------------------ Equilibration Run -------------------------------

reset_timestep 0

thermo 50
thermo_style custom step etotal pe ke temp press &
             epair evdwl ecoul elong ebond fnorm fmax vol

compute CStemp all temp/cs cores shells 
compute thermo_press_lmp all pressure thermo_temp # press for correct kinetic scalar

# output via chunk method

#compute prop all property/atom i_CSID
#compute cs_chunk all chunk/atom c_prop
#compute cstherm all temp/chunk cs_chunk temp internal com yes cdof 3.0
#fix ave_chunk all ave/time 100 1 100 c_cstherm file chunk.dump mode vector 

thermo_modify temp CStemp press thermo_press_lmp

# 2 fmsec timestep

timestep 0.002

# velocity bias option

velocity all create 1427 134 dist gaussian mom yes rot no bias yes temp CStemp
velocity all scale 1427 temp CStemp

# thermostating using the core/shell decoupling 

fix thermoberendsen all temp/berendsen 1427 1427 0.4
fix nve all nve
fix_modify thermoberendsen temp CStemp

run 500

unfix thermoberendsen
unfix nve

fix npt_equ all npt temp 1427 1427 0.04 iso 0 0 0.4
fix_modify npt_equ temp CStemp press thermo_press_lmp # pressure for correct kinetic scalar

run 500

unfix npt_equ

# ------------------------ Dynamic Run -------------------------------

fix npt_dyn all npt temp 1427 1427 0.04 iso 0 0 0.4
fix_modify npt_dyn temp CStemp press thermo_press_lmp # pressure for correct kinetic scalar
run 1000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/smooth/linear 5.456108274435118 pair style with pair coefficients * * 0.7242785984051078 2.598146797350056 and f p p boundary conditions with a timestep of 0.0 running for 1 steps.","# This test compares Hardy and Cauchy-Born metrics of energy density and stress
# for an Ar system subjected to uniaxial strain deformation.
echo both
units		real	
atom_style	atomic
# create domain
lattice         fcc 4.08 origin 0.25 0.25 0.25
region		BOX block -8 8 -2 2 -2 2
boundary	f p p
create_box	1 BOX
# create atoms
region		MD block -7 7 -2 2 -2 2
create_atoms	1 region MD
#pair_style  eam
#pair_coeff  * * Au_u3.eam
#pair_style      lj/cut/smooth 5.456108274435118
pair_style      lj/smooth/linear 5.456108274435118
pair_coeff      * * 0.7242785984051078 2.598146797350056
mass          *  196.97
# specify interal/ghost atoms
region    FREE block -6 6 -2 2 -2 2
group   internal region FREE
# specify inter-atomic potential
# specify neighbor/re-neighboring parameters
neighbor	0.3 bin
neigh_modify	every 10 delay 0 check no
# setup thermal output
thermo		10
thermo_style custom step pe ke press lx ly lz
#           ID  group atc PhysicsType ParameterFile
fix         PP1 internal   atc field Au_CauchyBorn_linear.mat
fix_modify  PP1 mesh create 8 1 1 BOX f p p
fix_modify  PP1  fields add displacement 
fix_modify  PP1  fields add internal_energy stress cauchy_born_energy cauchy_born_stress
fix_modify  PP1  gradients add displacement 
fix_modify  PP1  set reference_potential_energy 0 # correct cb and messes pe
#           ID  group atc PhysicsType ParameterFile
fix         PP2 internal   atc field Au_CauchyBorn.mat
fix_modify  PP2 mesh create 8 1 1 BOX f p p
fix_modify  PP2  fields add cauchy_born_energy cauchy_born_stress internal_energy
fix_modify  PP2  set reference_potential_energy
timestep 0.0
fix_modify  PP1  output cb_unistrain_linearFE 1 text tensor_components binary
fix_modify  PP2  output cb_unistrain_refFE    1 text tensor_components 
log       cb_unistrain_linear.log
variable step  equal 0
thermo_style  custom step v_step pe ke press lx ly lz
run 	1
variable step equal ${step}+1
displace_atoms	all ramp x -0.1 0.1 x -100 100
run		1
variable step equal ${step}+1
displace_atoms	all ramp x -0.1 0.1 x -100 100
run		1
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13. pair style and f p p boundary conditions with a timestep of 0 running for 1 steps.","# Computes elastic waves propagating in and out of a finite temperature region
#AtC ThermoElastic Coupling
echo both

units		real
atom_style	atomic

# create domain
#lattice	type reduced density rho* = 4*(sigma/a)^3, where N=4 for fcc, s = 3.405 A (Wagner) and a = 5.25 A (Ashcroft & Mermin, p. 70)
lattice         fcc 5.2582305 origin 0.25 0.25 0.25

# NOTE following 3 lines added for restart
boundary        f p p
pair_style      lj/cut 13.
read_data       temp.init
region		simRegion block -12 12 -3 3 -3 3
# create atoms, NOTE commented out for restart
#region		mdRegion block -8 8 -3 3 -3 3
#boundary	f p p
#region		mdBox block -9 9 -3 3 -3 3
#create_box	1 mdBox
#create_atoms	1 region mdRegion
#mass		1 39.95

# specify interal/ghost atoms
region		mdInternal block -6 6 -3 3 -3 3
region		leftghost block -8 -6 -3 3 -3 3
region		rightghost block 6 8 -3 3 -3 3
group		internal region mdInternal
group		Lghost region leftghost
group		Rghost region rightghost
group		ghosts union Lghost Rghost

# velocities have Vcm = 0, NOTE next for lines commented out for restart
#velocity	internal create 40. 87287 mom yes loop geom
#pair_style	lj/cut 13.
##pair_coeff	1 1 0.010323166 3.405 13.
#pair_coeff  	1 1 .2381 3.405 13.

neighbor	5. bin
neigh_modify	every 10 delay 0 check no
#write_restart  tinit.dat

# zero initial momentum
fix             AtC internal   atc elastic     Ar_thermo_elastic.mat
#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 12  1  1  simRegion f p p
fix_modify      AtC mesh create_faceset obndy box -6.0 6.0 -INF INF -INF  INF outward
fix_modify      AtC internal_quadrature off
fix_modify	AtC fix displacement x all 0.
fix_modify      AtC fix displacement y all 0.
fix_modify      AtC fix displacement z all 0.
fix_modify      AtC fix velocity x all 0.
fix_modify      AtC fix velocity y all 0.
fix_modify      AtC fix velocity z all 0.
fix_modify      AtC control momentum glc_velocity
#fix_modify      AtC  output bar1d_thermo_elastic_initializeFE 1 text #binary
timestep        0
thermo          1
run             1
unfix AtC

# define  layer
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc thermo_elastic     Ar_thermo_elastic.mat
fix_modify	AtC boundary ghosts

#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 12  1  1  simRegion f p p
fix_modify      AtC mesh create_faceset obndy box -6.0 6.0 -INF INF -INF  INF outward
fix_modify      AtC internal_quadrature off

# initial conditions 
fix_modify  AtC  initial displacement x all 0.0
fix_modify  AtC  fix displacement y all 0.0
fix_modify  AtC  fix displacement z all 0.0
fix_modify  AtC  initial velocity x all 0.0
fix_modify  AtC  fix velocity y all 0.0
fix_modify  AtC  fix velocity z all 0.0
fix_modify  AtC  fix temperature all 20.

# set node sets and bcs
#           ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
fix_modify  AtC mesh create_nodeset lbc -12.1  -11.9   -INF INF  -INF INF
fix_modify  AtC mesh create_nodeset rbc  11.9   12.1   -INF INF  -INF INF
#fix_modify  AtC  fix velocity x rbc 0.
#fix_modify  AtC  fix displacement x rbc 0.
fix_modify  AtC  fix displacement x lbc 0.
fix_modify  AtC  fix velocity x lbc 0.

# rescale thermostat for initial atomic temperatures
fix_modify      AtC  control thermal rescale 10
fix_modify      AtC control momentum ghost_flux
fix_modify      AtC  output bar1d_thermo_elasticFE 100 text #binary
timestep        5
thermo          100
run             1000

# free all nodes
#fix_modify  AtC  unfix displacement x all
#fix_modify  AtC  unfix velocity x all
fix_modify  AtC  unfix temperature all

# new boundary conditions
fix_modify  AtC  fix velocity x rbc 0.00000004
fix_modify  AtC fix temperature lbc 20.


#fix_modify      AtC  output follow_ex.fe 50
#fix_modify	AtC  localized_lambda on
#fix_modify	AtC  momentum control glc_velocity
#fix_modify	AtC  momentum control flux faceset obndy
#fix_modify     AtC control momentum flux
#fix_modify	AtC control momentum ghost_flux
fix_modify	AtC control thermal flux
#fix_modify      AtC  filter scale 1000.0

# run to extension
compute		myTemp internal temp
compute		atomStress internal stress/atom NULL
compute		avgStress internal reduce sum c_atomStress[1] c_atomStress[2] c_atomStress[3]
variable	myPres equal -(c_avgStress[1]+c_avgStress[2]+c_avgStress[3])/(3*vol)
thermo_style	custom step c_myTemp v_myPres pe
fix_modify      AtC  output bar1d_thermo_elasticFE 500 text
#dump            D1 all custom 100 bar1d_thermo_elastic.dmp id type x y z vx vy vz
timestep	5
thermo		100
run 		1000

# change nodes to fixed
fix_modify      AtC  unfix velocity x rbc 0.
#fix_modify	AtC  fix displacement x rbc 0.0002

#fix_modify      AtC  output bar1d_fluxFE 500 text binary

# run to equilibrium
timestep        5
thermo		100
run 		3000
"
"Generate a LAMMPS input script for a general simulation of an full system with a timestep of 0.001 running for 0 steps.","# Series of single-point calcs of 2,3,4 UO2 molecules
# with LATTE in MDI stand-alone mode

variable        files index 2uo2 3uo2 4uo2

mdi             connect

label LOOP

  units           metal
  atom_style      full

  read_data       data.${files}

  neighbor        0.3 bin
  neigh_modify    every 1 delay 0 check yes

  timestep        0.001

  fix             1 all mdi/qm virial yes elements U O connect no

  thermo_style    custom step temp pe etotal press
  thermo          1

  run             0

  #write_dump      all custom dump.series.mpi.${files} &
  #                id type x y z fx fy fz modify sort id

  clear

next            files

jump            SELF LOOP

mdi             exit
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay          & pair style with pair coefficients 1     1     lj/cut/coul/long 0.5 1.775 3.268        # HG   HG with a timestep of 0.002 running for 2000 steps.","# Ionic surfactant system: S12S

units           lj
dimension       3
atom_style      full

read_data       data.gauss-diel

pair_style      hybrid/overlay          &
                lj/cut 3.5              &
                lj/cut/coul/long 8.0    &
                gauss/cut 3.4           &
                coul/diel 2.5
pair_modify    shift yes

dielectric      0.4255
kspace_style    pppm 0.0001
kspace_modify   mesh 30 30 30 order 3

bond_style      harmonic
angle_style     harmonic
dihedral_style  opls

pair_coeff  1     1     lj/cut/coul/long 0.5 1.775 3.268        # HG   HG  
pair_coeff  1     1     gauss/cut        0.1 2.549 0.1525           
pair_coeff  1     2     lj/cut           0.31623 1.5329 1.7206  # HG   CM  
pair_coeff  1     3     lj/cut           0.31623 1.5329 1.7206  # HG   CT  
pair_coeff  1     4     lj/cut/coul/long 0.05 1.75 4.375        # HG   CI  
pair_coeff  1     4     gauss/cut        0.2805 1.45 0.112 
pair_coeff  1     4     coul/diel        78. 1.375 0.112 
pair_coeff  2     2     lj/cut           0.2000 1.2910 3.2275   # CM   CM  
pair_coeff  2     3     lj/cut           0.2000 1.2910 3.2275   # CM   CT  
pair_coeff  2     4     lj/cut           0.4472 1.1455 1.28585  # CM   CI  
pair_coeff  3     3     lj/cut           1.95 1.291 3.2275      # CT   CT  
pair_coeff  3     4     lj/cut           0.4472 1.1455 1.28585  # CT   CI  
pair_coeff  4     4     lj/cut/coul/long 1.0 10. 1.12246          # CI   CI 

bond_coeff  1      12650.0000   0.7500 # HG CM FROM TOP
bond_coeff  2      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  3      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  4      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  5      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  6      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  7      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  8      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  9      12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  10     12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  11     12650.0000   0.5000 # CM CM FROM TOP
bond_coeff  12     12650.0000   0.5000 # CM CT FROM TOP

angle_coeff 1           85.7600 109.5000 # HG CM CM FROM TOP
angle_coeff 2           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 3           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 4           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 5           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 6           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 7           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 8           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 9           85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 10          85.7600 111.0000 # CM CM CM FROM TOP
angle_coeff 11          85.7600 111.0000 # CM CM CT FROM TOP

dihedral_coeff 1     5.7431 -2.53241 5.0742 0.0 # HG CM CM CM FROM TOP
dihedral_coeff 2     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 3     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 4     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 5     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 6     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 7     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 8     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 9     5.7431 -2.53241 5.0742 0.0 # CM CM CM CM FROM TOP
dihedral_coeff 10    5.7431 -2.53241 5.0742 0.0 # CM CM CM CT FROM TOP

timestep        0.002  

reset_timestep  0

group           cions type 4
group           sds subtract all cions

velocity        all create 1. 87287 dist gaussian

neighbor        1.5 multi
neigh_modify    exclude molecule/intra sds
neigh_modify    every 5 delay 0 check yes

fix             1 all nve/limit 0.2
fix             2 all langevin 1.0 1.0 0.05 18273

thermo_style    multi
thermo          500

run             2000
"
"Generate a LAMMPS input script for a NVE simulation of an electron system using eff/cut 100.0 pair style with pair coefficients * * and f f f boundary conditions with a timestep of 0.005 running for 100000 steps.","variable        sname index ch4

units           electron
newton          on
boundary        f f f

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 100.0
pair_coeff      * *

comm_modify     vel yes 

# Minimize
min_style       cg
compute         1 all property/atom spin eradius
#dump            1 all custom 1 ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z
min_modify      line quadratic dmax 0.1
minimize        0 1.0e-6 1000 10000

# Dynamics

compute         effTemp all temp/eff

thermo          1000
thermo_style    custom step pe temp press 
thermo_modify   temp effTemp

velocity        all create 300.0 4928459 dist gaussian rot yes mom yes

timestep        0.005
fix             1 all nve/eff

# the custom dump includes the radii
#dump            2 all custom 1000 ${sname}.nve.lammpstrj id type q c_1[1] c_1[2] x y z
#dump           3 all xyz 1000 ${sname}.nve.xyz 

run             100000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using eam pair style with pair coefficients * * ../../../../potentials/Au_u3.eam and p p p boundary conditions with a timestep of 0.0 running for 1 steps.","# This test examines the convergence of the Hardy localization (kernel) function
# with respect to its range for the calculation of stress. 
echo both
log    eam_kernel_convergence.log  
units    metal
dimension  3
boundary  p p p
atom_style      atomic
# create system
variable a equal 4.08
lattice		fcc $a
region    SYSTEM    block -6 6 -6 6 -6 6
create_box  1 SYSTEM 
create_atoms  1 region SYSTEM
mass    1 196.97 
group    internal region SYSTEM 
# n-th shell at sqrt(n/2) * a for FCC
# distances 1:2.9   2:4.1  3:5.1   4:5.8   5:6.5
# counts    1:12:12 2:6:18 3:24:42 4:12:54 5:24:78 
pair_style  eam
pair_coeff    * * ../../../../potentials/Au_u3.eam
# specify neighbor/re-neighboring parameters
neighbor  0.3 bin
neigh_modify  delay 1000000
thermo    10
thermo_style	custom step ke pe pxx pyy pzz pxy
timestep  0.0
reset_timestep  0
velocity	all set 0.0 0.0 0.0 sum no units box
fix         ATC internal atc hardy
fix_modify  ATC mesh create 1 1 1 SYSTEM p p p
fix_modify  ATC  fields none
fix_modify  ATC  fields add mass_density stress number_density
##fix_modify  ATC  set reference_potential_energy
fix_modify  ATC  output        eam_kernel_convergenceFE 1 text tensor_components
##fix_modify  ATC  on_the_fly kernel on  ## NOTE HACK REJ 8Jan13 temporary
##fix_modify  ATC  on_the_fly bond on
 
# relative to a
variable d equal 0.1
variable n equal 60
variable i loop $n
label loop_i
  variable R equal $i*$d 
  variable Ra equal $R*$a
  fix_modify	ATC  kernel quartic_sphere ${Ra}
# initial (1)
run 1
# increment (2)
next i
jump in.eam_kernel_convergence loop_i
"
"Generate a LAMMPS input script for a NVE simulation of an ellipsoid system using resquared 1 pair style with pair coefficients 1 1 10.0 1.0 0.5 0.5 4 0.5 0.5 4 1 and p p f boundary conditions with a timestep of 0.0002 running for 40000 steps.","units lj
atom_style ellipsoid
boundary p p f
read_data Data_wall
#------------------------------------#
pair_style resquared 1
pair_coeff 1 1 10.0 1.0 0.5 0.5 4 0.5 0.5 4 1
#------------------------------------#
timestep 0.0002
#------------------------------------#

compute temp all temp/asphere
thermo_modify temp temp

fix EES_substrate all wall/ees zhi EDGE 10 1 10 zlo EDGE 10 1 10
#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^#

thermo_style custom step temp press etotal f_EES_substrate f_EES_substrate[1]

fix NVE all nve/asphere
#------------------------------------#
compute qw all  property/atom quatw
compute qi all  property/atom quati
compute qj all  property/atom quatj
compute qk all  property/atom quatk
#------------------------------------#
thermo 500
#dump 1 all custom 1000 dump_substrate id type x y z c_qw c_qi c_qj c_qk 
run 40000

"
"Generate a LAMMPS input script for a NVE simulation of an full system using born/coul/long/cs 20.0 20.0    # A, rho, sigma=0, C, D pair style with pair coefficients * *      0.0 1.000   0.00  0.00   0.00 and p	p	p boundary conditions with a timestep of 0.002 running for 500 steps.","# Testsystem for core-shell model compared to Mitchel and Finchham
# Hendrik Heenen, June 2014

# ------------------------ INITIALIZATION ----------------------------

units 		metal
dimension	3
boundary	p	p	p
atom_style	full

# ----------------------- ATOM DEFINITION ----------------------------

fix csinfo all property/atom i_CSID
read_data data.coreshell fix csinfo NULL CS-Info

group cores type 1 2
group shells type 3 4

neighbor 2.0 bin
comm_modify vel yes

# ------------------------ FORCE FIELDS ------------------------------

kspace_style ewald 1.0e-6
pair_style   born/coul/long/cs 20.0 20.0    # A, rho, sigma=0, C, D 
pair_coeff   * *      0.0 1.000   0.00  0.00   0.00
pair_coeff   3 3    487.0 0.23768 0.00  1.05   0.50 #Na-Na
pair_coeff   3 4 145134.0 0.23768 0.00  6.99   8.70 #Na-Cl
pair_coeff   4 4 405774.0 0.23768 0.00 72.40 145.40 #Cl-Cl

bond_style harmonic
bond_coeff 1 63.014 0.0
bond_coeff 2 25.724 0.0

# ------------------------ Equilibration Run -------------------------------

reset_timestep 0

thermo 50
thermo_style custom step etotal pe ke temp press &
             epair evdwl ecoul elong ebond fnorm fmax vol

compute CStemp all temp/cs cores shells 
compute thermo_press_lmp all pressure thermo_temp # press for correct kinetic scalar

# output via chunk method

#compute prop all property/atom i_CSID
#compute cs_chunk all chunk/atom c_prop
#compute cstherm all temp/chunk cs_chunk temp internal com yes cdof 3.0
#fix ave_chunk all ave/time 100 1 100 c_cstherm file chunk.dump mode vector 

thermo_modify temp CStemp press thermo_press_lmp

# velocity bias option

velocity all create 1427 134 dist gaussian mom yes rot no bias yes temp CStemp
velocity all scale 1427 temp CStemp

# thermostating using the core/shell decoupling

fix thermoberendsen all temp/berendsen 1427 1427 0.4
fix nve all nve
fix_modify thermoberendsen temp CStemp

# 2 fmsec timestep

timestep 0.002
run 500

unfix thermoberendsen

# ------------------------ Dynamic Run -------------------------------

run 1000
"
"Generate a LAMMPS input script for a general simulation with a timestep of ${delta_t} running for 1000 steps.","## This script first uses fix qtb to equilibrate alpha quartz structure to an initial state with quantum nuclear correction and then simulate shock induced phase transition through the quantum thermal bath multi-scale shock technique
variable                x_rep equal 2   #plot is made with x_rep = 8                                            #x-direction replication number
variable                y_rep equal 1   #plot is made with y_rep = 5                                            #y-direction replication number
variable                z_rep equal 4   #plot is made with z_rep = 15                                           #z-direction replication number
variable                cut_off equal 10.0                                                                      #Cut-off distance for the Buckingham term (Angstrom in metal units)
variable                pressure equal 1.03125                                                                  #Initial state pressure (bar in metal units)
variable                temperature equal 300.0                                                                 #Initial state quantum temperature (K in metal units)
variable                delta_t equal 1.0e-3                                                                    #MD timestep length (ps in metal units)
variable                damp_qtb equal 1                                                                        #1/gamma where gamma is the friction coefficient in quantum thermal bath (ps in metal units)
variable                v_msst equal 78.0                                                                       #Shock velocity (Angstrom/ps in metal units)
variable                q_msst equal 40.0                                                                       #Box mass-like parameter in the MSST (mass^2/length^4, where mass=grams/mole and length=Angstrom in metal units)
variable                tscale_msst equal 0.05                                                                  #Temperature reduction parameter in the MSST (unitless)
variable                eta_qbmsst equal 1.0                                                                    #Coupling constant between the shock and the quantum thermal bath (unitless constant)


## This part uses fix qtb to prepare alpha-quartz with quantum nuclear correction of the initial state
include                 alpha_quartz_qtb.mod


## This part demonstrates how to retart fix qbmsst during any stage of the shock simulation.
## PPPM may break down when compression ratio becomes extremely large. One can always use this restart technique to resume the shock simulation.
#Compression restart 1
reset_timestep          0
#Beta is the number of time steps between each update of the quantum bath temperature. Setting a larger beta can reduce thermal flactuations.
fix                     shock all qbmsst z ${v_msst} q ${q_msst} tscale ${tscale_msst} damp ${damp_qtb} f_max 120 N_f 100 seed 35082 eta ${eta_qbmsst} beta 5 T_init ${temperature}
variable                dhug equal f_shock[1]
variable                dray equal f_shock[2]
variable                lgr_vel equal f_shock[3]
variable                lgr_pos equal f_shock[4]
variable                T_qm equal f_shock[5]                                                                   #Temperature with quantum nuclear correction
thermo_style            custom step v_T_qm press econserve vol lx ly lz pzz v_dhug v_dray v_lgr_vel v_lgr_pos
thermo                  200
timestep                ${delta_t}
run                     1000
write_restart           restart.1000

#Compression restart 2
#Read restart file and load potential again
clear
read_restart            restart.1000
include                 alpha_quartz_potential.mod
#Use the same fix id and add no tscale if the system is already compressed
fix                     shock all qbmsst z ${v_msst} q ${q_msst} tscale 0.0 damp ${damp_qtb} f_max 120 N_f 100 seed 35082 eta ${eta_qbmsst} beta 5 T_init ${temperature}
variable                dhug equal f_shock[1]
variable                dray equal f_shock[2]
variable                lgr_vel equal f_shock[3]
variable                lgr_pos equal f_shock[4]
variable                T_qm equal f_shock[5]                                                                   #Temperature with quantum nuclear correction
thermo_style            custom step v_T_qm press econserve vol lx ly lz pzz v_dhug v_dray v_lgr_vel v_lgr_pos
thermo                  500
timestep                ${delta_t}
#restart                 1000 restart
run                     10000                                                                                   #10 ps
shell rm restart.1000
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using sw pair style with pair coefficients * * Si.sw Si and p p p boundary conditions with a timestep of 1.0e-3 running for 100 steps.","# Parallel replica dynamics model for a single vacancy in bulk Si
# events occur when a neighboring atom diffuses to the vacant site
# run this on multiple partitions as
#   mpirun -np 4 lmp_g++ -partition 4x1 -in in.prd

#log             none

units           metal

atom_style      atomic
atom_modify     map array
boundary        p p p
atom_modify	sort 0 0.0

# temperature

variable t equal 1800.0

# coordination number cutoff

variable r equal 2.835

# minimization parameters

variable etol equal 1.0e-5
variable ftol equal 1.0e-5
variable maxiter equal 100
variable maxeval equal 100
variable dmax equal 1.0e-1

# diamond unit cell

variable a equal 5.431
lattice         custom $a               &
                a1 1.0 0.0 0.0          &
                a2 0.0 1.0 0.0          &
                a3 0.0 0.0 1.0          &
                basis 0.0 0.0 0.0       &
                basis 0.0 0.5 0.5       &
                basis 0.5 0.0 0.5       &
                basis 0.5 0.5 0.0       &
                basis 0.25 0.25 0.25    &
                basis 0.25 0.75 0.75    &
                basis 0.75 0.25 0.75    &
                basis 0.75 0.75 0.25

region          myreg block     0 4 &
                                0 4 &
                                0 4
create_box      1 myreg
create_atoms    1 region myreg

mass            1       28.06

group Si type 1

velocity all create $t 5287287 mom yes rot yes dist gaussian

# make a vacancy

group del id 300
delete_atoms group del

pair_style      sw
pair_coeff * * Si.sw Si

thermo          10

fix             1 all nvt temp $t $t 0.1

timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes

# equilibrate

run             100

# only output atoms near vacancy

compute coord all coord/atom cutoff $r

#dump events all custom 1 dump.prd id type x y z
#dump_modify events thresh c_coord != 4

compute  patom all pe/atom
compute  pe all reduce sum c_patom
compute  satom all stress/atom NULL
compute  str all reduce sum c_satom[1] c_satom[2] c_satom[3]
variable press equal (c_str[1]+c_str[2]+c_str[3])/(3*vol)

thermo_style custom step temp pe c_pe press v_press

compute         1 all event/displace 0.5

prd  2000 100 10 10 100 1 54985 temp $t &
     min ${etol} ${ftol} ${maxiter} ${maxeval} vel all uniform
"
"Generate a LAMMPS input script for a NVT simulation of an full system using mesocnt 40 chain pair style with pair coefficients * * C_10_10.mesocnt 1 and p p s boundary conditions with a timestep of 0.01 running for 100 steps at temperature 300.0.","# initialisation

units             metal
dimension         3
boundary          p p s
atom_style        full
special_bonds     lj 1 1 1
neigh_modify      every 5 delay 0 check yes
newton            on

read_data         data.film_mesocnt

# force field

bond_style        mesocnt
bond_coeff        1 C 10 10 10

angle_style       mesocnt
angle_coeff       1 buckling C 10 10 10

pair_style        mesocnt 40 chain
pair_coeff        * * C_10_10.mesocnt 1

# output

compute         epair all pe pair
compute         ebond all pe bond
compute         eangle all pe angle

compute         epair_atom all pe/atom pair
compute         ebond_atom all pe/atom bond
compute         eangle_atom all pe/atom angle

fix             angle_mesocnt_buckled all property/atom i_buckled ghost yes

thermo_style    custom step temp etotal ke pe c_ebond c_eangle c_epair
thermo 10
#dump            custom all custom 100 film_mesocnt.lmp id mol type x y z c_ebond_atom c_eangle_atom c_epair_atom i_buckled

# simulation setup

velocity        all create 600.0 2022 loop geom
timestep        0.01
fix             nvt all nvt temp 300.0 300.0 1

run             100
"
"Generate a LAMMPS input script for a NVE simulation of an molecular system using hybrid/overlay table spline 500 local/density pair style with pair coefficients 1     1 table         methanol_implicit_water.pair.table PairMM and p p p boundary conditions with a timestep of 1.0 running for 2000 steps.","# LAMMPS input file for 50.0% methanol mole fraction solution
# with 2500 methanol molecules in implicit water.
#
#
# Author: David Rosenberger, van der Vegt Group, TU Darmstadt
#
# Refer: Rosenberger, Sanyal, Shell, van der Vegt, J. Chem. Theory Comput. 15, 2881-2895 (2019)


# Initialize simulation box
dimension       3
boundary        p p p
units           real
atom_style      molecular

# Set potential styles
pair_style      hybrid/overlay table spline 500 local/density

# Read molecule data and set initial velocities
read_data       methanol_implicit_water.data
velocity        all create  3.0000e+02 12142 rot yes dist gaussian

# Assign potentials
pair_coeff          1     1 table         methanol_implicit_water.pair.table PairMM
pair_coeff          *     * local/density methanol_implicit_water.localdensity.table




#Recentering during minimization and equilibration
fix recentering all recenter 0.0 0.0 0.0 units box

#Thermostat & time integration
timestep        1.0
thermo          100
thermo_style    custom etotal ke pe temp evdwl

#minimization
minimize        1.e-4 0.0 1000 1000

#set up integration parameters
fix             timeintegration all nve
fix             thermostat all langevin  3.0000e+02  3.0000e+02  1.0000e+02 59915

#Equilibration (for realistic results, run for 2000000  steps)
reset_timestep  0
thermo          200
thermo_style    custom etotal ke pe temp evdwl

#run equilibration
run             2000

#turn off recentering during production run
unfix recentering
reset_timestep  0

#setup trajectory output
#dump            myDump all custom 100 methanol_implicit_water.lammpstrj.gz id type x y z element
#dump_modify     myDump element M
#dump_modify     myDump sort id

#run production (for realistic results, run for 10000000 steps)
thermo          1000
thermo_style    custom etotal ke pe temp  evdwl
run             10000


"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 1.0 1.0 running for 1000 steps.","# 3d Lennard-Jones melt

variable	x index 1
variable	y index 1
variable	z index 1

variable	xx equal 20*$x
variable	yy equal 20*$y
variable	zz equal 20*$z

units		lj
atom_style	atomic

lattice		fcc 0.8442
region		box block 0 ${xx} 0 ${yy} 0 ${zz}
create_box	1 box
create_atoms	1 box
mass		1 1.0

velocity	all create 1.44 87287 loop geom

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0

neighbor	0.3 bin
neigh_modify	delay 0 every 20 check no

fix		1 all nve

dump            1 all custom 100 lj.dump id type x y z

compute         myRDF all rdf 50 cutoff 2.5
fix             2 all ave/time 100 10 1000 c_myRDF[*] file rdf.first mode vector

thermo          100
run		1000
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style with pair coefficients 1 1 .238 3.405 13.5 and f f f # p boundary conditions with a timestep of 1.0 running for 100 steps.","echo both
units    real
atom_style  atomic

variable L equal 12
variable l2 equal 6
variable l equal 4
variable w equal 2

lattice         fcc 5.405 origin 0.25 0.25 0.25
region     mdInternal block -$l $l -$l $l -$w $w

boundary  f f f # p
pair_style  lj/cut 13.5
read_data temp.init
fix ZWALLS all wall/reflect zlo EDGE zhi EDGE
mass    1 39.95
pair_coeff    1 1 .238 3.405 13.5
group    internal region mdInternal

fix             AtC internal   atc two_temperature  Ar_ttm.mat
fix_modify      AtC mesh read  gaussianIC2d_tet.mesh
#fix_modify      AtC mesh read  gaussianIC2d_tet.exo
fix_modify      AtC mesh write  parsed_gaussianIC2d_tet.mesh
fix_modify      AtC mesh output  parsed_gaussianIC2d_tetMESH
fix_modify      AtC  output    gaussianIC2d_tetFE 10 full_text

fix_modify AtC initial temperature      all 20.0
# NOTE this is only gaussian in x
fix_modify AtC initial electron_temperature all gaussian 0 0 0 1 0 0 5 20 20
fix_modify AtC fix temperature   11 20.0
fix_modify AtC fix temperature   12 20.0
fix_modify AtC control thermal flux
fix_modify AtC extrinsic exchange on
fix_modify AtC extrinsic electron_integration explicit 10

thermo_style custom step temp pe f_AtC[2] f_AtC[4]
timestep  1.0
thermo    10
run     100
"
"Generate a LAMMPS input script for a general simulation using none pair style and p p p boundary conditions with a timestep of 0.001 running for 0 steps.","variable  A string bulkNi

boundary        p p p

units		metal
timestep	0.001

lattice         fcc 3.52
region          box block 0 20 0 20 0 20
create_box      1 box
create_atoms    1 box

pair_style      none
mass            * 58.71
atom_modify     sort 0 0

compute         XRD all xrd  1.541838 Ni 2Theta 40 80 c 2 2 2 LP 1 echo

compute         SAED all saed 0.0251  Ni Kmax 0.85 &
                Zone 0 0 0 c 0.025 0.025 0.025 &
                dR_Ewald 0.01 echo manual

fix             1 all ave/histo/weight 1 1 1 40 80 200 c_XRD[1] c_XRD[2] &
                mode vector file $A.hist.xrd

fix             2 all saed/vtk 1 1 1 c_SAED file $A_001.saed 

#dump            1 all custom 1 $A.dump id x y z 
run             0

unfix           1
unfix           2
uncompute       XRD
uncompute       SAED
"
"Generate a LAMMPS input script for a NVE simulation of an body rounded/polyhedron 1 8 system using body/rounded/polyhedron ${c_n} ${c_t} ${mu} ${A_ua} ${cut_inner} pair style with pair coefficients * * ${k_n} ${k_na} and p p fm boundary conditions with a timestep of 0.001 running for ${steps} steps.","# pouring 3d rounded polyhedron bodies

variable    steps index 6000

units       lj
boundary    p p fm
comm_modify vel yes

atom_style  body rounded/polyhedron 1 8
atom_modify map array

region		reg block 0 50 0 50 0 50 units box
create_box	4 reg

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 5
variable c_n        equal 20
variable c_t        equal 5
variable mu         equal 0
variable A_ua       equal 1

pair_style body/rounded/polyhedron ${c_n} ${c_t} ${mu} ${A_ua} ${cut_inner}
pair_coeff * * ${k_n} ${k_na}

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

fix          1 all nve/body
fix          2 all gravity 1.0 spherical 0.0 -180.0

molecule     object molecule.cube molecule.tetra toff 1 &
             molecule.rod3d toff 2 molecule.point3d toff 3

region       slab block 5 45 5 45 25 35 units box
fix          ins all pour 500 0 4767548 vol 0.4 10 region slab mol object &
             molfrac 0.25 0.25 0.25 0.25

fix          4 all wall/body/polyhedron 2000 50 50 zplane 0.0 NULL

#compute      1 all body/local type 1 2 3
#dump         1 all local 1000 dump.polyhedron index c_1[1] c_1[2] c_1[3] c_1[4]
#dump         10 all custom 1000 tmp.dump id type x y z radius

thermo_style custom step atoms ke pe etotal press

thermo       1000

#dump	     2 all image 500 image.*.jpg type type &
#	     zoom 1.5 adiam 1.5 body type 0 0 view 75 15
#dump_modify  2 pad 6

run	     ${steps}


"
"Generate a LAMMPS input script for a NVE simulation of an charge system using hybrid reax/c NULL zbl 8.0 10.0 pair style with pair coefficients * * reax/c ../ffield.reax.combined.COFSi.v4 Si O C F NULL and p p f boundary conditions with a timestep of ${dt} running for 5000 steps at temperature 300.0.","# get equilibrated crystal Si

dimension      3
boundary       p p f
units		   real
atom_style	   charge

variable       dt equal 0.25 # units=fs
timestep       ${dt}

variable       box_zh equal 50
variable       material_height equal 34.5
region         sim_box block 0 ${material_height} 0 ${material_height} 0 ${box_zh} units box
create_box     5 sim_box
# read_data	   initial/SiO2.300K.equilibrated.dat add merge

mass	3 12.0107  # C
mass	4 18.9984  # F
mass    5 39.948   # Ar

# create Si crystal
mass	1 28.0855  # Si
mass	2 15.9994  # O
region		   substrate block EDGE EDGE EDGE EDGE EDGE ${material_height}
lattice		   diamond 5.4307 orient x 1 1 0 orient y -1 1 0 orient z 0 0 1
create_atoms   1 region substrate

# freeze the bottom layer
variable       freeze_below_z equal 0.2*v_material_height
region         freeze_block block INF INF INF INF INF ${freeze_below_z} units box
region         mobile_block block INF INF INF INF ${freeze_below_z} INF units box
group		   freeze_group region freeze_block
group          mobile_group region mobile_block
fix        1   freeze_group setforce 0.0 0.0 0.0

# NVT for middle region and NVE for top region
variable       between_nvt_and_nve equal 0.8*v_material_height
region         middle_nvt_block block INF INF INF INF ${freeze_below_z} ${between_nvt_and_nve} units box
region         top_nve_block    block INF INF INF INF ${between_nvt_and_nve} INF units box
group          middle_nvt_group region middle_nvt_block
group          top_nve_group    region top_nve_block

pair_style	   hybrid reax/c NULL zbl 8.0 10.0
pair_coeff	   * * reax/c ../ffield.reax.combined.COFSi.v4 Si O C F NULL
# pair_coeff	   * * reax/c ../../ffield_Kapton Si O C F NULL
# pair_coeff	   * * ffield.reax.CHOSi Si O
pair_coeff     1 5 zbl 14.0 18.0
pair_coeff     2 5 zbl  8.0 18.0
pair_coeff     3 5 zbl  6.0 18.0
pair_coeff     4 5 zbl  9.0 18.0
pair_coeff     5 5 zbl 18.0 18.0

neighbor	   2. bin
neigh_modify   every 10 delay 0 check no
fix        2   all qeq/reax 1 0.0 10.0 1e-6 reax/c

# # initial minimisation
# thermo_style   custom step temp epair etotal press
# thermo         10
# minimize       1.0e-6 1.0e-6 100000 100000
# reset_timestep 0

compute        mobile_temp mobile_group temp
compute_modify mobile_temp dynamic/dof yes

dump           1 all custom 100 dumpidtype.dat id type x y z
thermo_style   custom step temp pe ke etotal press vol density
thermo         100
thermo_modify  lost warn temp mobile_temp

fix		   3   mobile_group npt temp 300.0 300.0 $(100.0*dt) x 0.0 0.0 $(1000.0*dt) y 0.0 0.0 $(1000.0*dt)
run		       5000
unfix      3

# fix		   3   mobile_group nvt temp 300.0 300.0 $(100.0*dt)
fix		   3   middle_nvt_group nvt temp 300.0 300.0 $(100.0*dt)
fix		   4   top_nve_group nve
run		       5000

# molecule       CFx  ../../../molecules/data.molecule.CF  ../../../molecules/data.molecule.CF2

# # deposit CF_x molecules on top of a-SiO2
# variable       ratio_flux_CFx_over_C equal 1.0
# variable       num_of_insert_C   equal 3000
# variable       num_of_insert_CFx equal floor(v_num_of_insert_C*v_ratio_flux_CFx_over_C)
# variable       delta_step_insert_C   equal 1000
# variable       delta_step_insert_CFx equal floor(v_delta_step_insert_C/v_ratio_flux_CFx_over_C)
#
# variable       randomSeedForDeposit_CFx equal 1234
# variable       offset_for_atom_types equal 2
# variable       deposit_slab_zl equal v_material_height+30
# variable       deposit_slab_zh equal v_material_height+35
#
# variable       in_angle_degree equal 0 # random(0,60,${randomSeedForDeposit_CFx}) # degree
# variable       in_energy equal 1 # eV
# variable       in_angle equal v_in_angle_degree/180*3.1415926 # rad
# variable       in_angle_phi equal random(0,6.2831852,${randomSeedForDeposit_CFx}) # rad
# variable       in_mass_kg_CF equal 1.66054E-27*(12.0107+18.9984)
# variable       in_mass_kg_CF2 equal 1.66054E-27*(12.0107+18.9984*2)
# variable       in_velocity equal sqrt(2*v_in_energy*1.602E-19/((v_in_mass_kg_CF+v_in_mass_kg_CF2)/2))/100/1000 # Angstrom/fs
# variable       in_vz equal -v_in_velocity*cos(v_in_angle)
# variable       in_vy equal v_in_velocity*sin(v_in_angle)*cos(v_in_angle_phi)
# variable       in_vx equal v_in_velocity*sin(v_in_angle)*sin(v_in_angle_phi)
#
# variable       in_mass_kg_C equal 1.66054E-27*(12.0107)
# variable       in_velocity_C equal sqrt(2*v_in_energy*1.602E-19/(v_in_mass_kg_C))/100/1000 # Angstrom/fs
# variable       in_vz_C equal -v_in_velocity_C*cos(v_in_angle)
# variable       in_vy_C equal v_in_velocity_C*sin(v_in_angle)*cos(v_in_angle_phi)
# variable       in_vx_C equal v_in_velocity_C*sin(v_in_angle)*sin(v_in_angle_phi)

# # define variables for Ar atoms
# variable       CFx_to_Ar_flux_ratio equal 3/80
# variable       num_of_insert_Ar equal floor(v_num_of_insert_CFx*v_CFx_to_Ar_flux_ratio)
# variable       delta_step_insert_Ar equal floor(v_delta_step_insert_CFx/v_CFx_to_Ar_flux_ratio)
# variable       randomSeedForDeposit_Ar equal 5678
# variable       in_angle_degree_Ar equal 85 # degree
# variable       in_energy_Ar equal 100 # eV
# variable       in_angle_Ar equal v_in_angle_degree_Ar/180*3.1415926 # rad
# variable       in_angle_phi_Ar equal random(0,6.2831852,${randomSeedForDeposit_Ar}) # rad
# variable       in_velocity_Ar equal sqrt(2*v_in_energy_Ar*1.602E-19/6.633E-26)/100/1000 # Angstrom/fs
# variable       in_vz_Ar equal -v_in_velocity_Ar*cos(v_in_angle_Ar)
# variable       in_vy_Ar equal  v_in_velocity_Ar*sin(v_in_angle_Ar)*cos(v_in_angle_phi_Ar)
# variable       in_vx_Ar equal  v_in_velocity_Ar*sin(v_in_angle_Ar)*sin(v_in_angle_phi_Ar)


# group	       addatoms type 3 4 5
# region         deposit_slab block EDGE EDGE EDGE EDGE ${deposit_slab_zl} ${deposit_slab_zh} units box
# fix		   5   addatoms deposit ${num_of_insert_CFx} ${offset_for_atom_types} ${delta_step_insert_CFx} ${randomSeedForDeposit_CFx} &
#                region deposit_slab near 2.0 id next mol CFx molfrac 1.0 0.0 vx ${in_vx} ${in_vx} vy ${in_vy} ${in_vy} vz ${in_vz} ${in_vz} units box
# # fix        6   addatoms deposit ${num_of_insert_Ar} 5 ${delta_step_insert_Ar} ${randomSeedForDeposit_Ar} region deposit_slab near 2.0 &
# #                id next vx ${in_vx_Ar} ${in_vx_Ar} vy ${in_vy_Ar} ${in_vy_Ar} vz ${in_vz_Ar} ${in_vz_Ar} units box
# fix        9   addatoms deposit ${num_of_insert_C} 3 ${delta_step_insert_C} ${randomSeedForDeposit_CFx} region deposit_slab near 2.0 &
#                id next vx ${in_vx_C} ${in_vx_C} vy ${in_vy_C} ${in_vy_C} vz ${in_vz_C} ${in_vz_C} units box
#
# fix        7   addatoms nve
#
# # remove atoms using ""oneway"" to fix the issues of partially removing molecules
# variable       evaporate_slab_zl equal v_box_zh-5
# region         evaporate_slab block EDGE EDGE EDGE EDGE ${evaporate_slab_zl} EDGE units box
# fix        8   all oneway 100 evaporate_slab z
#
# variable       run_step equal (v_num_of_insert_C+5)*v_delta_step_insert_C
# run		       ${run_step}

write_data     Si.300K.equilibrated.dat
# write_restart  Si.300K.equilibrated.restart
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using edip/multi pair style with pair coefficients * * Si.edip Si and p p p boundary conditions with a timestep of 1.0e-3 running for 500 steps.","
units           metal

atom_style      atomic
atom_modify     map array
boundary        p p p
atom_modify	sort 0 0.0

# temperature

variable t equal 1800.0

# coordination number cutoff

variable r equal 2.835

# minimization parameters

variable etol equal 1.0e-5
variable ftol equal 1.0e-5
variable maxiter equal 100
variable maxeval equal 100
variable dmax equal 1.0e-1

# diamond unit cell

variable a equal 5.431
lattice         custom $a               &
                a1 1.0 0.0 0.0          &
                a2 0.0 1.0 0.0          &
                a3 0.0 0.0 1.0          &
                basis 0.0 0.0 0.0       &
                basis 0.0 0.5 0.5       &
                basis 0.5 0.0 0.5       &
                basis 0.5 0.5 0.0       &
                basis 0.25 0.25 0.25    &
                basis 0.25 0.75 0.75    &
                basis 0.75 0.25 0.75    &
                basis 0.75 0.75 0.25

region          myreg block     0 4 &
                                0 4 &
                                0 4
create_box      1 myreg
create_atoms    1 region myreg

mass            1       28.06

group Si type 1

velocity all create $t 5287287 mom yes rot yes dist gaussian

# make a vacancy

group del id 300
delete_atoms group del

pair_style      edip/multi
pair_coeff * * Si.edip Si

thermo          10

fix             1 all nvt temp $t $t 0.1

timestep        1.0e-3
neighbor        1.0 bin
neigh_modify    every 1 delay 10 check yes

# equilibrate

run             500

"
"Generate a LAMMPS input script for a NVE simulation of an amoeba system using amoeba pair style with pair coefficients * * amoeba_water.prm amoeba_water.key and s s s boundary conditions running for 100 steps.","# water hexamer with AMOEBA or HIPPO

units           real
boundary        s s s

atom_style      amoeba
bond_style      class2
angle_style     amoeba
dihedral_style  none

# per-atom properties required by AMOEBA or HIPPO

fix             amtype all property/atom i_amtype ghost yes
fix             extra all property/atom i_amgroup d_redID d_pval ghost yes
fix             extra2 all property/atom i_polaxe d2_xyzaxis 3

# read data file

read_data       data.water_hexamer.amoeba fix amtype NULL ""Tinker Types""

# force field

pair_style      amoeba
pair_coeff      * * amoeba_water.prm amoeba_water.key

special_bonds   lj/coul 0.5 0.5 0.5 one/five yes

# thermo output

compute         virial all pressure NULL virial

thermo_style    custom step temp epair ebond eangle edihed eimp &
                emol etotal press c_virial[*]

#dump            1 all custom 10 dump.water_hexamer id type x y z fx fy fz
#dump_modify     1 sort id

# dynamics

fix             1 all nve

thermo          10
run             100
"
"Generate a LAMMPS input script for a NVE simulation of an spin system using hybrid/overlay eam/alloy spin/exchange 3.5 spin/dipole/cut 8.0 pair style with pair coefficients * * eam/alloy Fe_Mishin2006.eam.alloy Fe and p p p boundary conditions with a timestep of 0.0001 running for 100 steps.","# bcc iron in a 3d periodic box

clear 
units 		metal
atom_style 	spin

dimension 	3
boundary 	p p p

# necessary for the serial algorithm (sametag)
atom_modify 	map array 

lattice 	bcc 2.8665
region 		box block 0.0 12.0 0.0 12.0 0.0 12.0
create_box 	1 box
create_atoms 	1 box

# setting mass, mag. moments, and interactions for bcc iron

mass		1 55.845
set 		group all spin 2.2 -1.0 0.0 0.0
velocity 	all create 100 4928459 rot yes dist gaussian

pair_style 	hybrid/overlay eam/alloy spin/exchange 3.5 spin/dipole/cut 8.0
pair_coeff 	* * eam/alloy Fe_Mishin2006.eam.alloy Fe
pair_coeff 	* * spin/exchange exchange 3.4 0.02726 0.2171 1.841
pair_coeff      * * spin/dipole/cut 8.0

neighbor 	0.1 bin
neigh_modify 	every 10 check yes delay 20

fix 		1 all precession/spin cubic 0.001 0.0005 1.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 1.0
fix_modify 	1 energy yes
fix 		2 all langevin/spin 0.0 0.0 21

fix 		3 all nve/spin lattice moving
timestep	0.0001

# compute and output options

compute 	out_mag    all spin
compute 	out_pe     all pe
compute 	out_ke     all ke
compute 	out_temp   all temp

variable 	magx      equal c_out_mag[1]
variable 	magy      equal c_out_mag[2]
variable 	magz      equal c_out_mag[3]
variable 	magnorm   equal c_out_mag[4]
variable 	emag      equal c_out_mag[5]
variable 	tmag      equal c_out_mag[6]

thermo_style    custom step time v_magx v_magy v_magz v_magnorm v_tmag v_emag pe etotal
thermo          50

compute 	outsp all property/atom spx spy spz sp fmx fmy fmz
dump 		1 all custom 100 dump_iron.lammpstrj type x y z c_outsp[1] c_outsp[2] c_outsp[3]

run 		100
"
"Generate a LAMMPS input script for a NVT simulation of an full system using hybrid lj/cut/coul/long 10.0 10.0 lj/cut/coul/long/soft 1 0.5 10.0 10.0 10.0 pair style with pair coefficients 1    1  lj/cut/coul/long    0.0660   3.5000  # CF-C CF-C and p p p boundary conditions with a timestep of 1.0 running for 200000 steps.","# created by fftool

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
special_bonds lj/coul 0.0 0.0 0.5

read_data data.1.lmp
# read_restart restart.*.lmp
# reset_timestep 0

pair_style hybrid lj/cut/coul/long 10.0 10.0 lj/cut/coul/long/soft 1 0.5 10.0 10.0 10.0
pair_modify tail yes
kspace_style pppm 1.0e-4

pair_coeff    1    1  lj/cut/coul/long    0.0660   3.5000  # CF-C CF-C
pair_coeff    1    2  lj/cut/coul/long    0.0445   2.9580  # CF-C HD-
pair_coeff    1    3  lj/cut/coul/long    0.0591   3.2133  # CF-C F-D
pair_coeff    1    4  lj/cut/coul/long    0.0000   1.8708  # CF-C Hw
pair_coeff    1    5  lj/cut/coul/long    0.1013   3.3286  # CF-C Ow
pair_coeff    2    2  lj/cut/coul/long    0.0300   2.5000  # HD- HD-
pair_coeff    2    3  lj/cut/coul/long    0.0399   2.7157  # HD- F-D
pair_coeff    2    4  lj/cut/coul/long/soft    0.0000   1.5811  0.0  # HD- Hw
pair_coeff    2    5  lj/cut/coul/long/soft    0.0683   2.8131  0.0  # HD- Ow
pair_coeff    3    3  lj/cut/coul/long    0.0530   2.9500  # F-D F-D
pair_coeff    3    4  lj/cut/coul/long/soft    0.0000   1.7176  1.0  # F-D Hw
pair_coeff    3    5  lj/cut/coul/long/soft    0.0908   3.0559  1.0  # F-D Ow
pair_coeff    4    4  lj/cut/coul/long    0.0000   1.0000  # Hw Hw
pair_coeff    4    5  lj/cut/coul/long    0.0000   1.7792  # Hw Ow
pair_coeff    5    5  lj/cut/coul/long    0.1554   3.1655  # Ow Ow

variable TK equal 300.0
variable PBAR equal 1.0

neighbor 2.0 bin

timestep 1.0

velocity all create ${TK} 12345

fix SHAKE all shake 0.0001 20 0 b 3 a 4

fix NPT all npt temp ${TK} ${TK} 100 iso ${PBAR} ${PBAR} 500

thermo_style custom step cpu etotal ke pe evdwl ecoul elong temp press vol density
thermo 1000

run 200000

reset_timestep 0
unfix NPT
fix NVT all nvt temp ${TK} ${TK} 100

variable dlambda equal -1.0
variable minusdl equal  1.0
variable dqC equal  (0.48+0.24)*v_dlambda
variable dqH equal -0.06*v_dlambda
variable dqF equal -0.12*v_dlambda

compute FEP all fep ${TK} &
    pair lj/cut/coul/long/soft lambda 2 4*5 v_minusdl &
    pair lj/cut/coul/long/soft lambda 3 4*5 v_dlambda &
    atom charge 1 v_dqC &
    atom charge 2 v_dqH &
    atom charge 3 v_dqF

fix FEP all ave/time 1 1 100 c_FEP[1] c_FEP[2] file bar10.fep

dump TRAJ all custom 5000 dump.lammpstrj id mol type element xu yu zu
dump_modify TRAJ element C H F H O

run 500000

# write_restart restart.*.lmp
write_data data.*.lmp
"
"Generate a LAMMPS input script for a general simulation of an atomic system using meam/sw/spline pair style with pair coefficients * * Ti.meam.sw.spline Ti and f f f boundary conditions running for 0 steps.","# Ti single atom in vacuum

units           metal
boundary        f f f

atom_style      atomic
region          box block -100 100 -100 100 -100 100 units box
create_box              1 box
create_atoms    1 single 0 0 0 units box

pair_style      meam/sw/spline
pair_coeff      * * Ti.meam.sw.spline Ti
mass            * 47.90

variable        cohesive_energy equal pe/atoms
run                     0

print           ""====================================================""
print           ""Calculated cohesive energy: ${cohesive_energy} eV/atom""
print           ""Reference cohesive energy:  0 eV/atom""
print           ""====================================================""


#dump           1 all custom 1 single_atom.dump id type x y z fx fy fz
#run            0


"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay  tersoff  ilp/graphene/hbn 16.0 coul/shield 16.0 1 pair style with pair coefficients * * tersoff          BNC.tersoff   NULL NULL B N  # chemical and p p p boundary conditions with a timestep of 0.001 running for 1000 steps.","# Initialization
units           metal
boundary        p p p
atom_style      full
processors      * * 1     # domain decomposition over x and y

# System and atom definition
# we use 2 atom types so that inter- and intra-layer
# interactions can be specified separately
read_data       hBN_AB_stack_2L_noH_equi_300K.data
mass            1 10.8110   # boron mass (g/mole) | membrane
mass            2 14.0067   # nitrogen mass (g/mole) | adsorbate
mass            3 10.8110   # boron mass (g/mole) | membrane
mass            4 14.0067   # nitrogen mass (g/mole) | adsorbate
# Separate atom groups
group membrane  type 1 2
group adsorbate type 3 4

######################## Potential defition ########################
pair_style  hybrid/overlay  tersoff  ilp/graphene/hbn 16.0 coul/shield 16.0 1
####################################################################
pair_coeff  * * tersoff          BNC.tersoff   NULL NULL B N  # chemical
pair_coeff  * * ilp/graphene/hbn BNCH-old.ILP  B N B N  # long range
pair_coeff  1 3 coul/shield 0.70
pair_coeff  1 4 coul/shield 0.69498201415576216335
pair_coeff  2 3 coul/shield 0.69498201415576216335
pair_coeff  2 4 coul/shield 0.69
####################################################################
# Neighbor update settings
neighbor        2.0 bin
neigh_modify    every 1
neigh_modify    delay 0
neigh_modify    check yes

#### Simulation settings ####
timestep  0.001
#velocity  adsorbate create 300.0 12345
fix       subf membrane setforce 0.0 0.0 0.0
fix       thermostat all nve

compute   0 all pair tersoff
compute   1 all pair coul/shield ecoul
compute   2 all pair ilp/graphene/hbn
variable  Tersoff  equal c_0
variable  Ecoul    equal c_1
variable  ILP      equal c_2
variable  Evdw     equal c_2[1]
variable  Erep     equal c_2[2]

############################

# Output
thermo          100
thermo_style    custom step etotal pe ke v_Tersoff v_ILP v_Ecoul v_Erep v_Evdw temp
thermo_modify   lost warn #ignore

#dump            1 all custom 1000 traj.lammpstrj id mol type xu yu zu
#dump_modify     1 format line ""%7d %3d %3d %15.10g %15.10g %15.10g"" flush yes

###### Run molecular dynamics ######
run 1000
"
"Generate a LAMMPS input script for a NVE simulation of an bond system using bpm/spring pair style with pair coefficients 1 1 1.0 1.0 1.0 and f f f boundary conditions with a timestep of 0.1 running for 7500 steps.","units           lj
dimension       3
boundary        f f f
atom_style      bond
special_bonds   lj 0.0 1.0 1.0 coul 0.0 1.0 1.0
newton          on off
comm_modify     vel yes cutoff 2.6
lattice         fcc 1.0
region          box block -25 15 -22 22 -22 22
create_box      1 box bond/types 2 extra/bond/per/atom 20 extra/special/per/atom 50

region          disk cylinder x 0.0 0.0 20.0 -0.5 0.5
create_atoms    1 region disk
group           plate region disk

region          ball sphere 8.0 0.0 0.0 6.0
create_atoms    1 region ball
group           projectile region ball

displace_atoms  all random 0.1 0.1 0.1 134598738

mass            1 1.0

neighbor        1.0 bin
pair_style      bpm/spring
pair_coeff      1 1 1.0 1.0 1.0

fix             1 all nve

create_bonds    many plate plate 1 0.0 1.5
create_bonds    many projectile projectile 2 0.0 1.5

neighbor        0.3 bin
special_bonds   lj 0.0 1.0 1.0 coul 1.0 1.0 1.0

bond_style      bpm/spring store/local brkbond 100 time id1 id2
bond_coeff      1 1.0 0.04 1.0
bond_coeff      2 1.0 0.20 1.0

velocity        projectile set -0.05 0.0 0.0
compute         nbond all nbond/atom
compute         tbond all reduce sum c_nbond

timestep        0.1
thermo_style    custom step ke pe pxx pyy pzz c_tbond
thermo          100
thermo_modify   lost ignore lost/bond ignore
#dump            1 all custom 100 atomDump id x y z c_nbond

dump            2 all local 100 brokenDump f_brkbond[1] f_brkbond[2] f_brkbond[3]
dump_modify     2 header no

run             7500
"
"Generate a LAMMPS input script for a general simulation and p p f boundary conditions running for 10 steps.","boundary p p f
kspace_style pppm/electrode 1.0e-7
kspace_modify slab 3.0

include ""settings.mod"" # styles, computes, groups and fixes

# constant potential electrodes with ramping potential difference
fix conp bot electrode/conp 0 1.979 couple top v_v symm on

thermo 1
# thermo: step, imposed potential, bottom charge, top charge, theory charge, percent deviation
thermo_style custom step v_v c_qbot c_qtop v_qtheory v_percdev

run 10

"
"Generate a LAMMPS input script for a general simulation of an atomic system and f f p boundary conditions with a timestep of 0.002 running for $m steps.","# needs description
#AtC drift diffusion Coupling
# DESCRIPTION:
# electric potential solved over whole domain
# all others only over the lower half
# temperature is fixed over whole domain

# NOTE the vacuum can fully masked out by making the material 
# have null electron_density in Ar_ddm.mat

echo both
units    metal

variable s equal 100
variable T equal 20
variable n equal 0.000004
variable tol equal 0.1
variable W   equal 1000

atom_style  atomic

lattice   fcc 5.405 origin 0.25 0.25 0.25
region    FE block   -8 8 -6 6 0 3
region    MD block   -7 7 -6 0 0 3
region    FREE block -4 4 -6 0 0 3

boundary  f f p

# create atoms
create_box  1 FE
mass    1 39.95 
atom_modify     sort 0 1

timestep  0.002
thermo  $s

#          ID  group atc PhysicsType ParameterFile
fix        AtC all  atc drift_diffusion  Ar_ddm.mat

#          ID  part keywords    nx ny nz region
fix_modify AtC mesh  create 4 4  1  FE f f p

variable a   equal $W+${tol}
fix_modify AtC mesh create_elementset wire  -$a $a -INF ${tol} -INF INF
fix_modify AtC mesh create_elementset gap   -$a $a -${tol} INF -INF INF
# void is the complement of the wire nodeset
variable a   equal $W-${tol}
fix_modify AtC mesh create_nodeset    void -$a $a  ${tol}  INF -INF INF
fix_modify AtC mesh output   null_material_ddmMESH binary

fix_modify  AtC control thermal none

# fix a temperature
fix_modify AtC  initial temperature          all $T
fix_modify AtC  initial electron_temperature all $T
fix_modify AtC  initial electron_density     all $n
fix_modify AtC  initial electric_potential   all 0.0
fix_modify AtC  initial temperature          void 0.0
fix_modify AtC  initial electron_density     void 0.0
fix_modify AtC  initial electric_potential   void 0.0

# create vacuum
fix_modify AtC material gap Vacuum

thermo_style custom step cpu f_AtC[1] f_AtC[2] f_AtC[3] f_AtC[4]
fix_modify AtC  output          null_material_ddmFE $s full_text binary
fix_modify AtC extrinsic electron_integration implicit

# 
fix_modify AtC mesh create_nodeset lbc -8.1  -7.9 -INF INF -INF INF
fix_modify AtC mesh create_nodeset rbc  7.9   8.1 -INF INF -INF INF
fix_modify AtC  fix electron_temperature lbc $T
fix_modify AtC  fix electron_temperature rbc $T
fix_modify AtC  fix electron_density     lbc $n
fix_modify AtC  fix electric_potential lbc 0.0

variable m equal $s*10
run    $m

"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/long 12 pair style with a timestep of 0.01.","# QMMM with PySCF - mixture example

units           real
atom_style      full

pair_style      lj/cut/coul/long 12
pair_modify     mix arithmetic

bond_style      harmonic
angle_style     harmonic
dihedral_style  none
improper_style  none

kspace_style    pppm 1e-5

read_data       data.mixture

# QM atoms are IDs 1 to 9
# MM atoms are remaining atoms

group           qm id 1:9
group           mm subtract all qm

# remove bonds/angles between QM atoms
# set charges to zero on QM atoms

delete_bonds    qm multi remove special
set             group qm charge 0.0

neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes

# QMMM dynamics

timestep        0.01

fix		1 all nve

fix             2 qm mdi/qmmm direct elements N H C H Cl O H
fix_modify      2 energy yes

thermo_style    custom step cpu temp ke evdwl ecoul epair emol elong &
                f_2 pe etotal press

thermo          1

mdi             plugin pyscf_mdi mdi ""-role ENGINE -name PySCF -method LINK"" &
                extra ""-pbc no"" command ""run 2""
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/thole/long 2.600 8.0 8.0 pair style with pair coefficients 1    1 0.069998 3.550000 1.620000 # CAT CAT and p p p boundary conditions with a timestep of 0.5 running for 2000 steps.","# 250 toluene system for drude polarizability example (Langevin)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
improper_style fourier
special_bonds lj/coul 0.0 0.0 0.5

pair_style lj/cut/thole/long 2.600 8.0 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.toluene extra/special/per/atom 1

comm_modify vel yes

group gTOLUENE molecule 1:250
group gCORES type 1 2 3 4 5 6 7
group gDRUDES type 8 9 10 11 12

pair_coeff    1    1 0.069998 3.550000 1.620000 # CAT CAT
pair_coeff    1    2 0.069998 3.550000 1.620000 # CAT CAO
pair_coeff    1    3 0.069998 3.550000 1.620000 # CAT CAM
pair_coeff    1    4 0.069998 3.550000 1.620000 # CAT CAP
pair_coeff    1    5 0.067968 3.524911 1.620000 # CAT CTT
pair_coeff    1    6 0.045825 2.931041 0.000000 # CAT HAT
pair_coeff    1    7 0.045825 2.931041 0.000000 # CAT HT
pair_coeff    2    2 0.069998 3.550000 1.620000 # CAO CAO
pair_coeff    2    3 0.069998 3.550000 1.620000 # CAO CAM
pair_coeff    2    4 0.069998 3.550000 1.620000 # CAO CAP
pair_coeff    2    5 0.067968 3.524911 1.620000 # CAO CTT
pair_coeff    2    6 0.045825 2.931041 0.000000 # CAO HAT
pair_coeff    2    7 0.045825 2.931041 0.000000 # CAO HT
pair_coeff    3    3 0.069998 3.550000 1.620000 # CAM CAM
pair_coeff    3    4 0.069998 3.550000 1.620000 # CAM CAP
pair_coeff    3    5 0.067968 3.524911 1.620000 # CAM CTT
pair_coeff    3    6 0.045825 2.931041 0.000000 # CAM HAT
pair_coeff    3    7 0.045825 2.931041 0.000000 # CAM HT
pair_coeff    4    4 0.069998 3.550000 1.620000 # CAP CAP
pair_coeff    4    5 0.067968 3.524911 1.620000 # CAP CTT
pair_coeff    4    6 0.045825 2.931041 0.000000 # CAP HAT
pair_coeff    4    7 0.045825 2.931041 0.000000 # CAP HT
pair_coeff    5    5 0.065997 3.500000 1.620000 # CTT CTT
pair_coeff    5    6 0.044496 2.910326 0.000000 # CTT HAT
pair_coeff    5    7 0.044496 2.910326 0.000000 # CTT HT
pair_coeff    6    6 0.029999 2.420000 0.000000 # HAT HAT
pair_coeff    6    7 0.029999 2.420000 0.000000 # HAT HT
pair_coeff    7    7 0.029999 2.420000 0.000000 # HT HT
pair_coeff    1    8 0.000000 0.000000 1.620000 # CAT D_CAT
pair_coeff    1    9 0.000000 0.000000 1.620000 # CAT D_CAO
pair_coeff    1   10 0.000000 0.000000 1.620000 # CAT D_CAM
pair_coeff    1   11 0.000000 0.000000 1.620000 # CAT D_CAP
pair_coeff    1   12 0.000000 0.000000 1.620000 # CAT D_CTT
pair_coeff    2    8 0.000000 0.000000 1.620000 # CAO D_CAT
pair_coeff    2    9 0.000000 0.000000 1.620000 # CAO D_CAO
pair_coeff    2   10 0.000000 0.000000 1.620000 # CAO D_CAM
pair_coeff    2   11 0.000000 0.000000 1.620000 # CAO D_CAP
pair_coeff    2   12 0.000000 0.000000 1.620000 # CAO D_CTT
pair_coeff    3    8 0.000000 0.000000 1.620000 # CAM D_CAT
pair_coeff    3    9 0.000000 0.000000 1.620000 # CAM D_CAO
pair_coeff    3   10 0.000000 0.000000 1.620000 # CAM D_CAM
pair_coeff    3   11 0.000000 0.000000 1.620000 # CAM D_CAP
pair_coeff    3   12 0.000000 0.000000 1.620000 # CAM D_CTT
pair_coeff    4    8 0.000000 0.000000 1.620000 # CAP D_CAT
pair_coeff    4    9 0.000000 0.000000 1.620000 # CAP D_CAO
pair_coeff    4   10 0.000000 0.000000 1.620000 # CAP D_CAM
pair_coeff    4   11 0.000000 0.000000 1.620000 # CAP D_CAP
pair_coeff    4   12 0.000000 0.000000 1.620000 # CAP D_CTT
pair_coeff    5    8 0.000000 0.000000 1.620000 # CTT D_CAT
pair_coeff    5    9 0.000000 0.000000 1.620000 # CTT D_CAO
pair_coeff    5   10 0.000000 0.000000 1.620000 # CTT D_CAM
pair_coeff    5   11 0.000000 0.000000 1.620000 # CTT D_CAP
pair_coeff    5   12 0.000000 0.000000 1.620000 # CTT D_CTT
pair_coeff    8    8 0.000000 0.000000 1.620000 # D_CAT D_CAT
pair_coeff    8    9 0.000000 0.000000 1.620000 # D_CAT D_CAO
pair_coeff    8   10 0.000000 0.000000 1.620000 # D_CAT D_CAM
pair_coeff    8   11 0.000000 0.000000 1.620000 # D_CAT D_CAP
pair_coeff    8   12 0.000000 0.000000 1.620000 # D_CAT D_CTT
pair_coeff    9    9 0.000000 0.000000 1.620000 # D_CAO D_CAO
pair_coeff    9   10 0.000000 0.000000 1.620000 # D_CAO D_CAM
pair_coeff    9   11 0.000000 0.000000 1.620000 # D_CAO D_CAP
pair_coeff    9   12 0.000000 0.000000 1.620000 # D_CAO D_CTT
pair_coeff   10   10 0.000000 0.000000 1.620000 # D_CAM D_CAM
pair_coeff   10   11 0.000000 0.000000 1.620000 # D_CAM D_CAP
pair_coeff   10   12 0.000000 0.000000 1.620000 # D_CAM D_CTT
pair_coeff   11   11 0.000000 0.000000 1.620000 # D_CAP D_CAP
pair_coeff   11   12 0.000000 0.000000 1.620000 # D_CAP D_CTT
pair_coeff   12   12 0.000000 0.000000 1.620000 # D_CTT D_CTT

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gDRUDES create ${vTEMP_D} 12345

fix fDRUDE all drude C C C C C N N D D D D D

fix fSHAKE gCORES shake 0.0001 20 0 b 4 6 7 8

fix fLANG all langevin/drude ${vTEMP} 100.0 200611 ${vTEMP_D} 20.0 260514 zero yes
fix fNPH all nve

compute cTEMP all temp/drude

thermo_style custom step etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 50

timestep 0.5
run 2000
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/charmm/coul/long 8.0 10.0 10.0 pair style with a timestep of 2.0 running for 100 steps at temperature 275.0.","# Solvated 5-mer peptide

units		real
atom_style	full

pair_style	lj/charmm/coul/long 8.0 10.0 10.0
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic
kspace_style	pppm 0.0001

read_data	data.peptide

neighbor	2.0 bin
neigh_modify	delay 5

timestep	2.0

group		peptide type <= 12
group		one id 2 4 5 6
group		two id 80 82 83 84
group		ref id 37
group		colvar union one two ref

fix		1 all nvt temp  275.0 275.0 100.0 tchain 1

shell ""rm -f out*.colvars.*""
fix		2 all colvars peptide.colvars
fix		2a ref setforce 0.0 0.0 0.0

fix		4 all shake 0.0001 10 100 b 4 6 8 10 12 14 18 a 31

#dump		1 colvar custom 1 dump.colvar.lammpstrj id xu yu zu fx fy fz
#dump_modify 1 sort id

thermo_style	custom step temp etotal pe ke epair ebond f_2
thermo		10


run		100

run     100

fix 2 all colvars peptide.colvars input out.colvars.state output out2

run     100

"
"Generate a LAMMPS input script for a NVE simulation of an full system with a timestep of 0.00025 running for 20 steps.","# AIMD test of two UO2 molecules with LATTE in MDI stand-alone mode

units           metal
atom_style      full

read_data       data.2uo2

velocity        all create 300.0 87287 loop geom

neighbor        1.0 bin
neigh_modify    every 1 delay 0 check yes

timestep        0.00025

fix             1 all nve

fix             2 all mdi/qm virial yes elements U O

thermo_style    custom step temp pe etotal press
thermo          5

#dump            1 all custom 1 dump.aimd.mpi &
#                id type x y z vx vy vz fx fy fz

run             20
"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 2.45 pair style with pair coefficients * * 0.0 0.0 2.45 and p p f boundary conditions with a timestep of 2.0 running for 2500 steps.","#===========================================================================#
# Rigid sphere freely moving in a system with pressure driven flow through  #
#   a pit geometry.                                                         # 
#                                                                           #
# If uncommented, the example produces several output files:                # 
#   'flow.xdmf', 'flow.raw' ... xdmf and accompanying binary file for the   #
#                               fluid density and velocity which can be read#
#                               and plotted using Paraview.                 #
#   'dumpatomsXX.vtp', 'dumpatomsXX_boundingBox.vtr' ... produces by the    #
#                               dumpvtk routine (requires that lammps be    #
#                               compiled with the vtk package).  These filed#
#                               can also be read and plotted using Paraview.#
#                               XX is the timestep of the dump output.      #
#===========================================================================# 

units          micro
dimension      3
boundary       p p f
atom_style     atomic

#----------------------------------------------------------------------------
# Need a neighbor bin size smaller than the lattice-Boltzmann grid spacing
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid.
# The arguments for neigh_modify have been set to ""delay 0 every 1"", again
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid.  However, these values can likely
#   be somewhat increased without issue.  If a problem does arise (a particle
#   is outside of its processors LB grid) an error message is printed and 
#   the simulation is terminated.    
#----------------------------------------------------------------------------
neighbor       1.0 bin
neigh_modify   delay 0 every 1 

read_data      data.one_radius16d2

#----------------------------------------------------------------------------
# None of the particles interact with one another.
#----------------------------------------------------------------------------
pair_style     lj/cut 2.45
pair_coeff     * * 0.0 0.0 2.45
neigh_modify   exclude type 1 1 

mass           * 100.0
timestep       2.0

group          sphere1 id <> 1 320

#----------------------------------------------------------------------------
# Colloidal particle is initially stationary.
#----------------------------------------------------------------------------
velocity       all set 0.0 0.0 0.0 units box

#----------------------------------------------------------------------------
# Create a lattice-Boltzmann fluid covering the simulation domain.
# All of the particles in the simulation apply a force to the fluid.
#   (however, this fix does not explicity apply a force back on to these 
#    particles...this is accomplished through the use of the lb/viscous fix).
# Set the fluid density = 1.0, fluid viscosity = 1.0 (water), and lattice
#    spacing dx=4.0.
# dumpxdmf is set to output to the xdmf file (fflow.xdmf and fflow.raw) every
#    2500 steps, indexed by the frame number (rather than timestep).
# The flow is generated via a pressure jump at the otherwise periodic x-
#    boundary using the pressurebcx option.
# The initial conditions are set as linear interpolation between boundary
#    values using the linearInit option.
#-----------------------------------------------------------------------------
fix  1 all lb/fluid 1 1.0 1.0 dx 4.0 linearInit pressurebcx 0.01 npits 2 20 40 5 0 wp 30 # dumpxdmf 2500 fflow 0

#-----------------------------------------------------------------------------
# You can get some other interesting geometries by replacing the npits options
#   at the end of the above lb/fluid fix with one of the following:
#-----------------------------------------------------------------------------
# Channel with 2 pits placed symmetrically about center in x: 
#npits 2 20 20 10 5 sw

# Channel with 1 pit placed at center:
#npits 1 20 20 20 sw

# Full channel with 1 ""speedbump"" placed in right end of the channel: 
#npits 2 20 40 5 0 sw  

# Channel with 2 ""potholes"" placed symmetrically about center in x:
#npits 2 20 15 10 10 wp 30

# Channel with T-shaped cross-section with a ""speedbump"" in right end: 
#npits 2 20 40 5 0 wp 30

# Long rectangular channel (all pit, no slit):
#npits 1 20 65 5 0 sw

#----------------------------------------------------------------------------
# Apply the force from the fluid to the particles, and integrate their 
#   motion, constraining them to move and rotate together as a single rigid 
#   spherical object.  
#---------------------------------------------------------------------------- 
fix 2 all lb/viscous
fix 3 all rigid group 1 sphere1

#----------------------------------------------------------------------------
# Create variables for the center-of-mass and angular velocities, and output
#   these quantities to the screen.
#----------------------------------------------------------------------------
variable vx equal vcm(all,x)
variable vy equal vcm(all,y)
variable vz equal vcm(all,z)
variable omegax equal omega(all,x)
variable omegay equal omega(all,y)
variable omegaz equal omega(all,z)

thermo_style   custom step f_1[2] v_vx v_vy v_vz v_omegax v_omegay v_omegaz
thermo         500

#dump dumpvtk all vtk 2500 dumpatoms*.vtp vx vy vz

run	       2500
"
"Generate a LAMMPS input script for a NVE simulation of an full system using zero 1.0 pair style with pair coefficients * * with a timestep of 0.00025 running for 20 steps.","# graphene model with LATTE

units           metal
atom_style      full

read_data       data.graphene

# replicate system if requested

variable        x index 1
variable        y index 1
variable        z index 1

variable        nrep equal v_x*v_y*v_z
if              ""${nrep} > 1"" then ""replicate $x $y $z""

# initialize system

velocity        all create 100.0 87287 loop geom

pair_style      zero 1.0
pair_coeff      * *

neighbor        1.0 bin
neigh_modify    every 1 delay 0 check yes

timestep        0.00025

fix             1 all nve

fix             2 all mdi/qm virial yes elements C
fix_modify      2 energy yes

thermo_style    custom step temp pe etotal press

# dynamics

thermo          5
run             20
"
"Generate a LAMMPS input script for a NVT simulation of an full system using lj/cut/coul/long 10.0 pair style with pair coefficients 1 1 0.1502629 3.1169 and p p p boundary conditions with a timestep of 0.5 running for 100 steps at temperature 298.0.","units           real
dimension       3
boundary        p p p
atom_style      full

pair_style      lj/cut/coul/long 10.0
bond_style      harmonic
angle_style     harmonic

read_data       data.spce

molecule        h2omol H2O.txt

### Flexible SPC/E Potential Parameters ###
### Zhang et al., Fluid Phase Equilibria, 262 (2007) 210-216 ###
pair_coeff 1 1 0.1502629 3.1169
pair_coeff 1 2 0.0341116368 2.04845
pair_coeff 2 2 0.00774378 0.98

bond_coeff  1 176.864 0.9611
angle_coeff 1 42.1845 109.4712
kspace_style pppm 1.0e-4

fix mywidom all widom 10 20 0 29494 298 mol h2omol

fix 2 all nvt temp 298.0 298.0 100.0

neighbor 2.0 bin
neigh_modify delay 10 every 2 check yes


#run variables
timestep        0.5

thermo          10
thermo_style    custom step etotal pe temp press vol density f_mywidom[1] f_mywidom[2] f_mywidom[3]

run             100
"
"Generate a LAMMPS input script for a NPT simulation of an atomic system using lj/cut 9.5251 pair style with pair coefficients * * 0.00965188 3.4 and p p p boundary conditions with a timestep of 0.001 running for 1000 steps at temperature 113.15.","variable ibead uloop 99 pad

units metal
atom_style atomic
atom_modify map yes
boundary p p p
pair_style lj/cut 9.5251
read_data data.metalnpt${ibead}

pair_coeff    * * 0.00965188 3.4
pair_modify shift yes

mass 1 39.948

timestep 0.001

velocity all create 0.0 ${ibead}

fix 1 all pimd/langevin method nmpimd ensemble npt integrator obabo thermostat PILE_L 1234 tau 1.0 temp 113.15 iso 1.0 barostat BZP taup 1.0 fixcom no

thermo_style custom step temp f_1[*] vol press
thermo 100
thermo_modify norm no

# dump dcd all custom 100 ${ibead}.dcd id type xu yu zu vx vy vz ix iy iz fx fy fz
# dump_modify dcd sort id format line ""%d %d %.16f %.16f %.16f %.16f %.16f %.16f %d %d %d %.16f %.16f %.16f""

run 1000
"
"Generate a LAMMPS input script for a NVT simulation of an electron system using eff/cut 1000.0 pair style with pair coefficients * * and f f f boundary conditions with a timestep of 0.001 running for 40000 steps at temperature 10000.0.","# Created 2010-11-28

# General parameters

variable	sname index CH4fc.bohr

units		electron
newton		on
boundary	f f f

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 1000.0
pair_coeff      * *

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

comm_modify	vel yes

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff
compute         effPress all pressure effTemp

thermo          10
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp press effPress

# Minimization

min_style       cg
dump            1 all xyz 10 ${sname}.min.xyz
compute         1 all property/atom spin eradius erforce
dump            2 all custom 10 ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
min_modify      line quadratic
minimize        0 1.0e-6 1000 10000

undump		1
undump		2

# Equilibrate at 300K
velocity        all create 10000.0 4928459 rot yes mom yes dist gaussian

timestep        0.001

dump            1 all custom 1000 ${sname}.nvt.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
#fix		0 all langevin/eff 300.0 300.0 0.1
fix             1 all nvt/eff temp 10000.0 10000.0 0.1

run             40000


"
"Generate a LAMMPS input script for a general simulation of an atomic system and f p p boundary conditions with a timestep of 0.0 running for $s steps.","# needs description
echo both
units		metal
# PARAMETERS-----------------------------
variable s equal 1
variable L equal 10
variable e equal 4
variable E equal 0.0001
variable V equal $E*$L
# END -----------------------------------

atom_style atomic
lattice    diamond  1.0
boundary   f p p
region	box block -$L $L 0 1 0 1
create_box 1 box
group	box region box
atom_modify  sort 0 1
timestep     0.0
mass         *  12.01

# coupling
### NOTE ATC:  material cnt does not provide all interfaces for charge_density physics and will be treated as null
fix         AtC box  atc electrostatic-equilibrium CNT.mat
fix_modify  AtC internal_quadrature off
#fix_modify  AtC atom_weight constant internal 1.0 NOTE penultimate is a group 
fix_modify  AtC atom_weight constant box 1.0
fix_modify  AtC omit atomic_charge 
fix_modify  AtC mesh create $e  1  1  box f p p
#fix_modify  AtC control  momentum flux
fix_modify AtC mesh create_elementset all -INF INF -INF INF -INF INF

# bcs/ics conditions
fix_modify AtC  fix displacement x all 0.0
fix_modify AtC  fix displacement y all 0.0
fix_modify AtC  fix displacement z all 0.0
fix_modify AtC  fix velocity x all 0.0
fix_modify AtC  fix velocity y all 0.0
fix_modify AtC  fix velocity z all 0.0

fix_modify AtC mesh create_nodeset lbc -10 -10 INF INF INF INF
fix_modify AtC mesh create_nodeset rbc  10  10 INF INF INF INF
fix_modify AtC  fix electric_potential lbc linear 0 0 0 $E 0 0 $V
fix_modify AtC  fix electric_potential rbc linear 0 0 0 $E 0 0 $V

# run
thermo_style    custom step cpu etotal ke
thermo          $s
fix_modify      AtC  output electron_densityFE $s text
fix_modify      AtC  output index step      
log electron_density.log

# run default material
print ""default material - table linear""
run   	        $s

# run CNT1 material
print ""CNT1 material - analytical linear""
fix_modify AtC material all CNT1
run   	        $s

# run CNT2 material
print ""CNT2 material - analytical exponetial""
fix_modify AtC material all CNT2
run   	        $s

# run CNT material
print ""CNT material - table DOS""
fix_modify AtC material all CNT
#variable E equal 10*$E
#fix_modify AtC  fix electric_potential lbc linear 0 0 0 $E 0 0 $V
#fix_modify AtC  fix electric_potential rbc linear 0 0 0 $E 0 0 $V
run   	        $s

"
"Generate a LAMMPS input script for a general simulation and p p p boundary conditions running for 0 steps.","boundary p p p
kspace_style pppm/electrode 1.0e-10

include ""settings.mod"" # styles, computes, groups and fixes

thermo_style custom step pe c_qbot c_qtop
fix conp bot electrode/conp 0 2 couple top 1 symm on ffield yes write_inv inv.csv write_vec vec.csv

run 0

"
"Generate a LAMMPS input script for a general simulation of an atomic system using lj/cut 13.5 pair style and f f f boundary conditions with a timestep of 5.0 running for 500 steps.","# this input can be used to generate the benchmark for in.gaussianIC2d_hex_uniform
echo both
units    real
atom_style  atomic

variable l equal 8
variable g equal 2
variable lg equal $l+$g
variable w equal 2

lattice         fcc 5.405 origin 0.25 0.25 0.25
boundary  f f f

# region to create atoms
region		bigCyl cylinder z 0. 0. ${lg} -$w $w
region		offsetPlane block -${lg} $g -${lg} ${lg} -$w $w
region		mdRegion intersect 2 bigCyl offsetPlane
#create_box 1 mdRegion
pair_style  lj/cut 13.5
read_data	semicircle.init

# region for internal atoms
region     mdInternalCyl cylinder z 0. 0. $l -$w $w
region		leftHalfPlane block INF 0. INF INF INF INF
region		mdInternal intersect 2 mdInternalCyl leftHalfPlane

# region for coupling ghosts
region		rightHalfPlane block 0. INF INF INF INF INF
region		mdGhost union 2 rightHalfPlane mdInternal side out

#create_atoms 1 region mdRegion
#create_atoms 1 region mdInternal
#create_atoms 2 region mdGhost
#region	outerGhost intersect 2 rightHalfPlane mdRegion
#create_atoms 3 region outerGhost

#pair_style  lj/cut 13.5
fix ZWALLS all wall/reflect zlo EDGE zhi EDGE
#mass    1 39.95
#pair_coeff    1 1 .238 3.405 13.5
group    internal region mdInternal
group	 ghost region mdGhost
#velocity internal create 40 102486 mom yes rot yes dist gaussian
#write_restart semicircle_init.rst

# ATC commands
fix	AtC internal atc thermal Ar_ttm.mat
fix_modify	AtC boundary ghost
fix_modify	AtC mesh read semicircle.mesh  f f p 
fix_modify	AtC mesh nodeset_to_elementset 2 hole min
fix_modify	AtC internal_quadrature off
fix_modify	AtC time_integration fractional_step

# initial conditions
fix_modify	AtC fix temperature all 20.
fix_modify	AtC control thermal rescale 10
fix_modify      AtC control tolerance 1.e-14 # tolerance needed to produce consistent parallel and serial results

# initial output
#fix_modify	AtC mesh output semicircle_mesh
#fix_modify	AtC output semicircle_init 100 text binary
#dump		D1 all atom 100 semicircle_init.dmp

# run
timestep  5.0
thermo    100
run       500

# boundary conditions
fix_modify	AtC unfix temperature all
fix_modify	AtC fix temperature 1 20.
fix_modify	AtC control thermal flux
fix_modify	AtC control localized_lambda on

# NOTE appears to be a problem with the temporal ramp function
variable delta_t equal 1000*5.
fix_modify      AtC source temperature hole temporal_ramp 0. 0.0000000001 ${delta_t}

# equilibrate filter
fix_modify	AtC filter type exponential
fix_modify	AtC filter scale 1000.
fix_modify	AtC filter on

# equilibration output
fix_modify      AtC output semicircleFE 100 full_text #binary
#undump		D1
#dump            D1 all atom 100 semicircle_equil.dmp

# run
fix_modify	AtC reset_time 0.
reset_timestep  0
thermo 100
run    1000

# heat source
# NOTE second run omitted as it causes diffs in parallel execution after just one timestep, not sure why
#fix_modify	AtC source temperature hole 0.0000000001
#fix_modify      AtC output semicircleFE 1 full_text #binary
#undump          D1
#dump            D1 all atom 100 semicircle.dmp
#run    1#000
"
"Generate a LAMMPS input script for a NPT simulation of an full system using lj/cut/coul/long     10.0 pair style and p p p boundary conditions with a timestep of 1.0 running for 2000 steps.","# DFF generated Lammps input file

units          real
atom_style     full
boundary       p p p

pair_style     lj/cut/coul/long     10.0
pair_modify    mix arithmetic
pair_modify    tail yes
kspace_style   pppm 1.0e-4
dielectric     1.0
special_bonds  amber
bond_style     harmonic
angle_style    harmonic
dihedral_style none
improper_style none

read_data      data.cos.1000SPCE

variable T equal 300
variable P equal 1.0

velocity       all create ${T} 12345 mom yes rot yes dist gaussian

timestep       1.0

# Constraint ##################################
fix com        all momentum 100 linear 1 1 1
fix rigid      all shake 1e-4 20 0 b 1 a 1

# Viscosity  ##################################
variable       A equal 0.05e-5 # angstrom/fs^2

fix            cos all accelerate/cos ${A}
compute        cos all viscosity/cos

variable       density equal density
variable       lz equal lz
variable       vMax equal c_cos[7] # velocity of atoms at z=0
variable       invVis equal v_vMax/${A}/v_density*39.4784/v_lz/v_lz*100 # reciprocal of viscosity 1/Pa/s

fix            npt all npt temp ${T} ${T} 100 iso ${P} ${P} 1000
fix_modify     npt temp cos

thermo_style   custom step cpu temp press pe density v_vMax v_invVis
thermo_modify  temp cos
thermo         100
################################################

dump           1 all custom 10000 dump.lammpstrj id mol type element q xu yu zu
dump_modify    1 sort id element O H

run            2000
"
"Generate a LAMMPS input script for a NVT simulation of an template cychex system using lj/cut 12.0 pair style with pair coefficients 1 1  0.1180  3.905 and p p p boundary conditions running for 2500 steps at temperature 100.0.","# demo for atom style template simulating a cyclohexane methane mixture
# part 1: creating system with create_atoms

units real
boundary p p p
molecule cychex cyclohexane.mol
atom_style template cychex

pair_style lj/cut 12.0
pair_modify mix geometric tail yes
bond_style harmonic
angle_style harmonic
dihedral_style harmonic

lattice sc 6.0
variable boxlen index 4.0
region box block -${boxlen} ${boxlen} -${boxlen} ${boxlen} -${boxlen} ${boxlen} units lattice
create_box 2 box bond/types 1 angle/types 1 dihedral/types 1

create_atoms 0 box mol cychex 734594
create_atoms 2 random 800 495437 box

mass 1 14.027
mass 2 16.043

pair_coeff 1 1  0.1180  3.905
pair_coeff 2 2  0.2940  3.730

bond_coeff      1  260.00 1.5260
angle_coeff     1  63.0   112.40
dihedral_coeff  1  2.0 1 3

thermo 100
minimize 0.001 0.001 500 1000
reset_timestep 0

velocity all create 100.0 6234235
fix 1 all nvt temp 100.0 300.0 1.0
# dump 1 all custom 100 cychex-methane.lammpstrj id xu yu zu
run 2500
#write_data template-mix.data
#write_restart template-mix.restart
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using eam/fs pair style with pair coefficients * * FeVoter-ChenRecheck.fs Fe and p p p boundary conditions with a timestep of 0.0001 running for 1000 steps.","units           metal
atom_style      atomic
boundary        p p p

variable        latc  equal 2.87
lattice         bcc ${latc}
variable 	xmax equal   10.0
variable 	xmin equal  -10.0
variable 	ymax equal   10.0
variable 	ymin equal  -10.0
variable 	zmax equal   10.0
variable 	zmin equal  -10.0

region 		sim_box block ${xmin} ${xmax} ${ymin} ${ymax} ${zmin} ${zmax} &
                units lattice
create_box 	1 sim_box
region 		atom_box block ${xmin} ${xmax} ${ymin} ${ymax} ${zmin} ${zmax} &
                units lattice
create_atoms 	1 region atom_box

mass            1 55.845

pair_style      eam/fs
pair_coeff      * * FeVoter-ChenRecheck.fs Fe

neighbor        2.0 bin
neigh_modify    every 5 delay 0 check yes

fix             1 all nve

fix             twotemp all ttm 342785 1.2470e-5 0.087614 &
                0.005365 29.5917 47.5679 58.4613 10 10 10 set 1800.0

compute         pe all pe/atom
compute         ke all ke/atom

timestep        0.0001
thermo          100

thermo_style    custom step temp etotal f_twotemp[1] f_twotemp[2]
                thermo_modify format float ""%20.16g""

run             1000
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using pace recursive pair style with pair coefficients * * Cu-PBE-core-rep.ace Cu with a timestep of 0.0005 running for 100 steps.","# simple test of fcc Cu with ACE recursive

units           metal
atom_style      atomic

neighbor        0.3 bin
neigh_modify    every 2 delay 10 check yes

variable        a equal 3.597
lattice         fcc $a
region          box block 0 4 0 4 0 4
create_box      1 box
create_atoms    1 box

mass            1 26.98

pair_style      pace recursive
pair_coeff  * * Cu-PBE-core-rep.ace Cu

velocity        all create 300 8728 loop geom
timestep        0.0005
fix             1 all nve

compute         eatom all pe/atom
compute         energy all reduce sum c_eatom
variable        delenergy equal c_energy-pe

compute         satom all stress/atom NULL
compute         str all reduce sum c_satom[1] c_satom[2] c_satom[3]
variable        delpress equal -(c_str[1]+c_str[2]+c_str[3])/(3*vol)-press

thermo          10
thermo_style    custom step temp epair etotal press v_delenergy v_delpress

run             100

"
"Generate a LAMMPS input script for a NVE simulation of an full system using dpd/coul/slater/long ${T} ${cut_DPD} ${seed} ${lambda} ${cut_coul} pair style and p p p # periodic at all axes boundary conditions with a timestep of 0.01 running for _style    verlet steps.","# DPD Ionic Fluid

variable    T           equal 1.0
variable    cut_DPD     equal 1.0
variable    seed        equal 165412
variable    lambda      equal 0.25
variable    cut_coul    equal 2.0

#-------------------------------------------------------------------------------
# Initialize LAMMPS run for 3-d periodic
#-------------------------------------------------------------------------------

units                   lj
boundary                p p p # periodic at all axes
atom_style              full
dimension    3

bond_style              none
angle_style             none
dihedral_style          none
improper_style          none

newton on
comm_modify vel yes # store info of ghost atoms btw processors

#-------------------------------------------------------------------------------
# Box creation and configuration
#-------------------------------------------------------------------------------

# Define pair style and coefficients
pair_style dpd/coul/slater/long ${T} ${cut_DPD} ${seed} ${lambda} ${cut_coul}

read_data data.dpd_coul_slater_long

# Enable long range electrostatics solver
kspace_style    pppm       1e-04

# Construct neighbors every steps
neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes

#-------------------------------------------------------------------------------
# Run the simulation
#-------------------------------------------------------------------------------

thermo_style            custom step temp press vol evdwl ecoul elong pe ke fnorm fmax
thermo_modify norm no
thermo                  100

timestep     0.01
run_style    verlet

fix                     1 all nve

run                     1000

unfix           1

"
"Generate a LAMMPS input script for a NVE simulation of an charge system using zero 1.0 pair style with pair coefficients * * with a timestep of 0.005 running for _style verlet steps.","units	    lj	
atom_style  charge	

read_data data.cloud_wall

velocity	all set 0.0 0.0 0.0 mom no

pair_style	zero 1.0
pair_coeff	* * 

neighbor	1.0 bin
neigh_modify	delay 0

fix     1 all nve


#pair_style      coul/long 3.0
#pair_coeff      * *
#kspace_style    pppm 1.0e-3

kspace_style scafacos fmm 1.0e-3 
kspace_modify scafacos tolerance energy_rel
kspace_modify scafacos fmm_tuning 1

timestep	0.005

thermo_style custom step atoms cpu temp pe ke etotal ecoul press

run_style verlet

#dump simple all custom 1000 id x y z vx vy vz 
#dump dmp    all custom 1000 part.dump id mol x y z vx vy vz fx fy fz q mass
#dump dmpvtk all vtk 1000 vtk/part_*.vtk id mol x y z vx vy vz fx fy fz q mass 
#dump_modify dmpvtk pad 7

thermo 10
run	100
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0 pair style with pair coefficients 1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H and p p p boundary conditions with a timestep of 0.5 running for 2000 steps.","# 250 butane system for drude polarizability example (Langevin)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane

comm_modify vel yes

group gBUTANE molecule 1:250
group gCORES type 1 2 3
group gDRUDES type 4 5

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gDRUDES create ${vTEMP_D} 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4

fix fLANG all langevin/drude ${vTEMP} 100.0 200611 ${vTEMP_D} 20.0 260514 zero yes
fix fNPH all nve

compute cTEMP all temp/drude

thermo_style custom step cpu etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 50

timestep 0.5
run 2000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using lj/cut/coul/long 12 pair style with a timestep of 2.0 running for 10 steps.","# QMMM with PySCF - two water example

units           real
atom_style      full

pair_style      lj/cut/coul/long 12
pair_modify     mix arithmetic

bond_style      harmonic
angle_style     harmonic
dihedral_style  none
improper_style  none

kspace_style    pppm 1e-5

read_data       data.water

# QM atoms are 1st water
# MM atoms are 2nd water

group           qm molecule 1
group           mm molecule 2

# remove bonds/angles between QM atoms
# set charges to zero on QM atoms

delete_bonds    qm multi remove special
set             group qm charge 0.0

neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes

velocity        all create 300.0 87287 loop geom

# QMMM dynamics

timestep        2.0

fix             1 all nve

fix             2 qm mdi/qmmm direct elements O H
fix_modify      2 energy yes

thermo_style    custom step cpu temp ke evdwl ecoul epair emol elong &
                f_2 pe etotal press

thermo          1
run             10
"
"Generate a LAMMPS input script for a NVE simulation of an bond system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 and p p f boundary conditions running for 10000 steps at temperature 0.1.","# sample surface deposition script for molecules

units		lj
atom_style      bond
boundary        p p f

lattice		fcc 1.0
region          box block 0 5 0 5 0 10
create_box      3 box bond/types 1 extra/bond/per/atom 1

region		substrate block INF INF INF INF INF 3
create_atoms	1 region substrate

pair_style	lj/cut 2.5
pair_coeff	* * 1.0 1.0
pair_coeff	1 2 1.0 1.0 5.0
mass		* 1.0

bond_style	harmonic
bond_coeff      1 5.0 1.0

neigh_modify	delay 0

molecule        dimer molecule.dimer
region          slab block 0 5 0 5 8 9

group		addatoms empty
region          mobile block 0 5 0 5 2 INF
group		mobile region mobile

compute	add addatoms temp
compute_modify	add dynamic/dof yes extra/dof 0

fix		1 addatoms rigid/nvt/small molecule temp 0.1 0.1 0.1 mol dimer
fix		2 mobile langevin 0.1 0.1 0.1 587283
fix		3 mobile nve

fix		4 addatoms deposit 100 0 100 12345 region slab near 1.0 &
                mol dimer vz -1.0 -1.0 rigid 1
fix		5 addatoms wall/reflect zhi EDGE

thermo_style	custom step atoms temp epair etotal press
thermo          100
thermo_modify	temp add lost/bond ignore lost warn

#dump		1 all atom 50 dump.deposit.atom

#dump		2 all image 50 image.*.jpg type type &
#		axes yes 0.8 0.02 view 80 -30
#dump_modify	2 pad 5

#dump		3 all movie 50 tmp.mpg type type &
#		axes yes 0.8 0.02 view 80 -30
#dump_modify	3 pad 5

run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an hybrid bond ellipsoid oxdna system using hybrid/overlay oxdna2/excv oxdna2/stk oxdna2/hbond oxdna2/xstk oxdna2/coaxstk oxdna2/dh pair style with pair coefficients * * oxdna2/excv 11.92337812042065 5.9626 5.74965 11.92337812042065 4.38677 4.259 11.92337812042065 2.81094 2.72576 and p p p boundary conditions with a timestep of 0.01706 running for 100000 steps.","# LAMMPS input file in real units via oxdna lj2real.py, date 2024-05-19
variable number	equal 5
variable ofreq	equal 1000
variable efreq	equal 1000
variable T      equal 300.0
variable rhos   equal 0.2

units real

dimension 3

newton on

boundary  p p p

atom_style hybrid bond ellipsoid oxdna
atom_modify sort 0 8.518

# Pair interactions require lists of neighbours to be calculated
neighbor 17.036 bin
neigh_modify every 1 delay 0 check yes

read_data data.dsring

set atom * mass 315.8376

group all type 1 4

# oxDNA2 bond interactions - FENE backbone
bond_style oxdna2/fene
bond_coeff * 11.92337812042065 2.1295 6.4430152
special_bonds lj 0 1 1

# oxDNA2 pair interactions
pair_style hybrid/overlay oxdna2/excv oxdna2/stk oxdna2/hbond oxdna2/xstk oxdna2/coaxstk oxdna2/dh
pair_coeff * * oxdna2/excv 11.92337812042065 5.9626 5.74965 11.92337812042065 4.38677 4.259 11.92337812042065 2.81094 2.72576
pair_coeff * * oxdna2/stk seqdep ${T} 8.06199211612242 0.005309213 0.70439070204273 3.4072 7.6662 2.72576 6.3885 1.3 0.0 0.8 0.9 0.0 0.95 0.9 0.0 0.95 2.0 0.65 2.0 0.65
pair_coeff * * oxdna2/hbond seqdep 0.0 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0.0 0.7 1.5 0 0.7 1.5 0 0.7 0.46 3.141592654 0.7 4.0 1.570796327 0.45 4.0 1.570796327 0.45
pair_coeff 1 4 oxdna2/hbond seqdep 6.36589157849259 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0 0.7 1.5 0.0 0.7 1.5 0 0.7 0.46 3.141592654 0.7 4.0 1.570796327 0.45 4.0 1.570796327 0.45
pair_coeff 2 3 oxdna2/hbond seqdep 6.36589157849259 0.93918760272364 3.4072 6.3885 2.89612 5.9626 1.5 0 0.7 1.5 0.0 0.7 1.5 0 0.7 0.46 3.141592654 0.7 4.0 1.570796327 0.45 4.0 1.570796327 0.45
pair_coeff * * oxdna2/xstk 3.9029021145006 4.89785 5.74965 4.21641 5.57929 2.25 0.791592654 0.58 1.7 1.0 0.68 1.7 1.0 0.68 1.5 0 0.65 1.7 0.875 0.68 1.7 0.875 0.68
pair_coeff * * oxdna2/coaxstk 4.80673207785863 3.4072 5.1108 1.87396 4.94044 2.0 2.891592653589793 0.65 1.3 0 0.8 0.9 0 0.95 0.9 0 0.95 40.0 3.116592653589793
pair_coeff * * oxdna2/dh ${T} ${rhos} 0.815

# NVE ensemble
fix 1 all nve/asphere
#fix 2 all langevin ${T} ${T} 4265.0 457145 angmom 10

timestep 0.01706

#comm_style tiled
fix 3 all balance 1000 1.03 shift xyz 10 1.03
comm_modify cutoff 32.4

compute quat all property/atom quatw quati quatj quatk

compute erot all erotate/asphere
compute ekin all ke
compute epot all pe
variable erot equal c_erot
variable ekin equal c_ekin
variable epot equal c_epot
variable etot equal c_erot+c_ekin+c_epot
fix 5 all print ${efreq} ""$(step)  ekin = ${ekin} |  erot = ${erot} | epot = ${epot} | etot = ${etot}"" screen yes

dump out all custom ${ofreq} out.${number}.lammpstrj id mol type x y z ix iy iz vx vy vz c_quat[1] c_quat[2] c_quat[3] c_quat[4] angmomx angmomy angmomz
dump_modify out sort id
dump_modify out format line ""%d %d %d  %22.15le %22.15le %22.15le  %d %d %d  %22.15le %22.15le %22.15le  %22.15le %22.15le %22.15le %22.15le  %22.15le %22.15le %22.15le""

run 100000

write_data last_config.${number}.* nocoeff
#write_restart last_config.${number}.*
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using hybrid/overlay table linear 1200 threebody/table pair style with pair coefficients 1 1 table table_CG_CG.txt VOTCA with a timestep of 2.0 running for 1000 steps at temperature 300.0.","units           real
atom_style      atomic

# data file with one atom type
read_data       data.spce

pair_style      hybrid/overlay table linear 1200 threebody/table

#pair coefficients
pair_coeff      1 1 table table_CG_CG.txt VOTCA
pair_coeff      * * threebody/table spce.3b type

fix             1 all nvt temp 300.0 300.0 200.0

velocity        all create 300 432567 dist uniform loop geom mom yes
timestep        2.0

thermo          100
#dump            2 all custom 100 dump.spce id type x y z fx fy fz

run             1000
"
"Generate a LAMMPS input script for a NVE simulation of an full system using hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.600 8.0 coul/tt 4 8.0 pair style with pair coefficients 1    1 lj/cut/coul/long     0.057289     3.500000  # CTO CTO ~ and p p p boundary conditions with a timestep of 1.0 running for 500 steps.","# created by fftool

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls

special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.600 8.0 coul/tt 4 8.0
pair_modify tail yes
kspace_style pppm 1.0e-5

read_data data.ethylene_glycol

pair_coeff    1    1 lj/cut/coul/long     0.057289     3.500000  # CTO CTO ~
pair_coeff    1    2 lj/cut/coul/long     0.091945     3.304542  # CTO OHG ~
pair_coeff    1    3 lj/cut/coul/long     0.038625     2.958040  # CTO H1O ~
pair_coeff    1    4 lj/cut/coul/long     0.000000     0.000000  # CTO HOG ~
pair_coeff    2    2 lj/cut/coul/long     0.147565     3.120000  # OHG OHG ~
pair_coeff    2    3 lj/cut/coul/long     0.061990     2.792848  # OHG H1O ~
pair_coeff    2    4 lj/cut/coul/long     0.000000     0.000000  # OHG HOG ~
pair_coeff    3    3 lj/cut/coul/long     0.026041     2.500000  # H1O H1O ~
pair_coeff    3    4 lj/cut/coul/long     0.000000     0.000000  # H1O HOG ~
pair_coeff    4    4 lj/cut/coul/long     0.000000     0.000000  # HOG HOG ~
pair_coeff    *   5* lj/cut/coul/long     0.000000     0.000000 
pair_coeff    1    1 thole   1.662
pair_coeff    1    2 thole   1.561
pair_coeff    1    5 thole   1.662
pair_coeff    1    6 thole   1.561
pair_coeff    2    2 thole   1.467
pair_coeff    2    5 thole   1.561
pair_coeff    2    6 thole   1.467
pair_coeff    5    5 thole   1.662
pair_coeff    5    6 thole   1.561
pair_coeff    6    6 thole   1.467
pair_coeff    2    4 coul/tt  4.5 1.0
pair_coeff    4    6 coul/tt  4.5 1.0
pair_coeff    1    4 coul/tt  4.5 1.0
pair_coeff    4    5 coul/tt  4.5 1.0

group ATOMS type 1 2 3 4
group CORES type 1 2
group DRUDES type 5 6

fix DRUDE all drude C C N N D D

fix SHAKE ATOMS shake 0.0001 20 0 b 3 4

neighbor 2.0 bin

timestep 1.0

variable TK equal 298.0
variable TDK equal 1.0
variable PBAR equal 1.0

comm_modify vel yes
velocity ATOMS create ${TK} 12345

compute TATOM ATOMS temp
compute TDRUDE all temp/drude

fix DTDIR all drude/transform/direct
fix TSTAT ATOMS npt temp ${TK} ${TK} 200 iso ${PBAR} ${PBAR} 1000
fix_modify TSTAT temp TATOM press thermo_press
fix TSTDR DRUDES nvt temp ${TDK} ${TDK} 50
fix DTINV all drude/transform/inverse

fix ICECUBE all momentum 1000 linear 1 1 1

thermo_style custom step etotal ke pe ebond eangle evdwl ecoul elong &
  press vol density c_TATOM c_TDRUDE[1] c_TDRUDE[2]
thermo 50

run 500

"
"Generate a LAMMPS input script for a NVE simulation using rebomos pair style with pair coefficients * * MoS.rebomos Mo S running for 20 steps.","units metal

lattice custom 1.0 a1  3.1903157234 0.0000000000  0.0000000000 &
                   a2 -1.5964590311 2.7651481541  0.0000000000 &
                   a3  0.0000000000 0.0000000000 13.9827680588 &
                basis  0.0000000000 0.000000000   $(3.0/4.0)   &
                basis  0.0000000000 0.000000000   $(1.0/4.0)   &
                basis  $(2.0/3.0)   $(1.0/3.0)    0.862008989  &
                basis  $(1.0/3.0)   $(2.0/3.0)    0.137990996  &
                basis  $(1.0/3.0)   $(2.0/3.0)    0.362008989  &
                basis  $(2.0/3.0)   $(1.0/3.0)    0.637991011  &
                origin 0.1 0.1 0.1

region box prism 0 4 0 8 0 1 -2.0 0.0 0.0
create_box 2 box
create_atoms 2 box &
   basis 1 1 &
   basis 2 1 &
   basis 3 2 &
   basis 4 2 &
   basis 5 2 &
   basis 6 2

mass                    1 95.95  #Mo
mass                    2 32.065 #S

pair_style rebomos
pair_coeff * * MoS.rebomos Mo S

thermo_style custom step temp press pe ke cellgamma vol
thermo 10
#dump 1 all atom 10 MoS.lammpstrj
fix 1 all nve
run 20

"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients 1 1 10.0 1.0 2.5 and f f p boundary conditions with a timestep of 0.001 running for 10000 steps.","# 2d circle of particles inside a box with LJ walls

variable        b index 0

variable        x index 50
variable        y index 20
variable        d index 20
variable        v index 5
variable        w index 2

units           lj
dimension       2
atom_style      atomic
boundary        f f p

lattice         hex 0.85
region          box block 0 $x 0 $y -0.5 0.5
create_box      1 box
region          circle sphere $(v_d/2+1) $(v_d/2/sqrt(3.0)+1) 0.0 $(v_d/2)
create_atoms    1 region circle
mass            1 1.0

velocity        all create 0.5 87287 loop geom
velocity        all set $v $w 0 sum yes

pair_style      lj/cut 2.5
pair_coeff      1 1 10.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

fix             1 all nve

fix             2 all wall/lj93 xlo 0.0 1 1 2.5 xhi $x 1 1 2.5
fix             3 all wall/lj93 ylo 0.0 1 1 2.5 yhi $y 1 1 2.5

comm_style      tiled
fix             10 all balance 50 0.9 rcb

#compute         1 all property/atom proc
#variable        p atom c_1%10
#dump            2 all custom 50 tmp.dump id v_p x y z

#dump            3 all image 50 image.*.jpg v_p type &
#                adiam 1.0 view 0 0 zoom 1.8 subbox yes 0.02
#variable        colors string &
#                ""red green blue yellow white &
#                purple pink orange lime gray""
#dump_modify     3 pad 5 amap 0 10 sa 1 10 ${colors}

thermo_style    custom step temp epair press f_10[3] f_10
thermo          100
timestep        0.001

run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an dpd system using dpd/fdt/energy 10.0 245455 pair style with pair coefficients 1 1 0.075 0.022 3.2E-5 10.00 and p p p boundary conditions with a timestep of 0.001 running for 100 steps.","# Input File for DPD fluid under isoenergetic conditions using the VV-SSA integration scheme

boundary        p p p

units           metal  # ev, ps
atom_style      dpd
read_data       data.dpde

comm_modify 	mode single vel yes
mass            1 100.0

pair_style      dpd/fdt/energy 10.0 245455
pair_coeff      1 1 0.075 0.022 3.2E-5 10.00

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check no once no

timestep        0.001

compute         dpdU all dpd
variable        totEnergy equal pe+ke+c_dpdU[1]+c_dpdU[2]

thermo          1
thermo_style    custom step temp pe ke v_totEnergy
thermo_modify   format float %15.10f

fix             1 all shardlow
fix             2 all nve
fix             3 all eos/cv 0.0005

run             100
"
"Generate a LAMMPS input script for a NVT simulation of an electron system using eff/cut 529.177249 pair style with pair coefficients * * and f f f boundary conditions with a timestep of 0.0005 running for 400000 steps at temperature 10.0.","# Created 2010-11-28

# General parameters

variable	sname index CH4fc.ang

units		real
newton		on
boundary	f f f

atom_style      electron

read_data       data.${sname}

pair_style      eff/cut 529.177249 
pair_coeff      * *

compute         energies all pair eff/cut
variable        eke equal c_energies[1]
variable        epauli equal c_energies[2]
variable        estatics equal c_energies[3]
variable        errestrain equal c_energies[4]

comm_modify	vel yes

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable        press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

compute         effTemp all temp/eff

thermo          10
thermo_style    custom step etotal pe ke v_eke v_epauli v_estatics v_errestrain temp press v_press 
thermo_modify   temp effTemp

# Minimization

min_style       cg
dump            1 all xyz 10 ${sname}.min.xyz
compute         1 all property/atom spin eradius erforce
dump            2 all custom 10 ${sname}.min.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
#min_modify      line quadratic
minimize        0 1.0e-6 1000 10000

undump		1
undump		2

# Equilibrate at 300K
velocity        all create 10.0 4928459 rot yes mom yes dist gaussian

timestep        0.0005

dump            1 all custom 1000 ${sname}.nvt.lammpstrj id type q c_1[1] c_1[2] x y z fx fy fz c_1[3]
#fix		0 all langevin/eff 300.0 300.0 0.1
fix             1 all nvt/eff temp 10.0 10000.0 0.1

run             400000


"
"Generate a LAMMPS input script for a NVE simulation using lj/cut 8.1500 pair style with pair coefficients 1 1 0.0104 3.4000 running for 100 steps.","# 3d Lennard-Jones melt

variable     x index 1
variable     y index 1
variable     z index 1

variable     xx equal 20*$x
variable     yy equal 20*$y
variable     zz equal 20*$z

units        real

lattice      fcc 4.4300
region       box block 0 ${xx} 0 ${yy} 0 ${zz}
create_box   1 box
create_atoms 1 box

pair_style   lj/cut 8.1500
pair_coeff   1 1 0.0104 3.4000

#pair_style  kim LennardJones_Ar
#pair_coeff  * * Ar

mass         1 39.95
velocity     all create 200.0 232345 loop geom

neighbor     0.3 bin
neigh_modify delay 0 every 1 check yes

fix          1 all nve
#fix         1 all npt temp 1.0 1.0 1.0 iso 1.0 1.0 3.0

run          100
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using hybrid/overlay table spline 1000 dpd/tstat ${T} ${T} ${rc} 385262 pair style with pair coefficients 1 1 table cg_spce_table.pot VOTCA ${rc} and p p p boundary conditions with a timestep of 1.0 running for _style   verlet steps.","# Coarse-Grained SPC/E Water

variable T   equal 300.0
variable rc  equal   9.0
variable rcD equal  10.0

units            real
boundary     p p p
atom_style   atomic
dimension    3
newton       on
comm_modify  vel yes

read_data    cg_spce.data

pair_style       hybrid/overlay table spline 1000 dpd/tstat ${T} ${T} ${rc} 385262

pair_coeff   1 1 table cg_spce_table.pot VOTCA ${rc}
pair_coeff   1 1 dpd/tstat 10.0 ${rcD}

timestep    1.0
run_style   verlet

velocity all create ${T} 68768932

thermo_style custom step time temp press
thermo       100

fix 1 all    nve

run          1000
"
"Generate a LAMMPS input script for a NVE simulation of an hybrid sphere bond system using lj/cut 8.76 pair style with pair coefficients 1 1 0.2339 3.504 with a timestep of 1.0 running for 0 post no steps.","
units real
atom_style hybrid sphere bond

lattice         sc 5.0
region          box block 50 250 50 250 50 250 units box
create_box      2 box
region particles block 110 190 110 190 110 190 units box
create_atoms    1 region particles
region          lid block 100 110 50 250 50 250 units box
group           mobile type 1
set type 1 diameter 7.0

# create_atoms    2 mesh open_box.stl meshmode bisect 4.0 units box
create_atoms    2 mesh open_box.stl meshmode qrand 0.1 units box
group           mesh type 2

pair_style lj/cut 8.76
pair_coeff      1 1 0.2339 3.504
pair_coeff      1 2 0.2339 7.008 $(7.008*2^(1.0/6.0))
pair_coeff      2 2 0.0    1.0
mass *  39.95

neigh_modify exclude type 2 2

timestep 1.0

run 0 post no

fix dir  mobile oneway 10 lid x
fix move mobile nve
fix load all balance 1000 1.1 shift xyz 10 1.01 weight neigh 0.5 weight group 2 mesh 0.1 mobile 1.0
fix rot  mesh move rotate 150.0 150.0 150.0 1.0 0.0 0.0 500000.0 units box

reset_timestep 0 time 0.0
velocity mobile create 150.0 54634234

compute ptemp mobile temp
thermo_modify temp ptemp

thermo 200
compute ke all ke/atom
#dump 2 all movie 200 mesh.mkv c_ke radius size 960 1440 zoom 1.5 box no 0.0 view 120 180
#dump_modify 2 bitrate 4000 framerate 12 color orange 1.0 0.5 0.0 amap min max cf 0.0 6 min blue 0.1 fuchsia 0.2 red 0.4 orange 0.6 yellow max white
#dump 1 all custom 500 open_box.lammpstrj id type mol x y z vx vy vz


run 5000

"
"Generate a LAMMPS input script for a NVE simulation of an electron system using eff/cut 6.447968 pressure/evirials pair style with pair coefficients * * and p p p boundary conditions running for 10000 steps.","variable	sname index h2

units 		electron
newton		on
boundary        p p p

atom_style	electron

read_data  	data.${sname}

pair_style      eff/cut 6.447968 pressure/evirials
pair_coeff 	* *

comm_modify	vel yes

min_style	cg
min_modify	line quadratic
minimize 	0 1.0e-6 1000 2000

region 		part block INF 2.0 INF 2.0 INF 5.0 units box
group		sub id < 32

compute		effTemp all temp/eff
compute         effPress all pressure effTemp
compute 	regionT sub temp/region/eff part 

compute		peratom all stress/atom NULL
compute		p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable	press equal -(c_p[1]+c_p[2]+c_p[3])/(3*vol)

thermo		100
thermo_style	custom step etotal pe ke temp press v_press c_regionT
thermo_modify	temp effTemp press effPress

#velocity all create 300.0 4928459 rot yes dist gaussian

fix 		3 all temp/rescale/eff 10 0.0 300.0 0.02 1.0
fix		1 all nve/eff

run		10000
unfix		3

#compute         1 all property/atom spin eradius
#fix		1 all npt/eff temp 3000.0 3000.0 0.1 iso 1e7 1e7 1.0 drag 0.5
#dump		1 all custom 100 dump.file id type q c_1[1] c_1[2] x y z

#fix		1 all nve/eff

run 		10000
"
"Generate a LAMMPS input script for a general simulation of an hybrid molecular system using lj/cut 1.68369 pair style with pair coefficients * * 0 1.5 and p p p boundary conditions with a timestep of 0.00005 running for ${numofsteps}     # For 250001 steps without noise, 16 minutes on AMD Ryzen Threadripper 1950X 16-Core, 41 mintues on Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz 4-core steps.","#===========================================================================#
# Immersed Boundary Wall                                                    #
#                                                                           #
# Run consists of a 32-bead coarse-grained polymer                     	    #
# translocating through a solid-state atomistic wall                        #
# under pressure-driven lattice-Boltzmann fluid flow                        #
#                                                                           #
# To run this example, LAMMPS needs to be compiled with a the following     #
# packages: MOLECULE, RIGID, LATBOLTZ, USER-VTK                             #
#                                                                           #
#To run this example on N cores, use command:                               # 
# mpirun -n N /LAMMPS/EXE/FILE -in in.polymer > output.out                  #
#                                                                           #
# If uncommented:                                                           #
# Sample output for polymer from this run can be found in the file:         # 
#   'translocationdump.lammpstrj'                                           #
# and viewed using, the VMD software.                                       #
# OR                                                                        #
#    'dump.translocation.vtk'                                               #
# and viewed using the Paraview software.                                   #
#                                                                           #
# Sample output for the wall from this run can be found in the file:        #
#   'walldump.xyz'                                                          #
# and can be viewed using the VMD or Paraview Software.                     #
#===========================================================================#

units		nano
dimension	3
boundary	p p p
atom_style	hybrid molecular
special_bonds	fene
read_data	data.translocation

#---------------------------------------------------------------------------
#Creating a atomistic wall on an FCC lattice and removing the block from the
#middle to create the nanopore
#---------------------------------------------------------------------------
lattice fcc 1.0
region wall block 28 38 0 32 0 32
create_atoms 3 region wall

region hole block 28 38 14 18 14 18
delete_atoms region hole compress no

#----------------------------------------------------------------------------
# Need a neighbor bin size smaller than the lattice-Boltzmann grid spacing   
#   to ensure that the particles belonging to a given processor remain inside
#   that processors lattice-Boltzmann grid. 
# The communcation cutoff is set to 2.5 dx to ensure that all particles in the
#   processor ghost fluid region (of width 2dx) are known to local processor.
#---------------------------------------------------------------------------- 
neighbor 0.5 bin
neigh_modify delay 0 every 1 check yes
neigh_modify exclude type 2 2
neigh_modify exclude type 2 1
neigh_modify exclude type 2 3
neigh_modify exclude type 3 3
comm_modify cutoff 2.5        

#----------------------------------------------------------------------------
# Implement a hard-sphere interaction between the particles at the center of 
# each monomer with each other and the wall atoms
# (use a truncated and shifted Lennard-Jones potential).
#----------------------------------------------------------------------------
bond_style	fene
bond_coeff	1 60.0 2.25 4.14195 1.5
pair_style	lj/cut 1.68369
pair_coeff	* * 0 1.5
pair_coeff	1 1 4.14195 1.5 1.68369
pair_coeff	1 3 4.14195 1.5 1.68369

#-----------------------------------------------------------------------------
# The mass is set 4/3 PI r^3 fluid_density/31 , where r=0.617, 31 is number of
# nodes in a single monomer. The mass of wall atoms is chosen heavy as they
# are fixed.
# ----------------------------------------------------------------------------
mass * 0.00000318

#-----------------------------------------------------------------------------
timestep 0.00005

#----------------------------------------------------------------------------
# ForceAtoms are the particles at the center of each monomer which  
#   do not interact with the fluid, but are used to implement the hard-sphere
#   interactions.       
# FluidAtoms are the particles representing the surface of the monomer
# which do interact with the fluid. The nanopore particles are also included
# in this group as they interact with the fluid.
# Polymer is the entire set of monomers of the composite polymer chain. 
# WallAtoms are the particles of the nanopore.
#----------------------------------------------------------------------------
group ForceAtoms type 1
group FluidAtoms type 2 3
group Polymer    type 1 2
group WallAtoms  type 3

#---------------------------------------------------------------------------
# Create a lattice-Boltzmann fluid covering the simulation domain.
# This fluid feels a force due to the particles specified through FluidAtoms 
#   (however, this fix does not explicity apply a force back on to these 
#    particles. This is accomplished through the use of the lb/viscous fix).
# We set fluid viscosity = 0.1 and fluid density = 0.00009982071 which 
#   means the kinematic viscosity is idential to that of water but the 
#   dynamic viscosity is a factor of 10 less than that of water which 
#   increases the diffusive dynamics by a corresponding factor of 10.
#   lattice spacing dx=1.0, and mass unit, dm=0.00009982071 (makes density 1)
# Use a thermal lattice-Boltzmann fluid (temperature 300K, random number 
#   seed=5252).  This enables the particles to undergo Brownian motion in 
#   the fluid.
# In this case we use the scaleGamma argument to set the mass of the WallAtoms
#   to infinity.
# The commented out line can be substituted to look at the flow without noise
#   which should be similar to the average flow field in the case with noise.
#----------------------------------------------------------------------------
fix 1 FluidAtoms lb/fluid 1 0.1 0.00009982071 dx 1.0 scaleGamma 3 -1 stencil 2 pressurebcx 1200 noise 300.0 5252
#fix 1 FluidAtoms lb/fluid 1 0.1 0.00009982071 dx 1.0 scaleGamma 3 -1 stencil 2 pressurebcx 1200 dumpxdmf 1000 flow 0

#----------------------------------------------------------------------------
# Apply the force from the fluid to the particles, and integrate their 
#   motion, constraining each monomer to move and rotate as a single rigid 
#   spherical object.  
# Since both the ForceAtoms (central atoms), and the FluidAtoms (spherical
#   shell) should move and rotate together, this fix is applied to all Polymer
#   of atoms in the system.
# The wall atoms are frozen in space and all the calculated forces on the atoms
#   are set to zero at each timestep. 
#----------------------------------------------------------------------------#
fix 2 FluidAtoms lb/viscous
fix 3 Polymer rigid/small molecule
fix freeze WallAtoms setforce 0 0 0

#----------------------------------------------------------------------------
# Write position and velocity coordinates into a file every 2000 time steps.
#----------------------------------------------------------------------------
#variable x1 equal x[1]
#variable y1 equal y[1]
#variable z1 equal z[1]
#variable vx1 equal vx[1]
#variable vy1 equal vy[1]
#variable vz1 equal vz[1]
#variable x2 equal x[249]
#variable y2 equal y[249]
#variable z2 equal z[249]
#variable vx2 equal vx[249]
#variable vy2 equal vy[249]
#variable vz2 equal vz[249]
#variable x3 equal x[497]
#variable y3 equal y[497]
#variable z3 equal z[497]
#variable vx3 equal vx[497]
#variable vy3 equal vy[497]
#variable vz3 equal vz[497]
#variable x4 equal x[745]
#variable y4 equal y[745]
#variable z4 equal z[745]
#variable vx4 equal vx[745]
#variable vy4 equal vy[745]
#variable vz4 equal vz[745]

#thermo_style custom v_x1 v_y1 v_z1 v_vx1 v_vy1 v_vz1 v_x2 v_y2 v_z2 v_vx2 v_vy2 v_vz2 v_x3 v_y3 v_z3 v_vx3 v_vy3 v_vz3 v_x4 v_y4 v_z4 v_x4 v_y4 v_z4
#thermo       10

#---------------------------------------------------------------------------------
# Write coordinates of the centre of mass and radius of gyration tensor components
#---------------------------------------------------------------------------------
compute centre ForceAtoms com
compute rg ForceAtoms gyration
thermo_style custom c_rg c_rg[1] c_rg[2] c_rg[3] c_rg[4] c_rg[5] c_rg[6] c_centre[1] c_centre[2] c_centre[3]
thermo  1000

#--------------------------------------------------------------------------------
# Define number of steps variable. Write dump files for the polymer in both LAMMPS
# trajectory and vtk format (commented out here). Write xyz dump file
#--------------------------------------------------------------------------------
variable numofsteps equal 400001
#dump  1 ForceAtoms custom 500 translocationdump.lammpstrj id xu yu zu vx vy vz
#dump 2 ForceAtoms vtk 1000 dump*.translocation.vtk id xu yu zu vx vy vz
#dump 4 WallAtoms xyz $(v_numofsteps-1) walldump.xyz

#restart 50000 4nmrestart.*

run ${numofsteps}     # For 250001 steps without noise, 16 minutes on AMD Ryzen Threadripper 1950X 16-Core, 41 mintues on Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz 4-core
"
"Generate a LAMMPS input script for a NVE simulation of an electron system using eff/cut 30.627847 pair style with pair coefficients * * and p p p boundary conditions with a timestep of 0.001 running for 10 steps.","variable        sname index h2bulk

units 		electron
newton		on
boundary	p p p

atom_style	electron

read_data  	data.${sname}

pair_style      eff/cut 30.627847
pair_coeff	* * 

neigh_modify    one 10000 page 100000

comm_modify	vel yes

compute		effTemp all temp/eff

thermo          10
thermo_style    custom step pe temp press
thermo_modify	temp effTemp

# structure minimization
min_style	cg
minimize 	0 1.0e-4 10 10

timestep	0.001

velocity	all create 20000.0 4928459 rot yes mom yes dist gaussian

# nve
fix		1 all nve/eff
#fix             2 all imd 8888 trate 1 unwrap on nowait on

compute		peatom all pe/atom
compute		keatom all ke/atom/eff

dump		2 all xyz 1000 ${sname}.nve.xyz
compute         1 all property/atom spin eradius
dump		3 all custom 1000 ${sname}.nve.lammpstrj id type x y z c_1[1] c_1[2] c_peatom c_keatom

run		10

unfix		1
#unfix		2
undump		2
undump		3
"
"Generate a LAMMPS input script for a general simulation of an atomic system using sw pair style with pair coefficients * * Si.sw Si and p p p boundary conditions with a timestep of 0.01.","# NEB simulation of vacancy hopping in silicon crystal

units           metal

atom_style      atomic
atom_modify     map array
boundary        p p p
atom_modify     sort 0 0.0

# coordination number cutoff

variable r equal 2.835

# diamond unit cell

variable a equal 5.431
lattice         custom $a               &
                a1 1.0 0.0 0.0          &
                a2 0.0 1.0 0.0          &
                a3 0.0 0.0 1.0          &
                basis 0.0 0.0 0.0       &
                basis 0.0 0.5 0.5       &
                basis 0.5 0.0 0.5       &
                basis 0.5 0.5 0.0       &
                basis 0.25 0.25 0.25    &
                basis 0.25 0.75 0.75    &
                basis 0.75 0.25 0.75    &
                basis 0.75 0.75 0.25

region          myreg block     0 4 &
                                0 4 &
                                0 4

#create_box      1 myreg
#create_atoms    1 region myreg
#mass            1       28.06
#write_data      initial.sivac

read_data       initial.sivac

# make a vacancy

group Si type 1

group del id 300
delete_atoms group del compress no
group vacneigh id 174 175 301 304 306 331 337
 
# choose potential

pair_style      sw
pair_coeff * * Si.sw Si

# set up neb run

variable        u uloop 20

# only output atoms near vacancy

#dump events vacneigh custom 1000 dump.neb.sivac.$u id type x y z

# initial minimization to relax vacancy

displace_atoms all random 0.1 0.1 0.1 123456
minimize        1.0e-6 1.0e-4 1000 10000

reset_timestep  0

fix             1 all neb 1.0 

thermo          100

# run NEB for 2000 steps or to force tolerance

timestep        0.01
min_style       fire

neb             0.0 0.01 100 100 10 final final.sivac
"
"Generate a LAMMPS input script for a NVE simulation of an atomic system using lj/cut 2.5 pair style with pair coefficients * * 1.0 1.0 and p p f boundary conditions running for 10000 steps.","# sample surface deposition script for atoms

units		lj
atom_style      atomic
boundary        p p f

lattice		fcc 1.0
region          box block 0 5 0 5 0 10
create_box      2 box

region		substrate block INF INF INF INF INF 3
create_atoms	1 region substrate

pair_style	lj/cut 2.5
pair_coeff	* * 1.0 1.0
pair_coeff	1 2 1.0 1.0 5.0
mass		* 1.0

neigh_modify	delay 0

group		addatoms type 2
region          mobile block 0 5 0 5 2 INF
group		mobile region mobile

compute		add addatoms temp
compute_modify	add dynamic/dof yes extra/dof 0

fix		1 addatoms nve
fix		2 mobile langevin 1.0 1.0 0.1 587283
fix		3 mobile nve

region          slab block 0 5 0 5 8 9
fix		4 addatoms deposit 100 2 100 12345 region slab near 1.0 &
                vz -1.0 -1.0
fix		5 addatoms wall/reflect zhi EDGE

thermo_style	custom step atoms temp epair etotal press
thermo          100
thermo_modify	temp add

#dump		1 all atom 50 dump.deposit.atom

#dump		2 all image 50 image.*.jpg type type &
#		axes yes 0.8 0.02 view 80 -30
#dump_modify	2 pad 5

#dump		3 all movie 50 movie.mpg type type &
#		axes yes 0.8 0.02 view 80 -30
#dump_modify	3 pad 5

run             10000
"
"Generate a LAMMPS input script for a NVE simulation of an molecular system using lj/cut/gpu  10.0 pair style with pair coefficients 1  1    0.07    3.55 and f f f boundary conditions with a timestep of 2.0 running for 100000000 steps.","# stick a buckyball into a nanotube
units           real
dimension       3
boundary       f f f
atom_style      molecular
newton          off

processors * * 1

# read topology 
read_data       data.bucky-plus-cnt

pair_style  lj/cut/gpu  10.0
bond_style  harmonic
angle_style charmm
dihedral_style charmm

special_bonds lj/coul 0.0 0.0 0.0

pair_coeff  1  1    0.07    3.55
pair_coeff  1  2    0.07    3.55
pair_coeff  2  2    0.07    3.55
bond_coeff     1  305.0     1.4
angle_coeff    1   40.000 120.00   35.00   2.41620
dihedral_coeff 1    3.100   2     180   0.0

neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes

timestep        2.0

# required for GPU acceleration
fix   gpu  all      gpu  force 0 0 1.0

# we only move some atoms.
group mobile type 1

# have balls bounce off the walls
fix     walls       mobile wall/reflect xlo EDGE ylo EDGE zlo EDGE xhi EDGE yhi EDGE zhi EDGE

velocity mobile create 303.0 46659 mom yes rot yes dist gaussian

# take some potential energy out of the system
minimize 1.0e-4 1.0e-6 100 1000

reset_timestep 0

fix     integrate   mobile nve
fix     thermostat  mobile langevin 300.0 300.0 2000.0 234624

# IMD setup.
fix  comm       all imd 6789 unwrap on trate 10
#fix  comm       all imd 6789 unwrap on trate 10 nowait on

# temperature is based on mobile atoms only
compute mobtemp mobile temp
thermo_style    custom step pe ke evdwl emol c_mobtemp spcpu
thermo          1000
thermo_modify   norm yes
thermo_modify   temp mobtemp

run             100000000
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using hybrid/overlay table linear 1200 sw/angle/table pair style with pair coefficients 1 1 table table_CG_CG.txt VOTCA with a timestep of 2.0 running for 1000 steps at temperature 300.0.","units           real
atom_style      atomic

read_data       data.spce

pair_style      hybrid/overlay table linear 1200 sw/angle/table

pair_coeff      1 1 table table_CG_CG.txt VOTCA
pair_coeff      * * sw/angle/table spce.sw type

fix             1 all nvt temp 300.0 300.0 200.0

velocity        all create 300 432567 dist uniform mom yes

timestep        2.0

thermo          100
#dump            2 all custom 10 spce_sw.dump id type x y z fx fy fz

run             1000
"
"Generate a LAMMPS input script for a NVE simulation of an bpm/sphere system using gran/hertz/history 1.0 NULL 0.5 NULL 0.1 1 pair style with pair coefficients 1 1 and m m m boundary conditions with a timestep of 0.05 running for 100000 steps.","units           lj
dimension       3
boundary        m m m
atom_style      bpm/sphere
special_bonds   lj 0.0 1.0 1.0 coul 1.0 1.0 1.0
newton          on off
comm_modify     vel yes cutoff 3.3
region          box block -15 15 -15 15 0 60.0
create_box      1 box bond/types 1 extra/bond/per/atom 15 extra/special/per/atom 50

molecule        my_mol ""rect.mol""
region          wall_cyl cylinder z 0.0 0.0 10.0 EDGE EDGE side in
region          dropzone cylinder z 0.0 0.0 10.0 40.0 50.0 side in

pair_style      gran/hertz/history 1.0 NULL 0.5 NULL 0.1 1
bond_style      bpm/rotational
pair_coeff      1 1
bond_coeff      1 1.0 0.2 0.01 0.01 2.0 0.4 0.02 0.02 0.2 0.04 0.002 0.002

compute         nbond all nbond/atom
compute         tbond all reduce sum c_nbond
compute         bond_ids all property/local batom1 batom2
compute         bond_properties all bond/local dist b1

compute_modify  thermo_temp dynamic/dof yes

fix             1 all wall/gran hertz/history 1.0 NULL 0.5 NULL 0.1 1 zplane 0.0 NULL
fix             2 all wall/gran/region hertz/history 1.0 NULL 0.5 NULL 0.1 1 region wall_cyl
fix             3 all gravity 1e-4 vector 0 0 -1
fix             4 all deposit 40 0 1500 712511343 mol my_mol region dropzone near 2.0 vz -0.05 -0.05
fix             5 all nve/bpm/sphere

timestep        0.05
thermo_style    custom step ke pe pxx pyy pzz c_tbond
thermo          100
#dump            1 all custom 500 atomDump id radius x y z c_nbond mol
#dump            2 all local 500 bondDump c_bond_ids[*] c_bond_properties[*]
#dump_modify     2 colname 1 ""id1"" colname 2 ""id2"" colname 3 ""r"" colname 4 ""r0""

run             100000
"
"Generate a LAMMPS input script for a NVT simulation of an atomic system using lj/cut 13.5 pair style with pair coefficients 1 1 0.238 3.405 and p p p boundary conditions with a timestep of ${dt} running for $n steps.","# This test compares Hardy and Cauchy-Born metrics of energy density and stress
# for an Ar system undergoing dynamics at a finite temperature.
echo both
log            ftcb_constV.log
units          real
atom_style     atomic
variable       lattice_constant equal 5.256227487
variable       c equal 6
variable       L equal (${lattice_constant}*$c)
variable       V equal $L*$L*$L
print          ""Volume : $V""
variable       Ti equal 0.0001
variable       dT equal 0.2
variable       n equal 10000
variable       m equal 200
variable       dt equal 0.1
# create system
lattice        fcc ${lattice_constant}
region         box block 0 $c 0 $c 0 $c
boundary       p p p
pair_style     lj/cut 13.5
read_data      ftcb_constV_setup.init
mass           1 39.95
pair_coeff     1 1 0.238 3.405
# define region
neighbor       1.0 bin
neigh_modify   delay 0 every 2000 check no
reset_timestep 0
thermo         $m
compute_modify thermo_temp extra/dof 0
variable       nrepeat equal $n/$m
variable       sxx equal -pxx
variable       intenergy equal etotal
fix            TDAVE all ave/time $m ${nrepeat} $n c_thermo_temp v_sxx v_intenergy ave one file ftcb_constV.profile
thermo_style   custom step temp press etotal lx ly lz
timestep       ${dt}
# filtered
fix            ATCFILT all atc field Ar_CauchyBorn.mat
#fix_modify     ATCFILT  reset_atomic_reference_positions ftcb_constV_setup.data
fix_modify     ATCFILT mesh create 1 1 1 box p p p
fix_modify     ATCFILT  fields none
fix_modify     ATCFILT  fields add internal_energy stress cauchy_born_energy cauchy_born_stress
fix_modify     ATCFILT  fields add temperature displacement
fix_modify     ATCFILT  gradients add displacement
fix_modify     ATCFILT  output ftcb_constV_filteredFE $n text binary tensor_components
fix_modify     ATCFILT  sample_frequency $m
variable       scale equal $n*${dt}
fix_modify     ATCFILT  filter scale ${scale}
fix_modify     ATCFILT  filter on
fix_modify     ATCFILT  filter type step
# not filtered
fix            ATC all atc field Ar_CauchyBorn.mat
#fix_modify     ATC  reset_atomic_reference_positions ftcb_constV_setup.data
fix_modify     ATC mesh create 1 1 1 box p p p
fix_modify     ATC  fields none
fix_modify     ATC  fields add internal_energy stress cauchy_born_energy cauchy_born_stress
fix_modify     ATC  fields add temperature displacement
fix_modify     ATC  gradients add displacement
fix_modify     ATC  output ftcb_constVFE $m text binary tensor_components
velocity       all create ${Ti} 102486 mom yes rot yes dist gaussian
# step iu T,V space
variable i loop 1
label loop_i
  print "">>> step $i, T: ${Ti}, V: $V""
  variable Tf equal ${Ti}+${dT}
  fix NVT all nvt temp ${Ti} ${Tf} 20 drag 0.5 tchain 1
  run  $n
  unfix NVT
  fix NVT all nvt temp ${Tf} ${Tf} 20 drag 0.5 tchain 1
  run  $n
  unfix NVT
  variable Ti equal ${Tf}
next i
jump in.ftcb_constV loop_i
"
