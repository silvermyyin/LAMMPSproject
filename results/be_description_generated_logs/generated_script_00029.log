LAMMPS (27 Jun 2024 - Development - patch_27Jun2024-612-gaa0b6c47c2-modified)
# LAMMPS script for calculating elastic constants of fcc Argon

units           metal
dimension       3
boundary        p p p
atom_style      atomic

# Create the fcc lattice of Argon with lattice parameter 5.405 Å
lattice         fcc 5.405
Lattice spacing in x,y,z = 5.405 5.405 5.405
region          box block 0 5 0 5 0 5
create_box      1 box
Created orthogonal box = (0 0 0) to (27.025 27.025 27.025)
  1 by 1 by 1 MPI processor grid
create_atoms    1 box
Created 500 atoms
  using lattice units in orthogonal box = (0 0 0) to (27.025 27.025 27.025)
  create_atoms CPU = 0.000 seconds

# Define interatomic potential: Lennard-Jones
pair_style      lj/cut 12.0
pair_coeff      1 1 0.0103 3.40  # Argon parameters: epsilon = 0.0103 eV, sigma = 3.40 Å

# Define mass of Argon
mass            1 39.948

# Set the initial temperature
velocity        all create 60.0 12345 mom yes rot yes dist gaussian

# Setup NPT ensemble for equilibration
fix             1 all npt temp 60.0 60.0 1.0 iso 0.0 0.0 10.0

# Run equilibration
timestep        0.001
thermo          100
thermo_style    custom step temp press vol
run             10000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 7, bins = 4 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 3.264 | 3.264 | 3.264 Mbytes
   Step          Temp          Press          Volume    
         0   60            -1638.7264      19737.726    
       100   35.615402     -976.4584       19716.377    
       200   14.997048     -387.16476      19667.543    
       300   27.385855     -632.88662      19605.848    
       400   30.56589      -607.84965      19527.914    
       500   33.936468     -550.97113      19434.056    
       600   36.398522     -471.06065      19326.679    
       700   35.652607     -286.22038      19209.074    
       800   34.806982     -81.594232      19087.131    
       900   39.278772     -3.2567651      18966.686    
      1000   38.884755      207.51418      18851.237    
      1100   40.338383      366.81121      18745.934    
      1200   41.905866      502.34769      18654.836    
      1300   42.579064      646.02145      18580.704    
      1400   43.548229      747.32809      18526.043    
      1500   43.442864      844.67804      18492.326    
      1600   45.215248      859.63627      18480.514    
      1700   47.238674      826.33689      18489.87     
      1800   44.656563      865.48783      18518.976    
      1900   45.559182      787.64278      18567.451    
      2000   44.774589      739.9671       18633.041    
      2100   46.528093      596.49491      18713.645    
      2200   48.44013       426.79809      18805.21     
      2300   44.403069      400.68491      18903.502    
      2400   46.50269       222.78985      19006.527    
      2500   45.264836      142.83374      19110.118    
      2600   43.065569      93.192191      19211.797    
      2700   46.805588     -104.35611      19309.693    
      2800   48.075119     -217.67271      19399.328    
      2900   44.334831     -186.54474      19478.333    
      3000   48.116563     -330.28184      19547.22     
      3100   48.198589     -360.03533      19603.569    
      3200   45.498657     -310.46739      19647.158    
      3300   45.782883     -328.27497      19679.767    
      3400   45.263817     -304.76504      19701.893    
      3500   48.85157      -366.65604      19714.359    
      3600   51.000271     -384.92117      19716.297    
      3700   48.569707     -283.99831      19707.968    
      3800   51.57676      -297.24154      19691.755    
      3900   50.97034      -212.94659      19668.362    
      4000   52.308324     -176.33839      19639.902    
      4100   53.522811     -139.57866      19607.66     
      4200   52.805158     -40.757858      19572.915    
      4300   51.94082       66.373854      19538.218    
      4400   54.252671      78.771292      19506.268    
      4500   59.083998      28.865842      19477.265    
      4600   58.354034      121.77828      19450.351    
      4700   59.045464      170.04574      19427.441    
      4800   60.80035       180.04561      19409.62     
      4900   58.318148      287.82363      19397.313    
      5000   60.352309      276.70719      19392.741    
      5100   60.470096      293.59831      19395.89     
      5200   60.76399       297.85842      19406.882    
      5300   62.019191      259.93123      19425.495    
      5400   60.467359      280.81641      19450.994    
      5500   64.329067      161.02757      19483.224    
      5600   61.697045      202.79271      19519.631    
      5700   57.916865      255.2421       19560.984    
      5800   63.353173      62.838534      19607.882    
      5900   63.898142      3.9412463      19656.003    
      6000   59.443284      72.028108      19703.671    
      6100   61.8197       -33.228202      19751.892    
      6200   63.256959     -114.09577      19798.234    
      6300   59.005627     -48.091904      19840.843    
      6400   57.436749     -46.421356      19881.047    
      6500   58.044622     -103.89954      19919.015    
      6600   62.713369     -244.73873      19952.825    
      6700   61.322637     -230.46908      19979.444    
      6800   61.07112      -225.90284      19998.811    
      6900   61.084966     -234.23156      20011.306    
      7000   62.249479     -261.65311      20016.657    
      7100   59.908376     -188.04814      20014.765    
      7200   59.108449     -148.5625       20007.499    
      7300   59.859764     -152.11162      19996.022    
      7400   60.715194     -144.4199       19980.472    
      7500   59.068546     -75.301654      19961.424    
      7600   64.225508     -174.97347      19940.099    
      7700   64.772036     -148.24271      19914.71     
      7800   60.979374     -16.589236      19886.044    
      7900   64.731918     -72.154974      19856.966    
      8000   62.680354      15.969887      19827.058    
      8100   61.542371      84.561093      19798.292    
      8200   65.815459      8.9805185      19772.095    
      8300   63.319081      90.891882      19747.315    
      8400   65.408969      68.327636      19725.21     
      8500   63.275159      128.66647      19705.881    
      8600   64.412874      106.51689      19690.265    
      8700   63.905311      110.77252      19678.118    
      8800   64.181941      96.810959      19669.25     
      8900   63.307646      107.87428      19663.276    
      9000   60.603965      158.131        19660.566    
      9100   63.350512      67.462483      19661.844    
      9200   63.114047      43.964917      19665.172    
      9300   60.438647      85.778093      19669.923    
      9400   62.987941     -5.5710258      19676.565    
      9500   59.770774      43.996218      19683.31     
      9600   57.664925      66.927824      19691.113    
      9700   59.59345      -12.584152      19700.362    
      9800   60.924536     -70.295617      19709.146    
      9900   57.503159     -7.6797302      19716.213    
     10000   58.259575     -56.097007      19722.473    
Loop time of 6.25871 on 1 procs for 10000 steps with 500 atoms

Performance: 138.048 ns/day, 0.174 hours/ns, 1597.772 timesteps/s, 798.886 katom-step/s
98.8% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.0061     | 6.0061     | 6.0061     |   0.0 | 95.96
Neigh   | 0.052678   | 0.052678   | 0.052678   |   0.0 |  0.84
Comm    | 0.097774   | 0.097774   | 0.097774   |   0.0 |  1.56
Output  | 0.00081446 | 0.00081446 | 0.00081446 |   0.0 |  0.01
Modify  | 0.084827   | 0.084827   | 0.084827   |   0.0 |  1.36
Other   |            | 0.01653    |            |       |  0.26

Nlocal:            500 ave         500 max         500 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           4130 ave        4130 max        4130 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          75982 ave       75982 max       75982 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 75982
Ave neighs/atom = 151.964
Neighbor list builds = 31
Dangerous builds = 0

# Change box dimensions to maintain correct density
unfix           1
fix             2 all nvt temp 60.0 60.0 1.0

# Compute necessary properties for elastic constants
compute         1 all stress/atom NULL
compute         2 all reduce sum c_1[1] c_1[2] c_1[3] c_1[4] c_1[5] c_1[6]

# Setup output for elastic constants calculation
variable        V equal vol
variable        C11 equal (c_2[1]+c_2[2]+c_2[3])/3/${V}*160.21766208
variable        C11 equal (c_2[1]+c_2[2]+c_2[3])/3/19722.4730883989*160.21766208
variable        C12 equal (c_2[4]+c_2[5]+c_2[6])/3/${V}*160.21766208
variable        C12 equal (c_2[4]+c_2[5]+c_2[6])/3/19722.4730883989*160.21766208
variable        C44 equal (c_2[1]-c_2[2])/2/${V}*160.21766208
variable        C44 equal (c_2[1]-c_2[2])/2/19722.4730883989*160.21766208

# Run the simulation and calculate elastic constants
run             20000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 4.014 | 4.014 | 4.014 Mbytes
   Step          Temp          Press          Volume    
     10000   58.259575     -56.097007      19722.473    
     10100   59.320827     -91.403992      19722.473    
     10200   57.483493     -36.919188      19722.473    
     10300   57.51248      -33.993281      19722.473    
     10400   62.794553     -161.52957      19722.473    
     10500   59.447235     -76.393516      19722.473    
     10600   58.345932     -45.170096      19722.473    
     10700   59.64536      -67.474387      19722.473    
     10800   56.437936      20.351385      19722.473    
     10900   56.096424      26.266156      19722.473    
     11000   59.400146     -47.786373      19722.473    
     11100   60.177827     -51.080327      19722.473    
     11200   61.439162     -68.518536      19722.473    
     11300   58.464336      10.926265      19722.473    
     11400   59.422843     -1.2209845      19722.473    
     11500   62.962731     -71.358661      19722.473    
     11600   61.744743     -17.543429      19722.473    
     11700   60.450992      36.268829      19722.473    
     11800   61.000861      39.546939      19722.473    
     11900   61.113084      41.217845      19722.473    
     12000   61.983757      33.640596      19722.473    
     12100   61.791141      51.12571       19722.473    
     12200   63.291907      22.955037      19722.473    
     12300   63.409649      29.865588      19722.473    
     12400   61.131944      89.632311      19722.473    
     12500   61.313973      86.603355      19722.473    
     12600   66.341483     -28.783276      19722.473    
     12700   63.475765      51.54076       19722.473    
     12800   60.531255      120.873        19722.473    
     12900   63.825913      32.081015      19722.473    
     13000   61.279919      92.755967      19722.473    
     13100   60.378319      118.91974      19722.473    
     13200   61.002971      91.56738       19722.473    
     13300   62.686945      36.192013      19722.473    
     13400   63.622103      9.7865205      19722.473    
     13500   63.609112      2.7013304      19722.473    
     13600   64.71624      -21.276887      19722.473    
     13700   56.834143      167.7664       19722.473    
     13800   63.465785      6.1841119      19722.473    
     13900   63.95442      -15.490742      19722.473    
     14000   60.809998      53.660388      19722.473    
     14100   58.886237      87.785443      19722.473    
     14200   61.078097      28.648559      19722.473    
     14300   62.728237     -26.612315      19722.473    
     14400   61.608165      5.0449607      19722.473    
     14500   58.694052      81.107654      19722.473    
     14600   60.629065      18.938261      19722.473    
     14700   62.268755     -27.011899      19722.473    
     14800   59.869818      32.816906      19722.473    
     14900   61.4812       -10.67075       19722.473    
     15000   61.075212     -11.159761      19722.473    
     15100   58.869896      33.489303      19722.473    
     15200   61.727588     -41.176576      19722.473    
     15300   61.915834     -48.657314      19722.473    
     15400   59.390433      10.510118      19722.473    
     15500   57.472521      46.553718      19722.473    
     15600   59.659721     -19.955266      19722.473    
     15700   61.680768     -72.796465      19722.473    
     15800   58.335521      8.6334031      19722.473    
     15900   60.703512     -48.069663      19722.473    
     16000   61.828535     -83.619226      19722.473    
     16100   58.805713     -18.12131       19722.473    
     16200   59.82084      -48.810895      19722.473    
     16300   58.442332     -26.668734      19722.473    
     16400   58.464182     -28.178565      19722.473    
     16500   58.24238      -19.382618      19722.473    
     16600   58.946892     -38.27186       19722.473    
     16700   59.206076     -53.621496      19722.473    
     16800   58.829637     -46.174317      19722.473    
     16900   56.282682      10.666933      19722.473    
     17000   60.9953       -104.88697      19722.473    
     17100   60.13506      -82.194023      19722.473    
     17200   58.843082     -49.649888      19722.473    
     17300   58.014205     -39.0827        19722.473    
     17400   59.62544      -81.350031      19722.473    
     17500   57.620108     -28.988451      19722.473    
     17600   57.187176     -11.281764      19722.473    
     17700   58.688835     -46.279416      19722.473    
     17800   61.057578     -105.44878      19722.473    
     17900   58.647348     -44.625724      19722.473    
     18000   57.117241      1.5163746      19722.473    
     18100   58.95466      -38.039234      19722.473    
     18200   60.364558     -68.038455      19722.473    
     18300   60.427125     -52.663613      19722.473    
     18400   59.981609     -32.152932      19722.473    
     18500   59.890592     -24.526145      19722.473    
     18600   60.249805     -25.355072      19722.473    
     18700   58.700912      25.125899      19722.473    
     18800   58.951689      30.554445      19722.473    
     18900   61.043136     -11.028702      19722.473    
     19000   62.317423     -18.843547      19722.473    
     19100   62.010581      10.092746      19722.473    
     19200   61.057863      32.001651      19722.473    
     19300   61.070103      34.027811      19722.473    
     19400   61.199031      39.050628      19722.473    
     19500   62.307353      27.676025      19722.473    
     19600   60.949182      72.598676      19722.473    
     19700   61.433009      67.404227      19722.473    
     19800   62.041387      48.106508      19722.473    
     19900   63.455339      14.42489       19722.473    
     20000   61.336385      69.869835      19722.473    
     20100   60.733828      84.878566      19722.473    
     20200   62.837843      34.030983      19722.473    
     20300   61.811024      50.920182      19722.473    
     20400   61.69607       50.700706      19722.473    
     20500   63.539728      7.0595916      19722.473    
     20600   61.75657       52.769641      19722.473    
     20700   60.371147      80.391396      19722.473    
     20800   62.435063      9.2834475      19722.473    
     20900   62.587002     -8.1293727      19722.473    
     21000   64.949431     -69.673621      19722.473    
     21100   58.785291      68.211955      19722.473    
     21200   60.137523      20.207572      19722.473    
     21300   60.933305     -20.227082      19722.473    
     21400   61.191793     -39.976412      19722.473    
     21500   59.135189     -11.879075      19722.473    
     21600   58.626594     -15.745751      19722.473    
     21700   58.625704     -32.948568      19722.473    
     21800   59.124641     -57.221747      19722.473    
     21900   58.011804     -31.374239      19722.473    
     22000   58.057265     -34.378408      19722.473    
     22100   56.485364     -6.9477269      19722.473    
     22200   58.272352     -58.861386      19722.473    
     22300   60.637412     -117.44679      19722.473    
     22400   57.236174     -34.127498      19722.473    
     22500   56.571847     -18.065004      19722.473    
     22600   58.696333     -73.178912      19722.473    
     22700   60.041176     -107.98916      19722.473    
     22800   59.566996     -89.8274        19722.473    
     22900   60.61399      -106.10032      19722.473    
     23000   58.608562     -66.617364      19722.473    
     23100   57.437843     -37.123687      19722.473    
     23200   58.040471     -38.642396      19722.473    
     23300   57.915784     -24.811597      19722.473    
     23400   56.907709     -2.076517       19722.473    
     23500   59.359791     -60.57263       19722.473    
     23600   58.452854     -35.182394      19722.473    
     23700   60.270259     -76.659186      19722.473    
     23800   60.991822     -84.149767      19722.473    
     23900   60.648393     -67.467142      19722.473    
     24000   58.914533     -23.07204       19722.473    
     24100   59.263506     -31.407562      19722.473    
     24200   59.135581     -15.780104      19722.473    
     24300   58.329355      20.424952      19722.473    
     24400   59.039631      2.2692108      19722.473    
     24500   60.639503     -33.050269      19722.473    
     24600   60.221747     -7.2965431      19722.473    
     24700   60.372479     -0.22243342     19722.473    
     24800   62.682757     -53.247633      19722.473    
     24900   59.984283      12.432987      19722.473    
     25000   61.577454     -22.870056      19722.473    
     25100   62.401705     -32.494653      19722.473    
     25200   59.034303      53.013987      19722.473    
     25300   60.779425      13.184388      19722.473    
     25400   57.057563      106.77525      19722.473    
     25500   60.796549      23.596427      19722.473    
     25600   60.260823      40.135349      19722.473    
     25700   60.623191      36.685164      19722.473    
     25800   62.645666     -12.741505      19722.473    
     25900   64.001208     -46.892862      19722.473    
     26000   61.899782      8.1004287      19722.473    
     26100   60.617562      44.765755      19722.473    
     26200   61.39795       34.489514      19722.473    
     26300   57.903562      118.7107       19722.473    
     26400   62.065754      13.828793      19722.473    
     26500   62.015893      12.868529      19722.473    
     26600   62.672926     -0.91286191     19722.473    
     26700   60.829075      38.159849      19722.473    
     26800   60.795893      30.149095      19722.473    
     26900   61.146132      19.768268      19722.473    
     27000   60.769622      25.159989      19722.473    
     27100   62.464312     -29.865377      19722.473    
     27200   61.940991     -28.898514      19722.473    
     27300   60.820966     -3.5390743      19722.473    
     27400   58.601432      40.905224      19722.473    
     27500   59.383385      10.233205      19722.473    
     27600   58.735492      23.306592      19722.473    
     27700   59.164102     -2.2520945      19722.473    
     27800   62.358001     -101.60201      19722.473    
     27900   60.146662     -53.607367      19722.473    
     28000   59.642909     -50.244098      19722.473    
     28100   58.938711     -47.690722      19722.473    
     28200   60.335253     -80.110945      19722.473    
     28300   57.758951     -23.258901      19722.473    
     28400   56.168532      8.1189044      19722.473    
     28500   56.222573     -3.0675895      19722.473    
     28600   59.461078     -86.891256      19722.473    
     28700   58.348349     -67.30939       19722.473    
     28800   60.020013     -104.16223      19722.473    
     28900   59.193163     -89.565918      19722.473    
     29000   58.716667     -86.996523      19722.473    
     29100   55.009564      1.8803754      19722.473    
     29200   57.577615     -53.945468      19722.473    
     29300   58.764428     -82.770603      19722.473    
     29400   59.939725     -108.33514      19722.473    
     29500   57.408208     -44.450055      19722.473    
     29600   59.935999     -101.68788      19722.473    
     29700   58.273569     -56.914545      19722.473    
     29800   57.274163     -29.833584      19722.473    
     29900   60.613812     -100.64712      19722.473    
     30000   59.750679     -69.919578      19722.473    
Loop time of 12.2087 on 1 procs for 20000 steps with 500 atoms

Performance: 141.538 ns/day, 0.170 hours/ns, 1638.176 timesteps/s, 819.088 katom-step/s
98.8% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.764     | 11.764     | 11.764     |   0.0 | 96.36
Neigh   | 0.12111    | 0.12111    | 0.12111    |   0.0 |  0.99
Comm    | 0.19562    | 0.19562    | 0.19562    |   0.0 |  1.60
Output  | 0.001879   | 0.001879   | 0.001879   |   0.0 |  0.02
Modify  | 0.092484   | 0.092484   | 0.092484   |   0.0 |  0.76
Other   |            | 0.03313    |            |       |  0.27

Nlocal:            500 ave         500 max         500 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           4120 ave        4120 max        4120 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          76104 ave       76104 max       76104 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 76104
Ave neighs/atom = 152.208
Neighbor list builds = 71
Dangerous builds = 0

# Output the calculated elastic constants
print           "C11 = ${C11} GPa"
ERROR: Per-atom virial was not tallied on needed timestep (../compute_stress_atom.cpp:145)
Last command: C11 = ${C11
