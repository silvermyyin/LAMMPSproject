LAMMPS (27 Jun 2024 - Development - patch_27Jun2024-612-gaa0b6c47c2-modified)
# LAMMPS Input Script for Calculating Thermal Conductivity of LJ Liquid using Muller-Plathe Method

units lj
atom_style atomic

# Create simulation box and atoms
lattice fcc 0.6
Lattice spacing in x,y,z = 1.8820721 1.8820721 1.8820721
region box block 0 10 0 10 0 20
create_box 1 box
Created orthogonal box = (0 0 0) to (18.820721 18.820721 37.641441)
  1 by 1 by 1 MPI processor grid
create_atoms 1 box
Created 8000 atoms
  using lattice units in orthogonal box = (0 0 0) to (18.820721 18.820721 37.641441)
  create_atoms CPU = 0.000 seconds

mass 1 1.0

# Define interatomic potential
pair_style lj/cut 2.5
pair_coeff 1 1 1.0 1.0 2.5

# Set initial velocities
velocity all create 1.35 12345

# Equilibration phase using NVT ensemble
timestep 0.005
thermo 100
thermo_style custom step temp pe ke etotal

fix 1 all nvt temp 1.35 1.35 0.5
run 10000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.8
  ghost atom cutoff = 2.8
  binsize = 1.4, bins = 14 14 27
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.144 | 4.144 | 4.144 Mbytes
   Step          Temp          PotEng         KinEng         TotEng    
         0   1.35          -4.1241917      2.0247469     -2.0994448    
       100   1.1938723     -3.781369       1.7905846     -1.9907844    
       200   1.2717086     -3.7603979      1.9073244     -1.8530735    
       300   1.3254033     -3.718754       1.9878564     -1.7308976    
       400   1.3695117     -3.7043773      2.0540108     -1.6503665    
       500   1.3695249     -3.6950393      2.0540305     -1.6410087    
       600   1.3525482     -3.7212115      2.0285686     -1.6926429    
       700   1.3232787     -3.7139397      1.98467       -1.7292698    
       800   1.334374      -3.704766       2.0013109     -1.7034551    
       900   1.355252      -3.6840853      2.032624      -1.6514613    
      1000   1.3682587     -3.6943646      2.0521316     -1.642233     
      1100   1.3441317     -3.7046236      2.0159456     -1.688678     
      1200   1.3399182     -3.7242604      2.009626      -1.7146344    
      1300   1.3355434     -3.7036684      2.0030646     -1.7006037    
      1400   1.3543011     -3.7042207      2.0311977     -1.673023     
      1500   1.3561157     -3.7061313      2.0339193     -1.672212     
      1600   1.3445912     -3.7152601      2.0166346     -1.6986255    
      1700   1.3278871     -3.708117       1.9915817     -1.7165353    
      1800   1.3506034     -3.7195373      2.0256519     -1.6938854    
      1900   1.3639258     -3.7115843      2.045633      -1.6659513    
      2000   1.3581068     -3.7079939      2.0369056     -1.6710884    
      2100   1.3327378     -3.7011943      1.9988568     -1.7023376    
      2200   1.3372004     -3.7108152      2.0055499     -1.7052653    
      2300   1.3632059     -3.7137207      2.0445532     -1.6691674    
      2400   1.3759092     -3.7019473      2.0636058     -1.6383415    
      2500   1.3584148     -3.7018928      2.0373676     -1.6645252    
      2600   1.348716      -3.7051845      2.022821      -1.6823635    
      2700   1.344119      -3.708536       2.0159264     -1.6926096    
      2800   1.3382351     -3.7069281      2.0071017     -1.6998264    
      2900   1.3523812     -3.7128883      2.0283182     -1.68457      
      3000   1.3675992     -3.7034308      2.0511424     -1.6522884    
      3100   1.3698589     -3.7143575      2.0545314     -1.6598261    
      3200   1.3355003     -3.7069629      2.003         -1.7039629    
      3300   1.3424235     -3.7094509      2.0133836     -1.6960673    
      3400   1.3534763     -3.7012129      2.0299607     -1.6712522    
      3500   1.3510069     -3.6861724      2.026257      -1.6599155    
      3600   1.343525      -3.7094122      2.0150356     -1.6943766    
      3700   1.3293328     -3.7221446      1.99375       -1.7283945    
      3800   1.3433579     -3.7218827      2.014785      -1.7070977    
      3900   1.3516444     -3.7078101      2.0272132     -1.6805968    
      4000   1.3544245     -3.703867       2.0313828     -1.6724842    
      4100   1.3597155     -3.7216529      2.0393183     -1.6823346    
      4200   1.3422007     -3.7384121      2.0130493     -1.7253628    
      4300   1.3234885     -3.7284877      1.9849845     -1.7435032    
      4400   1.3278728     -3.7021671      1.9915603     -1.7106068    
      4500   1.3559966     -3.7234113      2.0337406     -1.6896707    
      4600   1.3634121     -3.7248407      2.0448625     -1.6799782    
      4700   1.3440765     -3.7162434      2.0158627     -1.7003807    
      4800   1.3326829     -3.7253673      1.9987745     -1.7265927    
      4900   1.3460997     -3.7113257      2.0188971     -1.6924286    
      5000   1.3664636     -3.7102387      2.0494392     -1.6607996    
      5100   1.351185      -3.7028852      2.0265242     -1.676361     
      5200   1.3457573     -3.7181022      2.0183836     -1.6997186    
      5300   1.3281431     -3.7049674      1.9919657     -1.7130017    
      5400   1.3635404     -3.7208081      2.0450549     -1.6757532    
      5500   1.3668197     -3.697085       2.0499732     -1.6471118    
      5600   1.3551768     -3.701177       2.0325112     -1.6686658    
      5700   1.3392618     -3.6961623      2.0086415     -1.6875208    
      5800   1.3592933     -3.7294184      2.0386851     -1.6907334    
      5900   1.3479724     -3.7195032      2.0217058     -1.6977974    
      6000   1.3418109     -3.7297582      2.0124648     -1.7172933    
      6100   1.3309335     -3.7186267      1.9961507     -1.722476     
      6200   1.3479861     -3.7035206      2.0217264     -1.6817943    
      6300   1.3466921     -3.6851784      2.0197856     -1.6653927    
      6400   1.3494997     -3.7022911      2.0239965     -1.6782945    
      6500   1.3254748     -3.7012023      1.9879636     -1.7132387    
      6600   1.3396855     -3.713663       2.009277      -1.7043859    
      6700   1.3766008     -3.7165963      2.0646431     -1.6519532    
      6800   1.3539516     -3.6992823      2.0306735     -1.6686088    
      6900   1.3543584     -3.7330299      2.0312836     -1.7017463    
      7000   1.3384514     -3.7213191      2.0074262     -1.7138929    
      7100   1.3508275     -3.7183997      2.025988      -1.6924117    
      7200   1.3596465     -3.6910941      2.0392148     -1.6518793    
      7300   1.3605959     -3.697308       2.0406388     -1.6566692    
      7400   1.3563896     -3.7103963      2.0343301     -1.6760662    
      7500   1.3338345     -3.6854954      2.0005016     -1.6849938    
      7600   1.3473315     -3.709239       2.0207447     -1.6884943    
      7700   1.3558809     -3.7128547      2.0335671     -1.6792876    
      7800   1.3525187     -3.6889197      2.0285244     -1.6603953    
      7900   1.3604883     -3.6993032      2.0404773     -1.6588259    
      8000   1.3372113     -3.7025086      2.0055662     -1.6969423    
      8100   1.3319981     -3.7102816      1.9977474     -1.7125342    
      8200   1.3545667     -3.7160589      2.031596      -1.6844629    
      8300   1.3679984     -3.7145696      2.0517411     -1.6628286    
      8400   1.3626232     -3.7166412      2.0436792     -1.672962     
      8500   1.3356287     -3.6883788      2.0031926     -1.6851862    
      8600   1.3501548     -3.7118151      2.024979      -1.6868361    
      8700   1.3549588     -3.7195741      2.0321841     -1.6873901    
      8800   1.3411251     -3.7075818      2.0114361     -1.6961457    
      8900   1.3427935     -3.7010698      2.0139384     -1.6871313    
      9000   1.3654815     -3.7148482      2.0479662     -1.6668821    
      9100   1.3571597     -3.6968388      2.0354851     -1.6613537    
      9200   1.3405753     -3.6995386      2.0106116     -1.6889269    
      9300   1.3362681     -3.721166       2.0041516     -1.7170144    
      9400   1.3396607     -3.7081057      2.0092399     -1.6988658    
      9500   1.3664575     -3.709532       2.04943       -1.660102     
      9600   1.3562132     -3.7061835      2.0340655     -1.672118     
      9700   1.3375719     -3.6985566      2.0061071     -1.6924496    
      9800   1.3423763     -3.7053748      2.0133128     -1.692062     
      9900   1.3758915     -3.7253746      2.0635792     -1.6617954    
     10000   1.3750066     -3.7033542      2.0622521     -1.6411021    
Loop time of 29.8982 on 1 procs for 10000 steps with 8000 atoms

Performance: 144490.170 tau/day, 334.468 timesteps/s, 2.676 Matom-step/s
97.8% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 17.196     | 17.196     | 17.196     |   0.0 | 57.52
Neigh   | 11.235     | 11.235     | 11.235     |   0.0 | 37.58
Comm    | 0.51171    | 0.51171    | 0.51171    |   0.0 |  1.71
Output  | 0.0020805  | 0.0020805  | 0.0020805  |   0.0 |  0.01
Modify  | 0.79452    | 0.79452    | 0.79452    |   0.0 |  2.66
Other   |            | 0.1589     |            |       |  0.53

Nlocal:           8000 ave        8000 max        8000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           7427 ave        7427 max        7427 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         216881 ave      216881 max      216881 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 216881
Ave neighs/atom = 27.110125
Neighbor list builds = 1652
Dangerous builds = 0
unfix 1

# Switch to NVE ensemble for production run
fix 2 all nve

# Apply Muller-Plathe method for thermal conductivity calculation
compute myTemp all temp
variable dT equal 0.0
fix 3 all thermal/conductivity 100 z 20 swap 1
fix 4 all ave/chunk 10 100 1000 c_myTemp file temp_profile.txt
ERROR: No values in fix ave/chunk command (../fix_ave_chunk.cpp:135)
Last command: fix 4 all ave/chunk 10 100 1000 c_myTemp file temp_profile.txt
