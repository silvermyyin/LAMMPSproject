LAMMPS (27 Jun 2024 - Development - patch_27Jun2024-612-gaa0b6c47c2-modified)
# LAMMPS input script for simulating elastic properties of an FCC Argon lattice

units real
atom_style atomic
boundary p p p

# Create FCC lattice
lattice fcc 5.405
Lattice spacing in x,y,z = 5.405 5.405 5.405
region box block 0 10 0 10 0 10
create_box 1 box
Created orthogonal box = (0 0 0) to (54.05 54.05 54.05)
  1 by 1 by 1 MPI processor grid
create_atoms 1 box
Created 4000 atoms
  using lattice units in orthogonal box = (0 0 0) to (54.05 54.05 54.05)
  create_atoms CPU = 0.000 seconds

# Define Lennard-Jones potential for Argon
pair_style lj/cut 10.0
pair_coeff 1 1 0.238 3.405  # epsilon in kcal/mol, sigma in Angstroms

# Define masses
mass 1 39.948

# Set initial velocity
velocity all create 60.0 12345

# Thermo settings
thermo 100
thermo_style custom step temp press etotal

# NPT Equilibration
fix 1 all npt temp 60.0 60.0 100.0 iso 0.0 0.0 1000.0
run 5000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 10 10 10
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.593 | 4.593 | 4.593 Mbytes
   Step          Temp          Press          TotEng    
         0   60            -1382.8767     -6891.2513    
       100   34.222033      349.68836     -7030.0205    
       200   21.249783      247.58046     -6983.8477    
       300   35.618845     -293.04133     -6881.7957    
       400   36.689676      213.64368     -6785.4683    
       500   49.572913     -32.923022     -6659.5599    
       600   53.318198      57.781366     -6539.91      
       700   52.37693       143.58044     -6425.7628    
       800   57.332579     -61.168112     -6307.5065    
       900   60.015779      18.739229     -6220.3671    
      1000   59.939388      82.386602     -6158.5909    
      1100   62.378837     -54.242031     -6112.7868    
      1200   59.734992     -0.9578562     -6115.2546    
      1300   60.744104     -20.51219      -6123.7769    
      1400   61.599826     -38.877074     -6149.0876    
      1500   60.591985     -10.46704      -6206.3324    
      1600   58.450468      24.868561     -6255.3341    
      1700   59.743611     -21.854007     -6270.9445    
      1800   59.387907      18.47868      -6276.5371    
      1900   59.571091      18.751971     -6268.2886    
      2000   60.32612      -9.5384243     -6250.6266    
      2100   59.800173      11.030198     -6239.7442    
      2200   60.136179     -2.7216485     -6225.4301    
      2300   60.272852      0.4026115     -6213.8241    
      2400   60.076199      0.47479362    -6208.942     
      2500   60.598176     -18.550345     -6206.9608    
      2600   60.425711     -1.8592392     -6219.4708    
      2700   58.846341      24.485535     -6236.0761    
      2800   59.980681     -21.32136      -6232.4559    
      2900   59.66654       20.78381      -6224.5061    
      3000   60.445396      1.4945322     -6211.4568    
      3100   61.273152     -36.955398     -6209.1003    
      3200   59.584356      18.86931      -6232.938     
      3300   59.175783      9.2049679     -6247.2812    
      3400   61.111275     -39.160445     -6248.9626    
      3500   58.669454      52.323449     -6265.8088    
      3600   59.844843     -13.268763     -6259.6611    
      3700   60.089392     -13.776927     -6245.6291    
      3800   60.16424       26.629192     -6236.7483    
      3900   59.911392     -4.0889667     -6227.9864    
      4000   60.343709     -26.88957      -6219.8792    
      4100   59.577156      30.995317     -6217.5827    
      4200   60.941343     -21.281807     -6208.8782    
      4300   60.577864     -19.181299     -6220.1027    
      4400   59.083797      31.782642     -6242.4775    
      4500   59.936578     -13.32832      -6247.35      
      4600   59.833619     -6.096972      -6247.3533    
      4700   60.112372      16.898317     -6245.4518    
      4800   59.775754      5.8124088     -6243.5844    
      4900   60.140089     -22.93351      -6238.0542    
      5000   59.730916      16.871741     -6235.1735    
Loop time of 15.4594 on 1 procs for 5000 steps with 4000 atoms

Performance: 27.944 ns/day, 0.859 hours/ns, 323.428 timesteps/s, 1.294 Matom-step/s
97.4% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.774     | 14.774     | 14.774     |   0.0 | 95.57
Neigh   | 0.14379    | 0.14379    | 0.14379    |   0.0 |  0.93
Comm    | 0.12948    | 0.12948    | 0.12948    |   0.0 |  0.84
Output  | 0.00071587 | 0.00071587 | 0.00071587 |   0.0 |  0.00
Modify  | 0.37073    | 0.37073    | 0.37073    |   0.0 |  2.40
Other   |            | 0.04081    |            |       |  0.26

Nlocal:           4000 ave        4000 max        4000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           8195 ave        8195 max        8195 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         364070 ave      364070 max      364070 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 364070
Ave neighs/atom = 91.0175
Neighbor list builds = 22
Dangerous builds = 0

# Switch to NVT for constant temperature
unfix 1
fix 2 all nvt temp 60.0 60.0 100.0
run 5000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 4.593 | 4.593 | 4.593 Mbytes
   Step          Temp          Press          TotEng    
      5000   59.730916      16.871741     -6235.1735    
      5100   59.812835      30.826365     -6227.5443    
      5200   61.377809      30.811069     -6210.8907    
      5300   59.759566      44.045601     -6223.4387    
      5400   59.126565      17.297098     -6242.7352    
      5500   60.304325     -4.9905222     -6238.8664    
      5600   59.503394      16.533029     -6237.7172    
      5700   61.363734      1.8262336     -6224.7894    
      5800   60.82953       8.5970746     -6227.4495    
      5900   58.95098       9.313815      -6247.9182    
      6000   59.182699      19.47017      -6241.4916    
      6100   59.879338      40.159835     -6224.933     
      6200   59.840668      57.614746     -6218.3063    
      6300   60.158292      65.218344     -6212.0575    
      6400   61.639984      22.347264     -6214.5892    
      6500   59.668227      2.2111793     -6242.5885    
      6600   60.250067     -20.408501     -6246.5125    
      6700   59.082837     -8.358063      -6252.8899    
      6800   60.156624     -11.420846     -6242.3003    
      6900   61.076168     -10.392781     -6233.3797    
      7000   58.695909      25.442102     -6242.4559    
      7100   61.596703     -4.1449313     -6224.4337    
      7200   60.446824      40.658277     -6217.8902    
      7300   59.377754      53.736133     -6224.8409    
      7400   61.529075      9.8950751     -6219.9553    
      7500   59.668161      1.763364      -6240.5221    
      7600   59.572355     -22.750058     -6252.327     
      7700   59.309873     -11.205642     -6250.092     
      7800   60.846275     -3.9637741     -6231.3206    
      7900   60.726308      4.0612587     -6230.5647    
      8000   59.164989      24.557857     -6239.5084    
      8100   59.960151      14.243949     -6234.7987    
      8200   59.927552      16.560765     -6233.6633    
      8300   60.076747      17.340403     -6232.6468    
      8400   60.354804      9.1117343     -6233.1224    
      8500   58.577735      20.948896     -6244.8913    
      8600   59.802836      12.537578     -6235.4078    
      8700   61.400995      7.2267548     -6221.2938    
      8800   60.250846      2.1230003     -6235.2782    
      8900   60.007761     -12.544003     -6245.4257    
      9000   59.316489      3.7261612     -6246.5102    
      9100   60.166198      12.379166     -6234.8735    
      9200   60.920574      11.929141     -6225.6948    
      9300   59.480799      4.333766      -6243.2853    
      9400   58.267951     -3.2220007     -6259.9508    
      9500   59.436578      6.7238025     -6244.364     
      9600   59.785693      34.518115     -6228.0321    
      9700   61.00135       27.144533     -6218.5159    
      9800   60.018397      26.482709     -6230.4641    
      9900   59.201099      17.8298       -6241.7765    
     10000   60.110381      2.4974032     -6237.753     
Loop time of 15.0401 on 1 procs for 5000 steps with 4000 atoms

Performance: 28.723 ns/day, 0.836 hours/ns, 332.445 timesteps/s, 1.330 Matom-step/s
98.1% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.519     | 14.519     | 14.519     |   0.0 | 96.54
Neigh   | 0.13727    | 0.13727    | 0.13727    |   0.0 |  0.91
Comm    | 0.12861    | 0.12861    | 0.12861    |   0.0 |  0.86
Output  | 0.00070662 | 0.00070662 | 0.00070662 |   0.0 |  0.00
Modify  | 0.21471    | 0.21471    | 0.21471    |   0.0 |  1.43
Other   |            | 0.03946    |            |       |  0.26

Nlocal:           4000 ave        4000 max        4000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           8195 ave        8195 max        8195 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         363880 ave      363880 max      363880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 363880
Ave neighs/atom = 90.97
Neighbor list builds = 21
Dangerous builds = 0

# Calculate stress and elastic constants
compute stress all stress/atom NULL
compute sigma all reduce sum c_stress[1] c_stress[2] c_stress[3] c_stress[4] c_stress[5] c_stress[6]

# Variables for elastic constants in pressure units
variable V equal vol
variable C11 equal (c_sigma[1]/v_V)*160.21766208  # Convert stress to GPa
variable C12 equal (c_sigma[2]/v_V)*160.21766208
variable C44 equal (c_sigma[4]/v_V)*160.21766208

# Output elastic constants
variable C11_avg equal ave(c11)
variable C12_avg equal ave(c12)
variable C44_avg equal ave(c44)

fix 3 all ave/time 10 1 1000 v_C11 v_C12 v_C44 file elastic_constants.txt

# Run more dynamics to average out fluctuations
run 10000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 6.093 | 6.093 | 6.093 Mbytes
   Step          Temp          Press          TotEng    
     10000   60.110381      2.4974032     -6237.753     
     10100   60.241538      1.5912245     -6238.008     
     10200   59.461191      14.884987     -6240.828     
     10300   59.710909      30.999267     -6230.7127    
     10400   62.273983      4.1288241     -6214.6511    
     10500   60.547647      5.0669794     -6230.9342    
     10600   60.009159      1.5997324     -6238.385     
     10700   59.452286      3.6381354     -6243.8096    
     10800   60.236319     -6.706781      -6240.4275    
     10900   60.449958      4.9396957     -6233.2126    
     11000   59.896686      23.144903     -6231.2271    
     11100   60.697597      11.518303     -6228.5139    
     11200   59.646         16.386819     -6238.0812    
     11300   59.019544      14.147872     -6245.4955    
     11400   60.948828     -1.9905085     -6231.6154    
     11500   60.423381      27.841393     -6224.7049    
     11600   59.755393      22.577634     -6232.6698    
     11700   59.627378     -16.282276     -6250.2772    
     11800   59.048854     -16.605849     -6256.1041    
     11900   60.594207     -20.586163     -6241.7444    
     12000   59.887414      17.174102     -6232.8764    
     12100   61.341426      41.813901     -6207.7247    
     12200   60.588278      71.746983     -6202.5288    
     12300   60.248878      58.158204     -6213.4338    
     12400   59.676385      43.497018     -6225.9862    
     12500   59.377288      45.442368     -6226.2243    
     12600   61.40528       0.011915766   -6224.191     
     12700   59.905896      0.26989674    -6239.8378    
     12800   59.771899     -11.547326     -6246.8348    
     12900   59.477884     -3.032552      -6245.8698    
     13000   60.547553      18.319416     -6226.082     
     13100   60.211912      57.504161     -6212.1664    
     13200   60.711628      43.351932     -6214.3286    
     13300   60.138582      30.701356     -6227.1184    
     13400   60.075474      12.051278     -6235.9159    
     13500   60.615039     -11.272269     -6239.0276    
     13600   59.911618     -22.716467     -6250.9036    
     13700   58.607065      2.9788149     -6253.6069    
     13800   60.348902     -3.0755046     -6238.2951    
     13900   59.384332      28.961994     -6233.7782    
     14000   60.494302      22.059402     -6225.3586    
     14100   60.336085      19.759798     -6228.607     
     14200   57.871757      35.998567     -6247.3837    
     14300   60.773158     -8.8576414     -6236.7467    
     14400   61.632229     -8.6854356     -6227.9416    
     14500   58.57251       33.183203     -6240.9535    
     14600   60.85878      -5.5904899     -6233.1373    
     14700   59.590213      9.2021051     -6239.0033    
     14800   59.377592      20.478925     -6237.789     
     14900   61.760208      17.761487     -6214.5629    
     15000   60.350034      34.669854     -6221.1578    
     15100   60.384773      20.763765     -6227.1756    
     15200   59.37385       33.523206     -6232.2579    
     15300   60.397265      20.968485     -6226.9455    
     15400   60.736802      26.192105     -6221.1353    
     15500   59.531758      31.010083     -6231.8125    
     15600   60.190212     -17.292424     -6245.1245    
     15700   59.177369     -27.539044     -6260.7249    
     15800   58.674129     -4.4142947     -6256.5773    
     15900   60.269182     -9.0850418     -6240.8887    
     16000   60.471653     -20.786493     -6242.6173    
     16100   58.340344      15.305247     -6249.3629    
     16200   60.332838      18.996705     -6227.5956    
     16300   60.992943      12.432618     -6223.1055    
     16400   59.614675      12.728411     -6237.965     
     16500   59.347422      9.9836557     -6241.8039    
     16600   59.711497      29.996775     -6229.8378    
     16700   61.020128      33.130856     -6216.6732    
     16800   60.138086      42.35929      -6221.3633    
     16900   60.000726      34.309066     -6225.2762    
     17000   60.431522      14.080639     -6229.626     
     17100   59.427277     -6.4275264     -6248.3629    
     17200   59.641415     -31.688204     -6257.0359    
     17300   59.439627     -20.230752     -6254.0141    
     17400   60.33484      -5.9388396     -6239.2616    
     17500   61.421885      28.802338     -6212.0217    
     17600   61.02486       41.494484     -6209.9663    
     17700   60.394159      37.571779     -6219.1958    
     17800   60.141677      11.147733     -6234.428     
     17900   59.189258      6.5340616     -6246.5056    
     18000   60.099015     -3.1172776     -6241.82      
     18100   60.923782      5.4000844     -6228.8044    
     18200   60.332414      42.795113     -6218.7454    
     18300   60.189704      79.24435      -6206.4869    
     18400   61.22601       87.256988     -6192.6134    
     18500   61.465328      41.255355     -6208.0438    
     18600   60.104935      27.681953     -6227.9849    
     18700   59.603258      25.432656     -6234.1289    
     18800   60.602368     -3.7742217     -6236.2206    
     18900   59.271662     -5.6506097     -6250.3161    
     19000   59.495478     -17.605342     -6253.5986    
     19100   60.890337     -11.691913     -6236.7963    
     19200   61.210771      2.7238622     -6227.2026    
     19300   58.830253      11.910683     -6247.9216    
     19400   59.005806      3.284829      -6249.6262    
     19500   59.637904      9.5014774     -6239.7283    
     19600   60.349721      4.7063276     -6235.0536    
     19700   60.02376       8.048639      -6236.9037    
     19800   59.084184      23.504947     -6240.8368    
     19900   59.821736      47.406714     -6223.456     
     20000   61.163549      46.411994     -6209.5994    
Loop time of 30.5672 on 1 procs for 10000 steps with 4000 atoms

Performance: 28.266 ns/day, 0.849 hours/ns, 327.148 timesteps/s, 1.309 Matom-step/s
97.3% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.5       | 29.5       | 29.5       |   0.0 | 96.51
Neigh   | 0.27342    | 0.27342    | 0.27342    |   0.0 |  0.89
Comm    | 0.26782    | 0.26782    | 0.26782    |   0.0 |  0.88
Output  | 0.0013897  | 0.0013897  | 0.0013897  |   0.0 |  0.00
Modify  | 0.44352    | 0.44352    | 0.44352    |   0.0 |  1.45
Other   |            | 0.08121    |            |       |  0.27

Nlocal:           4000 ave        4000 max        4000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           8195 ave        8195 max        8195 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         363857 ave      363857 max      363857 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 363857
Ave neighs/atom = 90.96425
Neighbor list builds = 43
Dangerous builds = 0

# Print final averaged values
print "Averaged Elastic Constants:"
Averaged Elastic Constants:
print "C11 = ${C11_avg} GPa"
ERROR: Invalid special function in variable formula (../variable.cpp:4496)
Last command: C11 = ${C11_avg
